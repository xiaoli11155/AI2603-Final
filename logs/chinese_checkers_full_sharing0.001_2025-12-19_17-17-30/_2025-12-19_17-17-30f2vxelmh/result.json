{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 510.0, "total_loss": -0.02474311338737607}, "default_policy": {"total_loss": -0.02474311338737607, "policy_loss": -0.04155124160461128, "vf_loss": 0.07472108172732987, "vf_loss_unclipped": 0.07472108172732987, "vf_explained_var": -0.09282832890748978, "entropy": 2.1664677262306213, "mean_kl_loss": 0.0014716104143948083, "gradients_default_optimizer_global_norm": 0.22718332689255477, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 512, "num_env_steps_trained": 0, "num_agent_steps_sampled": 510, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 7.929000000000002, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 6.484500000000002, "episode_len_mean": 231.5, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002], "episode_lengths": [234, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4390315786873784, "mean_inference_ms": 1.1899642907227987, "mean_action_processing_ms": 0.08404579607893056, "mean_env_wait_ms": 5.016123738270325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0037908554077148438, "ViewRequirementAgentConnector_ms": 0.2447962760925293}}, "episode_reward_max": 7.929000000000002, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 6.484500000000002, "episode_len_mean": 231.5, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002], "episode_lengths": [234, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4390315786873784, "mean_inference_ms": 1.1899642907227987, "mean_action_processing_ms": 0.08404579607893056, "mean_env_wait_ms": 5.016123738270325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0037908554077148438, "ViewRequirementAgentConnector_ms": 0.2447962760925293}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 510, "num_agent_steps_trained": 0, "num_env_steps_sampled": 512, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.643466632142032, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 512, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 510, "timers": {"training_iteration_time_ms": 77068.119, "sample_time_ms": 3473.177, "synch_weights_time_ms": 56.182}, "counters": {"num_env_steps_sampled": 512, "num_env_steps_trained": 0, "num_agent_steps_sampled": 510, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 1, "trial_id": "default", "date": "2025-12-19_17-18-50", "timestamp": 1766135930, "time_this_iter_s": 77.07039022445679, "time_total_s": 77.07039022445679, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 77.07039022445679, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 94.14727272727274, "ram_util_percent": 15.870909090909093}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": -0.03801406582351774}, "default_policy": {"total_loss": -0.03801406582351774, "policy_loss": -0.04672604252118617, "vf_loss": 0.042637328943237664, "vf_loss_unclipped": 0.042637328943237664, "vf_explained_var": -0.10918533429503441, "entropy": 2.197794009745121, "mean_kl_loss": 0.0025044194425987596, "gradients_default_optimizer_global_norm": 0.2587443716824055, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1022, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 7.929000000000002, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 6.154250000000003, "episode_len_mean": 233.75, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007], "episode_lengths": [234, 229, 233, 239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43955580488594076, "mean_inference_ms": 1.1820050540759466, "mean_action_processing_ms": 0.08391752725951689, "mean_env_wait_ms": 5.003368727212779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0037610530853271484, "ViewRequirementAgentConnector_ms": 0.2387702465057373}}, "episode_reward_max": 7.929000000000002, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 6.154250000000003, "episode_len_mean": 233.75, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007], "episode_lengths": [234, 229, 233, 239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43955580488594076, "mean_inference_ms": 1.1820050540759466, "mean_action_processing_ms": 0.08391752725951689, "mean_env_wait_ms": 5.003368727212779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0037610530853271484, "ViewRequirementAgentConnector_ms": 0.2387702465057373}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1022, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.665924510038634, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1024, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1022, "timers": {"training_iteration_time_ms": 76938.3, "sample_time_ms": 3445.181, "synch_weights_time_ms": 50.865}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1022, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 2, "trial_id": "default", "date": "2025-12-19_17-20-10", "timestamp": 1766136010, "time_this_iter_s": 76.81033325195312, "time_total_s": 153.8807234764099, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 153.8807234764099, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 91.92300884955752, "ram_util_percent": 15.838938053097348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.07277756953408243}, "default_policy": {"total_loss": 0.07277756953408243, "policy_loss": -0.02902887014206499, "vf_loss": 0.4155109388171695, "vf_loss_unclipped": 1.0324129713117145, "vf_explained_var": -0.0029864713549613954, "entropy": 2.170753465592861, "mean_kl_loss": 0.001989060043280233, "gradients_default_optimizer_global_norm": 0.32784553384408355, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 1536, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1534, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 13.535, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 8.197333333333335, "episode_len_mean": 222.33333333333334, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535], "episode_lengths": [234, 229, 233, 239, 230, 169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43920561938348057, "mean_inference_ms": 1.1780564231584238, "mean_action_processing_ms": 0.08365272948084941, "mean_env_wait_ms": 4.9978983344114125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036438306172688804, "ViewRequirementAgentConnector_ms": 0.23891131083170572}}, "episode_reward_max": 13.535, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 8.197333333333335, "episode_len_mean": 222.33333333333334, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535], "episode_lengths": [234, 229, 233, 239, 230, 169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43920561938348057, "mean_inference_ms": 1.1780564231584238, "mean_action_processing_ms": 0.08365272948084941, "mean_env_wait_ms": 4.9978983344114125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036438306172688804, "ViewRequirementAgentConnector_ms": 0.23891131083170572}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1534, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1536, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.621756012103028, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1536, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1534, "timers": {"training_iteration_time_ms": 77065.808, "sample_time_ms": 3438.029, "synch_weights_time_ms": 51.449}, "counters": {"num_env_steps_sampled": 1536, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1534, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 3, "trial_id": "default", "date": "2025-12-19_17-21-27", "timestamp": 1766136087, "time_this_iter_s": 77.32312345504761, "time_total_s": 231.20384693145752, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 231.20384693145752, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 95.0527272727273, "ram_util_percent": 16.015454545454542}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": -0.023024959303438664}, "default_policy": {"total_loss": -0.023024959303438664, "policy_loss": -0.0604267890448682, "vf_loss": 0.15732948551885784, "vf_loss_unclipped": 0.15732948551885784, "vf_explained_var": 0.17454393729567527, "entropy": 2.137933795154095, "mean_kl_loss": 0.008295809877185433, "gradients_default_optimizer_global_norm": 0.4205636678263545, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2046, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 13.535, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 8.882125000000004, "episode_len_mean": 223.75, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4385839322760644, "mean_inference_ms": 1.175684336408065, "mean_action_processing_ms": 0.08348097492763282, "mean_env_wait_ms": 4.995296164257731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003591179847717285, "ViewRequirementAgentConnector_ms": 0.23688971996307373}}, "episode_reward_max": 13.535, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 8.882125000000004, "episode_len_mean": 223.75, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4385839322760644, "mean_inference_ms": 1.175684336408065, "mean_action_processing_ms": 0.08348097492763282, "mean_env_wait_ms": 4.995296164257731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003591179847717285, "ViewRequirementAgentConnector_ms": 0.23688971996307373}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2046, "num_agent_steps_trained": 0, "num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.614924150130098, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 2048, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2046, "timers": {"training_iteration_time_ms": 77149.53, "sample_time_ms": 3434.723, "synch_weights_time_ms": 49.259}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2046, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 4, "trial_id": "default", "date": "2025-12-19_17-22-45", "timestamp": 1766136165, "time_this_iter_s": 77.40248584747314, "time_total_s": 308.60633277893066, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 308.60633277893066, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 94.97927927927928, "ram_util_percent": 16.096396396396386}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": -0.018134258221834898}, "default_policy": {"total_loss": -0.018134258221834898, "policy_loss": -0.057281216233968736, "vf_loss": 0.1642441678326577, "vf_loss_unclipped": 0.1642441678326577, "vf_explained_var": 0.3550074301660061, "entropy": 2.1358999416232107, "mean_kl_loss": 0.008872768711084689, "gradients_default_optimizer_global_norm": 0.5636404721066356, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 2560, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2558, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.018, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 9.682700000000002, "episode_len_mean": 224.9, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4385872596599943, "mean_inference_ms": 1.1750187038731421, "mean_action_processing_ms": 0.08340999966985993, "mean_env_wait_ms": 4.994361739688612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0037479400634765625, "ViewRequirementAgentConnector_ms": 0.2370738983154297}}, "episode_reward_max": 16.018, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 9.682700000000002, "episode_len_mean": 224.9, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4385872596599943, "mean_inference_ms": 1.1750187038731421, "mean_action_processing_ms": 0.08340999966985993, "mean_env_wait_ms": 4.994361739688612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0037479400634765625, "ViewRequirementAgentConnector_ms": 0.2370738983154297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2558, "num_agent_steps_trained": 0, "num_env_steps_sampled": 2560, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.694046605332877, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 2560, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2558, "timers": {"training_iteration_time_ms": 77016.782, "sample_time_ms": 3438.638, "synch_weights_time_ms": 53.078}, "counters": {"num_env_steps_sampled": 2560, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2558, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 5, "trial_id": "default", "date": "2025-12-19_17-24-01", "timestamp": 1766136241, "time_this_iter_s": 76.48805809020996, "time_total_s": 385.0943908691406, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 385.0943908691406, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 94.87339449541284, "ram_util_percent": 16.09999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.11597731774672866}, "default_policy": {"total_loss": 0.11597731774672866, "policy_loss": -0.043147299031261355, "vf_loss": 0.6433276836760342, "vf_loss_unclipped": 0.8813640032894909, "vf_explained_var": 0.3699693813920021, "entropy": 1.9512414306402206, "mean_kl_loss": 0.00975761956271839, "gradients_default_optimizer_global_norm": 0.7518099358305335, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3070, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 21.1, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 11.120769230769232, "episode_len_mean": 219.30769230769232, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43897526802937725, "mean_inference_ms": 1.1730987997427471, "mean_action_processing_ms": 0.0832478636524261, "mean_env_wait_ms": 4.991749860898599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003704657921424279, "ViewRequirementAgentConnector_ms": 0.23769048544076773}}, "episode_reward_max": 21.1, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 11.120769230769232, "episode_len_mean": 219.30769230769232, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43897526802937725, "mean_inference_ms": 1.1730987997427471, "mean_action_processing_ms": 0.0832478636524261, "mean_env_wait_ms": 4.991749860898599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003704657921424279, "ViewRequirementAgentConnector_ms": 0.23769048544076773}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3070, "num_agent_steps_trained": 0, "num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.712578347326058, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 3072, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3070, "timers": {"training_iteration_time_ms": 76893.099, "sample_time_ms": 3437.452, "synch_weights_time_ms": 52.043}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3070, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 13, "training_iteration": 6, "trial_id": "default", "date": "2025-12-19_17-25-17", "timestamp": 1766136317, "time_this_iter_s": 76.27640867233276, "time_total_s": 461.3707995414734, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 461.3707995414734, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 94.89351851851852, "ram_util_percent": 16.099999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.3217258456745185}, "default_policy": {"total_loss": 0.3217258456745185, "policy_loss": -0.04655966974678449, "vf_loss": 1.4800636964850127, "vf_loss_unclipped": 2.1048925424925984, "vf_explained_var": 0.3066647745668888, "entropy": 1.9697973862290383, "mean_kl_loss": 0.009575527249873516, "gradients_default_optimizer_global_norm": 1.189389749802649, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3582, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 12.700941176470591, "episode_len_mean": 197.11764705882354, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44013915741363635, "mean_inference_ms": 1.170700845956896, "mean_action_processing_ms": 0.08303608144999364, "mean_env_wait_ms": 4.986349524956654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036351821001838237, "ViewRequirementAgentConnector_ms": 0.23734429303337545}}, "episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 12.700941176470591, "episode_len_mean": 197.11764705882354, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44013915741363635, "mean_inference_ms": 1.170700845956896, "mean_action_processing_ms": 0.08303608144999364, "mean_env_wait_ms": 4.986349524956654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036351821001838237, "ViewRequirementAgentConnector_ms": 0.23734429303337545}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3582, "num_agent_steps_trained": 0, "num_env_steps_sampled": 3584, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.810803894137463, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 3584, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3582, "timers": {"training_iteration_time_ms": 76647.601, "sample_time_ms": 3431.246, "synch_weights_time_ms": 53.099}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3582, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 17, "training_iteration": 7, "trial_id": "default", "date": "2025-12-19_17-26-36", "timestamp": 1766136396, "time_this_iter_s": 75.1769871711731, "time_total_s": 536.5477867126465, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 536.5477867126465, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 91.75585585585587, "ram_util_percent": 16.09999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.37876965827308595}, "default_policy": {"total_loss": 0.37876965827308595, "policy_loss": -0.04029720358084887, "vf_loss": 1.6829551508650185, "vf_loss_unclipped": 2.202630860172212, "vf_explained_var": 0.24766631424427032, "entropy": 1.8846797361969947, "mean_kl_loss": 0.008510193094345198, "gradients_default_optimizer_global_norm": 1.0678818937391044, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4094, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 13.859047619047622, "episode_len_mean": 187.23809523809524, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4411264172056889, "mean_inference_ms": 1.1706511560251733, "mean_action_processing_ms": 0.08302651152803271, "mean_env_wait_ms": 4.984659533171429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003608067830403646, "ViewRequirementAgentConnector_ms": 0.23734683082217262}}, "episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 13.859047619047622, "episode_len_mean": 187.23809523809524, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4411264172056889, "mean_inference_ms": 1.1706511560251733, "mean_action_processing_ms": 0.08302651152803271, "mean_env_wait_ms": 4.984659533171429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003608067830403646, "ViewRequirementAgentConnector_ms": 0.23734683082217262}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4094, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.664047310472431, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4096, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4094, "timers": {"training_iteration_time_ms": 76670.42, "sample_time_ms": 3432.837, "synch_weights_time_ms": 52.316}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4094, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 21, "training_iteration": 8, "trial_id": "default", "date": "2025-12-19_17-27-52", "timestamp": 1766136472, "time_this_iter_s": 76.8320701122284, "time_total_s": 613.3798568248749, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 613.3798568248749, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 94.70183486238531, "ram_util_percent": 16.09999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.3860592405748321}, "default_policy": {"total_loss": 0.3860592405748321, "policy_loss": -0.04605811582878232, "vf_loss": 1.734485436603427, "vf_loss_unclipped": 2.4699193086475133, "vf_explained_var": 0.4024714596569538, "entropy": 1.7843026235699653, "mean_kl_loss": 0.011212043825645423, "gradients_default_optimizer_global_norm": 1.4609212003648282, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 4608, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4606, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 14.537640000000001, "episode_len_mean": 175.44, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44197414599747176, "mean_inference_ms": 1.170480743573983, "mean_action_processing_ms": 0.08300664233746727, "mean_env_wait_ms": 4.982669668748966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035800933837890625, "ViewRequirementAgentConnector_ms": 0.23729324340820312}}, "episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 14.537640000000001, "episode_len_mean": 175.44, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44197414599747176, "mean_inference_ms": 1.170480743573983, "mean_action_processing_ms": 0.08300664233746727, "mean_env_wait_ms": 4.982669668748966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035800933837890625, "ViewRequirementAgentConnector_ms": 0.23729324340820312}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4606, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4608, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.700575198915851, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4608, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4606, "timers": {"training_iteration_time_ms": 76641.631, "sample_time_ms": 3429.804, "synch_weights_time_ms": 51.604}, "counters": {"num_env_steps_sampled": 4608, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4606, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 25, "training_iteration": 9, "trial_id": "default", "date": "2025-12-19_17-29-09", "timestamp": 1766136549, "time_this_iter_s": 76.41328072547913, "time_total_s": 689.793137550354, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 689.793137550354, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 94.997247706422, "ram_util_percent": 16.09999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.5462503196671605}, "default_policy": {"total_loss": 0.5462503196671605, "policy_loss": -0.036379688512533905, "vf_loss": 2.3365937121212483, "vf_loss_unclipped": 3.932360813766718, "vf_explained_var": 0.09159897044301032, "entropy": 1.7814982503652572, "mean_kl_loss": 0.010523091176578703, "gradients_default_optimizer_global_norm": 2.055310294777155, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5118, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 15.212387096774195, "episode_len_mean": 162.8709677419355, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44345374848360075, "mean_inference_ms": 1.1701115858508702, "mean_action_processing_ms": 0.08295700678097154, "mean_env_wait_ms": 4.979403354039734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003578585963095388, "ViewRequirementAgentConnector_ms": 0.2371457315260364}}, "episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 15.212387096774195, "episode_len_mean": 162.8709677419355, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44345374848360075, "mean_inference_ms": 1.1701115858508702, "mean_action_processing_ms": 0.08295700678097154, "mean_env_wait_ms": 4.979403354039734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003578585963095388, "ViewRequirementAgentConnector_ms": 0.2371457315260364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5118, "num_agent_steps_trained": 0, "num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.68469247431871, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 5120, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 5118, "timers": {"training_iteration_time_ms": 76636.755, "sample_time_ms": 3427.234, "synch_weights_time_ms": 51.127}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5118, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 31, "training_iteration": 10, "trial_id": "default", "date": "2025-12-19_17-30-25", "timestamp": 1766136625, "time_this_iter_s": 76.5950288772583, "time_total_s": 766.3881664276123, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 766.3881664276123, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 95.04770642201836, "ram_util_percent": 16.09999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.4878263518330641}, "default_policy": {"total_loss": 0.4878263518330641, "policy_loss": -0.04044215997564606, "vf_loss": 2.1186185676604508, "vf_loss_unclipped": 4.778725158050657, "vf_explained_var": 0.11830148547887802, "entropy": 1.6362968385219574, "mean_kl_loss": 0.010006684355369088, "gradients_default_optimizer_global_norm": 1.326888805627823, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 5632, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5630, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 15.24116216216217, "episode_len_mean": 151.1891891891892, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4449795548664684, "mean_inference_ms": 1.1699686837957497, "mean_action_processing_ms": 0.08292309398138573, "mean_env_wait_ms": 4.976598593165044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036149411588101772, "ViewRequirementAgentConnector_ms": 0.23647836736730626}}, "episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 15.24116216216217, "episode_len_mean": 151.1891891891892, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4449795548664684, "mean_inference_ms": 1.1699686837957497, "mean_action_processing_ms": 0.08292309398138573, "mean_env_wait_ms": 4.976598593165044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036149411588101772, "ViewRequirementAgentConnector_ms": 0.23647836736730626}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5630, "num_agent_steps_trained": 0, "num_env_steps_sampled": 5632, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.564920942510698, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 5632, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 5630, "timers": {"training_iteration_time_ms": 76728.967, "sample_time_ms": 3422.504, "synch_weights_time_ms": 51.967}, "counters": {"num_env_steps_sampled": 5632, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5630, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 37, "training_iteration": 11, "trial_id": "default", "date": "2025-12-19_17-31-43", "timestamp": 1766136703, "time_this_iter_s": 77.99252676963806, "time_total_s": 844.3806931972504, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 844.3806931972504, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 95.1198198198198, "ram_util_percent": 16.09999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.4611369139398448}, "default_policy": {"total_loss": 0.4611369139398448, "policy_loss": -0.0504939149832353, "vf_loss": 2.0515815068036316, "vf_loss_unclipped": 5.562808575108647, "vf_explained_var": 0.007223141193389892, "entropy": 1.6099667072296142, "mean_kl_loss": 0.013816654550419116, "gradients_default_optimizer_global_norm": 1.614415066689253, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6142, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 15.283976744186049, "episode_len_mean": 141.34883720930233, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.446503511620003, "mean_inference_ms": 1.1696128188334187, "mean_action_processing_ms": 0.08287789910230471, "mean_env_wait_ms": 4.973694505407487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003575169762899709, "ViewRequirementAgentConnector_ms": 0.23574330085931822}}, "episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 15.283976744186049, "episode_len_mean": 141.34883720930233, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.446503511620003, "mean_inference_ms": 1.1696128188334187, "mean_action_processing_ms": 0.08287789910230471, "mean_env_wait_ms": 4.973694505407487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003575169762899709, "ViewRequirementAgentConnector_ms": 0.23574330085931822}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6142, "num_agent_steps_trained": 0, "num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.691365658055238, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 6144, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 6142, "timers": {"training_iteration_time_ms": 76699.766, "sample_time_ms": 3420.331, "synch_weights_time_ms": 53.509}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6142, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 43, "training_iteration": 12, "trial_id": "default", "date": "2025-12-19_17-33-03", "timestamp": 1766136783, "time_this_iter_s": 76.52159690856934, "time_total_s": 920.9022901058197, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 920.9022901058197, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 92.07610619469027, "ram_util_percent": 16.111504424778758}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.513230512291193}, "default_policy": {"total_loss": 0.513230512291193, "policy_loss": -0.042544606904266404, "vf_loss": 2.228038193285465, "vf_loss_unclipped": 7.196399557590484, "vf_explained_var": -0.02790646776556969, "entropy": 1.5715566292405128, "mean_kl_loss": 0.013484758065135338, "gradients_default_optimizer_global_norm": 1.1259951908141375, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 6656, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6654, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 15.008882352941178, "episode_len_mean": 129.76470588235293, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44860214440242574, "mean_inference_ms": 1.1691611849249013, "mean_action_processing_ms": 0.08282161322188547, "mean_env_wait_ms": 4.970315651666685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003580486073213465, "ViewRequirementAgentConnector_ms": 0.23502228306789025}}, "episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 15.008882352941178, "episode_len_mean": 129.76470588235293, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44860214440242574, "mean_inference_ms": 1.1691611849249013, "mean_action_processing_ms": 0.08282161322188547, "mean_env_wait_ms": 4.970315651666685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003580486073213465, "ViewRequirementAgentConnector_ms": 0.23502228306789025}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6654, "num_agent_steps_trained": 0, "num_env_steps_sampled": 6656, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.68562994949165, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 6656, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 6654, "timers": {"training_iteration_time_ms": 76625.896, "sample_time_ms": 3420.071, "synch_weights_time_ms": 54.161}, "counters": {"num_env_steps_sampled": 6656, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6654, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 51, "training_iteration": 13, "trial_id": "default", "date": "2025-12-19_17-34-19", "timestamp": 1766136859, "time_this_iter_s": 76.58435034751892, "time_total_s": 997.4866404533386, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 997.4866404533386, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 94.98623853211011, "ram_util_percent": 16.127522935779808}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.5387306241318583}, "default_policy": {"total_loss": 0.5387306241318583, "policy_loss": -0.04215587805956602, "vf_loss": 2.328440423309803, "vf_loss_unclipped": 7.250003087520599, "vf_explained_var": -0.0058699965476989744, "entropy": 1.5111005753278732, "mean_kl_loss": 0.011499729776704725, "gradients_default_optimizer_global_norm": 1.3822482772171498, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7166, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 14.854254237288139, "episode_len_mean": 121.27118644067797, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45052523804465755, "mean_inference_ms": 1.1687520267620195, "mean_action_processing_ms": 0.08277400683442818, "mean_env_wait_ms": 4.967365628796865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003554861424332958, "ViewRequirementAgentConnector_ms": 0.23454326694294558}}, "episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 14.854254237288139, "episode_len_mean": 121.27118644067797, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45052523804465755, "mean_inference_ms": 1.1687520267620195, "mean_action_processing_ms": 0.08277400683442818, "mean_env_wait_ms": 4.967365628796865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003554861424332958, "ViewRequirementAgentConnector_ms": 0.23454326694294558}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7166, "num_agent_steps_trained": 0, "num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.661160813709531, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 7168, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 7166, "timers": {"training_iteration_time_ms": 76572.17, "sample_time_ms": 3418.79, "synch_weights_time_ms": 54.452}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7166, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 59, "training_iteration": 14, "trial_id": "default", "date": "2025-12-19_17-35-36", "timestamp": 1766136936, "time_this_iter_s": 76.86593198776245, "time_total_s": 1074.352572441101, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1074.352572441101, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 95.0330275229358, "ram_util_percent": 16.148623853211003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.45330087595502844}, "default_policy": {"total_loss": 0.45330087595502844, "policy_loss": -0.04755741534754634, "vf_loss": 2.008586181513965, "vf_loss_unclipped": 5.220659100823104, "vf_explained_var": 0.16582888066768647, "entropy": 1.6021873772144317, "mean_kl_loss": 0.012557446246273685, "gradients_default_optimizer_global_norm": 1.3210363890975714, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 7680, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7678, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 14.737384615384618, "episode_len_mean": 116.33846153846154, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4518235475885039, "mean_inference_ms": 1.1687602283081135, "mean_action_processing_ms": 0.08275749161901313, "mean_env_wait_ms": 4.9656501661138455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00356747553898738, "ViewRequirementAgentConnector_ms": 0.23477921119103065}}, "episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 14.737384615384618, "episode_len_mean": 116.33846153846154, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4518235475885039, "mean_inference_ms": 1.1687602283081135, "mean_action_processing_ms": 0.08275749161901313, "mean_env_wait_ms": 4.9656501661138455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00356747553898738, "ViewRequirementAgentConnector_ms": 0.23477921119103065}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7678, "num_agent_steps_trained": 0, "num_env_steps_sampled": 7680, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.655262114404, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 7680, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 7678, "timers": {"training_iteration_time_ms": 76616.748, "sample_time_ms": 3419.232, "synch_weights_time_ms": 52.849}, "counters": {"num_env_steps_sampled": 7680, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7678, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 65, "training_iteration": 15, "trial_id": "default", "date": "2025-12-19_17-36-53", "timestamp": 1766137013, "time_this_iter_s": 76.93394470214844, "time_total_s": 1151.2865171432495, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1151.2865171432495, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 94.89357798165138, "ram_util_percent": 16.166055045871552}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.47586715809302405}, "default_policy": {"total_loss": 0.47586715809302405, "policy_loss": -0.042146280966699125, "vf_loss": 2.0769215868785977, "vf_loss_unclipped": 6.214569270797074, "vf_explained_var": 0.37725899666547774, "entropy": 1.495385466516018, "mean_kl_loss": 0.011136838019859851, "gradients_default_optimizer_global_norm": 1.3182031646370889, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8190, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 14.565835616438356, "episode_len_mean": 111.01369863013699, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45358002035253997, "mean_inference_ms": 1.1688755217171547, "mean_action_processing_ms": 0.08274320319645333, "mean_env_wait_ms": 4.963776064509431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035560294373394694, "ViewRequirementAgentConnector_ms": 0.23528125188122057}}, "episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 14.565835616438356, "episode_len_mean": 111.01369863013699, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45358002035253997, "mean_inference_ms": 1.1688755217171547, "mean_action_processing_ms": 0.08274320319645333, "mean_env_wait_ms": 4.963776064509431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035560294373394694, "ViewRequirementAgentConnector_ms": 0.23528125188122057}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8190, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.611459613370536, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8192, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 8190, "timers": {"training_iteration_time_ms": 76733.406, "sample_time_ms": 3422.034, "synch_weights_time_ms": 53.769}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8190, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 73, "training_iteration": 16, "trial_id": "default", "date": "2025-12-19_17-38-11", "timestamp": 1766137091, "time_this_iter_s": 77.44668388366699, "time_total_s": 1228.7332010269165, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1228.7332010269165, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 94.78378378378379, "ram_util_percent": 16.19459459459459}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.6120568234473467}, "default_policy": {"total_loss": 0.6120568234473467, "policy_loss": -0.03853604717296548, "vf_loss": 2.606904575228691, "vf_loss_unclipped": 7.5308851704001425, "vf_explained_var": 0.15365676805377007, "entropy": 1.4773629277944564, "mean_kl_loss": 0.013763263627970446, "gradients_default_optimizer_global_norm": 1.652881632745266, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 8704, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8702, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 14.46989024390244, "episode_len_mean": 105.57317073170732, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4554314614930019, "mean_inference_ms": 1.1686199809018836, "mean_action_processing_ms": 0.08270688284406379, "mean_env_wait_ms": 4.961340673098509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003534991566727801, "ViewRequirementAgentConnector_ms": 0.23504233941799257}}, "episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 14.46989024390244, "episode_len_mean": 105.57317073170732, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4554314614930019, "mean_inference_ms": 1.1686199809018836, "mean_action_processing_ms": 0.08270688284406379, "mean_env_wait_ms": 4.961340673098509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003534991566727801, "ViewRequirementAgentConnector_ms": 0.23504233941799257}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8702, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8704, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.669710214491284, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8704, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 8702, "timers": {"training_iteration_time_ms": 76892.435, "sample_time_ms": 3421.973, "synch_weights_time_ms": 53.035}, "counters": {"num_env_steps_sampled": 8704, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8702, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 82, "training_iteration": 17, "trial_id": "default", "date": "2025-12-19_17-39-30", "timestamp": 1766137170, "time_this_iter_s": 76.76739025115967, "time_total_s": 1305.5005912780762, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1305.5005912780762, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 92.01061946902654, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.5552818462252617}, "default_policy": {"total_loss": 0.5552818462252617, "policy_loss": -0.04581324527971446, "vf_loss": 2.4088415157049896, "vf_loss_unclipped": 7.06091148070991, "vf_explained_var": 0.2509115174412727, "entropy": 1.4135670706629753, "mean_kl_loss": 0.011931231220799532, "gradients_default_optimizer_global_norm": 1.2663500249385833, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9214, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 14.366373626373628, "episode_len_mean": 100.58241758241758, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45721245008904804, "mean_inference_ms": 1.1683870244394634, "mean_action_processing_ms": 0.08267503941084904, "mean_env_wait_ms": 4.959107543295795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003528594970703125, "ViewRequirementAgentConnector_ms": 0.23509512890826215}}, "episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 14.366373626373628, "episode_len_mean": 100.58241758241758, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45721245008904804, "mean_inference_ms": 1.1683870244394634, "mean_action_processing_ms": 0.08267503941084904, "mean_env_wait_ms": 4.959107543295795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003528594970703125, "ViewRequirementAgentConnector_ms": 0.23509512890826215}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9214, "num_agent_steps_trained": 0, "num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.656125931948025, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 9216, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 9214, "timers": {"training_iteration_time_ms": 76901.578, "sample_time_ms": 3419.779, "synch_weights_time_ms": 53.654}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9214, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 91, "training_iteration": 18, "trial_id": "default", "date": "2025-12-19_17-40-47", "timestamp": 1766137247, "time_this_iter_s": 76.92729473114014, "time_total_s": 1382.4278860092163, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1382.4278860092163, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 94.92935779816514, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.613920227251947}, "default_policy": {"total_loss": 0.613920227251947, "policy_loss": -0.03822240360314026, "vf_loss": 2.612901382893324, "vf_loss_unclipped": 7.820764604955912, "vf_explained_var": 0.04677841439843178, "entropy": 1.332518820464611, "mean_kl_loss": 0.009992279076146814, "gradients_default_optimizer_global_norm": 1.3236207898706198, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 9728, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9726, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 14.306666666666665, "episode_len_mean": 97.07070707070707, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45869403800186526, "mean_inference_ms": 1.1683248941787323, "mean_action_processing_ms": 0.08266049943341412, "mean_env_wait_ms": 4.957510861178873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035206476847330728, "ViewRequirementAgentConnector_ms": 0.23489142909194483}}, "episode_reward_max": 28.52899999999999, "episode_reward_min": 5.040000000000002, "episode_reward_mean": 14.306666666666665, "episode_len_mean": 97.07070707070707, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.929000000000002, 5.040000000000002, 5.065999999999997, 6.582000000000007, 11.031999999999998, 13.535, 13.412000000000011, 8.46100000000001, 16.018, 9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001], "episode_lengths": [234, 229, 233, 239, 230, 169, 226, 230, 226, 233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45869403800186526, "mean_inference_ms": 1.1683248941787323, "mean_action_processing_ms": 0.08266049943341412, "mean_env_wait_ms": 4.957510861178873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035206476847330728, "ViewRequirementAgentConnector_ms": 0.23489142909194483}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9726, "num_agent_steps_trained": 0, "num_env_steps_sampled": 9728, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.60478675469331, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 9728, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 9726, "timers": {"training_iteration_time_ms": 77012.395, "sample_time_ms": 3421.877, "synch_weights_time_ms": 53.734}, "counters": {"num_env_steps_sampled": 9728, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9726, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 99, "training_iteration": 19, "trial_id": "default", "date": "2025-12-19_17-42-05", "timestamp": 1766137325, "time_this_iter_s": 77.52256107330322, "time_total_s": 1459.9504470825195, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1459.9504470825195, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 94.96818181818182, "ram_util_percent": 16.20090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.580885560438037}, "default_policy": {"total_loss": 0.580885560438037, "policy_loss": -0.04335116904694587, "vf_loss": 2.5008741691708565, "vf_loss_unclipped": 8.30289272069931, "vf_explained_var": 0.06540863811969758, "entropy": 1.3295615032315253, "mean_kl_loss": 0.013909521661361168, "gradients_default_optimizer_global_norm": 1.0532925687730312, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10238, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.52899999999999, "episode_reward_min": 9.713999999999999, "episode_reward_mean": 14.654290000000001, "episode_len_mean": 81.46, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001], "episode_lengths": [233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4624457226437277, "mean_inference_ms": 1.1674662202572466, "mean_action_processing_ms": 0.08256236587277506, "mean_env_wait_ms": 4.9520093172722905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035169124603271484, "ViewRequirementAgentConnector_ms": 0.23467230796813965}}, "episode_reward_max": 28.52899999999999, "episode_reward_min": 9.713999999999999, "episode_reward_mean": 14.654290000000001, "episode_len_mean": 81.46, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.751999999999997, 16.929000000000006, 9.713999999999999, 21.1, 28.52899999999999, 12.318999999999999, 16.465000000000003, 14.033000000000001, 23.50200000000001, 16.424, 17.306000000000004, 17.892, 21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001], "episode_lengths": [233, 226, 233, 143, 234, 71, 101, 94, 199, 110, 116, 156, 159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4624457226437277, "mean_inference_ms": 1.1674662202572466, "mean_action_processing_ms": 0.08256236587277506, "mean_env_wait_ms": 4.9520093172722905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035169124603271484, "ViewRequirementAgentConnector_ms": 0.23467230796813965}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10238, "num_agent_steps_trained": 0, "num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.642779353363209, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 10240, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 10238, "timers": {"training_iteration_time_ms": 77060.722, "sample_time_ms": 3424.877, "synch_weights_time_ms": 54.759}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10238, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 109, "training_iteration": 20, "trial_id": "default", "date": "2025-12-19_17-43-22", "timestamp": 1766137402, "time_this_iter_s": 77.07868671417236, "time_total_s": 1537.029133796692, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1537.029133796692, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 94.99272727272727, "ram_util_percent": 16.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 513.0, "total_loss": 0.7607822057641582}, "default_policy": {"total_loss": 0.7607822057641582, "policy_loss": -0.03672278242438664, "vf_loss": 3.193643281489243, "vf_loss_unclipped": 11.241168051590154, "vf_explained_var": -0.07434915245315175, "entropy": 1.1974331147876787, "mean_kl_loss": 0.011664472723786286, "gradients_default_optimizer_global_norm": 1.2987122907314772, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10751, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 22.32, "episode_reward_min": 10.73, "episode_reward_mean": 14.084240000000001, "episode_len_mean": 67.82, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001, 14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235], "episode_lengths": [159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53, 61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.467207829280662, "mean_inference_ms": 1.167307541445929, "mean_action_processing_ms": 0.08252247297170809, "mean_env_wait_ms": 4.946616120593402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003499746322631836, "ViewRequirementAgentConnector_ms": 0.23411321640014648}}, "episode_reward_max": 22.32, "episode_reward_min": 10.73, "episode_reward_mean": 14.084240000000001, "episode_len_mean": 67.82, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.587, 18.619000000000007, 13.507, 18.688000000000002, 22.32, 17.329, 20.325000000000006, 16.668000000000003, 15.139, 16.362000000000002, 15.595000000000002, 15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001, 14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235], "episode_lengths": [159, 104, 73, 118, 131, 88, 131, 152, 72, 89, 91, 107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53, 61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.467207829280662, "mean_inference_ms": 1.167307541445929, "mean_action_processing_ms": 0.08252247297170809, "mean_env_wait_ms": 4.946616120593402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003499746322631836, "ViewRequirementAgentConnector_ms": 0.23411321640014648}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10751, "num_agent_steps_trained": 0, "num_env_steps_sampled": 10752, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.572076001369291, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 10752, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 10751, "timers": {"training_iteration_time_ms": 77052.232, "sample_time_ms": 3425.723, "synch_weights_time_ms": 53.248}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10751, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 121, "training_iteration": 21, "trial_id": "default", "date": "2025-12-19_17-44-40", "timestamp": 1766137480, "time_this_iter_s": 77.90788078308105, "time_total_s": 1614.937014579773, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1614.937014579773, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 95.01081081081084, "ram_util_percent": 16.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 511.0, "total_loss": 0.6758091454394162}, "default_policy": {"total_loss": 0.6758091454394162, "policy_loss": -0.04303353899158537, "vf_loss": 2.8786330349743365, "vf_loss_unclipped": 9.269481185078622, "vf_explained_var": 0.068763767182827, "entropy": 1.1178271234035493, "mean_kl_loss": 0.012090181108720798, "gradients_default_optimizer_global_norm": 1.4273198291659355, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11262, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 21.253, "episode_reward_min": 10.658, "episode_reward_mean": 13.504190000000001, "episode_len_mean": 60.72, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001, 14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235, 13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506], "episode_lengths": [107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53, 61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46, 40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47121015882069067, "mean_inference_ms": 1.1669742548490283, "mean_action_processing_ms": 0.08247784466301815, "mean_env_wait_ms": 4.942661613735963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003490447998046875, "ViewRequirementAgentConnector_ms": 0.23354291915893555}}, "episode_reward_max": 21.253, "episode_reward_min": 10.658, "episode_reward_mean": 13.504190000000001, "episode_len_mean": 60.72, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.760000000000002, 15.493, 12.231000000000002, 16.753, 16.507000000000005, 13.907, 13.247, 14.875, 16.675, 13.331, 21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001, 14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235, 13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506], "episode_lengths": [107, 82, 80, 106, 79, 62, 82, 77, 81, 68, 114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53, 61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46, 40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47121015882069067, "mean_inference_ms": 1.1669742548490283, "mean_action_processing_ms": 0.08247784466301815, "mean_env_wait_ms": 4.942661613735963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003490447998046875, "ViewRequirementAgentConnector_ms": 0.23354291915893555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11262, "num_agent_steps_trained": 0, "num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.677445772438645, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 11264, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 11262, "timers": {"training_iteration_time_ms": 77068.182, "sample_time_ms": 3427.152, "synch_weights_time_ms": 52.007}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11262, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 132, "training_iteration": 22, "trial_id": "default", "date": "2025-12-19_17-45-59", "timestamp": 1766137559, "time_this_iter_s": 76.678790807724, "time_total_s": 1691.615805387497, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1691.615805387497, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 92.19911504424779, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.5168771635740995}, "default_policy": {"total_loss": 0.5168771635740995, "policy_loss": -0.0315232562366873, "vf_loss": 2.197188304364681, "vf_loss_unclipped": 7.151407325267792, "vf_explained_var": 0.21268798038363457, "entropy": 1.1744677171111106, "mean_kl_loss": 0.011112269768690907, "gradients_default_optimizer_global_norm": 1.1549964636564254, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 11776, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11774, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 21.253, "episode_reward_min": 10.658, "episode_reward_mean": 13.357180000000001, "episode_len_mean": 57.69, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001, 14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235, 13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506, 13.412000000000003, 11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999], "episode_lengths": [114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53, 61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46, 40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47, 60, 47, 48, 55, 54, 51, 57, 66, 39, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4745032049297788, "mean_inference_ms": 1.1667259831126302, "mean_action_processing_ms": 0.08244890882067496, "mean_env_wait_ms": 4.939746339881971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003467559814453125, "ViewRequirementAgentConnector_ms": 0.23347806930541992}}, "episode_reward_max": 21.253, "episode_reward_min": 10.658, "episode_reward_mean": 13.357180000000001, "episode_len_mean": 57.69, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.253, 14.847000000000003, 14.983, 10.73, 16.046, 13.680000000000001, 12.271, 12.003, 13.681999999999999, 13.202, 12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001, 14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235, 13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506, 13.412000000000003, 11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999], "episode_lengths": [114, 95, 66, 51, 75, 65, 75, 52, 61, 61, 54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53, 61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46, 40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47, 60, 47, 48, 55, 54, 51, 57, 66, 39, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4745032049297788, "mean_inference_ms": 1.1667259831126302, "mean_action_processing_ms": 0.08244890882067496, "mean_env_wait_ms": 4.939746339881971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003467559814453125, "ViewRequirementAgentConnector_ms": 0.23347806930541992}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11774, "num_agent_steps_trained": 0, "num_env_steps_sampled": 11776, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.910217319510571, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 11776, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 11774, "timers": {"training_iteration_time_ms": 76819.286, "sample_time_ms": 3427.289, "synch_weights_time_ms": 50.89}, "counters": {"num_env_steps_sampled": 11776, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11774, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 142, "training_iteration": 23, "trial_id": "default", "date": "2025-12-19_17-47-13", "timestamp": 1766137633, "time_this_iter_s": 74.09575200080872, "time_total_s": 1765.7115573883057, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1765.7115573883057, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 94.7657142857143, "ram_util_percent": 15.918095238095244}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.650111573038157}, "default_policy": {"total_loss": 0.650111573038157, "policy_loss": -0.03832522227894515, "vf_loss": 2.757478752732277, "vf_loss_unclipped": 6.9532187029719354, "vf_explained_var": 0.30644519403576853, "entropy": 1.1835488632321358, "mean_kl_loss": 0.010026718284944992, "gradients_default_optimizer_global_norm": 1.7782962195575238, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12286, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.187, "episode_reward_min": 10.658, "episode_reward_mean": 13.193060000000001, "episode_len_mean": 55.49, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001, 14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235, 13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506, 13.412000000000003, 11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999, 13.24, 13.776, 12.419, 11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999], "episode_lengths": [54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53, 61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46, 40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47, 60, 47, 48, 55, 54, 51, 57, 66, 39, 44, 52, 55, 44, 54, 45, 48, 53, 54, 52, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4774358423771555, "mean_inference_ms": 1.1666234716958734, "mean_action_processing_ms": 0.08243374254434563, "mean_env_wait_ms": 4.937360101536985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034635066986083984, "ViewRequirementAgentConnector_ms": 0.23396635055541992}}, "episode_reward_max": 17.187, "episode_reward_min": 10.658, "episode_reward_mean": 13.193060000000001, "episode_len_mean": 55.49, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.876999999999999, 15.196, 15.442000000000004, 11.111, 13.712, 14.879000000000001, 14.529, 11.795, 14.116, 15.465, 11.239, 15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001, 14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235, 13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506, 13.412000000000003, 11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999, 13.24, 13.776, 12.419, 11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999], "episode_lengths": [54, 59, 90, 63, 63, 76, 71, 38, 65, 112, 55, 73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53, 61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46, 40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47, 60, 47, 48, 55, 54, 51, 57, 66, 39, 44, 52, 55, 44, 54, 45, 48, 53, 54, 52, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4774358423771555, "mean_inference_ms": 1.1666234716958734, "mean_action_processing_ms": 0.08243374254434563, "mean_env_wait_ms": 4.937360101536985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034635066986083984, "ViewRequirementAgentConnector_ms": 0.23396635055541992}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12286, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.957525076188557, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12288, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 12286, "timers": {"training_iteration_time_ms": 76491.876, "sample_time_ms": 3429.301, "synch_weights_time_ms": 52.717}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12286, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 152, "training_iteration": 24, "trial_id": "default", "date": "2025-12-19_17-48-27", "timestamp": 1766137707, "time_this_iter_s": 73.5941469669342, "time_total_s": 1839.3057043552399, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1839.3057043552399, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 94.56285714285714, "ram_util_percent": 15.900000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7021963345818222}, "default_policy": {"total_loss": 0.7021963345818222, "policy_loss": -0.03690290185622871, "vf_loss": 2.959821845591068, "vf_loss_unclipped": 7.198360395431519, "vf_explained_var": 0.35736349001526835, "entropy": 1.1405811972916127, "mean_kl_loss": 0.011373551791967884, "gradients_default_optimizer_global_norm": 1.2104067713022233, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12798, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.187, "episode_reward_min": 10.176, "episode_reward_mean": 13.045680000000003, "episode_len_mean": 53.06, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001, 14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235, 13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506, 13.412000000000003, 11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999, 13.24, 13.776, 12.419, 11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999, 13.399000000000001, 10.176, 13.791000000000002, 12.791, 12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846], "episode_lengths": [73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53, 61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46, 40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47, 60, 47, 48, 55, 54, 51, 57, 66, 39, 44, 52, 55, 44, 54, 45, 48, 53, 54, 52, 38, 47, 29, 73, 46, 49, 43, 40, 49, 37, 42, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48053526691570225, "mean_inference_ms": 1.166251967148698, "mean_action_processing_ms": 0.08239573122442706, "mean_env_wait_ms": 4.934520110267993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003469705581665039, "ViewRequirementAgentConnector_ms": 0.23404312133789062}}, "episode_reward_max": 17.187, "episode_reward_min": 10.176, "episode_reward_mean": 13.045680000000003, "episode_len_mean": 53.06, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.790999999999997, 13.123000000000001, 12.554, 14.896000000000004, 14.170000000000002, 10.814, 14.248000000000001, 12.783999999999999, 13.57, 12.34, 13.974000000000002, 17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001, 14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235, 13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506, 13.412000000000003, 11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999, 13.24, 13.776, 12.419, 11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999, 13.399000000000001, 10.176, 13.791000000000002, 12.791, 12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846], "episode_lengths": [73, 64, 78, 70, 70, 44, 87, 58, 71, 64, 68, 80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53, 61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46, 40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47, 60, 47, 48, 55, 54, 51, 57, 66, 39, 44, 52, 55, 44, 54, 45, 48, 53, 54, 52, 38, 47, 29, 73, 46, 49, 43, 40, 49, 37, 42, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48053526691570225, "mean_inference_ms": 1.166251967148698, "mean_action_processing_ms": 0.08239573122442706, "mean_env_wait_ms": 4.934520110267993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003469705581665039, "ViewRequirementAgentConnector_ms": 0.23404312133789062}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12798, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12800, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.974297169553393, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12800, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 12798, "timers": {"training_iteration_time_ms": 76139.957, "sample_time_ms": 3428.586, "synch_weights_time_ms": 52.151}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12798, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 163, "training_iteration": 25, "trial_id": "default", "date": "2025-12-19_17-49-40", "timestamp": 1766137780, "time_this_iter_s": 73.41847920417786, "time_total_s": 1912.7241835594177, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1912.7241835594177, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 94.6903846153846, "ram_util_percent": 15.763461538461543}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7186196722090245}, "default_policy": {"total_loss": 0.7186196722090245, "policy_loss": -0.035398690355941655, "vf_loss": 3.0198811441659927, "vf_loss_unclipped": 8.328380641341209, "vf_explained_var": 0.14730308800935746, "entropy": 1.1735006973147393, "mean_kl_loss": 0.008863275576078421, "gradients_default_optimizer_global_norm": 1.5847685240209102, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13310, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.187, "episode_reward_min": 10.176, "episode_reward_mean": 12.894279999999997, "episode_len_mean": 50.65, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001, 14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235, 13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506, 13.412000000000003, 11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999, 13.24, 13.776, 12.419, 11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999, 13.399000000000001, 10.176, 13.791000000000002, 12.791, 12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846, 10.677000000000001, 12.866, 11.171000000000001, 11.437999999999999, 10.905, 11.009, 12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331], "episode_lengths": [80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53, 61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46, 40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47, 60, 47, 48, 55, 54, 51, 57, 66, 39, 44, 52, 55, 44, 54, 45, 48, 53, 54, 52, 38, 47, 29, 73, 46, 49, 43, 40, 49, 37, 42, 48, 48, 46, 38, 41, 45, 35, 50, 57, 43, 50, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4834278156217458, "mean_inference_ms": 1.1661874999885098, "mean_action_processing_ms": 0.0823924912400684, "mean_env_wait_ms": 4.932441355577142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003456592559814453, "ViewRequirementAgentConnector_ms": 0.23345327377319336}}, "episode_reward_max": 17.187, "episode_reward_min": 10.176, "episode_reward_mean": 12.894279999999997, "episode_len_mean": 50.65, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.187, 14.798000000000002, 16.071, 14.484, 12.159999999999998, 11.359, 11.789000000000001, 11.402999999999999, 10.95, 15.653000000000002, 13.511, 13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001, 14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235, 13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506, 13.412000000000003, 11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999, 13.24, 13.776, 12.419, 11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999, 13.399000000000001, 10.176, 13.791000000000002, 12.791, 12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846, 10.677000000000001, 12.866, 11.171000000000001, 11.437999999999999, 10.905, 11.009, 12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331], "episode_lengths": [80, 67, 72, 68, 63, 37, 51, 47, 37, 70, 52, 56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53, 61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46, 40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47, 60, 47, 48, 55, 54, 51, 57, 66, 39, 44, 52, 55, 44, 54, 45, 48, 53, 54, 52, 38, 47, 29, 73, 46, 49, 43, 40, 49, 37, 42, 48, 48, 46, 38, 41, 45, 35, 50, 57, 43, 50, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4834278156217458, "mean_inference_ms": 1.1661874999885098, "mean_action_processing_ms": 0.0823924912400684, "mean_env_wait_ms": 4.932441355577142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003456592559814453, "ViewRequirementAgentConnector_ms": 0.23345327377319336}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13310, "num_agent_steps_trained": 0, "num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.9357625259767275, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 13312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 13310, "timers": {"training_iteration_time_ms": 75777.856, "sample_time_ms": 3425.179, "synch_weights_time_ms": 51.686}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13310, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 174, "training_iteration": 26, "trial_id": "default", "date": "2025-12-19_17-50-54", "timestamp": 1766137854, "time_this_iter_s": 73.82302355766296, "time_total_s": 1986.5472071170807, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1986.5472071170807, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 94.84761904761906, "ram_util_percent": 15.300000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7536528207361698}, "default_policy": {"total_loss": 0.7536528207361698, "policy_loss": -0.04354074979200959, "vf_loss": 3.192524363100529, "vf_loss_unclipped": 6.877089524269104, "vf_explained_var": 0.3971157379448414, "entropy": 1.1839921221137046, "mean_kl_loss": 0.009859026654021363, "gradients_default_optimizer_global_norm": 1.442124592885375, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 13824, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13822, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.416, "episode_reward_min": 10.176, "episode_reward_mean": 12.78079, "episode_len_mean": 49.45, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001, 14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235, 13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506, 13.412000000000003, 11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999, 13.24, 13.776, 12.419, 11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999, 13.399000000000001, 10.176, 13.791000000000002, 12.791, 12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846, 10.677000000000001, 12.866, 11.171000000000001, 11.437999999999999, 10.905, 11.009, 12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331, 12.304, 13.218, 11.879, 16.416, 11.722000000000001, 11.843, 11.922999999999998, 12.934000000000001, 11.122, 12.844000000000001, 11.811], "episode_lengths": [56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53, 61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46, 40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47, 60, 47, 48, 55, 54, 51, 57, 66, 39, 44, 52, 55, 44, 54, 45, 48, 53, 54, 52, 38, 47, 29, 73, 46, 49, 43, 40, 49, 37, 42, 48, 48, 46, 38, 41, 45, 35, 50, 57, 43, 50, 53, 52, 41, 39, 66, 38, 36, 44, 62, 49, 56, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4861430135197351, "mean_inference_ms": 1.1659557874588569, "mean_action_processing_ms": 0.08237275951396562, "mean_env_wait_ms": 4.930173721611245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003469705581665039, "ViewRequirementAgentConnector_ms": 0.2332007884979248}}, "episode_reward_max": 16.416, "episode_reward_min": 10.176, "episode_reward_mean": 12.78079, "episode_len_mean": 49.45, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.758000000000001, 11.728, 12.251000000000001, 14.783999999999999, 15.450000000000001, 12.724, 14.133000000000003, 11.559999999999999, 13.245000000000001, 14.193999999999999, 14.522000000000002, 13.685, 13.321, 14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001, 14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235, 13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506, 13.412000000000003, 11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999, 13.24, 13.776, 12.419, 11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999, 13.399000000000001, 10.176, 13.791000000000002, 12.791, 12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846, 10.677000000000001, 12.866, 11.171000000000001, 11.437999999999999, 10.905, 11.009, 12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331, 12.304, 13.218, 11.879, 16.416, 11.722000000000001, 11.843, 11.922999999999998, 12.934000000000001, 11.122, 12.844000000000001, 11.811], "episode_lengths": [56, 46, 50, 68, 69, 48, 69, 48, 56, 62, 56, 64, 47, 55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53, 61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46, 40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47, 60, 47, 48, 55, 54, 51, 57, 66, 39, 44, 52, 55, 44, 54, 45, 48, 53, 54, 52, 38, 47, 29, 73, 46, 49, 43, 40, 49, 37, 42, 48, 48, 46, 38, 41, 45, 35, 50, 57, 43, 50, 53, 52, 41, 39, 66, 38, 36, 44, 62, 49, 56, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4861430135197351, "mean_inference_ms": 1.1659557874588569, "mean_action_processing_ms": 0.08237275951396562, "mean_env_wait_ms": 4.930173721611245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003469705581665039, "ViewRequirementAgentConnector_ms": 0.2332007884979248}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13822, "num_agent_steps_trained": 0, "num_env_steps_sampled": 13824, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.04159167218795, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 13824, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 13822, "timers": {"training_iteration_time_ms": 75372.444, "sample_time_ms": 3426.831, "synch_weights_time_ms": 50.477}, "counters": {"num_env_steps_sampled": 13824, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13822, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 185, "training_iteration": 27, "trial_id": "default", "date": "2025-12-19_17-52-09", "timestamp": 1766137929, "time_this_iter_s": 72.71360659599304, "time_total_s": 2059.2608137130737, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2059.2608137130737, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 91.70560747663552, "ram_util_percent": 15.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 513.0, "total_loss": 0.8082009495040516}, "default_policy": {"total_loss": 0.8082009495040516, "policy_loss": -0.03608045411974559, "vf_loss": 3.3803554905785456, "vf_loss_unclipped": 9.295435228465516, "vf_explained_var": 0.3178969386183185, "entropy": 1.07668458532404, "mean_kl_loss": 0.010768935006081498, "gradients_default_optimizer_global_norm": 1.3307023350103402, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14335, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.416, "episode_reward_min": 10.176, "episode_reward_mean": 12.65479, "episode_len_mean": 47.7, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001, 14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235, 13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506, 13.412000000000003, 11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999, 13.24, 13.776, 12.419, 11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999, 13.399000000000001, 10.176, 13.791000000000002, 12.791, 12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846, 10.677000000000001, 12.866, 11.171000000000001, 11.437999999999999, 10.905, 11.009, 12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331, 12.304, 13.218, 11.879, 16.416, 11.722000000000001, 11.843, 11.922999999999998, 12.934000000000001, 11.122, 12.844000000000001, 11.811, 12.923, 13.465000000000003, 11.581999999999999, 11.799, 10.389000000000001, 14.072000000000001, 10.988999999999999, 12.535, 13.023000000000001, 10.696000000000002, 14.137, 15.249, 11.896], "episode_lengths": [55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53, 61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46, 40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47, 60, 47, 48, 55, 54, 51, 57, 66, 39, 44, 52, 55, 44, 54, 45, 48, 53, 54, 52, 38, 47, 29, 73, 46, 49, 43, 40, 49, 37, 42, 48, 48, 46, 38, 41, 45, 35, 50, 57, 43, 50, 53, 52, 41, 39, 66, 38, 36, 44, 62, 49, 56, 41, 50, 43, 40, 32, 31, 47, 31, 59, 43, 37, 53, 61, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4892192677515547, "mean_inference_ms": 1.1662310177453443, "mean_action_processing_ms": 0.08240056892356275, "mean_env_wait_ms": 4.92850850211595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003472566604614258, "ViewRequirementAgentConnector_ms": 0.2332303524017334}}, "episode_reward_max": 16.416, "episode_reward_min": 10.176, "episode_reward_mean": 12.65479, "episode_len_mean": 47.7, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.360000000000001, 16.408, 13.622000000000002, 12.956999999999999, 11.649000000000001, 13.251000000000001, 12.32, 13.183000000000002, 15.709999999999999, 13.764000000000003, 13.280000000000001, 14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235, 13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506, 13.412000000000003, 11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999, 13.24, 13.776, 12.419, 11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999, 13.399000000000001, 10.176, 13.791000000000002, 12.791, 12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846, 10.677000000000001, 12.866, 11.171000000000001, 11.437999999999999, 10.905, 11.009, 12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331, 12.304, 13.218, 11.879, 16.416, 11.722000000000001, 11.843, 11.922999999999998, 12.934000000000001, 11.122, 12.844000000000001, 11.811, 12.923, 13.465000000000003, 11.581999999999999, 11.799, 10.389000000000001, 14.072000000000001, 10.988999999999999, 12.535, 13.023000000000001, 10.696000000000002, 14.137, 15.249, 11.896], "episode_lengths": [55, 81, 51, 52, 36, 60, 54, 48, 60, 57, 53, 61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46, 40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47, 60, 47, 48, 55, 54, 51, 57, 66, 39, 44, 52, 55, 44, 54, 45, 48, 53, 54, 52, 38, 47, 29, 73, 46, 49, 43, 40, 49, 37, 42, 48, 48, 46, 38, 41, 45, 35, 50, 57, 43, 50, 53, 52, 41, 39, 66, 38, 36, 44, 62, 49, 56, 41, 50, 43, 40, 32, 31, 47, 31, 59, 43, 37, 53, 61, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4892192677515547, "mean_inference_ms": 1.1662310177453443, "mean_action_processing_ms": 0.08240056892356275, "mean_env_wait_ms": 4.92850850211595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003472566604614258, "ViewRequirementAgentConnector_ms": 0.2332303524017334}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14335, "num_agent_steps_trained": 0, "num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.904858749291596, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 14336, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 14335, "timers": {"training_iteration_time_ms": 75095.351, "sample_time_ms": 3427.476, "synch_weights_time_ms": 50.648}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14335, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 198, "training_iteration": 28, "trial_id": "default", "date": "2025-12-19_17-53-24", "timestamp": 1766138004, "time_this_iter_s": 74.15366458892822, "time_total_s": 2133.414478302002, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2133.414478302002, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 94.84905660377356, "ram_util_percent": 15.300000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 511.0, "total_loss": 0.7819482298931689}, "default_policy": {"total_loss": 0.7819482298931689, "policy_loss": -0.041713361232541504, "vf_loss": 3.29781601279974, "vf_loss_unclipped": 9.010812416672707, "vf_explained_var": 0.24719727858901025, "entropy": 1.0631592400372027, "mean_kl_loss": 0.010829421851133248, "gradients_default_optimizer_global_norm": 1.3305630564689637, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 14848, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14846, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.416, "episode_reward_min": 10.176, "episode_reward_mean": 12.511510000000001, "episode_len_mean": 46.41, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235, 13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506, 13.412000000000003, 11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999, 13.24, 13.776, 12.419, 11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999, 13.399000000000001, 10.176, 13.791000000000002, 12.791, 12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846, 10.677000000000001, 12.866, 11.171000000000001, 11.437999999999999, 10.905, 11.009, 12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331, 12.304, 13.218, 11.879, 16.416, 11.722000000000001, 11.843, 11.922999999999998, 12.934000000000001, 11.122, 12.844000000000001, 11.811, 12.923, 13.465000000000003, 11.581999999999999, 11.799, 10.389000000000001, 14.072000000000001, 10.988999999999999, 12.535, 13.023000000000001, 10.696000000000002, 14.137, 15.249, 11.896, 12.263000000000002, 12.286, 12.273, 12.58, 12.893, 11.427000000000001, 13.098, 12.166, 12.719000000000001, 11.502, 12.969], "episode_lengths": [61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46, 40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47, 60, 47, 48, 55, 54, 51, 57, 66, 39, 44, 52, 55, 44, 54, 45, 48, 53, 54, 52, 38, 47, 29, 73, 46, 49, 43, 40, 49, 37, 42, 48, 48, 46, 38, 41, 45, 35, 50, 57, 43, 50, 53, 52, 41, 39, 66, 38, 36, 44, 62, 49, 56, 41, 50, 43, 40, 32, 31, 47, 31, 59, 43, 37, 53, 61, 37, 44, 51, 48, 38, 40, 38, 43, 46, 44, 39, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4915647069158882, "mean_inference_ms": 1.1659862851990035, "mean_action_processing_ms": 0.08238190244862213, "mean_env_wait_ms": 4.926458904750138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003452301025390625, "ViewRequirementAgentConnector_ms": 0.23284268379211426}}, "episode_reward_max": 16.416, "episode_reward_min": 10.176, "episode_reward_mean": 12.511510000000001, "episode_len_mean": 46.41, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.113000000000003, 14.205, 13.345, 12.777000000000001, 10.758999999999999, 11.193999999999999, 12.601, 10.979999999999999, 12.218, 12.786999999999999, 10.746, 11.235, 13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506, 13.412000000000003, 11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999, 13.24, 13.776, 12.419, 11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999, 13.399000000000001, 10.176, 13.791000000000002, 12.791, 12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846, 10.677000000000001, 12.866, 11.171000000000001, 11.437999999999999, 10.905, 11.009, 12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331, 12.304, 13.218, 11.879, 16.416, 11.722000000000001, 11.843, 11.922999999999998, 12.934000000000001, 11.122, 12.844000000000001, 11.811, 12.923, 13.465000000000003, 11.581999999999999, 11.799, 10.389000000000001, 14.072000000000001, 10.988999999999999, 12.535, 13.023000000000001, 10.696000000000002, 14.137, 15.249, 11.896, 12.263000000000002, 12.286, 12.273, 12.58, 12.893, 11.427000000000001, 13.098, 12.166, 12.719000000000001, 11.502, 12.969], "episode_lengths": [61, 66, 43, 50, 41, 37, 40, 40, 41, 50, 37, 46, 40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47, 60, 47, 48, 55, 54, 51, 57, 66, 39, 44, 52, 55, 44, 54, 45, 48, 53, 54, 52, 38, 47, 29, 73, 46, 49, 43, 40, 49, 37, 42, 48, 48, 46, 38, 41, 45, 35, 50, 57, 43, 50, 53, 52, 41, 39, 66, 38, 36, 44, 62, 49, 56, 41, 50, 43, 40, 32, 31, 47, 31, 59, 43, 37, 53, 61, 37, 44, 51, 48, 38, 40, 38, 43, 46, 44, 39, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4915647069158882, "mean_inference_ms": 1.1659862851990035, "mean_action_processing_ms": 0.08238190244862213, "mean_env_wait_ms": 4.926458904750138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003452301025390625, "ViewRequirementAgentConnector_ms": 0.23284268379211426}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14846, "num_agent_steps_trained": 0, "num_env_steps_sampled": 14848, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.933010770519894, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 14848, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 14846, "timers": {"training_iteration_time_ms": 74728.356, "sample_time_ms": 3427.293, "synch_weights_time_ms": 50.813}, "counters": {"num_env_steps_sampled": 14848, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14846, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 209, "training_iteration": 29, "trial_id": "default", "date": "2025-12-19_17-54-37", "timestamp": 1766138077, "time_this_iter_s": 73.85264873504639, "time_total_s": 2207.2671270370483, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2207.2671270370483, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 94.81142857142858, "ram_util_percent": 15.304761904761907}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7054421505657956}, "default_policy": {"total_loss": 0.7054421505657956, "policy_loss": -0.03721324307844043, "vf_loss": 2.97399395853281, "vf_loss_unclipped": 6.410451222956181, "vf_explained_var": 0.6421445071697235, "entropy": 1.0584576807916164, "mean_kl_loss": 0.008614371762971019, "gradients_default_optimizer_global_norm": 1.1758074328303336, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15358, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.416, "episode_reward_min": 10.097, "episode_reward_mean": 12.415700000000001, "episode_len_mean": 45.78, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506, 13.412000000000003, 11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999, 13.24, 13.776, 12.419, 11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999, 13.399000000000001, 10.176, 13.791000000000002, 12.791, 12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846, 10.677000000000001, 12.866, 11.171000000000001, 11.437999999999999, 10.905, 11.009, 12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331, 12.304, 13.218, 11.879, 16.416, 11.722000000000001, 11.843, 11.922999999999998, 12.934000000000001, 11.122, 12.844000000000001, 11.811, 12.923, 13.465000000000003, 11.581999999999999, 11.799, 10.389000000000001, 14.072000000000001, 10.988999999999999, 12.535, 13.023000000000001, 10.696000000000002, 14.137, 15.249, 11.896, 12.263000000000002, 12.286, 12.273, 12.58, 12.893, 11.427000000000001, 13.098, 12.166, 12.719000000000001, 11.502, 12.969, 11.898, 11.115, 12.437000000000001, 10.097, 14.183, 12.091, 10.238000000000001, 11.258, 12.493, 10.402000000000001, 10.102, 11.065000000000001], "episode_lengths": [40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47, 60, 47, 48, 55, 54, 51, 57, 66, 39, 44, 52, 55, 44, 54, 45, 48, 53, 54, 52, 38, 47, 29, 73, 46, 49, 43, 40, 49, 37, 42, 48, 48, 46, 38, 41, 45, 35, 50, 57, 43, 50, 53, 52, 41, 39, 66, 38, 36, 44, 62, 49, 56, 41, 50, 43, 40, 32, 31, 47, 31, 59, 43, 37, 53, 61, 37, 44, 51, 48, 38, 40, 38, 43, 46, 44, 39, 47, 54, 33, 44, 36, 58, 39, 29, 40, 43, 36, 34, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4938844960535267, "mean_inference_ms": 1.1660196898225106, "mean_action_processing_ms": 0.08238231620692651, "mean_env_wait_ms": 4.924832178602161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034439563751220703, "ViewRequirementAgentConnector_ms": 0.23297667503356934}}, "episode_reward_max": 16.416, "episode_reward_min": 10.097, "episode_reward_mean": 12.415700000000001, "episode_len_mean": 45.78, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.093, 11.145999999999999, 13.268000000000002, 13.260000000000002, 13.323, 12.84, 12.442, 11.038, 15.56, 10.658, 11.506, 13.412000000000003, 11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999, 13.24, 13.776, 12.419, 11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999, 13.399000000000001, 10.176, 13.791000000000002, 12.791, 12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846, 10.677000000000001, 12.866, 11.171000000000001, 11.437999999999999, 10.905, 11.009, 12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331, 12.304, 13.218, 11.879, 16.416, 11.722000000000001, 11.843, 11.922999999999998, 12.934000000000001, 11.122, 12.844000000000001, 11.811, 12.923, 13.465000000000003, 11.581999999999999, 11.799, 10.389000000000001, 14.072000000000001, 10.988999999999999, 12.535, 13.023000000000001, 10.696000000000002, 14.137, 15.249, 11.896, 12.263000000000002, 12.286, 12.273, 12.58, 12.893, 11.427000000000001, 13.098, 12.166, 12.719000000000001, 11.502, 12.969, 11.898, 11.115, 12.437000000000001, 10.097, 14.183, 12.091, 10.238000000000001, 11.258, 12.493, 10.402000000000001, 10.102, 11.065000000000001], "episode_lengths": [40, 38, 55, 47, 49, 44, 41, 36, 64, 37, 47, 60, 47, 48, 55, 54, 51, 57, 66, 39, 44, 52, 55, 44, 54, 45, 48, 53, 54, 52, 38, 47, 29, 73, 46, 49, 43, 40, 49, 37, 42, 48, 48, 46, 38, 41, 45, 35, 50, 57, 43, 50, 53, 52, 41, 39, 66, 38, 36, 44, 62, 49, 56, 41, 50, 43, 40, 32, 31, 47, 31, 59, 43, 37, 53, 61, 37, 44, 51, 48, 38, 40, 38, 43, 46, 44, 39, 47, 54, 33, 44, 36, 58, 39, 29, 40, 43, 36, 34, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4938844960535267, "mean_inference_ms": 1.1660196898225106, "mean_action_processing_ms": 0.08238231620692651, "mean_env_wait_ms": 4.924832178602161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034439563751220703, "ViewRequirementAgentConnector_ms": 0.23297667503356934}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15358, "num_agent_steps_trained": 0, "num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.9086908994954985, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 15360, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 15358, "timers": {"training_iteration_time_ms": 74431.694, "sample_time_ms": 3426.176, "synch_weights_time_ms": 49.016}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15358, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 221, "training_iteration": 30, "trial_id": "default", "date": "2025-12-19_17-55-52", "timestamp": 1766138152, "time_this_iter_s": 74.11243891716003, "time_total_s": 2281.3795659542084, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2281.3795659542084, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 94.75333333333332, "ram_util_percent": 15.300000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.8502276495099068}, "default_policy": {"total_loss": 0.8502276495099068, "policy_loss": -0.034141689515672625, "vf_loss": 3.540857645869255, "vf_loss_unclipped": 8.331692665815353, "vf_explained_var": 0.36022582054138186, "entropy": 1.0302758559584617, "mean_kl_loss": 0.007408025515678674, "gradients_default_optimizer_global_norm": 1.6053115844726562, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 15872, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15870, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.416, "episode_reward_min": 10.072000000000001, "episode_reward_mean": 12.336839999999997, "episode_len_mean": 45.68, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999, 13.24, 13.776, 12.419, 11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999, 13.399000000000001, 10.176, 13.791000000000002, 12.791, 12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846, 10.677000000000001, 12.866, 11.171000000000001, 11.437999999999999, 10.905, 11.009, 12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331, 12.304, 13.218, 11.879, 16.416, 11.722000000000001, 11.843, 11.922999999999998, 12.934000000000001, 11.122, 12.844000000000001, 11.811, 12.923, 13.465000000000003, 11.581999999999999, 11.799, 10.389000000000001, 14.072000000000001, 10.988999999999999, 12.535, 13.023000000000001, 10.696000000000002, 14.137, 15.249, 11.896, 12.263000000000002, 12.286, 12.273, 12.58, 12.893, 11.427000000000001, 13.098, 12.166, 12.719000000000001, 11.502, 12.969, 11.898, 11.115, 12.437000000000001, 10.097, 14.183, 12.091, 10.238000000000001, 11.258, 12.493, 10.402000000000001, 10.102, 11.065000000000001, 12.418, 12.105, 11.802, 10.072000000000001, 12.464000000000002, 12.748000000000001, 14.079, 11.602, 13.235000000000001, 10.899, 11.568999999999999, 10.667], "episode_lengths": [47, 48, 55, 54, 51, 57, 66, 39, 44, 52, 55, 44, 54, 45, 48, 53, 54, 52, 38, 47, 29, 73, 46, 49, 43, 40, 49, 37, 42, 48, 48, 46, 38, 41, 45, 35, 50, 57, 43, 50, 53, 52, 41, 39, 66, 38, 36, 44, 62, 49, 56, 41, 50, 43, 40, 32, 31, 47, 31, 59, 43, 37, 53, 61, 37, 44, 51, 48, 38, 40, 38, 43, 46, 44, 39, 47, 54, 33, 44, 36, 58, 39, 29, 40, 43, 36, 34, 43, 42, 45, 47, 31, 49, 42, 71, 40, 44, 33, 61, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4960961233361387, "mean_inference_ms": 1.1656490621499904, "mean_action_processing_ms": 0.08234969749104919, "mean_env_wait_ms": 4.92267732925661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003445148468017578, "ViewRequirementAgentConnector_ms": 0.23332643508911133}}, "episode_reward_max": 16.416, "episode_reward_min": 10.072000000000001, "episode_reward_mean": 12.336839999999997, "episode_len_mean": 45.68, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.074000000000002, 14.318, 14.262000000000002, 14.415000000000003, 13.484000000000002, 13.232, 15.333000000000002, 12.706, 11.841999999999999, 13.24, 13.776, 12.419, 11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999, 13.399000000000001, 10.176, 13.791000000000002, 12.791, 12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846, 10.677000000000001, 12.866, 11.171000000000001, 11.437999999999999, 10.905, 11.009, 12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331, 12.304, 13.218, 11.879, 16.416, 11.722000000000001, 11.843, 11.922999999999998, 12.934000000000001, 11.122, 12.844000000000001, 11.811, 12.923, 13.465000000000003, 11.581999999999999, 11.799, 10.389000000000001, 14.072000000000001, 10.988999999999999, 12.535, 13.023000000000001, 10.696000000000002, 14.137, 15.249, 11.896, 12.263000000000002, 12.286, 12.273, 12.58, 12.893, 11.427000000000001, 13.098, 12.166, 12.719000000000001, 11.502, 12.969, 11.898, 11.115, 12.437000000000001, 10.097, 14.183, 12.091, 10.238000000000001, 11.258, 12.493, 10.402000000000001, 10.102, 11.065000000000001, 12.418, 12.105, 11.802, 10.072000000000001, 12.464000000000002, 12.748000000000001, 14.079, 11.602, 13.235000000000001, 10.899, 11.568999999999999, 10.667], "episode_lengths": [47, 48, 55, 54, 51, 57, 66, 39, 44, 52, 55, 44, 54, 45, 48, 53, 54, 52, 38, 47, 29, 73, 46, 49, 43, 40, 49, 37, 42, 48, 48, 46, 38, 41, 45, 35, 50, 57, 43, 50, 53, 52, 41, 39, 66, 38, 36, 44, 62, 49, 56, 41, 50, 43, 40, 32, 31, 47, 31, 59, 43, 37, 53, 61, 37, 44, 51, 48, 38, 40, 38, 43, 46, 44, 39, 47, 54, 33, 44, 36, 58, 39, 29, 40, 43, 36, 34, 43, 42, 45, 47, 31, 49, 42, 71, 40, 44, 33, 61, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4960961233361387, "mean_inference_ms": 1.1656490621499904, "mean_action_processing_ms": 0.08234969749104919, "mean_env_wait_ms": 4.92267732925661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003445148468017578, "ViewRequirementAgentConnector_ms": 0.23332643508911133}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15870, "num_agent_steps_trained": 0, "num_env_steps_sampled": 15872, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 13.461506961830398, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 15872, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 15870, "timers": {"training_iteration_time_ms": 70444.594, "sample_time_ms": 3428.65, "synch_weights_time_ms": 44.965}, "counters": {"num_env_steps_sampled": 15872, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15870, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 233, "training_iteration": 31, "trial_id": "default", "date": "2025-12-19_17-56-30", "timestamp": 1766138190, "time_this_iter_s": 38.03677177429199, "time_total_s": 2319.4163377285004, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2319.4163377285004, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 90.53148148148149, "ram_util_percent": 14.631481481481485}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.8270004190504551}, "default_policy": {"total_loss": 0.8270004190504551, "policy_loss": -0.030279790004715323, "vf_loss": 3.432330247759819, "vf_loss_unclipped": 7.622300499677658, "vf_explained_var": 0.3101813167333603, "entropy": 0.9439796172082424, "mean_kl_loss": 0.005664460637501634, "gradients_default_optimizer_global_norm": 1.7925870195031166, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16382, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.416, "episode_reward_min": 10.072000000000001, "episode_reward_mean": 12.191080000000001, "episode_len_mean": 44.74, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999, 13.399000000000001, 10.176, 13.791000000000002, 12.791, 12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846, 10.677000000000001, 12.866, 11.171000000000001, 11.437999999999999, 10.905, 11.009, 12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331, 12.304, 13.218, 11.879, 16.416, 11.722000000000001, 11.843, 11.922999999999998, 12.934000000000001, 11.122, 12.844000000000001, 11.811, 12.923, 13.465000000000003, 11.581999999999999, 11.799, 10.389000000000001, 14.072000000000001, 10.988999999999999, 12.535, 13.023000000000001, 10.696000000000002, 14.137, 15.249, 11.896, 12.263000000000002, 12.286, 12.273, 12.58, 12.893, 11.427000000000001, 13.098, 12.166, 12.719000000000001, 11.502, 12.969, 11.898, 11.115, 12.437000000000001, 10.097, 14.183, 12.091, 10.238000000000001, 11.258, 12.493, 10.402000000000001, 10.102, 11.065000000000001, 12.418, 12.105, 11.802, 10.072000000000001, 12.464000000000002, 12.748000000000001, 14.079, 11.602, 13.235000000000001, 10.899, 11.568999999999999, 10.667, 10.354999999999999, 13.223, 11.143, 13.542000000000002, 12.297, 12.266000000000002, 11.963000000000001, 11.048, 12.28, 11.804, 12.854, 12.75], "episode_lengths": [54, 45, 48, 53, 54, 52, 38, 47, 29, 73, 46, 49, 43, 40, 49, 37, 42, 48, 48, 46, 38, 41, 45, 35, 50, 57, 43, 50, 53, 52, 41, 39, 66, 38, 36, 44, 62, 49, 56, 41, 50, 43, 40, 32, 31, 47, 31, 59, 43, 37, 53, 61, 37, 44, 51, 48, 38, 40, 38, 43, 46, 44, 39, 47, 54, 33, 44, 36, 58, 39, 29, 40, 43, 36, 34, 43, 42, 45, 47, 31, 49, 42, 71, 40, 44, 33, 61, 43, 42, 45, 37, 46, 44, 48, 39, 39, 42, 44, 48, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49821609773774994, "mean_inference_ms": 1.1652323227808123, "mean_action_processing_ms": 0.08231792759768597, "mean_env_wait_ms": 4.920448561557054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003442525863647461, "ViewRequirementAgentConnector_ms": 0.2335340976715088}}, "episode_reward_max": 16.416, "episode_reward_min": 10.072000000000001, "episode_reward_mean": 12.191080000000001, "episode_len_mean": 44.74, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.923, 12.557, 11.999000000000002, 11.593000000000002, 14.323, 12.879, 11.575999999999999, 13.399000000000001, 10.176, 13.791000000000002, 12.791, 12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846, 10.677000000000001, 12.866, 11.171000000000001, 11.437999999999999, 10.905, 11.009, 12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331, 12.304, 13.218, 11.879, 16.416, 11.722000000000001, 11.843, 11.922999999999998, 12.934000000000001, 11.122, 12.844000000000001, 11.811, 12.923, 13.465000000000003, 11.581999999999999, 11.799, 10.389000000000001, 14.072000000000001, 10.988999999999999, 12.535, 13.023000000000001, 10.696000000000002, 14.137, 15.249, 11.896, 12.263000000000002, 12.286, 12.273, 12.58, 12.893, 11.427000000000001, 13.098, 12.166, 12.719000000000001, 11.502, 12.969, 11.898, 11.115, 12.437000000000001, 10.097, 14.183, 12.091, 10.238000000000001, 11.258, 12.493, 10.402000000000001, 10.102, 11.065000000000001, 12.418, 12.105, 11.802, 10.072000000000001, 12.464000000000002, 12.748000000000001, 14.079, 11.602, 13.235000000000001, 10.899, 11.568999999999999, 10.667, 10.354999999999999, 13.223, 11.143, 13.542000000000002, 12.297, 12.266000000000002, 11.963000000000001, 11.048, 12.28, 11.804, 12.854, 12.75], "episode_lengths": [54, 45, 48, 53, 54, 52, 38, 47, 29, 73, 46, 49, 43, 40, 49, 37, 42, 48, 48, 46, 38, 41, 45, 35, 50, 57, 43, 50, 53, 52, 41, 39, 66, 38, 36, 44, 62, 49, 56, 41, 50, 43, 40, 32, 31, 47, 31, 59, 43, 37, 53, 61, 37, 44, 51, 48, 38, 40, 38, 43, 46, 44, 39, 47, 54, 33, 44, 36, 58, 39, 29, 40, 43, 36, 34, 43, 42, 45, 47, 31, 49, 42, 71, 40, 44, 33, 61, 43, 42, 45, 37, 46, 44, 48, 39, 39, 42, 44, 48, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49821609773774994, "mean_inference_ms": 1.1652323227808123, "mean_action_processing_ms": 0.08231792759768597, "mean_env_wait_ms": 4.920448561557054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003442525863647461, "ViewRequirementAgentConnector_ms": 0.2335340976715088}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16382, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 75.01562845061419, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16384, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16382, "timers": {"training_iteration_time_ms": 63459.516, "sample_time_ms": 3428.006, "synch_weights_time_ms": 41.262}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16382, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 245, "training_iteration": 32, "trial_id": "default", "date": "2025-12-19_17-56-39", "timestamp": 1766138199, "time_this_iter_s": 6.82829737663269, "time_total_s": 2326.244635105133, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2326.244635105133, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 38.464285714285715, "ram_util_percent": 8.599999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7785549615160562}, "default_policy": {"total_loss": 0.7785549615160562, "policy_loss": -0.028471851209178566, "vf_loss": 3.231078211963177, "vf_loss_unclipped": 6.752154749631882, "vf_explained_var": 0.5473801016807556, "entropy": 0.8971272960305214, "mean_kl_loss": 0.0061757055386436836, "gradients_default_optimizer_global_norm": 1.4716622531414032, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 16896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16894, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.416, "episode_reward_min": 10.072000000000001, "episode_reward_mean": 12.11961, "episode_len_mean": 44.13, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846, 10.677000000000001, 12.866, 11.171000000000001, 11.437999999999999, 10.905, 11.009, 12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331, 12.304, 13.218, 11.879, 16.416, 11.722000000000001, 11.843, 11.922999999999998, 12.934000000000001, 11.122, 12.844000000000001, 11.811, 12.923, 13.465000000000003, 11.581999999999999, 11.799, 10.389000000000001, 14.072000000000001, 10.988999999999999, 12.535, 13.023000000000001, 10.696000000000002, 14.137, 15.249, 11.896, 12.263000000000002, 12.286, 12.273, 12.58, 12.893, 11.427000000000001, 13.098, 12.166, 12.719000000000001, 11.502, 12.969, 11.898, 11.115, 12.437000000000001, 10.097, 14.183, 12.091, 10.238000000000001, 11.258, 12.493, 10.402000000000001, 10.102, 11.065000000000001, 12.418, 12.105, 11.802, 10.072000000000001, 12.464000000000002, 12.748000000000001, 14.079, 11.602, 13.235000000000001, 10.899, 11.568999999999999, 10.667, 10.354999999999999, 13.223, 11.143, 13.542000000000002, 12.297, 12.266000000000002, 11.963000000000001, 11.048, 12.28, 11.804, 12.854, 12.75, 14.658999999999999, 12.407, 11.652999999999999, 10.85, 10.199000000000002, 11.238, 11.075, 11.337, 10.190000000000001, 11.857, 14.395000000000001], "episode_lengths": [49, 43, 40, 49, 37, 42, 48, 48, 46, 38, 41, 45, 35, 50, 57, 43, 50, 53, 52, 41, 39, 66, 38, 36, 44, 62, 49, 56, 41, 50, 43, 40, 32, 31, 47, 31, 59, 43, 37, 53, 61, 37, 44, 51, 48, 38, 40, 38, 43, 46, 44, 39, 47, 54, 33, 44, 36, 58, 39, 29, 40, 43, 36, 34, 43, 42, 45, 47, 31, 49, 42, 71, 40, 44, 33, 61, 43, 42, 45, 37, 46, 44, 48, 39, 39, 42, 44, 48, 44, 58, 44, 39, 29, 38, 40, 48, 53, 39, 37, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5000600885053132, "mean_inference_ms": 1.164994637095298, "mean_action_processing_ms": 0.08230590708311387, "mean_env_wait_ms": 4.91877458724441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034236907958984375, "ViewRequirementAgentConnector_ms": 0.23285675048828125}}, "episode_reward_max": 16.416, "episode_reward_min": 10.072000000000001, "episode_reward_mean": 12.11961, "episode_len_mean": 44.13, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.305, 12.413, 11.933, 11.578000000000001, 11.145000000000001, 13.246, 12.846, 10.677000000000001, 12.866, 11.171000000000001, 11.437999999999999, 10.905, 11.009, 12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331, 12.304, 13.218, 11.879, 16.416, 11.722000000000001, 11.843, 11.922999999999998, 12.934000000000001, 11.122, 12.844000000000001, 11.811, 12.923, 13.465000000000003, 11.581999999999999, 11.799, 10.389000000000001, 14.072000000000001, 10.988999999999999, 12.535, 13.023000000000001, 10.696000000000002, 14.137, 15.249, 11.896, 12.263000000000002, 12.286, 12.273, 12.58, 12.893, 11.427000000000001, 13.098, 12.166, 12.719000000000001, 11.502, 12.969, 11.898, 11.115, 12.437000000000001, 10.097, 14.183, 12.091, 10.238000000000001, 11.258, 12.493, 10.402000000000001, 10.102, 11.065000000000001, 12.418, 12.105, 11.802, 10.072000000000001, 12.464000000000002, 12.748000000000001, 14.079, 11.602, 13.235000000000001, 10.899, 11.568999999999999, 10.667, 10.354999999999999, 13.223, 11.143, 13.542000000000002, 12.297, 12.266000000000002, 11.963000000000001, 11.048, 12.28, 11.804, 12.854, 12.75, 14.658999999999999, 12.407, 11.652999999999999, 10.85, 10.199000000000002, 11.238, 11.075, 11.337, 10.190000000000001, 11.857, 14.395000000000001], "episode_lengths": [49, 43, 40, 49, 37, 42, 48, 48, 46, 38, 41, 45, 35, 50, 57, 43, 50, 53, 52, 41, 39, 66, 38, 36, 44, 62, 49, 56, 41, 50, 43, 40, 32, 31, 47, 31, 59, 43, 37, 53, 61, 37, 44, 51, 48, 38, 40, 38, 43, 46, 44, 39, 47, 54, 33, 44, 36, 58, 39, 29, 40, 43, 36, 34, 43, 42, 45, 47, 31, 49, 42, 71, 40, 44, 33, 61, 43, 42, 45, 37, 46, 44, 48, 39, 39, 42, 44, 48, 44, 58, 44, 39, 29, 38, 40, 48, 53, 39, 37, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5000600885053132, "mean_inference_ms": 1.164994637095298, "mean_action_processing_ms": 0.08230590708311387, "mean_env_wait_ms": 4.91877458724441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034236907958984375, "ViewRequirementAgentConnector_ms": 0.23285675048828125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16894, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.960721342411963, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16894, "timers": {"training_iteration_time_ms": 62481.775, "sample_time_ms": 3427.761, "synch_weights_time_ms": 41.118}, "counters": {"num_env_steps_sampled": 16896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16894, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 256, "training_iteration": 33, "trial_id": "default", "date": "2025-12-19_17-57-44", "timestamp": 1766138264, "time_this_iter_s": 64.31946277618408, "time_total_s": 2390.564097881317, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2390.564097881317, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 93.27252747252747, "ram_util_percent": 12.357142857142854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7511136842891574}, "default_policy": {"total_loss": 0.7511136842891574, "policy_loss": -0.03659627051092684, "vf_loss": 3.1530992671847344, "vf_loss_unclipped": 7.636668854951859, "vf_explained_var": 0.570535833388567, "entropy": 0.8514496564865113, "mean_kl_loss": 0.011464166376745766, "gradients_default_optimizer_global_norm": 1.3943519592285156, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17406, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.416, "episode_reward_min": 10.072000000000001, "episode_reward_mean": 12.06115, "episode_len_mean": 43.83, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331, 12.304, 13.218, 11.879, 16.416, 11.722000000000001, 11.843, 11.922999999999998, 12.934000000000001, 11.122, 12.844000000000001, 11.811, 12.923, 13.465000000000003, 11.581999999999999, 11.799, 10.389000000000001, 14.072000000000001, 10.988999999999999, 12.535, 13.023000000000001, 10.696000000000002, 14.137, 15.249, 11.896, 12.263000000000002, 12.286, 12.273, 12.58, 12.893, 11.427000000000001, 13.098, 12.166, 12.719000000000001, 11.502, 12.969, 11.898, 11.115, 12.437000000000001, 10.097, 14.183, 12.091, 10.238000000000001, 11.258, 12.493, 10.402000000000001, 10.102, 11.065000000000001, 12.418, 12.105, 11.802, 10.072000000000001, 12.464000000000002, 12.748000000000001, 14.079, 11.602, 13.235000000000001, 10.899, 11.568999999999999, 10.667, 10.354999999999999, 13.223, 11.143, 13.542000000000002, 12.297, 12.266000000000002, 11.963000000000001, 11.048, 12.28, 11.804, 12.854, 12.75, 14.658999999999999, 12.407, 11.652999999999999, 10.85, 10.199000000000002, 11.238, 11.075, 11.337, 10.190000000000001, 11.857, 14.395000000000001, 10.699, 10.183, 13.565000000000001, 10.373, 11.216999999999999, 10.622, 10.923, 12.084, 11.463, 10.566, 11.699, 12.865000000000002, 11.427], "episode_lengths": [50, 57, 43, 50, 53, 52, 41, 39, 66, 38, 36, 44, 62, 49, 56, 41, 50, 43, 40, 32, 31, 47, 31, 59, 43, 37, 53, 61, 37, 44, 51, 48, 38, 40, 38, 43, 46, 44, 39, 47, 54, 33, 44, 36, 58, 39, 29, 40, 43, 36, 34, 43, 42, 45, 47, 31, 49, 42, 71, 40, 44, 33, 61, 43, 42, 45, 37, 46, 44, 48, 39, 39, 42, 44, 48, 44, 58, 44, 39, 29, 38, 40, 48, 53, 39, 37, 53, 36, 33, 46, 33, 46, 40, 38, 43, 39, 30, 48, 54, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5021526149308357, "mean_inference_ms": 1.1647353382101722, "mean_action_processing_ms": 0.0822913547448782, "mean_env_wait_ms": 4.9170343448189255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003430604934692383, "ViewRequirementAgentConnector_ms": 0.234025239944458}}, "episode_reward_max": 16.416, "episode_reward_min": 10.072000000000001, "episode_reward_mean": 12.06115, "episode_len_mean": 43.83, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.190999999999999, 14.506000000000002, 10.507000000000001, 13.523, 14.331, 12.304, 13.218, 11.879, 16.416, 11.722000000000001, 11.843, 11.922999999999998, 12.934000000000001, 11.122, 12.844000000000001, 11.811, 12.923, 13.465000000000003, 11.581999999999999, 11.799, 10.389000000000001, 14.072000000000001, 10.988999999999999, 12.535, 13.023000000000001, 10.696000000000002, 14.137, 15.249, 11.896, 12.263000000000002, 12.286, 12.273, 12.58, 12.893, 11.427000000000001, 13.098, 12.166, 12.719000000000001, 11.502, 12.969, 11.898, 11.115, 12.437000000000001, 10.097, 14.183, 12.091, 10.238000000000001, 11.258, 12.493, 10.402000000000001, 10.102, 11.065000000000001, 12.418, 12.105, 11.802, 10.072000000000001, 12.464000000000002, 12.748000000000001, 14.079, 11.602, 13.235000000000001, 10.899, 11.568999999999999, 10.667, 10.354999999999999, 13.223, 11.143, 13.542000000000002, 12.297, 12.266000000000002, 11.963000000000001, 11.048, 12.28, 11.804, 12.854, 12.75, 14.658999999999999, 12.407, 11.652999999999999, 10.85, 10.199000000000002, 11.238, 11.075, 11.337, 10.190000000000001, 11.857, 14.395000000000001, 10.699, 10.183, 13.565000000000001, 10.373, 11.216999999999999, 10.622, 10.923, 12.084, 11.463, 10.566, 11.699, 12.865000000000002, 11.427], "episode_lengths": [50, 57, 43, 50, 53, 52, 41, 39, 66, 38, 36, 44, 62, 49, 56, 41, 50, 43, 40, 32, 31, 47, 31, 59, 43, 37, 53, 61, 37, 44, 51, 48, 38, 40, 38, 43, 46, 44, 39, 47, 54, 33, 44, 36, 58, 39, 29, 40, 43, 36, 34, 43, 42, 45, 47, 31, 49, 42, 71, 40, 44, 33, 61, 43, 42, 45, 37, 46, 44, 48, 39, 39, 42, 44, 48, 44, 58, 44, 39, 29, 38, 40, 48, 53, 39, 37, 53, 36, 33, 46, 33, 46, 40, 38, 43, 39, 30, 48, 54, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5021526149308357, "mean_inference_ms": 1.1647353382101722, "mean_action_processing_ms": 0.0822913547448782, "mean_env_wait_ms": 4.9170343448189255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003430604934692383, "ViewRequirementAgentConnector_ms": 0.234025239944458}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17406, "num_agent_steps_trained": 0, "num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.930171649315154, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 17408, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 17406, "timers": {"training_iteration_time_ms": 62510.821, "sample_time_ms": 3431.102, "synch_weights_time_ms": 38.893}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17406, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 269, "training_iteration": 34, "trial_id": "default", "date": "2025-12-19_17-58-58", "timestamp": 1766138338, "time_this_iter_s": 73.8826584815979, "time_total_s": 2464.446756362915, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2464.446756362915, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 94.84339622641508, "ram_util_percent": 15.440566037735854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.9464063413441182}, "default_policy": {"total_loss": 0.9464063413441182, "policy_loss": -0.03689139767084271, "vf_loss": 3.9358745217323303, "vf_loss_unclipped": 9.266904646158219, "vf_explained_var": 0.2727396868169308, "entropy": 0.8186675392091274, "mean_kl_loss": 0.005911147930072502, "gradients_default_optimizer_global_norm": 1.7091724306344986, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17918, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 15.249, "episode_reward_min": 10.072000000000001, "episode_reward_mean": 11.879719999999999, "episode_len_mean": 42.45, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.844000000000001, 11.811, 12.923, 13.465000000000003, 11.581999999999999, 11.799, 10.389000000000001, 14.072000000000001, 10.988999999999999, 12.535, 13.023000000000001, 10.696000000000002, 14.137, 15.249, 11.896, 12.263000000000002, 12.286, 12.273, 12.58, 12.893, 11.427000000000001, 13.098, 12.166, 12.719000000000001, 11.502, 12.969, 11.898, 11.115, 12.437000000000001, 10.097, 14.183, 12.091, 10.238000000000001, 11.258, 12.493, 10.402000000000001, 10.102, 11.065000000000001, 12.418, 12.105, 11.802, 10.072000000000001, 12.464000000000002, 12.748000000000001, 14.079, 11.602, 13.235000000000001, 10.899, 11.568999999999999, 10.667, 10.354999999999999, 13.223, 11.143, 13.542000000000002, 12.297, 12.266000000000002, 11.963000000000001, 11.048, 12.28, 11.804, 12.854, 12.75, 14.658999999999999, 12.407, 11.652999999999999, 10.85, 10.199000000000002, 11.238, 11.075, 11.337, 10.190000000000001, 11.857, 14.395000000000001, 10.699, 10.183, 13.565000000000001, 10.373, 11.216999999999999, 10.622, 10.923, 12.084, 11.463, 10.566, 11.699, 12.865000000000002, 11.427, 11.33, 10.786, 10.663, 10.477, 11.285, 12.098, 10.569, 10.207, 11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792], "episode_lengths": [56, 41, 50, 43, 40, 32, 31, 47, 31, 59, 43, 37, 53, 61, 37, 44, 51, 48, 38, 40, 38, 43, 46, 44, 39, 47, 54, 33, 44, 36, 58, 39, 29, 40, 43, 36, 34, 43, 42, 45, 47, 31, 49, 42, 71, 40, 44, 33, 61, 43, 42, 45, 37, 46, 44, 48, 39, 39, 42, 44, 48, 44, 58, 44, 39, 29, 38, 40, 48, 53, 39, 37, 53, 36, 33, 46, 33, 46, 40, 38, 43, 39, 30, 48, 54, 45, 36, 33, 42, 33, 44, 41, 30, 32, 38, 39, 52, 49, 40, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5044366571014121, "mean_inference_ms": 1.164825521786884, "mean_action_processing_ms": 0.08230615636542699, "mean_env_wait_ms": 4.915992214173489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003441333770751953, "ViewRequirementAgentConnector_ms": 0.23447561264038086}}, "episode_reward_max": 15.249, "episode_reward_min": 10.072000000000001, "episode_reward_mean": 11.879719999999999, "episode_len_mean": 42.45, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.844000000000001, 11.811, 12.923, 13.465000000000003, 11.581999999999999, 11.799, 10.389000000000001, 14.072000000000001, 10.988999999999999, 12.535, 13.023000000000001, 10.696000000000002, 14.137, 15.249, 11.896, 12.263000000000002, 12.286, 12.273, 12.58, 12.893, 11.427000000000001, 13.098, 12.166, 12.719000000000001, 11.502, 12.969, 11.898, 11.115, 12.437000000000001, 10.097, 14.183, 12.091, 10.238000000000001, 11.258, 12.493, 10.402000000000001, 10.102, 11.065000000000001, 12.418, 12.105, 11.802, 10.072000000000001, 12.464000000000002, 12.748000000000001, 14.079, 11.602, 13.235000000000001, 10.899, 11.568999999999999, 10.667, 10.354999999999999, 13.223, 11.143, 13.542000000000002, 12.297, 12.266000000000002, 11.963000000000001, 11.048, 12.28, 11.804, 12.854, 12.75, 14.658999999999999, 12.407, 11.652999999999999, 10.85, 10.199000000000002, 11.238, 11.075, 11.337, 10.190000000000001, 11.857, 14.395000000000001, 10.699, 10.183, 13.565000000000001, 10.373, 11.216999999999999, 10.622, 10.923, 12.084, 11.463, 10.566, 11.699, 12.865000000000002, 11.427, 11.33, 10.786, 10.663, 10.477, 11.285, 12.098, 10.569, 10.207, 11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792], "episode_lengths": [56, 41, 50, 43, 40, 32, 31, 47, 31, 59, 43, 37, 53, 61, 37, 44, 51, 48, 38, 40, 38, 43, 46, 44, 39, 47, 54, 33, 44, 36, 58, 39, 29, 40, 43, 36, 34, 43, 42, 45, 47, 31, 49, 42, 71, 40, 44, 33, 61, 43, 42, 45, 37, 46, 44, 48, 39, 39, 42, 44, 48, 44, 58, 44, 39, 29, 38, 40, 48, 53, 39, 37, 53, 36, 33, 46, 33, 46, 40, 38, 43, 39, 30, 48, 54, 45, 36, 33, 42, 33, 44, 41, 30, 32, 38, 39, 52, 49, 40, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5044366571014121, "mean_inference_ms": 1.164825521786884, "mean_action_processing_ms": 0.08230615636542699, "mean_env_wait_ms": 4.915992214173489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003441333770751953, "ViewRequirementAgentConnector_ms": 0.23447561264038086}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17918, "num_agent_steps_trained": 0, "num_env_steps_sampled": 17920, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.997153142172847, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 17920, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 17918, "timers": {"training_iteration_time_ms": 62486.841, "sample_time_ms": 3432.566, "synch_weights_time_ms": 38.121}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17918, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 283, "training_iteration": 35, "trial_id": "default", "date": "2025-12-19_18-00-11", "timestamp": 1766138411, "time_this_iter_s": 73.1749939918518, "time_total_s": 2537.621750354767, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2537.621750354767, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 94.69615384615386, "ram_util_percent": 15.405769230769234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7350596455857158}, "default_policy": {"total_loss": 0.7350596455857158, "policy_loss": -0.03661578599130735, "vf_loss": 3.0887846127152443, "vf_loss_unclipped": 7.48949984908104, "vf_explained_var": 0.6749271750450134, "entropy": 0.789701695740223, "mean_kl_loss": 0.010758613758929414, "gradients_default_optimizer_global_norm": 1.2984624944627285, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18430, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 15.249, "episode_reward_min": 9.976, "episode_reward_mean": 11.752970000000003, "episode_len_mean": 42.07, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.696000000000002, 14.137, 15.249, 11.896, 12.263000000000002, 12.286, 12.273, 12.58, 12.893, 11.427000000000001, 13.098, 12.166, 12.719000000000001, 11.502, 12.969, 11.898, 11.115, 12.437000000000001, 10.097, 14.183, 12.091, 10.238000000000001, 11.258, 12.493, 10.402000000000001, 10.102, 11.065000000000001, 12.418, 12.105, 11.802, 10.072000000000001, 12.464000000000002, 12.748000000000001, 14.079, 11.602, 13.235000000000001, 10.899, 11.568999999999999, 10.667, 10.354999999999999, 13.223, 11.143, 13.542000000000002, 12.297, 12.266000000000002, 11.963000000000001, 11.048, 12.28, 11.804, 12.854, 12.75, 14.658999999999999, 12.407, 11.652999999999999, 10.85, 10.199000000000002, 11.238, 11.075, 11.337, 10.190000000000001, 11.857, 14.395000000000001, 10.699, 10.183, 13.565000000000001, 10.373, 11.216999999999999, 10.622, 10.923, 12.084, 11.463, 10.566, 11.699, 12.865000000000002, 11.427, 11.33, 10.786, 10.663, 10.477, 11.285, 12.098, 10.569, 10.207, 11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792, 13.120999999999999, 12.205, 10.9, 10.492, 10.229, 10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976], "episode_lengths": [37, 53, 61, 37, 44, 51, 48, 38, 40, 38, 43, 46, 44, 39, 47, 54, 33, 44, 36, 58, 39, 29, 40, 43, 36, 34, 43, 42, 45, 47, 31, 49, 42, 71, 40, 44, 33, 61, 43, 42, 45, 37, 46, 44, 48, 39, 39, 42, 44, 48, 44, 58, 44, 39, 29, 38, 40, 48, 53, 39, 37, 53, 36, 33, 46, 33, 46, 40, 38, 43, 39, 30, 48, 54, 45, 36, 33, 42, 33, 44, 41, 30, 32, 38, 39, 52, 49, 40, 33, 49, 45, 36, 35, 39, 38, 35, 42, 39, 44, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5060200802747687, "mean_inference_ms": 1.164453327302126, "mean_action_processing_ms": 0.08228003084910424, "mean_env_wait_ms": 4.914760660254272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003444671630859375, "ViewRequirementAgentConnector_ms": 0.23490071296691895}}, "episode_reward_max": 15.249, "episode_reward_min": 9.976, "episode_reward_mean": 11.752970000000003, "episode_len_mean": 42.07, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.696000000000002, 14.137, 15.249, 11.896, 12.263000000000002, 12.286, 12.273, 12.58, 12.893, 11.427000000000001, 13.098, 12.166, 12.719000000000001, 11.502, 12.969, 11.898, 11.115, 12.437000000000001, 10.097, 14.183, 12.091, 10.238000000000001, 11.258, 12.493, 10.402000000000001, 10.102, 11.065000000000001, 12.418, 12.105, 11.802, 10.072000000000001, 12.464000000000002, 12.748000000000001, 14.079, 11.602, 13.235000000000001, 10.899, 11.568999999999999, 10.667, 10.354999999999999, 13.223, 11.143, 13.542000000000002, 12.297, 12.266000000000002, 11.963000000000001, 11.048, 12.28, 11.804, 12.854, 12.75, 14.658999999999999, 12.407, 11.652999999999999, 10.85, 10.199000000000002, 11.238, 11.075, 11.337, 10.190000000000001, 11.857, 14.395000000000001, 10.699, 10.183, 13.565000000000001, 10.373, 11.216999999999999, 10.622, 10.923, 12.084, 11.463, 10.566, 11.699, 12.865000000000002, 11.427, 11.33, 10.786, 10.663, 10.477, 11.285, 12.098, 10.569, 10.207, 11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792, 13.120999999999999, 12.205, 10.9, 10.492, 10.229, 10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976], "episode_lengths": [37, 53, 61, 37, 44, 51, 48, 38, 40, 38, 43, 46, 44, 39, 47, 54, 33, 44, 36, 58, 39, 29, 40, 43, 36, 34, 43, 42, 45, 47, 31, 49, 42, 71, 40, 44, 33, 61, 43, 42, 45, 37, 46, 44, 48, 39, 39, 42, 44, 48, 44, 58, 44, 39, 29, 38, 40, 48, 53, 39, 37, 53, 36, 33, 46, 33, 46, 40, 38, 43, 39, 30, 48, 54, 45, 36, 33, 42, 33, 44, 41, 30, 32, 38, 39, 52, 49, 40, 33, 49, 45, 36, 35, 39, 38, 35, 42, 39, 44, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5060200802747687, "mean_inference_ms": 1.164453327302126, "mean_action_processing_ms": 0.08228003084910424, "mean_env_wait_ms": 4.914760660254272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003444671630859375, "ViewRequirementAgentConnector_ms": 0.23490071296691895}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18430, "num_agent_steps_trained": 0, "num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.9806246517239074, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 18432, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 18430, "timers": {"training_iteration_time_ms": 62439.399, "sample_time_ms": 3438.476, "synch_weights_time_ms": 36.758}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18430, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 294, "training_iteration": 36, "trial_id": "default", "date": "2025-12-19_18-01-24", "timestamp": 1766138484, "time_this_iter_s": 73.3485152721405, "time_total_s": 2610.9702656269073, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2610.9702656269073, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 94.7076923076923, "ram_util_percent": 15.400000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 513.0, "total_loss": 0.9704194344856121}, "default_policy": {"total_loss": 0.9704194344856121, "policy_loss": -0.029480197455412076, "vf_loss": 4.00198299502149, "vf_loss_unclipped": 9.430677911381663, "vf_explained_var": 0.3867893903343766, "entropy": 0.7957161922513702, "mean_kl_loss": 0.00798435290795326, "gradients_default_optimizer_global_norm": 1.5011279774300845, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 18944, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18943, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 14.658999999999999, "episode_reward_min": 9.976, "episode_reward_mean": 11.56663, "episode_len_mean": 41.85, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.502, 12.969, 11.898, 11.115, 12.437000000000001, 10.097, 14.183, 12.091, 10.238000000000001, 11.258, 12.493, 10.402000000000001, 10.102, 11.065000000000001, 12.418, 12.105, 11.802, 10.072000000000001, 12.464000000000002, 12.748000000000001, 14.079, 11.602, 13.235000000000001, 10.899, 11.568999999999999, 10.667, 10.354999999999999, 13.223, 11.143, 13.542000000000002, 12.297, 12.266000000000002, 11.963000000000001, 11.048, 12.28, 11.804, 12.854, 12.75, 14.658999999999999, 12.407, 11.652999999999999, 10.85, 10.199000000000002, 11.238, 11.075, 11.337, 10.190000000000001, 11.857, 14.395000000000001, 10.699, 10.183, 13.565000000000001, 10.373, 11.216999999999999, 10.622, 10.923, 12.084, 11.463, 10.566, 11.699, 12.865000000000002, 11.427, 11.33, 10.786, 10.663, 10.477, 11.285, 12.098, 10.569, 10.207, 11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792, 13.120999999999999, 12.205, 10.9, 10.492, 10.229, 10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976, 10.344, 10.173, 11.190999999999999, 10.604000000000001, 10.655, 11.318999999999999, 10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378], "episode_lengths": [39, 47, 54, 33, 44, 36, 58, 39, 29, 40, 43, 36, 34, 43, 42, 45, 47, 31, 49, 42, 71, 40, 44, 33, 61, 43, 42, 45, 37, 46, 44, 48, 39, 39, 42, 44, 48, 44, 58, 44, 39, 29, 38, 40, 48, 53, 39, 37, 53, 36, 33, 46, 33, 46, 40, 38, 43, 39, 30, 48, 54, 45, 36, 33, 42, 33, 44, 41, 30, 32, 38, 39, 52, 49, 40, 33, 49, 45, 36, 35, 39, 38, 35, 42, 39, 44, 33, 41, 31, 53, 41, 43, 34, 37, 66, 51, 45, 36, 37, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5080448362563703, "mean_inference_ms": 1.164915842985412, "mean_action_processing_ms": 0.08232144221591511, "mean_env_wait_ms": 4.914820743991856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034513473510742188, "ViewRequirementAgentConnector_ms": 0.23543667793273926}}, "episode_reward_max": 14.658999999999999, "episode_reward_min": 9.976, "episode_reward_mean": 11.56663, "episode_len_mean": 41.85, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.502, 12.969, 11.898, 11.115, 12.437000000000001, 10.097, 14.183, 12.091, 10.238000000000001, 11.258, 12.493, 10.402000000000001, 10.102, 11.065000000000001, 12.418, 12.105, 11.802, 10.072000000000001, 12.464000000000002, 12.748000000000001, 14.079, 11.602, 13.235000000000001, 10.899, 11.568999999999999, 10.667, 10.354999999999999, 13.223, 11.143, 13.542000000000002, 12.297, 12.266000000000002, 11.963000000000001, 11.048, 12.28, 11.804, 12.854, 12.75, 14.658999999999999, 12.407, 11.652999999999999, 10.85, 10.199000000000002, 11.238, 11.075, 11.337, 10.190000000000001, 11.857, 14.395000000000001, 10.699, 10.183, 13.565000000000001, 10.373, 11.216999999999999, 10.622, 10.923, 12.084, 11.463, 10.566, 11.699, 12.865000000000002, 11.427, 11.33, 10.786, 10.663, 10.477, 11.285, 12.098, 10.569, 10.207, 11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792, 13.120999999999999, 12.205, 10.9, 10.492, 10.229, 10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976, 10.344, 10.173, 11.190999999999999, 10.604000000000001, 10.655, 11.318999999999999, 10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378], "episode_lengths": [39, 47, 54, 33, 44, 36, 58, 39, 29, 40, 43, 36, 34, 43, 42, 45, 47, 31, 49, 42, 71, 40, 44, 33, 61, 43, 42, 45, 37, 46, 44, 48, 39, 39, 42, 44, 48, 44, 58, 44, 39, 29, 38, 40, 48, 53, 39, 37, 53, 36, 33, 46, 33, 46, 40, 38, 43, 39, 30, 48, 54, 45, 36, 33, 42, 33, 44, 41, 30, 32, 38, 39, 52, 49, 40, 33, 49, 45, 36, 35, 39, 38, 35, 42, 39, 44, 33, 41, 31, 53, 41, 43, 34, 37, 66, 51, 45, 36, 37, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5080448362563703, "mean_inference_ms": 1.164915842985412, "mean_action_processing_ms": 0.08232144221591511, "mean_env_wait_ms": 4.914820743991856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034513473510742188, "ViewRequirementAgentConnector_ms": 0.23543667793273926}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18943, "num_agent_steps_trained": 0, "num_env_steps_sampled": 18944, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.927723540646423, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 18944, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 18943, "timers": {"training_iteration_time_ms": 62558.912, "sample_time_ms": 3440.623, "synch_weights_time_ms": 38.869}, "counters": {"num_env_steps_sampled": 18944, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18943, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 307, "training_iteration": 37, "trial_id": "default", "date": "2025-12-19_18-02-41", "timestamp": 1766138561, "time_this_iter_s": 73.90836024284363, "time_total_s": 2684.878625869751, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2684.878625869751, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 91.82660550458715, "ram_util_percent": 15.400000000000007}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 511.0, "total_loss": 0.9599539713934064}, "default_policy": {"total_loss": 0.9599539713934064, "policy_loss": -0.03246088115265593, "vf_loss": 3.9718804478645326, "vf_loss_unclipped": 9.282028710842132, "vf_explained_var": 0.30608588457107544, "entropy": 0.7462951354682446, "mean_kl_loss": 0.007641381385136014, "gradients_default_optimizer_global_norm": 1.655634119361639, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19454, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 14.658999999999999, "episode_reward_min": 9.976, "episode_reward_mean": 11.548230000000004, "episode_len_mean": 41.97, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.102, 11.065000000000001, 12.418, 12.105, 11.802, 10.072000000000001, 12.464000000000002, 12.748000000000001, 14.079, 11.602, 13.235000000000001, 10.899, 11.568999999999999, 10.667, 10.354999999999999, 13.223, 11.143, 13.542000000000002, 12.297, 12.266000000000002, 11.963000000000001, 11.048, 12.28, 11.804, 12.854, 12.75, 14.658999999999999, 12.407, 11.652999999999999, 10.85, 10.199000000000002, 11.238, 11.075, 11.337, 10.190000000000001, 11.857, 14.395000000000001, 10.699, 10.183, 13.565000000000001, 10.373, 11.216999999999999, 10.622, 10.923, 12.084, 11.463, 10.566, 11.699, 12.865000000000002, 11.427, 11.33, 10.786, 10.663, 10.477, 11.285, 12.098, 10.569, 10.207, 11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792, 13.120999999999999, 12.205, 10.9, 10.492, 10.229, 10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976, 10.344, 10.173, 11.190999999999999, 10.604000000000001, 10.655, 11.318999999999999, 10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378, 10.735, 10.782, 12.283999999999999, 10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001], "episode_lengths": [34, 43, 42, 45, 47, 31, 49, 42, 71, 40, 44, 33, 61, 43, 42, 45, 37, 46, 44, 48, 39, 39, 42, 44, 48, 44, 58, 44, 39, 29, 38, 40, 48, 53, 39, 37, 53, 36, 33, 46, 33, 46, 40, 38, 43, 39, 30, 48, 54, 45, 36, 33, 42, 33, 44, 41, 30, 32, 38, 39, 52, 49, 40, 33, 49, 45, 36, 35, 39, 38, 35, 42, 39, 44, 33, 41, 31, 53, 41, 43, 34, 37, 66, 51, 45, 36, 37, 43, 41, 35, 42, 42, 48, 46, 45, 46, 39, 41, 36, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5097003281406777, "mean_inference_ms": 1.1649111237207095, "mean_action_processing_ms": 0.08232511494225793, "mean_env_wait_ms": 4.914290760459704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034627914428710938, "ViewRequirementAgentConnector_ms": 0.235792875289917}}, "episode_reward_max": 14.658999999999999, "episode_reward_min": 9.976, "episode_reward_mean": 11.548230000000004, "episode_len_mean": 41.97, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.102, 11.065000000000001, 12.418, 12.105, 11.802, 10.072000000000001, 12.464000000000002, 12.748000000000001, 14.079, 11.602, 13.235000000000001, 10.899, 11.568999999999999, 10.667, 10.354999999999999, 13.223, 11.143, 13.542000000000002, 12.297, 12.266000000000002, 11.963000000000001, 11.048, 12.28, 11.804, 12.854, 12.75, 14.658999999999999, 12.407, 11.652999999999999, 10.85, 10.199000000000002, 11.238, 11.075, 11.337, 10.190000000000001, 11.857, 14.395000000000001, 10.699, 10.183, 13.565000000000001, 10.373, 11.216999999999999, 10.622, 10.923, 12.084, 11.463, 10.566, 11.699, 12.865000000000002, 11.427, 11.33, 10.786, 10.663, 10.477, 11.285, 12.098, 10.569, 10.207, 11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792, 13.120999999999999, 12.205, 10.9, 10.492, 10.229, 10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976, 10.344, 10.173, 11.190999999999999, 10.604000000000001, 10.655, 11.318999999999999, 10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378, 10.735, 10.782, 12.283999999999999, 10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001], "episode_lengths": [34, 43, 42, 45, 47, 31, 49, 42, 71, 40, 44, 33, 61, 43, 42, 45, 37, 46, 44, 48, 39, 39, 42, 44, 48, 44, 58, 44, 39, 29, 38, 40, 48, 53, 39, 37, 53, 36, 33, 46, 33, 46, 40, 38, 43, 39, 30, 48, 54, 45, 36, 33, 42, 33, 44, 41, 30, 32, 38, 39, 52, 49, 40, 33, 49, 45, 36, 35, 39, 38, 35, 42, 39, 44, 33, 41, 31, 53, 41, 43, 34, 37, 66, 51, 45, 36, 37, 43, 41, 35, 42, 42, 48, 46, 45, 46, 39, 41, 36, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5097003281406777, "mean_inference_ms": 1.1649111237207095, "mean_action_processing_ms": 0.08232511494225793, "mean_env_wait_ms": 4.914290760459704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034627914428710938, "ViewRequirementAgentConnector_ms": 0.235792875289917}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19454, "num_agent_steps_trained": 0, "num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.989076909019302, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 19456, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 19454, "timers": {"training_iteration_time_ms": 62469.561, "sample_time_ms": 3444.684, "synch_weights_time_ms": 37.263}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19454, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 319, "training_iteration": 38, "trial_id": "default", "date": "2025-12-19_18-03-54", "timestamp": 1766138634, "time_this_iter_s": 73.25970196723938, "time_total_s": 2758.1383278369904, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2758.1383278369904, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 94.71923076923076, "ram_util_percent": 15.405769230769234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.9015893686562777}, "default_policy": {"total_loss": 0.9015893686562777, "policy_loss": -0.031926995748654007, "vf_loss": 3.736235924065113, "vf_loss_unclipped": 9.656592306494712, "vf_explained_var": 0.437214607000351, "entropy": 0.7404122717678547, "mean_kl_loss": 0.007912062371761407, "gradients_default_optimizer_global_norm": 1.5273130692541599, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 19968, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19966, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 14.658999999999999, "episode_reward_min": 9.976, "episode_reward_mean": 11.527239999999997, "episode_len_mean": 42.11, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.568999999999999, 10.667, 10.354999999999999, 13.223, 11.143, 13.542000000000002, 12.297, 12.266000000000002, 11.963000000000001, 11.048, 12.28, 11.804, 12.854, 12.75, 14.658999999999999, 12.407, 11.652999999999999, 10.85, 10.199000000000002, 11.238, 11.075, 11.337, 10.190000000000001, 11.857, 14.395000000000001, 10.699, 10.183, 13.565000000000001, 10.373, 11.216999999999999, 10.622, 10.923, 12.084, 11.463, 10.566, 11.699, 12.865000000000002, 11.427, 11.33, 10.786, 10.663, 10.477, 11.285, 12.098, 10.569, 10.207, 11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792, 13.120999999999999, 12.205, 10.9, 10.492, 10.229, 10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976, 10.344, 10.173, 11.190999999999999, 10.604000000000001, 10.655, 11.318999999999999, 10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378, 10.735, 10.782, 12.283999999999999, 10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001, 11.551, 12.888, 13.443999999999999, 11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464], "episode_lengths": [61, 43, 42, 45, 37, 46, 44, 48, 39, 39, 42, 44, 48, 44, 58, 44, 39, 29, 38, 40, 48, 53, 39, 37, 53, 36, 33, 46, 33, 46, 40, 38, 43, 39, 30, 48, 54, 45, 36, 33, 42, 33, 44, 41, 30, 32, 38, 39, 52, 49, 40, 33, 49, 45, 36, 35, 39, 38, 35, 42, 39, 44, 33, 41, 31, 53, 41, 43, 34, 37, 66, 51, 45, 36, 37, 43, 41, 35, 42, 42, 48, 46, 45, 46, 39, 41, 36, 49, 39, 65, 60, 42, 38, 45, 39, 35, 44, 49, 39, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5111916309388884, "mean_inference_ms": 1.1646309042574752, "mean_action_processing_ms": 0.08230440707047966, "mean_env_wait_ms": 4.913383141066754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034613609313964844, "ViewRequirementAgentConnector_ms": 0.23580312728881836}}, "episode_reward_max": 14.658999999999999, "episode_reward_min": 9.976, "episode_reward_mean": 11.527239999999997, "episode_len_mean": 42.11, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.568999999999999, 10.667, 10.354999999999999, 13.223, 11.143, 13.542000000000002, 12.297, 12.266000000000002, 11.963000000000001, 11.048, 12.28, 11.804, 12.854, 12.75, 14.658999999999999, 12.407, 11.652999999999999, 10.85, 10.199000000000002, 11.238, 11.075, 11.337, 10.190000000000001, 11.857, 14.395000000000001, 10.699, 10.183, 13.565000000000001, 10.373, 11.216999999999999, 10.622, 10.923, 12.084, 11.463, 10.566, 11.699, 12.865000000000002, 11.427, 11.33, 10.786, 10.663, 10.477, 11.285, 12.098, 10.569, 10.207, 11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792, 13.120999999999999, 12.205, 10.9, 10.492, 10.229, 10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976, 10.344, 10.173, 11.190999999999999, 10.604000000000001, 10.655, 11.318999999999999, 10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378, 10.735, 10.782, 12.283999999999999, 10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001, 11.551, 12.888, 13.443999999999999, 11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464], "episode_lengths": [61, 43, 42, 45, 37, 46, 44, 48, 39, 39, 42, 44, 48, 44, 58, 44, 39, 29, 38, 40, 48, 53, 39, 37, 53, 36, 33, 46, 33, 46, 40, 38, 43, 39, 30, 48, 54, 45, 36, 33, 42, 33, 44, 41, 30, 32, 38, 39, 52, 49, 40, 33, 49, 45, 36, 35, 39, 38, 35, 42, 39, 44, 33, 41, 31, 53, 41, 43, 34, 37, 66, 51, 45, 36, 37, 43, 41, 35, 42, 42, 48, 46, 45, 46, 39, 41, 36, 49, 39, 65, 60, 42, 38, 45, 39, 35, 44, 49, 39, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5111916309388884, "mean_inference_ms": 1.1646309042574752, "mean_action_processing_ms": 0.08230440707047966, "mean_env_wait_ms": 4.913383141066754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034613609313964844, "ViewRequirementAgentConnector_ms": 0.23580312728881836}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19966, "num_agent_steps_trained": 0, "num_env_steps_sampled": 19968, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.994374610469808, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 19968, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 19966, "timers": {"training_iteration_time_ms": 62404.771, "sample_time_ms": 3449.049, "synch_weights_time_ms": 36.471}, "counters": {"num_env_steps_sampled": 19968, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19966, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 331, "training_iteration": 39, "trial_id": "default", "date": "2025-12-19_18-05-07", "timestamp": 1766138707, "time_this_iter_s": 73.20424103736877, "time_total_s": 2831.342568874359, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2831.342568874359, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 94.7701923076923, "ram_util_percent": 15.40288461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.8549823968671262}, "default_policy": {"total_loss": 0.8549823968671262, "policy_loss": -0.03369000172242522, "vf_loss": 3.5566158547997473, "vf_loss_unclipped": 9.0840214073658, "vf_explained_var": 0.4220159791409969, "entropy": 0.6609036758542061, "mean_kl_loss": 0.007173684675673897, "gradients_default_optimizer_global_norm": 1.3397017002105713, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20478, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 14.658999999999999, "episode_reward_min": 9.976, "episode_reward_mean": 11.484019999999997, "episode_len_mean": 41.67, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.854, 12.75, 14.658999999999999, 12.407, 11.652999999999999, 10.85, 10.199000000000002, 11.238, 11.075, 11.337, 10.190000000000001, 11.857, 14.395000000000001, 10.699, 10.183, 13.565000000000001, 10.373, 11.216999999999999, 10.622, 10.923, 12.084, 11.463, 10.566, 11.699, 12.865000000000002, 11.427, 11.33, 10.786, 10.663, 10.477, 11.285, 12.098, 10.569, 10.207, 11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792, 13.120999999999999, 12.205, 10.9, 10.492, 10.229, 10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976, 10.344, 10.173, 11.190999999999999, 10.604000000000001, 10.655, 11.318999999999999, 10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378, 10.735, 10.782, 12.283999999999999, 10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001, 11.551, 12.888, 13.443999999999999, 11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464, 10.556000000000001, 10.392000000000001, 11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897], "episode_lengths": [48, 44, 58, 44, 39, 29, 38, 40, 48, 53, 39, 37, 53, 36, 33, 46, 33, 46, 40, 38, 43, 39, 30, 48, 54, 45, 36, 33, 42, 33, 44, 41, 30, 32, 38, 39, 52, 49, 40, 33, 49, 45, 36, 35, 39, 38, 35, 42, 39, 44, 33, 41, 31, 53, 41, 43, 34, 37, 66, 51, 45, 36, 37, 43, 41, 35, 42, 42, 48, 46, 45, 46, 39, 41, 36, 49, 39, 65, 60, 42, 38, 45, 39, 35, 44, 49, 39, 40, 31, 37, 35, 44, 43, 42, 42, 40, 41, 42, 54, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5126959501085362, "mean_inference_ms": 1.164710291058569, "mean_action_processing_ms": 0.08230787287848704, "mean_env_wait_ms": 4.913222774654638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034694671630859375, "ViewRequirementAgentConnector_ms": 0.2361621856689453}}, "episode_reward_max": 14.658999999999999, "episode_reward_min": 9.976, "episode_reward_mean": 11.484019999999997, "episode_len_mean": 41.67, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.854, 12.75, 14.658999999999999, 12.407, 11.652999999999999, 10.85, 10.199000000000002, 11.238, 11.075, 11.337, 10.190000000000001, 11.857, 14.395000000000001, 10.699, 10.183, 13.565000000000001, 10.373, 11.216999999999999, 10.622, 10.923, 12.084, 11.463, 10.566, 11.699, 12.865000000000002, 11.427, 11.33, 10.786, 10.663, 10.477, 11.285, 12.098, 10.569, 10.207, 11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792, 13.120999999999999, 12.205, 10.9, 10.492, 10.229, 10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976, 10.344, 10.173, 11.190999999999999, 10.604000000000001, 10.655, 11.318999999999999, 10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378, 10.735, 10.782, 12.283999999999999, 10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001, 11.551, 12.888, 13.443999999999999, 11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464, 10.556000000000001, 10.392000000000001, 11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897], "episode_lengths": [48, 44, 58, 44, 39, 29, 38, 40, 48, 53, 39, 37, 53, 36, 33, 46, 33, 46, 40, 38, 43, 39, 30, 48, 54, 45, 36, 33, 42, 33, 44, 41, 30, 32, 38, 39, 52, 49, 40, 33, 49, 45, 36, 35, 39, 38, 35, 42, 39, 44, 33, 41, 31, 53, 41, 43, 34, 37, 66, 51, 45, 36, 37, 43, 41, 35, 42, 42, 48, 46, 45, 46, 39, 41, 36, 49, 39, 65, 60, 42, 38, 45, 39, 35, 44, 49, 39, 40, 31, 37, 35, 44, 43, 42, 42, 40, 41, 42, 54, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5126959501085362, "mean_inference_ms": 1.164710291058569, "mean_action_processing_ms": 0.08230787287848704, "mean_env_wait_ms": 4.913222774654638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034694671630859375, "ViewRequirementAgentConnector_ms": 0.2361621856689453}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20478, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.954874954136744, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20480, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 20478, "timers": {"training_iteration_time_ms": 62355.558, "sample_time_ms": 3452.264, "synch_weights_time_ms": 36.527}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20478, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 343, "training_iteration": 40, "trial_id": "default", "date": "2025-12-19_18-06-21", "timestamp": 1766138781, "time_this_iter_s": 73.62010025978088, "time_total_s": 2904.96266913414, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2904.96266913414, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 94.74571428571429, "ram_util_percent": 15.429523809523813}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.9077325496822596}, "default_policy": {"total_loss": 0.9077325496822596, "policy_loss": -0.03242180892266333, "vf_loss": 3.7627347677946092, "vf_loss_unclipped": 10.218669882416725, "vf_explained_var": 0.5699244424700737, "entropy": 0.692591791599989, "mean_kl_loss": 0.006530727731370689, "gradients_default_optimizer_global_norm": 1.5551671609282494, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 20992, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20990, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 14.395000000000001, "episode_reward_min": 9.976, "episode_reward_mean": 11.458349999999998, "episode_len_mean": 41.61, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.395000000000001, 10.699, 10.183, 13.565000000000001, 10.373, 11.216999999999999, 10.622, 10.923, 12.084, 11.463, 10.566, 11.699, 12.865000000000002, 11.427, 11.33, 10.786, 10.663, 10.477, 11.285, 12.098, 10.569, 10.207, 11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792, 13.120999999999999, 12.205, 10.9, 10.492, 10.229, 10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976, 10.344, 10.173, 11.190999999999999, 10.604000000000001, 10.655, 11.318999999999999, 10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378, 10.735, 10.782, 12.283999999999999, 10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001, 11.551, 12.888, 13.443999999999999, 11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464, 10.556000000000001, 10.392000000000001, 11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897, 11.523, 10.91, 11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237], "episode_lengths": [53, 36, 33, 46, 33, 46, 40, 38, 43, 39, 30, 48, 54, 45, 36, 33, 42, 33, 44, 41, 30, 32, 38, 39, 52, 49, 40, 33, 49, 45, 36, 35, 39, 38, 35, 42, 39, 44, 33, 41, 31, 53, 41, 43, 34, 37, 66, 51, 45, 36, 37, 43, 41, 35, 42, 42, 48, 46, 45, 46, 39, 41, 36, 49, 39, 65, 60, 42, 38, 45, 39, 35, 44, 49, 39, 40, 31, 37, 35, 44, 43, 42, 42, 40, 41, 42, 54, 35, 51, 39, 40, 36, 42, 40, 37, 48, 63, 43, 33, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5141497743540936, "mean_inference_ms": 1.164823897628463, "mean_action_processing_ms": 0.08231115531391581, "mean_env_wait_ms": 4.913209590937454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034837722778320312, "ViewRequirementAgentConnector_ms": 0.23615121841430664}}, "episode_reward_max": 14.395000000000001, "episode_reward_min": 9.976, "episode_reward_mean": 11.458349999999998, "episode_len_mean": 41.61, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.395000000000001, 10.699, 10.183, 13.565000000000001, 10.373, 11.216999999999999, 10.622, 10.923, 12.084, 11.463, 10.566, 11.699, 12.865000000000002, 11.427, 11.33, 10.786, 10.663, 10.477, 11.285, 12.098, 10.569, 10.207, 11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792, 13.120999999999999, 12.205, 10.9, 10.492, 10.229, 10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976, 10.344, 10.173, 11.190999999999999, 10.604000000000001, 10.655, 11.318999999999999, 10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378, 10.735, 10.782, 12.283999999999999, 10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001, 11.551, 12.888, 13.443999999999999, 11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464, 10.556000000000001, 10.392000000000001, 11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897, 11.523, 10.91, 11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237], "episode_lengths": [53, 36, 33, 46, 33, 46, 40, 38, 43, 39, 30, 48, 54, 45, 36, 33, 42, 33, 44, 41, 30, 32, 38, 39, 52, 49, 40, 33, 49, 45, 36, 35, 39, 38, 35, 42, 39, 44, 33, 41, 31, 53, 41, 43, 34, 37, 66, 51, 45, 36, 37, 43, 41, 35, 42, 42, 48, 46, 45, 46, 39, 41, 36, 49, 39, 65, 60, 42, 38, 45, 39, 35, 44, 49, 39, 40, 31, 37, 35, 44, 43, 42, 42, 40, 41, 42, 54, 35, 51, 39, 40, 36, 42, 40, 37, 48, 63, 43, 33, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5141497743540936, "mean_inference_ms": 1.164823897628463, "mean_action_processing_ms": 0.08231115531391581, "mean_env_wait_ms": 4.913209590937454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034837722778320312, "ViewRequirementAgentConnector_ms": 0.23615121841430664}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20990, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20992, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.05707155222123, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20992, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 20990, "timers": {"training_iteration_time_ms": 65807.255, "sample_time_ms": 3451.212, "synch_weights_time_ms": 39.645}, "counters": {"num_env_steps_sampled": 20992, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20990, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 355, "training_iteration": 41, "trial_id": "default", "date": "2025-12-19_18-07-33", "timestamp": 1766138853, "time_this_iter_s": 72.55391573905945, "time_total_s": 2977.5165848731995, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2977.5165848731995, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 94.53106796116502, "ram_util_percent": 15.406796116504864}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.8801626455038786}, "default_policy": {"total_loss": 0.8801626455038786, "policy_loss": -0.038269368442706765, "vf_loss": 3.675342506170273, "vf_loss_unclipped": 12.13341007232666, "vf_explained_var": -0.006070373952388764, "entropy": 0.6194966301321984, "mean_kl_loss": 0.008635278967247473, "gradients_default_optimizer_global_norm": 1.3517958335578442, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 0, "num_agent_steps_sampled": 21502, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.252, "episode_reward_min": 9.976, "episode_reward_mean": 11.584159999999997, "episode_len_mean": 42.35, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.699, 12.865000000000002, 11.427, 11.33, 10.786, 10.663, 10.477, 11.285, 12.098, 10.569, 10.207, 11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792, 13.120999999999999, 12.205, 10.9, 10.492, 10.229, 10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976, 10.344, 10.173, 11.190999999999999, 10.604000000000001, 10.655, 11.318999999999999, 10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378, 10.735, 10.782, 12.283999999999999, 10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001, 11.551, 12.888, 13.443999999999999, 11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464, 10.556000000000001, 10.392000000000001, 11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897, 11.523, 10.91, 11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237, 16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001], "episode_lengths": [48, 54, 45, 36, 33, 42, 33, 44, 41, 30, 32, 38, 39, 52, 49, 40, 33, 49, 45, 36, 35, 39, 38, 35, 42, 39, 44, 33, 41, 31, 53, 41, 43, 34, 37, 66, 51, 45, 36, 37, 43, 41, 35, 42, 42, 48, 46, 45, 46, 39, 41, 36, 49, 39, 65, 60, 42, 38, 45, 39, 35, 44, 49, 39, 40, 31, 37, 35, 44, 43, 42, 42, 40, 41, 42, 54, 35, 51, 39, 40, 36, 42, 40, 37, 48, 63, 43, 33, 39, 82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5151692697064396, "mean_inference_ms": 1.1643441861443034, "mean_action_processing_ms": 0.0822694439324803, "mean_env_wait_ms": 4.912262738302978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003461122512817383, "ViewRequirementAgentConnector_ms": 0.23494982719421387}}, "episode_reward_max": 16.252, "episode_reward_min": 9.976, "episode_reward_mean": 11.584159999999997, "episode_len_mean": 42.35, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.699, 12.865000000000002, 11.427, 11.33, 10.786, 10.663, 10.477, 11.285, 12.098, 10.569, 10.207, 11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792, 13.120999999999999, 12.205, 10.9, 10.492, 10.229, 10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976, 10.344, 10.173, 11.190999999999999, 10.604000000000001, 10.655, 11.318999999999999, 10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378, 10.735, 10.782, 12.283999999999999, 10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001, 11.551, 12.888, 13.443999999999999, 11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464, 10.556000000000001, 10.392000000000001, 11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897, 11.523, 10.91, 11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237, 16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001], "episode_lengths": [48, 54, 45, 36, 33, 42, 33, 44, 41, 30, 32, 38, 39, 52, 49, 40, 33, 49, 45, 36, 35, 39, 38, 35, 42, 39, 44, 33, 41, 31, 53, 41, 43, 34, 37, 66, 51, 45, 36, 37, 43, 41, 35, 42, 42, 48, 46, 45, 46, 39, 41, 36, 49, 39, 65, 60, 42, 38, 45, 39, 35, 44, 49, 39, 40, 31, 37, 35, 44, 43, 42, 42, 40, 41, 42, 54, 35, 51, 39, 40, 36, 42, 40, 37, 48, 63, 43, 33, 39, 82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5151692697064396, "mean_inference_ms": 1.1643441861443034, "mean_action_processing_ms": 0.0822694439324803, "mean_env_wait_ms": 4.912262738302978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003461122512817383, "ViewRequirementAgentConnector_ms": 0.23494982719421387}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21502, "num_agent_steps_trained": 0, "num_env_steps_sampled": 21504, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.0430971428874285, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 21504, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 21502, "timers": {"training_iteration_time_ms": 72394.259, "sample_time_ms": 3454.257, "synch_weights_time_ms": 43.614}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 0, "num_agent_steps_sampled": 21502, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 366, "training_iteration": 42, "trial_id": "default", "date": "2025-12-19_18-08-49", "timestamp": 1766138929, "time_this_iter_s": 72.69803667068481, "time_total_s": 3050.2146215438843, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3050.2146215438843, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 91.55185185185184, "ram_util_percent": 15.46388888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 513.0, "total_loss": 0.8850754997060623}, "default_policy": {"total_loss": 0.8850754997060623, "policy_loss": -0.029753397034918083, "vf_loss": 3.6599790858633723, "vf_loss_unclipped": 11.430959551422685, "vf_explained_var": 0.016812746171598083, "entropy": 0.6310104525383607, "mean_kl_loss": 0.018605352653049734, "gradients_default_optimizer_global_norm": 1.211801717310776, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 22016, "num_env_steps_trained": 0, "num_agent_steps_sampled": 22015, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.252, "episode_reward_min": 9.976, "episode_reward_mean": 11.771310000000003, "episode_len_mean": 43.38, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792, 13.120999999999999, 12.205, 10.9, 10.492, 10.229, 10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976, 10.344, 10.173, 11.190999999999999, 10.604000000000001, 10.655, 11.318999999999999, 10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378, 10.735, 10.782, 12.283999999999999, 10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001, 11.551, 12.888, 13.443999999999999, 11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464, 10.556000000000001, 10.392000000000001, 11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897, 11.523, 10.91, 11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237, 16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001, 15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968], "episode_lengths": [38, 39, 52, 49, 40, 33, 49, 45, 36, 35, 39, 38, 35, 42, 39, 44, 33, 41, 31, 53, 41, 43, 34, 37, 66, 51, 45, 36, 37, 43, 41, 35, 42, 42, 48, 46, 45, 46, 39, 41, 36, 49, 39, 65, 60, 42, 38, 45, 39, 35, 44, 49, 39, 40, 31, 37, 35, 44, 43, 42, 42, 40, 41, 42, 54, 35, 51, 39, 40, 36, 42, 40, 37, 48, 63, 43, 33, 39, 82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48, 73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5160475162484254, "mean_inference_ms": 1.163861798437768, "mean_action_processing_ms": 0.08222450245699699, "mean_env_wait_ms": 4.911336615102303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003448009490966797, "ViewRequirementAgentConnector_ms": 0.23473000526428223}}, "episode_reward_max": 16.252, "episode_reward_min": 9.976, "episode_reward_mean": 11.771310000000003, "episode_len_mean": 43.38, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.45, 11.774000000000001, 14.207, 13.933, 10.705, 10.792, 13.120999999999999, 12.205, 10.9, 10.492, 10.229, 10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976, 10.344, 10.173, 11.190999999999999, 10.604000000000001, 10.655, 11.318999999999999, 10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378, 10.735, 10.782, 12.283999999999999, 10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001, 11.551, 12.888, 13.443999999999999, 11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464, 10.556000000000001, 10.392000000000001, 11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897, 11.523, 10.91, 11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237, 16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001, 15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968], "episode_lengths": [38, 39, 52, 49, 40, 33, 49, 45, 36, 35, 39, 38, 35, 42, 39, 44, 33, 41, 31, 53, 41, 43, 34, 37, 66, 51, 45, 36, 37, 43, 41, 35, 42, 42, 48, 46, 45, 46, 39, 41, 36, 49, 39, 65, 60, 42, 38, 45, 39, 35, 44, 49, 39, 40, 31, 37, 35, 44, 43, 42, 42, 40, 41, 42, 54, 35, 51, 39, 40, 36, 42, 40, 37, 48, 63, 43, 33, 39, 82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48, 73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5160475162484254, "mean_inference_ms": 1.163861798437768, "mean_action_processing_ms": 0.08222450245699699, "mean_env_wait_ms": 4.911336615102303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003448009490966797, "ViewRequirementAgentConnector_ms": 0.23473000526428223}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22015, "num_agent_steps_trained": 0, "num_env_steps_sampled": 22016, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.974140388758076, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 22016, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 22015, "timers": {"training_iteration_time_ms": 73304.087, "sample_time_ms": 3458.284, "synch_weights_time_ms": 43.538}, "counters": {"num_env_steps_sampled": 22016, "num_env_steps_trained": 0, "num_agent_steps_sampled": 22015, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 377, "training_iteration": 43, "trial_id": "default", "date": "2025-12-19_18-10-02", "timestamp": 1766139002, "time_this_iter_s": 73.41680788993835, "time_total_s": 3123.6314294338226, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3123.6314294338226, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 94.7201923076923, "ram_util_percent": 15.483653846153848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 511.0, "total_loss": 0.7666834791307338}, "default_policy": {"total_loss": 0.7666834791307338, "policy_loss": -0.0312976370099932, "vf_loss": 3.1931405320763586, "vf_loss_unclipped": 10.392777448892593, "vf_explained_var": -0.04432692676782608, "entropy": 0.5606596104800701, "mean_kl_loss": 0.010265621258542978, "gradients_default_optimizer_global_norm": 1.485443177074194, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 0, "num_agent_steps_sampled": 22526, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.252, "episode_reward_min": 9.976, "episode_reward_mean": 11.809109999999999, "episode_len_mean": 43.62, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976, 10.344, 10.173, 11.190999999999999, 10.604000000000001, 10.655, 11.318999999999999, 10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378, 10.735, 10.782, 12.283999999999999, 10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001, 11.551, 12.888, 13.443999999999999, 11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464, 10.556000000000001, 10.392000000000001, 11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897, 11.523, 10.91, 11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237, 16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001, 15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968, 12.197, 9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741], "episode_lengths": [38, 35, 42, 39, 44, 33, 41, 31, 53, 41, 43, 34, 37, 66, 51, 45, 36, 37, 43, 41, 35, 42, 42, 48, 46, 45, 46, 39, 41, 36, 49, 39, 65, 60, 42, 38, 45, 39, 35, 44, 49, 39, 40, 31, 37, 35, 44, 43, 42, 42, 40, 41, 42, 54, 35, 51, 39, 40, 36, 42, 40, 37, 48, 63, 43, 33, 39, 82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48, 73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35, 43, 36, 50, 39, 44, 41, 42, 57, 44, 42, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5170795979950416, "mean_inference_ms": 1.164226406469028, "mean_action_processing_ms": 0.08225027535928417, "mean_env_wait_ms": 4.911854640451424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034465789794921875, "ViewRequirementAgentConnector_ms": 0.23514008522033691}}, "episode_reward_max": 16.252, "episode_reward_min": 9.976, "episode_reward_mean": 11.809109999999999, "episode_len_mean": 43.62, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.950999999999999, 10.613999999999999, 11.692, 10.702, 11.875, 9.976, 10.344, 10.173, 11.190999999999999, 10.604000000000001, 10.655, 11.318999999999999, 10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378, 10.735, 10.782, 12.283999999999999, 10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001, 11.551, 12.888, 13.443999999999999, 11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464, 10.556000000000001, 10.392000000000001, 11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897, 11.523, 10.91, 11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237, 16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001, 15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968, 12.197, 9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741], "episode_lengths": [38, 35, 42, 39, 44, 33, 41, 31, 53, 41, 43, 34, 37, 66, 51, 45, 36, 37, 43, 41, 35, 42, 42, 48, 46, 45, 46, 39, 41, 36, 49, 39, 65, 60, 42, 38, 45, 39, 35, 44, 49, 39, 40, 31, 37, 35, 44, 43, 42, 42, 40, 41, 42, 54, 35, 51, 39, 40, 36, 42, 40, 37, 48, 63, 43, 33, 39, 82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48, 73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35, 43, 36, 50, 39, 44, 41, 42, 57, 44, 42, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5170795979950416, "mean_inference_ms": 1.164226406469028, "mean_action_processing_ms": 0.08225027535928417, "mean_env_wait_ms": 4.911854640451424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034465789794921875, "ViewRequirementAgentConnector_ms": 0.23514008522033691}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22526, "num_agent_steps_trained": 0, "num_env_steps_sampled": 22528, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.064589581903483, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 22528, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 22526, "timers": {"training_iteration_time_ms": 73163.515, "sample_time_ms": 3456.487, "synch_weights_time_ms": 44.63}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 0, "num_agent_steps_sampled": 22526, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 388, "training_iteration": 44, "trial_id": "default", "date": "2025-12-19_18-11-15", "timestamp": 1766139075, "time_this_iter_s": 72.479816198349, "time_total_s": 3196.1112456321716, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3196.1112456321716, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 94.6757281553398, "ram_util_percent": 15.454368932038843}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7003121806774288}, "default_policy": {"total_loss": 0.7003121806774288, "policy_loss": -0.031347226607613264, "vf_loss": 2.9280848637223245, "vf_loss_unclipped": 9.185817110538483, "vf_explained_var": 0.12990971952676772, "entropy": 0.603662358224392, "mean_kl_loss": 0.009674194973229078, "gradients_default_optimizer_global_norm": 1.2151930928230286, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 23040, "num_env_steps_trained": 0, "num_agent_steps_sampled": 23038, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.252, "episode_reward_min": 9.981, "episode_reward_mean": 11.953410000000002, "episode_len_mean": 44.32, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378, 10.735, 10.782, 12.283999999999999, 10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001, 11.551, 12.888, 13.443999999999999, 11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464, 10.556000000000001, 10.392000000000001, 11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897, 11.523, 10.91, 11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237, 16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001, 15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968, 12.197, 9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741, 11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913], "episode_lengths": [37, 66, 51, 45, 36, 37, 43, 41, 35, 42, 42, 48, 46, 45, 46, 39, 41, 36, 49, 39, 65, 60, 42, 38, 45, 39, 35, 44, 49, 39, 40, 31, 37, 35, 44, 43, 42, 42, 40, 41, 42, 54, 35, 51, 39, 40, 36, 42, 40, 37, 48, 63, 43, 33, 39, 82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48, 73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35, 43, 36, 50, 39, 44, 41, 42, 57, 44, 42, 41, 44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5179965177262642, "mean_inference_ms": 1.1640827488377514, "mean_action_processing_ms": 0.08223365470484444, "mean_env_wait_ms": 4.911403523500791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034630298614501953, "ViewRequirementAgentConnector_ms": 0.23505425453186035}}, "episode_reward_max": 16.252, "episode_reward_min": 9.981, "episode_reward_mean": 11.953410000000002, "episode_len_mean": 44.32, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.414, 14.274000000000001, 11.809000000000001, 12.622, 9.981, 10.285000000000002, 11.378, 10.735, 10.782, 12.283999999999999, 10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001, 11.551, 12.888, 13.443999999999999, 11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464, 10.556000000000001, 10.392000000000001, 11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897, 11.523, 10.91, 11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237, 16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001, 15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968, 12.197, 9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741, 11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913], "episode_lengths": [37, 66, 51, 45, 36, 37, 43, 41, 35, 42, 42, 48, 46, 45, 46, 39, 41, 36, 49, 39, 65, 60, 42, 38, 45, 39, 35, 44, 49, 39, 40, 31, 37, 35, 44, 43, 42, 42, 40, 41, 42, 54, 35, 51, 39, 40, 36, 42, 40, 37, 48, 63, 43, 33, 39, 82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48, 73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35, 43, 36, 50, 39, 44, 41, 42, 57, 44, 42, 41, 44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5179965177262642, "mean_inference_ms": 1.1640827488377514, "mean_action_processing_ms": 0.08223365470484444, "mean_env_wait_ms": 4.911403523500791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034630298614501953, "ViewRequirementAgentConnector_ms": 0.23505425453186035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23038, "num_agent_steps_trained": 0, "num_env_steps_sampled": 23040, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.03520529696188, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 23040, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 23038, "timers": {"training_iteration_time_ms": 73123.938, "sample_time_ms": 3456.058, "synch_weights_time_ms": 46.624}, "counters": {"num_env_steps_sampled": 23040, "num_env_steps_trained": 0, "num_agent_steps_sampled": 23038, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 400, "training_iteration": 45, "trial_id": "default", "date": "2025-12-19_18-12-28", "timestamp": 1766139148, "time_this_iter_s": 72.77944612503052, "time_total_s": 3268.890691757202, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3268.890691757202, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 94.7317307692308, "ram_util_percent": 15.490384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.6990127069875598}, "default_policy": {"total_loss": 0.6990127069875598, "policy_loss": -0.03178326147608459, "vf_loss": 2.9246726825833322, "vf_loss_unclipped": 10.27105571627617, "vf_explained_var": -0.18002187013626098, "entropy": 0.5716578666120767, "mean_kl_loss": 0.007978177143286302, "gradients_default_optimizer_global_norm": 1.4387554064393044, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 0, "num_agent_steps_sampled": 23550, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.252, "episode_reward_min": 9.991, "episode_reward_mean": 12.098950000000002, "episode_len_mean": 44.69, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001, 11.551, 12.888, 13.443999999999999, 11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464, 10.556000000000001, 10.392000000000001, 11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897, 11.523, 10.91, 11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237, 16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001, 15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968, 12.197, 9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741, 11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602], "episode_lengths": [42, 48, 46, 45, 46, 39, 41, 36, 49, 39, 65, 60, 42, 38, 45, 39, 35, 44, 49, 39, 40, 31, 37, 35, 44, 43, 42, 42, 40, 41, 42, 54, 35, 51, 39, 40, 36, 42, 40, 37, 48, 63, 43, 33, 39, 82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48, 73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35, 43, 36, 50, 39, 44, 41, 42, 57, 44, 42, 41, 44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5188692183475735, "mean_inference_ms": 1.1645385491331168, "mean_action_processing_ms": 0.082267116013573, "mean_env_wait_ms": 4.911954762982074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003484487533569336, "ViewRequirementAgentConnector_ms": 0.23548102378845215}}, "episode_reward_max": 16.252, "episode_reward_min": 9.991, "episode_reward_mean": 12.098950000000002, "episode_len_mean": 44.69, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.547, 11.739, 12.717000000000002, 11.683, 11.597999999999999, 11.123000000000001, 10.844, 11.533999999999999, 13.257000000000001, 11.551, 12.888, 13.443999999999999, 11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464, 10.556000000000001, 10.392000000000001, 11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897, 11.523, 10.91, 11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237, 16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001, 15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968, 12.197, 9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741, 11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602], "episode_lengths": [42, 48, 46, 45, 46, 39, 41, 36, 49, 39, 65, 60, 42, 38, 45, 39, 35, 44, 49, 39, 40, 31, 37, 35, 44, 43, 42, 42, 40, 41, 42, 54, 35, 51, 39, 40, 36, 42, 40, 37, 48, 63, 43, 33, 39, 82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48, 73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35, 43, 36, 50, 39, 44, 41, 42, 57, 44, 42, 41, 44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5188692183475735, "mean_inference_ms": 1.1645385491331168, "mean_action_processing_ms": 0.082267116013573, "mean_env_wait_ms": 4.911954762982074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003484487533569336, "ViewRequirementAgentConnector_ms": 0.23548102378845215}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23550, "num_agent_steps_trained": 0, "num_env_steps_sampled": 23552, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.9802328863303345, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 23552, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 23550, "timers": {"training_iteration_time_ms": 73124.348, "sample_time_ms": 3457.767, "synch_weights_time_ms": 48.325}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 0, "num_agent_steps_sampled": 23550, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 410, "training_iteration": 46, "trial_id": "default", "date": "2025-12-19_18-13-41", "timestamp": 1766139221, "time_this_iter_s": 73.3528425693512, "time_total_s": 3342.2435343265533, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3342.2435343265533, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 94.61442307692309, "ram_util_percent": 15.486538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.6931178580969573}, "default_policy": {"total_loss": 0.6931178580969573, "policy_loss": -0.033251641481183467, "vf_loss": 2.9068117499351502, "vf_loss_unclipped": 11.318387186527252, "vf_explained_var": -0.12197849825024605, "entropy": 0.594681816548109, "mean_kl_loss": 0.01045003575114265, "gradients_default_optimizer_global_norm": 1.0203934460878372, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 24064, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24062, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.252, "episode_reward_min": 9.991, "episode_reward_mean": 12.15738, "episode_len_mean": 44.52, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464, 10.556000000000001, 10.392000000000001, 11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897, 11.523, 10.91, 11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237, 16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001, 15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968, 12.197, 9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741, 11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602, 12.277, 14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642], "episode_lengths": [42, 38, 45, 39, 35, 44, 49, 39, 40, 31, 37, 35, 44, 43, 42, 42, 40, 41, 42, 54, 35, 51, 39, 40, 36, 42, 40, 37, 48, 63, 43, 33, 39, 82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48, 73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35, 43, 36, 50, 39, 44, 41, 42, 57, 44, 42, 41, 44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52, 44, 55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5197735838667877, "mean_inference_ms": 1.1646919040003774, "mean_action_processing_ms": 0.08227661324057403, "mean_env_wait_ms": 4.911924973403197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034978389739990234, "ViewRequirementAgentConnector_ms": 0.23546409606933594}}, "episode_reward_max": 16.252, "episode_reward_min": 9.991, "episode_reward_mean": 12.15738, "episode_len_mean": 44.52, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.568, 10.808, 11.986, 12.154, 10.398, 10.868, 12.724, 10.639, 11.464, 10.556000000000001, 10.392000000000001, 11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897, 11.523, 10.91, 11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237, 16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001, 15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968, 12.197, 9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741, 11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602, 12.277, 14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642], "episode_lengths": [42, 38, 45, 39, 35, 44, 49, 39, 40, 31, 37, 35, 44, 43, 42, 42, 40, 41, 42, 54, 35, 51, 39, 40, 36, 42, 40, 37, 48, 63, 43, 33, 39, 82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48, 73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35, 43, 36, 50, 39, 44, 41, 42, 57, 44, 42, 41, 44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52, 44, 55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5197735838667877, "mean_inference_ms": 1.1646919040003774, "mean_action_processing_ms": 0.08227661324057403, "mean_env_wait_ms": 4.911924973403197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034978389739990234, "ViewRequirementAgentConnector_ms": 0.23546409606933594}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24062, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24064, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.046355178668513, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24064, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 24062, "timers": {"training_iteration_time_ms": 72999.922, "sample_time_ms": 3456.653, "synch_weights_time_ms": 46.611}, "counters": {"num_env_steps_sampled": 24064, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24062, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 422, "training_iteration": 47, "trial_id": "default", "date": "2025-12-19_18-14-57", "timestamp": 1766139297, "time_this_iter_s": 72.66428422927856, "time_total_s": 3414.907818555832, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3414.907818555832, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 91.54953271028039, "ram_util_percent": 15.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7376599334180355}, "default_policy": {"total_loss": 0.7376599334180355, "policy_loss": -0.02883921153843403, "vf_loss": 3.067466729879379, "vf_loss_unclipped": 11.151006871461869, "vf_explained_var": -0.15447628498077393, "entropy": 0.5777705941349268, "mean_kl_loss": 0.00840875278047406, "gradients_default_optimizer_global_norm": 1.2018437255173922, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24574, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.454, "episode_reward_min": 9.991, "episode_reward_mean": 12.316679999999996, "episode_len_mean": 45.15, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897, 11.523, 10.91, 11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237, 16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001, 15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968, 12.197, 9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741, 11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602, 12.277, 14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999], "episode_lengths": [35, 44, 43, 42, 42, 40, 41, 42, 54, 35, 51, 39, 40, 36, 42, 40, 37, 48, 63, 43, 33, 39, 82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48, 73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35, 43, 36, 50, 39, 44, 41, 42, 57, 44, 42, 41, 44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52, 44, 55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5207075607087733, "mean_inference_ms": 1.165524371646754, "mean_action_processing_ms": 0.08234164163815079, "mean_env_wait_ms": 4.913017446188899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003516674041748047, "ViewRequirementAgentConnector_ms": 0.23660874366760254}}, "episode_reward_max": 16.454, "episode_reward_min": 9.991, "episode_reward_mean": 12.316679999999996, "episode_len_mean": 45.15, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.194, 11.664000000000001, 10.853000000000002, 12.784, 11.676, 11.530000000000001, 10.847000000000001, 11.246, 14.196, 10.897, 11.523, 10.91, 11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237, 16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001, 15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968, 12.197, 9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741, 11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602, 12.277, 14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999], "episode_lengths": [35, 44, 43, 42, 42, 40, 41, 42, 54, 35, 51, 39, 40, 36, 42, 40, 37, 48, 63, 43, 33, 39, 82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48, 73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35, 43, 36, 50, 39, 44, 41, 42, 57, 44, 42, 41, 44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52, 44, 55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5207075607087733, "mean_inference_ms": 1.165524371646754, "mean_action_processing_ms": 0.08234164163815079, "mean_env_wait_ms": 4.913017446188899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003516674041748047, "ViewRequirementAgentConnector_ms": 0.23660874366760254}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24574, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24576, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.6562555362993985, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24576, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 24574, "timers": {"training_iteration_time_ms": 73366.217, "sample_time_ms": 3464.696, "synch_weights_time_ms": 47.274}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24574, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 433, "training_iteration": 48, "trial_id": "default", "date": "2025-12-19_18-16-14", "timestamp": 1766139374, "time_this_iter_s": 76.9229564666748, "time_total_s": 3491.8307750225067, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3491.8307750225067, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 94.75454545454545, "ram_util_percent": 16.003636363636367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7672181803871354}, "default_policy": {"total_loss": 0.7672181803871354, "policy_loss": -0.03105193255469203, "vf_loss": 3.1947220116853714, "vf_loss_unclipped": 10.766005003452301, "vf_explained_var": -0.020673183351755144, "entropy": 0.5694626044481993, "mean_kl_loss": 0.006362582083809798, "gradients_default_optimizer_global_norm": 1.6528297685086728, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 0, "num_agent_steps_sampled": 25086, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.454, "episode_reward_min": 9.991, "episode_reward_mean": 12.37368, "episode_len_mean": 45.33, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237, 16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001, 15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968, 12.197, 9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741, 11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602, 12.277, 14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26], "episode_lengths": [40, 36, 42, 40, 37, 48, 63, 43, 33, 39, 82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48, 73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35, 43, 36, 50, 39, 44, 41, 42, 57, 44, 42, 41, 44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52, 44, 55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5215146230295753, "mean_inference_ms": 1.1658771152279177, "mean_action_processing_ms": 0.08236558426911966, "mean_env_wait_ms": 4.913230274322327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035233497619628906, "ViewRequirementAgentConnector_ms": 0.23683428764343262}}, "episode_reward_max": 16.454, "episode_reward_min": 9.991, "episode_reward_mean": 12.37368, "episode_len_mean": 45.33, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.627, 10.114, 11.456999999999999, 12.161999999999999, 10.828, 12.811, 13.377, 12.089, 10.367, 11.237, 16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001, 15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968, 12.197, 9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741, 11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602, 12.277, 14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26], "episode_lengths": [40, 36, 42, 40, 37, 48, 63, 43, 33, 39, 82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48, 73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35, 43, 36, 50, 39, 44, 41, 42, 57, 44, 42, 41, 44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52, 44, 55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5215146230295753, "mean_inference_ms": 1.1658771152279177, "mean_action_processing_ms": 0.08236558426911966, "mean_env_wait_ms": 4.913230274322327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035233497619628906, "ViewRequirementAgentConnector_ms": 0.23683428764343262}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25086, "num_agent_steps_trained": 0, "num_env_steps_sampled": 25088, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.640407562778953, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 25088, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 25086, "timers": {"training_iteration_time_ms": 73756.42, "sample_time_ms": 3464.528, "synch_weights_time_ms": 47.402}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 0, "num_agent_steps_sampled": 25086, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 445, "training_iteration": 49, "trial_id": "default", "date": "2025-12-19_18-17-31", "timestamp": 1766139451, "time_this_iter_s": 77.10630941390991, "time_total_s": 3568.9370844364166, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3568.9370844364166, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 94.60642201834862, "ram_util_percent": 16.47614678899082}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7171604290604592}, "default_policy": {"total_loss": 0.7171604290604592, "policy_loss": -0.028949852380901576, "vf_loss": 2.9858094096183776, "vf_loss_unclipped": 10.125981491804122, "vf_explained_var": -0.1510460376739502, "entropy": 0.5698408659547567, "mean_kl_loss": 0.009110384265559901, "gradients_default_optimizer_global_norm": 1.1455677896738052, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 0, "num_agent_steps_sampled": 25598, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.454, "episode_reward_min": 9.991, "episode_reward_mean": 12.545110000000001, "episode_len_mean": 46.14, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001, 15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968, 12.197, 9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741, 11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602, 12.277, 14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642], "episode_lengths": [82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48, 73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35, 43, 36, 50, 39, 44, 41, 42, 57, 44, 42, 41, 44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52, 44, 55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5222197977945606, "mean_inference_ms": 1.166475444562135, "mean_action_processing_ms": 0.08241359869264389, "mean_env_wait_ms": 4.913890997825002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035376548767089844, "ViewRequirementAgentConnector_ms": 0.23724913597106934}}, "episode_reward_max": 16.454, "episode_reward_min": 9.991, "episode_reward_mean": 12.545110000000001, "episode_len_mean": 46.14, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.252, 12.178, 12.103, 14.498000000000001, 10.55, 12.776, 10.587, 11.967, 12.791, 11.147, 13.822000000000001, 15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968, 12.197, 9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741, 11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602, 12.277, 14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642], "episode_lengths": [82, 47, 46, 59, 28, 43, 34, 42, 43, 39, 48, 73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35, 43, 36, 50, 39, 44, 41, 42, 57, 44, 42, 41, 44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52, 44, 55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5222197977945606, "mean_inference_ms": 1.166475444562135, "mean_action_processing_ms": 0.08241359869264389, "mean_env_wait_ms": 4.913890997825002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035376548767089844, "ViewRequirementAgentConnector_ms": 0.23724913597106934}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25598, "num_agent_steps_trained": 0, "num_env_steps_sampled": 25600, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.473731444652192, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 25600, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 25598, "timers": {"training_iteration_time_ms": 74303.563, "sample_time_ms": 3464.589, "synch_weights_time_ms": 47.814}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 0, "num_agent_steps_sampled": 25598, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 455, "training_iteration": 50, "trial_id": "default", "date": "2025-12-19_18-18-50", "timestamp": 1766139530, "time_this_iter_s": 79.09193658828735, "time_total_s": 3648.029021024704, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3648.029021024704, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 94.77168141592921, "ram_util_percent": 16.884070796460176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7360534358769655}, "default_policy": {"total_loss": 0.7360534358769655, "policy_loss": -0.032565429667010905, "vf_loss": 3.075946831703186, "vf_loss_unclipped": 10.669287985563278, "vf_explained_var": -0.06865179985761642, "entropy": 0.5593657266348601, "mean_kl_loss": 0.0076605808008110895, "gradients_default_optimizer_global_norm": 1.5496155701577663, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 26112, "num_env_steps_trained": 0, "num_agent_steps_sampled": 26110, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.454, "episode_reward_min": 9.991, "episode_reward_mean": 12.523060000000001, "episode_len_mean": 46.08, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968, 12.197, 9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741, 11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602, 12.277, 14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01], "episode_lengths": [73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35, 43, 36, 50, 39, 44, 41, 42, 57, 44, 42, 41, 44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52, 44, 55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5229636936907327, "mean_inference_ms": 1.1670911000656097, "mean_action_processing_ms": 0.08246423812382674, "mean_env_wait_ms": 4.914605854863293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035398006439208984, "ViewRequirementAgentConnector_ms": 0.23742175102233887}}, "episode_reward_max": 16.454, "episode_reward_min": 9.991, "episode_reward_mean": 12.523060000000001, "episode_len_mean": 46.08, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.134, 13.345, 12.621, 15.341, 13.244, 11.353000000000002, 11.805, 14.643999999999998, 11.39, 12.276, 10.968, 12.197, 9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741, 11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602, 12.277, 14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01], "episode_lengths": [73, 51, 47, 57, 48, 42, 34, 67, 42, 45, 35, 43, 36, 50, 39, 44, 41, 42, 57, 44, 42, 41, 44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52, 44, 55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5229636936907327, "mean_inference_ms": 1.1670911000656097, "mean_action_processing_ms": 0.08246423812382674, "mean_env_wait_ms": 4.914605854863293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035398006439208984, "ViewRequirementAgentConnector_ms": 0.23742175102233887}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26110, "num_agent_steps_trained": 0, "num_env_steps_sampled": 26112, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.545389658806645, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 26112, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 26110, "timers": {"training_iteration_time_ms": 74870.729, "sample_time_ms": 3463.764, "synch_weights_time_ms": 48.537}, "counters": {"num_env_steps_sampled": 26112, "num_env_steps_trained": 0, "num_agent_steps_sampled": 26110, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 466, "training_iteration": 51, "trial_id": "default", "date": "2025-12-19_18-20-08", "timestamp": 1766139608, "time_this_iter_s": 78.22556591033936, "time_total_s": 3726.2545869350433, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3726.2545869350433, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 94.83603603603603, "ram_util_percent": 17.062162162162156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.6776239160448313}, "default_policy": {"total_loss": 0.6776239160448313, "policy_loss": -0.03356280424632132, "vf_loss": 2.8461166620254517, "vf_loss_unclipped": 10.137782809138297, "vf_explained_var": 0.05463440865278244, "entropy": 0.6017243910580874, "mean_kl_loss": 0.01037115313219501, "gradients_default_optimizer_global_norm": 1.1299547031521797, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 0, "num_agent_steps_sampled": 26622, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.454, "episode_reward_min": 9.991, "episode_reward_mean": 12.48537, "episode_len_mean": 45.58, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741, 11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602, 12.277, 14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001], "episode_lengths": [36, 50, 39, 44, 41, 42, 57, 44, 42, 41, 44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52, 44, 55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5236733605767424, "mean_inference_ms": 1.1674310970314716, "mean_action_processing_ms": 0.08249172606376182, "mean_env_wait_ms": 4.914807673045106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035407543182373047, "ViewRequirementAgentConnector_ms": 0.23705101013183594}}, "episode_reward_max": 16.454, "episode_reward_min": 9.991, "episode_reward_mean": 12.48537, "episode_len_mean": 45.58, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.991, 13.766, 10.918000000000001, 12.081000000000001, 12.056000000000001, 12.776, 13.177, 13.004000000000001, 11.881, 11.741, 11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602, 12.277, 14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001], "episode_lengths": [36, 50, 39, 44, 41, 42, 57, 44, 42, 41, 44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52, 44, 55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5236733605767424, "mean_inference_ms": 1.1674310970314716, "mean_action_processing_ms": 0.08249172606376182, "mean_env_wait_ms": 4.914807673045106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035407543182373047, "ViewRequirementAgentConnector_ms": 0.23705101013183594}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26622, "num_agent_steps_trained": 0, "num_env_steps_sampled": 26624, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.772989464320989, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 26624, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 26622, "timers": {"training_iteration_time_ms": 75160.64, "sample_time_ms": 3464.705, "synch_weights_time_ms": 49.616}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 0, "num_agent_steps_sampled": 26622, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 478, "training_iteration": 52, "trial_id": "default", "date": "2025-12-19_18-21-26", "timestamp": 1766139686, "time_this_iter_s": 75.59687542915344, "time_total_s": 3801.851462364197, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3801.851462364197, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 91.83392857142859, "ram_util_percent": 16.655357142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7511314705014229}, "default_policy": {"total_loss": 0.7511314705014229, "policy_loss": -0.032872065994888545, "vf_loss": 3.1378660783171655, "vf_loss_unclipped": 10.252789038419724, "vf_explained_var": -0.19233668968081474, "entropy": 0.6404429182410241, "mean_kl_loss": 0.007098490013041215, "gradients_default_optimizer_global_norm": 1.8580302231013774, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 27136, "num_env_steps_trained": 0, "num_agent_steps_sampled": 27134, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.802000000000007, "episode_reward_min": 10.002, "episode_reward_mean": 12.610290000000003, "episode_len_mean": 46.23, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602, 12.277, 14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015], "episode_lengths": [44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52, 44, 55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5242319863559791, "mean_inference_ms": 1.167729346270958, "mean_action_processing_ms": 0.08251575166060322, "mean_env_wait_ms": 4.914991323182836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035517215728759766, "ViewRequirementAgentConnector_ms": 0.23676824569702148}}, "episode_reward_max": 17.802000000000007, "episode_reward_min": 10.002, "episode_reward_mean": 12.610290000000003, "episode_len_mean": 46.23, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.033000000000001, 13.404, 11.976, 11.455, 10.672, 12.616, 10.725999999999999, 10.14, 12.39, 14.494, 12.706999999999999, 12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602, 12.277, 14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015], "episode_lengths": [44, 51, 42, 40, 41, 49, 38, 30, 55, 57, 49, 48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52, 44, 55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5242319863559791, "mean_inference_ms": 1.167729346270958, "mean_action_processing_ms": 0.08251575166060322, "mean_env_wait_ms": 4.914991323182836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035517215728759766, "ViewRequirementAgentConnector_ms": 0.23676824569702148}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27134, "num_agent_steps_trained": 0, "num_env_steps_sampled": 27136, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.542173497428684, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 27136, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 27134, "timers": {"training_iteration_time_ms": 75645.379, "sample_time_ms": 3464.12, "synch_weights_time_ms": 50.825}, "counters": {"num_env_steps_sampled": 27136, "num_env_steps_trained": 0, "num_agent_steps_sampled": 27134, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 488, "training_iteration": 53, "trial_id": "default", "date": "2025-12-19_18-22-45", "timestamp": 1766139765, "time_this_iter_s": 78.26449465751648, "time_total_s": 3880.1159570217133, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3880.1159570217133, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 94.91621621621623, "ram_util_percent": 16.398198198198198}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7167714389972388}, "default_policy": {"total_loss": 0.7167714389972388, "policy_loss": -0.03221448775148019, "vf_loss": 2.9972470700740814, "vf_loss_unclipped": 9.828282508254052, "vf_explained_var": 0.012413211166858673, "entropy": 0.5391074560582638, "mean_kl_loss": 0.008530995955712228, "gradients_default_optimizer_global_norm": 1.3654156908392907, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 0, "num_agent_steps_sampled": 27646, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.802000000000007, "episode_reward_min": 10.002, "episode_reward_mean": 12.68693, "episode_len_mean": 46.37, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602, 12.277, 14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573], "episode_lengths": [48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52, 44, 55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5247366877078773, "mean_inference_ms": 1.1678658287508952, "mean_action_processing_ms": 0.08252086713581729, "mean_env_wait_ms": 4.914806921117709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003544330596923828, "ViewRequirementAgentConnector_ms": 0.2375633716583252}}, "episode_reward_max": 17.802000000000007, "episode_reward_min": 10.002, "episode_reward_mean": 12.68693, "episode_len_mean": 46.37, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.913, 12.458, 12.742999999999999, 12.296999999999999, 13.138, 10.108, 15.764, 13.094, 11.84, 13.074, 14.602, 12.277, 14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573], "episode_lengths": [48, 40, 56, 47, 52, 36, 60, 46, 38, 43, 52, 44, 55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5247366877078773, "mean_inference_ms": 1.1678658287508952, "mean_action_processing_ms": 0.08252086713581729, "mean_env_wait_ms": 4.914806921117709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003544330596923828, "ViewRequirementAgentConnector_ms": 0.2375633716583252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27646, "num_agent_steps_trained": 0, "num_env_steps_sampled": 27648, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.672822431331823, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 27648, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 27646, "timers": {"training_iteration_time_ms": 76070.882, "sample_time_ms": 3469.125, "synch_weights_time_ms": 50.591}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 0, "num_agent_steps_sampled": 27646, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 499, "training_iteration": 54, "trial_id": "default", "date": "2025-12-19_18-24-02", "timestamp": 1766139842, "time_this_iter_s": 76.73602294921875, "time_total_s": 3956.851979970932, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3956.851979970932, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 94.77339449541283, "ram_util_percent": 16.922935779816513}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 513.0, "total_loss": 0.7943330885451517}, "default_policy": {"total_loss": 0.7943330885451517, "policy_loss": -0.033347205730316076, "vf_loss": 3.311967796749539, "vf_loss_unclipped": 11.324487798007919, "vf_explained_var": -0.09299789608260732, "entropy": 0.5282631085978614, "mean_kl_loss": 0.008664396813127175, "gradients_default_optimizer_global_norm": 1.3950297920792192, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 28160, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28159, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.802000000000007, "episode_reward_min": 10.002, "episode_reward_mean": 12.657670000000001, "episode_len_mean": 45.98, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378], "episode_lengths": [55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5253685532226812, "mean_inference_ms": 1.1682231276788944, "mean_action_processing_ms": 0.08254637311606437, "mean_env_wait_ms": 4.915067381086576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035185813903808594, "ViewRequirementAgentConnector_ms": 0.23692584037780762}}, "episode_reward_max": 17.802000000000007, "episode_reward_min": 10.002, "episode_reward_mean": 12.657670000000001, "episode_len_mean": 45.98, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.891, 11.751999999999999, 12.273, 11.777000000000001, 12.064, 12.309, 12.41, 10.248000000000001, 10.918, 12.207, 15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378], "episode_lengths": [55, 39, 41, 43, 42, 45, 45, 43, 36, 46, 60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5253685532226812, "mean_inference_ms": 1.1682231276788944, "mean_action_processing_ms": 0.08254637311606437, "mean_env_wait_ms": 4.915067381086576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035185813903808594, "ViewRequirementAgentConnector_ms": 0.23692584037780762}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28159, "num_agent_steps_trained": 0, "num_env_steps_sampled": 28160, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.410391964796815, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 28160, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 28159, "timers": {"training_iteration_time_ms": 76780.229, "sample_time_ms": 3471.058, "synch_weights_time_ms": 50.305}, "counters": {"num_env_steps_sampled": 28160, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28159, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 511, "training_iteration": 55, "trial_id": "default", "date": "2025-12-19_18-25-21", "timestamp": 1766139921, "time_this_iter_s": 79.87297797203064, "time_total_s": 4036.7249579429626, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4036.7249579429626, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 95.0017543859649, "ram_util_percent": 17.326315789473686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 511.0, "total_loss": 0.6558548498898744}, "default_policy": {"total_loss": 0.6558548498898744, "policy_loss": -0.026668399409390985, "vf_loss": 2.731493467837572, "vf_loss_unclipped": 9.96964338645339, "vf_explained_var": 0.0013438314199447632, "entropy": 0.5651652064174414, "mean_kl_loss": 0.00860183280512956, "gradients_default_optimizer_global_norm": 1.488449377939105, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28670, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.802000000000007, "episode_reward_min": 10.002, "episode_reward_mean": 12.768470000000002, "episode_len_mean": 46.56, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955], "episode_lengths": [60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5258276459593247, "mean_inference_ms": 1.168543932765457, "mean_action_processing_ms": 0.08256799370590226, "mean_env_wait_ms": 4.915356844631058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035152435302734375, "ViewRequirementAgentConnector_ms": 0.23704957962036133}}, "episode_reward_max": 17.802000000000007, "episode_reward_min": 10.002, "episode_reward_mean": 12.768470000000002, "episode_len_mean": 46.56, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.642, 13.213000000000001, 11.741, 11.754999999999999, 12.105, 14.104, 11.857, 10.637, 13.212, 11.513, 16.454, 12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955], "episode_lengths": [60, 45, 39, 41, 48, 53, 41, 39, 52, 37, 64, 43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5258276459593247, "mean_inference_ms": 1.168543932765457, "mean_action_processing_ms": 0.08256799370590226, "mean_env_wait_ms": 4.915356844631058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035152435302734375, "ViewRequirementAgentConnector_ms": 0.23704957962036133}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28670, "num_agent_steps_trained": 0, "num_env_steps_sampled": 28672, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.424801090233771, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 28672, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 28670, "timers": {"training_iteration_time_ms": 77414.35, "sample_time_ms": 3465.012, "synch_weights_time_ms": 50.405}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28670, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 521, "training_iteration": 56, "trial_id": "default", "date": "2025-12-19_18-26-41", "timestamp": 1766140001, "time_this_iter_s": 79.69340467453003, "time_total_s": 4116.418362617493, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4116.418362617493, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 94.92035398230088, "ram_util_percent": 17.050442477876103}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.6711840059608221}, "default_policy": {"total_loss": 0.6711840059608221, "policy_loss": -0.0371752399019897, "vf_loss": 2.8348427206277846, "vf_loss_unclipped": 10.332707250118256, "vf_explained_var": -0.08728272020816803, "entropy": 0.5887719832360745, "mean_kl_loss": 0.009493594831769769, "gradients_default_optimizer_global_norm": 1.3115794606506825, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 29184, "num_env_steps_trained": 0, "num_agent_steps_sampled": 29182, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.802000000000007, "episode_reward_min": 9.993, "episode_reward_mean": 12.79979, "episode_len_mean": 46.77, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22], "episode_lengths": [43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5262621837711354, "mean_inference_ms": 1.1687118608117057, "mean_action_processing_ms": 0.08258029667875862, "mean_env_wait_ms": 4.915404499691511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003489971160888672, "ViewRequirementAgentConnector_ms": 0.23561525344848633}}, "episode_reward_max": 17.802000000000007, "episode_reward_min": 9.993, "episode_reward_mean": 12.79979, "episode_len_mean": 46.77, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.895999999999999, 14.243000000000002, 10.995000000000001, 10.911000000000001, 12.381, 14.191, 12.173, 12.379, 10.854, 11.892, 11.299999999999999, 11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22], "episode_lengths": [43, 55, 35, 40, 42, 54, 41, 42, 45, 50, 45, 39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5262621837711354, "mean_inference_ms": 1.1687118608117057, "mean_action_processing_ms": 0.08258029667875862, "mean_env_wait_ms": 4.915404499691511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003489971160888672, "ViewRequirementAgentConnector_ms": 0.23561525344848633}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29182, "num_agent_steps_trained": 0, "num_env_steps_sampled": 29184, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.4244930981003, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 29184, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 29182, "timers": {"training_iteration_time_ms": 78117.681, "sample_time_ms": 3465.773, "synch_weights_time_ms": 52.278}, "counters": {"num_env_steps_sampled": 29184, "num_env_steps_trained": 0, "num_agent_steps_sampled": 29182, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 532, "training_iteration": 57, "trial_id": "default", "date": "2025-12-19_18-28-04", "timestamp": 1766140084, "time_this_iter_s": 79.69753766059875, "time_total_s": 4196.115900278091, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4196.115900278091, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 91.86186440677965, "ram_util_percent": 17.02372881355932}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7409601908177137}, "default_policy": {"total_loss": 0.7409601908177137, "policy_loss": -0.03482224578037858, "vf_loss": 3.1045503400266172, "vf_loss_unclipped": 10.268687760084868, "vf_explained_var": 0.000807027518749237, "entropy": 0.5863703683018684, "mean_kl_loss": 0.009249055994183663, "gradients_default_optimizer_global_norm": 1.5576368853449822, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 0, "num_agent_steps_sampled": 29694, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.881, "episode_reward_min": 9.993, "episode_reward_mean": 12.92997, "episode_len_mean": 46.98, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739], "episode_lengths": [39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266633695330518, "mean_inference_ms": 1.168831206140057, "mean_action_processing_ms": 0.08259143775888925, "mean_env_wait_ms": 4.915471145939314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003492593765258789, "ViewRequirementAgentConnector_ms": 0.23594164848327637}}, "episode_reward_max": 17.881, "episode_reward_min": 9.993, "episode_reward_mean": 12.92997, "episode_len_mean": 46.98, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.441, 12.26, 14.72, 13.309999999999999, 11.344, 13.215, 13.518, 14.237, 15.325, 11.683, 13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739], "episode_lengths": [39, 38, 66, 42, 40, 50, 50, 54, 68, 44, 48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266633695330518, "mean_inference_ms": 1.168831206140057, "mean_action_processing_ms": 0.08259143775888925, "mean_env_wait_ms": 4.915471145939314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003492593765258789, "ViewRequirementAgentConnector_ms": 0.23594164848327637}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29694, "num_agent_steps_trained": 0, "num_env_steps_sampled": 29696, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 5.847985063378099, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 29696, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 29694, "timers": {"training_iteration_time_ms": 79180.819, "sample_time_ms": 3457.853, "synch_weights_time_ms": 52.428}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 0, "num_agent_steps_sampled": 29694, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 543, "training_iteration": 58, "trial_id": "default", "date": "2025-12-19_18-29-31", "timestamp": 1766140171, "time_this_iter_s": 87.55423140525818, "time_total_s": 4283.67013168335, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4283.67013168335, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 94.70403225806453, "ram_util_percent": 21.19596774193549}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.6066966526210308}, "default_policy": {"total_loss": 0.6066966526210308, "policy_loss": -0.04026941144838929, "vf_loss": 2.589154678583145, "vf_loss_unclipped": 9.531015330553055, "vf_explained_var": -0.0818635955452919, "entropy": 0.5420350588858127, "mean_kl_loss": 0.008776883182471185, "gradients_default_optimizer_global_norm": 0.8518069379031659, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 30208, "num_env_steps_trained": 0, "num_agent_steps_sampled": 30206, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.881, "episode_reward_min": 9.993, "episode_reward_mean": 12.932720000000003, "episode_len_mean": 46.79, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919], "episode_lengths": [48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5270064542937218, "mean_inference_ms": 1.1689291206863754, "mean_action_processing_ms": 0.08259976202690948, "mean_env_wait_ms": 4.91554115265881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034906864166259766, "ViewRequirementAgentConnector_ms": 0.23639941215515137}}, "episode_reward_max": 17.881, "episode_reward_min": 9.993, "episode_reward_mean": 12.932720000000003, "episode_len_mean": 46.79, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.218, 12.642, 12.045, 12.167, 12.597000000000001, 11.712, 13.322, 12.771, 13.518, 10.931999999999999, 10.776, 12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919], "episode_lengths": [48, 40, 40, 41, 47, 39, 50, 45, 54, 37, 46, 48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5270064542937218, "mean_inference_ms": 1.1689291206863754, "mean_action_processing_ms": 0.08259976202690948, "mean_env_wait_ms": 4.91554115265881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034906864166259766, "ViewRequirementAgentConnector_ms": 0.23639941215515137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30206, "num_agent_steps_trained": 0, "num_env_steps_sampled": 30208, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 5.6786719315359395, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 30208, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 30206, "timers": {"training_iteration_time_ms": 80486.642, "sample_time_ms": 3455.54, "synch_weights_time_ms": 54.355}, "counters": {"num_env_steps_sampled": 30208, "num_env_steps_trained": 0, "num_agent_steps_sampled": 30206, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 553, "training_iteration": 59, "trial_id": "default", "date": "2025-12-19_18-31-02", "timestamp": 1766140262, "time_this_iter_s": 90.16453981399536, "time_total_s": 4373.834671497345, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4373.834671497345, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 94.97265625, "ram_util_percent": 21.631249999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7330502865836024}, "default_policy": {"total_loss": 0.7330502865836024, "policy_loss": -0.03523127066437155, "vf_loss": 3.0743579246103763, "vf_loss_unclipped": 10.16757308319211, "vf_explained_var": -0.093256925791502, "entropy": 0.5912804722785949, "mean_kl_loss": 0.011334629982570732, "gradients_default_optimizer_global_norm": 1.4707790039479733, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 0, "num_agent_steps_sampled": 30718, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.881, "episode_reward_min": 9.993, "episode_reward_mean": 12.966690000000002, "episode_len_mean": 47.28, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476], "episode_lengths": [48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5273804704180515, "mean_inference_ms": 1.1690521258708453, "mean_action_processing_ms": 0.08260710709660439, "mean_env_wait_ms": 4.915585214678616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034911632537841797, "ViewRequirementAgentConnector_ms": 0.23658204078674316}}, "episode_reward_max": 17.881, "episode_reward_min": 9.993, "episode_reward_mean": 12.966690000000002, "episode_len_mean": 47.28, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.616000000000001, 14.01, 13.418, 11.213000000000001, 13.424, 10.898, 12.383, 11.599, 14.804, 10.002, 11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476], "episode_lengths": [48, 58, 50, 37, 50, 35, 42, 38, 53, 37, 38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5273804704180515, "mean_inference_ms": 1.1690521258708453, "mean_action_processing_ms": 0.08260710709660439, "mean_env_wait_ms": 4.915585214678616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034911632537841797, "ViewRequirementAgentConnector_ms": 0.23658204078674316}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30718, "num_agent_steps_trained": 0, "num_env_steps_sampled": 30720, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.185572642079127, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 30720, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 30718, "timers": {"training_iteration_time_ms": 80855.082, "sample_time_ms": 3454.737, "synch_weights_time_ms": 55.073}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 0, "num_agent_steps_sampled": 30718, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 564, "training_iteration": 60, "trial_id": "default", "date": "2025-12-19_18-32-24", "timestamp": 1766140344, "time_this_iter_s": 82.77886486053467, "time_total_s": 4456.61353635788, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4456.61353635788, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 95.12118644067795, "ram_util_percent": 18.715254237288136}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.5851754080504179}, "default_policy": {"total_loss": 0.5851754080504179, "policy_loss": -0.0385810766601935, "vf_loss": 2.4964157000184057, "vf_loss_unclipped": 9.644742256402969, "vf_explained_var": -0.09009388461709023, "entropy": 0.6067120648920536, "mean_kl_loss": 0.01037069052671652, "gradients_default_optimizer_global_norm": 1.1683017142117023, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 31232, "num_env_steps_trained": 0, "num_agent_steps_sampled": 31230, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.881, "episode_reward_min": 9.993, "episode_reward_mean": 13.04804, "episode_len_mean": 47.63, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002], "episode_lengths": [38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275850839331697, "mean_inference_ms": 1.1689109357757295, "mean_action_processing_ms": 0.08259150606358365, "mean_env_wait_ms": 4.915209503416933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035085678100585938, "ViewRequirementAgentConnector_ms": 0.23649954795837402}}, "episode_reward_max": 17.881, "episode_reward_min": 9.993, "episode_reward_mean": 13.04804, "episode_len_mean": 47.63, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.318000000000001, 11.852, 15.509000000000002, 14.129000000000001, 12.384, 16.141, 17.802000000000007, 12.928, 10.584, 12.893, 13.767, 11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002], "episode_lengths": [38, 41, 62, 51, 43, 64, 73, 47, 35, 48, 52, 41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275850839331697, "mean_inference_ms": 1.1689109357757295, "mean_action_processing_ms": 0.08259150606358365, "mean_env_wait_ms": 4.915209503416933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035085678100585938, "ViewRequirementAgentConnector_ms": 0.23649954795837402}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31230, "num_agent_steps_trained": 0, "num_env_steps_sampled": 31232, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.334626676693042, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 31232, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 31230, "timers": {"training_iteration_time_ms": 84844.639, "sample_time_ms": 3454.362, "synch_weights_time_ms": 59.315}, "counters": {"num_env_steps_sampled": 31232, "num_env_steps_trained": 0, "num_agent_steps_sampled": 31230, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 574, "training_iteration": 61, "trial_id": "default", "date": "2025-12-19_18-34-22", "timestamp": 1766140462, "time_this_iter_s": 118.12657880783081, "time_total_s": 4574.74011516571, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4574.74011516571, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 93.93988095238096, "ram_util_percent": 25.411904761904765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.6759501797147095}, "default_policy": {"total_loss": 0.6759501797147095, "policy_loss": -0.031870564166456464, "vf_loss": 2.8327845349907874, "vf_loss_unclipped": 10.49063229560852, "vf_explained_var": -0.07647998556494713, "entropy": 0.5605714522302151, "mean_kl_loss": 0.0074067899504684604, "gradients_default_optimizer_global_norm": 1.7250432748347522, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 0, "num_agent_steps_sampled": 31742, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.881, "episode_reward_min": 9.993, "episode_reward_mean": 12.937990000000003, "episode_len_mean": 47.24, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294], "episode_lengths": [41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5282126686696688, "mean_inference_ms": 1.1699533713012562, "mean_action_processing_ms": 0.08265140766390955, "mean_env_wait_ms": 4.917705147028811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036592483520507812, "ViewRequirementAgentConnector_ms": 0.24439001083374023}}, "episode_reward_max": 17.881, "episode_reward_min": 9.993, "episode_reward_mean": 12.937990000000003, "episode_len_mean": 47.24, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.534, 12.835, 13.015, 13.184000000000001, 13.225999999999999, 13.158000000000001, 11.644, 11.581, 13.117, 12.468, 13.396, 14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294], "episode_lengths": [41, 51, 47, 46, 48, 51, 41, 42, 47, 43, 46, 60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5282126686696688, "mean_inference_ms": 1.1699533713012562, "mean_action_processing_ms": 0.08265140766390955, "mean_env_wait_ms": 4.917705147028811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036592483520507812, "ViewRequirementAgentConnector_ms": 0.24439001083374023}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31742, "num_agent_steps_trained": 0, "num_env_steps_sampled": 31744, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.00576451717136, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 31744, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 31742, "timers": {"training_iteration_time_ms": 90066.777, "sample_time_ms": 3563.45, "synch_weights_time_ms": 61.098}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 0, "num_agent_steps_sampled": 31742, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 585, "training_iteration": 62, "trial_id": "default", "date": "2025-12-19_18-36-34", "timestamp": 1766140594, "time_this_iter_s": 127.81902122497559, "time_total_s": 4702.559136390686, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4702.559136390686, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 95.40481283422463, "ram_util_percent": 30.942245989304816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.6575556909665465}, "default_policy": {"total_loss": 0.6575556909665465, "policy_loss": -0.03195374426431954, "vf_loss": 2.759447990357876, "vf_loss_unclipped": 10.458850771188736, "vf_explained_var": -0.0643388107419014, "entropy": 0.5776668850332498, "mean_kl_loss": 0.009004383814746575, "gradients_default_optimizer_global_norm": 1.1875561442226172, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32254, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.881, "episode_reward_min": 9.993, "episode_reward_mean": 12.974300000000001, "episode_len_mean": 47.5, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422], "episode_lengths": [60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.529185687856953, "mean_inference_ms": 1.172025875015847, "mean_action_processing_ms": 0.08277255258955092, "mean_env_wait_ms": 4.9225006492595185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0037598609924316406, "ViewRequirementAgentConnector_ms": 0.2504091262817383}}, "episode_reward_max": 17.881, "episode_reward_min": 9.993, "episode_reward_mean": 12.974300000000001, "episode_len_mean": 47.5, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.7, 11.23, 11.573, 12.478, 11.618, 14.032, 11.717, 12.57, 12.25, 13.715, 12.401, 14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422], "episode_lengths": [60, 44, 42, 51, 37, 54, 39, 42, 40, 47, 46, 53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.529185687856953, "mean_inference_ms": 1.172025875015847, "mean_action_processing_ms": 0.08277255258955092, "mean_env_wait_ms": 4.9225006492595185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0037598609924316406, "ViewRequirementAgentConnector_ms": 0.2504091262817383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32254, "num_agent_steps_trained": 0, "num_env_steps_sampled": 32256, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 3.8663121102136966, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 32256, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 32254, "timers": {"training_iteration_time_ms": 95483.225, "sample_time_ms": 3654.374, "synch_weights_time_ms": 63.273}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32254, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 596, "training_iteration": 63, "trial_id": "default", "date": "2025-12-19_18-38-46", "timestamp": 1766140726, "time_this_iter_s": 132.42883253097534, "time_total_s": 4834.987968921661, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4834.987968921661, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 95.47659574468085, "ram_util_percent": 32.335638297872336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.6721556117758155}, "default_policy": {"total_loss": 0.6721556117758155, "policy_loss": -0.031521548284217715, "vf_loss": 2.8162290543317794, "vf_loss_unclipped": 10.464500451087952, "vf_explained_var": -0.00749695748090744, "entropy": 0.5820734106004238, "mean_kl_loss": 0.008078838709337788, "gradients_default_optimizer_global_norm": 1.0916196547448636, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32766, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.881, "episode_reward_min": 9.993, "episode_reward_mean": 12.995630000000004, "episode_len_mean": 47.55, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421], "episode_lengths": [53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5301515745470142, "mean_inference_ms": 1.1741500662861422, "mean_action_processing_ms": 0.08288134939002191, "mean_env_wait_ms": 4.928415654426888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003839254379272461, "ViewRequirementAgentConnector_ms": 0.2564818859100342}}, "episode_reward_max": 17.881, "episode_reward_min": 9.993, "episode_reward_mean": 12.995630000000004, "episode_len_mean": 47.55, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.962, 11.715, 12.546000000000001, 11.378, 13.2, 17.428, 10.812000000000001, 12.062999999999999, 12.358, 12.726, 11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421], "episode_lengths": [53, 41, 41, 32, 44, 73, 39, 43, 42, 48, 40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5301515745470142, "mean_inference_ms": 1.1741500662861422, "mean_action_processing_ms": 0.08288134939002191, "mean_env_wait_ms": 4.928415654426888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003839254379272461, "ViewRequirementAgentConnector_ms": 0.2564818859100342}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32766, "num_agent_steps_trained": 0, "num_env_steps_sampled": 32768, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.169710412756243, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 32768, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 32766, "timers": {"training_iteration_time_ms": 100089.339, "sample_time_ms": 3743.264, "synch_weights_time_ms": 65.948}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32766, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 607, "training_iteration": 64, "trial_id": "default", "date": "2025-12-19_18-40-49", "timestamp": 1766140849, "time_this_iter_s": 122.79328036308289, "time_total_s": 4957.781249284744, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4957.781249284744, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 96.24571428571429, "ram_util_percent": 33.186857142857136}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.6924869824200869}, "default_policy": {"total_loss": 0.6924869824200869, "policy_loss": -0.03402511065360159, "vf_loss": 2.907516856491566, "vf_loss_unclipped": 9.782239082455636, "vf_explained_var": 0.02113935798406601, "entropy": 0.6170082975178957, "mean_kl_loss": 0.00999555139026711, "gradients_default_optimizer_global_norm": 1.6875895712524653, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 33280, "num_env_steps_trained": 0, "num_agent_steps_sampled": 33278, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.881, "episode_reward_min": 9.993, "episode_reward_mean": 13.014380000000001, "episode_len_mean": 47.93, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198], "episode_lengths": [40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5313040165740786, "mean_inference_ms": 1.177067134967767, "mean_action_processing_ms": 0.08303687348152534, "mean_env_wait_ms": 4.936064370042722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003943204879760742, "ViewRequirementAgentConnector_ms": 0.26262664794921875}}, "episode_reward_max": 17.881, "episode_reward_min": 9.993, "episode_reward_mean": 13.014380000000001, "episode_len_mean": 47.93, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.643, 13.535, 15.209000000000003, 12.955, 14.299999999999999, 16.426000000000002, 9.993, 12.248999999999999, 12.388000000000002, 13.141, 15.617, 11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198], "episode_lengths": [40, 50, 59, 55, 54, 72, 34, 40, 47, 50, 59, 46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5313040165740786, "mean_inference_ms": 1.177067134967767, "mean_action_processing_ms": 0.08303687348152534, "mean_env_wait_ms": 4.936064370042722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003943204879760742, "ViewRequirementAgentConnector_ms": 0.26262664794921875}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33278, "num_agent_steps_trained": 0, "num_env_steps_sampled": 33280, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.226869162200223, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 33280, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 33278, "timers": {"training_iteration_time_ms": 104215.291, "sample_time_ms": 3838.712, "synch_weights_time_ms": 68.207}, "counters": {"num_env_steps_sampled": 33280, "num_env_steps_trained": 0, "num_agent_steps_sampled": 33278, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 617, "training_iteration": 65, "trial_id": "default", "date": "2025-12-19_18-42-50", "timestamp": 1766140970, "time_this_iter_s": 121.13227868080139, "time_total_s": 5078.913527965546, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5078.913527965546, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 96.37093023255814, "ram_util_percent": 33.15058139534884}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.7337295250967145}, "default_policy": {"total_loss": 0.7337295250967145, "policy_loss": -0.03468909211223945, "vf_loss": 3.075219210982323, "vf_loss_unclipped": 10.722319811582565, "vf_explained_var": -0.046900282800197604, "entropy": 0.5976131469011307, "mean_kl_loss": 0.008456805489748831, "gradients_default_optimizer_global_norm": 1.2340312041342258, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 0, "num_agent_steps_sampled": 33790, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.881, "episode_reward_min": 10.404, "episode_reward_mean": 12.963890000000001, "episode_len_mean": 47.78, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548], "episode_lengths": [46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5326852507129958, "mean_inference_ms": 1.180665987146217, "mean_action_processing_ms": 0.0832210478497783, "mean_env_wait_ms": 4.945791152206303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0040628910064697266, "ViewRequirementAgentConnector_ms": 0.2704813480377197}}, "episode_reward_max": 17.881, "episode_reward_min": 10.404, "episode_reward_mean": 12.963890000000001, "episode_len_mean": 47.78, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.978, 14.001000000000001, 12.052000000000001, 13.22, 14.027, 11.941, 11.947000000000001, 11.624, 13.062000000000001, 12.024000000000001, 13.115, 15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548], "episode_lengths": [46, 48, 44, 46, 49, 42, 39, 39, 40, 40, 46, 57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5326852507129958, "mean_inference_ms": 1.180665987146217, "mean_action_processing_ms": 0.0832210478497783, "mean_env_wait_ms": 4.945791152206303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0040628910064697266, "ViewRequirementAgentConnector_ms": 0.2704813480377197}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33790, "num_agent_steps_trained": 0, "num_env_steps_sampled": 33792, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.164911358277829, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 33792, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 33790, "timers": {"training_iteration_time_ms": 108539.35, "sample_time_ms": 3924.51, "synch_weights_time_ms": 71.585}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 0, "num_agent_steps_sampled": 33790, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 628, "training_iteration": 66, "trial_id": "default", "date": "2025-12-19_18-44-53", "timestamp": 1766141093, "time_this_iter_s": 122.93531823158264, "time_total_s": 5201.848846197128, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5201.848846197128, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 96.03085714285713, "ram_util_percent": 33.926857142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.6450348859652877}, "default_policy": {"total_loss": 0.6450348859652877, "policy_loss": -0.03205545023083687, "vf_loss": 2.7095612064003944, "vf_loss_unclipped": 10.637125355005264, "vf_explained_var": -0.19665515869855882, "entropy": 0.5362197909504175, "mean_kl_loss": 0.009450236819481006, "gradients_default_optimizer_global_norm": 0.98922448605299, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 34304, "num_env_steps_trained": 0, "num_agent_steps_sampled": 34302, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.881, "episode_reward_min": 10.404, "episode_reward_mean": 12.96078, "episode_len_mean": 48.12, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2], "episode_lengths": [57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5343630882630677, "mean_inference_ms": 1.1852348026691617, "mean_action_processing_ms": 0.0834605629595623, "mean_env_wait_ms": 4.9578025296114525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004150867462158203, "ViewRequirementAgentConnector_ms": 0.27686357498168945}}, "episode_reward_max": 17.881, "episode_reward_min": 10.404, "episode_reward_mean": 12.96078, "episode_len_mean": 48.12, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.625, 17.881, 12.248000000000001, 13.739, 13.303999999999998, 14.213000000000001, 13.405000000000001, 13.09, 12.257, 12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2], "episode_lengths": [57, 72, 39, 50, 47, 59, 45, 44, 40, 46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5343630882630677, "mean_inference_ms": 1.1852348026691617, "mean_action_processing_ms": 0.0834605629595623, "mean_env_wait_ms": 4.9578025296114525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004150867462158203, "ViewRequirementAgentConnector_ms": 0.27686357498168945}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34302, "num_agent_steps_trained": 0, "num_env_steps_sampled": 34304, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.204110975655375, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 34304, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 34302, "timers": {"training_iteration_time_ms": 112748.406, "sample_time_ms": 4024.026, "synch_weights_time_ms": 72.224}, "counters": {"num_env_steps_sampled": 34304, "num_env_steps_trained": 0, "num_agent_steps_sampled": 34302, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 639, "training_iteration": 67, "trial_id": "default", "date": "2025-12-19_18-46-59", "timestamp": 1766141219, "time_this_iter_s": 121.79159259796143, "time_total_s": 5323.64043879509, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5323.64043879509, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 95.65393258426967, "ram_util_percent": 33.85561797752809}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.632073182053864}, "default_policy": {"total_loss": 0.632073182053864, "policy_loss": -0.039136498630978164, "vf_loss": 2.686655621230602, "vf_loss_unclipped": 9.897144377231598, "vf_explained_var": -0.1296469710767269, "entropy": 0.6727369572967291, "mean_kl_loss": 0.00874029496694675, "gradients_default_optimizer_global_norm": 1.0315426889806987, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 0, "num_agent_steps_sampled": 34814, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19.040999999999997, "episode_reward_min": 10.404, "episode_reward_mean": 13.01358, "episode_len_mean": 48.59, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732], "episode_lengths": [46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.535782033304327, "mean_inference_ms": 1.1892593979161077, "mean_action_processing_ms": 0.08366310087426047, "mean_env_wait_ms": 4.968774464742146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0042324066162109375, "ViewRequirementAgentConnector_ms": 0.28180646896362305}}, "episode_reward_max": 19.040999999999997, "episode_reward_min": 10.404, "episode_reward_mean": 13.01358, "episode_len_mean": 48.59, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.796, 13.428, 10.803, 13.113, 14.919, 13.224, 12.712, 11.316, 11.979, 12.062, 14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732], "episode_lengths": [46, 49, 37, 47, 58, 48, 48, 42, 45, 44, 56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.535782033304327, "mean_inference_ms": 1.1892593979161077, "mean_action_processing_ms": 0.08366310087426047, "mean_env_wait_ms": 4.968774464742146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0042324066162109375, "ViewRequirementAgentConnector_ms": 0.28180646896362305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34814, "num_agent_steps_trained": 0, "num_env_steps_sampled": 34816, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.103922199239913, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 34816, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 34814, "timers": {"training_iteration_time_ms": 116469.124, "sample_time_ms": 4119.034, "synch_weights_time_ms": 75.381}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 0, "num_agent_steps_sampled": 34814, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 648, "training_iteration": 68, "trial_id": "default", "date": "2025-12-19_18-49-04", "timestamp": 1766141344, "time_this_iter_s": 124.76310586929321, "time_total_s": 5448.403544664383, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5448.403544664383, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 96.18757062146894, "ram_util_percent": 30.476836158192093}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 513.0, "total_loss": 0.6634798667129175}, "default_policy": {"total_loss": 0.6634798667129175, "policy_loss": -0.02663208439624236, "vf_loss": 2.761923098269804, "vf_loss_unclipped": 10.420511958039837, "vf_explained_var": -0.13994266074380757, "entropy": 0.6205334475746861, "mean_kl_loss": 0.010068548782047727, "gradients_default_optimizer_global_norm": 1.2561863130993314, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 35328, "num_env_steps_trained": 0, "num_agent_steps_sampled": 35327, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19.524, "episode_reward_min": 10.404, "episode_reward_mean": 13.166019999999998, "episode_len_mean": 49.26, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701], "episode_lengths": [56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5377070753492896, "mean_inference_ms": 1.1949345834554324, "mean_action_processing_ms": 0.08396917191904278, "mean_env_wait_ms": 4.983319184267508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004423379898071289, "ViewRequirementAgentConnector_ms": 0.29110288619995117}}, "episode_reward_max": 19.524, "episode_reward_min": 10.404, "episode_reward_mean": 13.166019999999998, "episode_len_mean": 49.26, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.004000000000001, 14.479, 11.323, 13.280999999999999, 12.241, 12.476, 12.816, 12.251000000000001, 12.696000000000002, 13.758, 13.309, 15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701], "episode_lengths": [56, 52, 40, 77, 40, 44, 50, 41, 46, 51, 47, 63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5377070753492896, "mean_inference_ms": 1.1949345834554324, "mean_action_processing_ms": 0.08396917191904278, "mean_env_wait_ms": 4.983319184267508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004423379898071289, "ViewRequirementAgentConnector_ms": 0.29110288619995117}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35327, "num_agent_steps_trained": 0, "num_env_steps_sampled": 35328, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 3.584103982753097, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 35328, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 35327, "timers": {"training_iteration_time_ms": 121738.229, "sample_time_ms": 4240.152, "synch_weights_time_ms": 79.625}, "counters": {"num_env_steps_sampled": 35328, "num_env_steps_trained": 0, "num_agent_steps_sampled": 35327, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 658, "training_iteration": 69, "trial_id": "default", "date": "2025-12-19_18-51-26", "timestamp": 1766141486, "time_this_iter_s": 142.8571960926056, "time_total_s": 5591.2607407569885, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5591.2607407569885, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 94.53940886699509, "ram_util_percent": 32.20935960591133}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 511.0, "total_loss": 0.6621571935713291}, "default_policy": {"total_loss": 0.6621571935713291, "policy_loss": -0.029965110681951047, "vf_loss": 2.7698490589857103, "vf_loss_unclipped": 10.444679433107376, "vf_explained_var": -0.06205467730760574, "entropy": 0.48616426400840285, "mean_kl_loss": 0.005848031635463258, "gradients_default_optimizer_global_norm": 0.8129993293434381, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 0, "num_agent_steps_sampled": 35838, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19.524, "episode_reward_min": 10.404, "episode_reward_mean": 13.120410000000001, "episode_len_mean": 48.68, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587], "episode_lengths": [63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5402056352063436, "mean_inference_ms": 1.2024393593405958, "mean_action_processing_ms": 0.08437560644149517, "mean_env_wait_ms": 5.001354307745342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004794597625732422, "ViewRequirementAgentConnector_ms": 0.30562829971313477}}, "episode_reward_max": 19.524, "episode_reward_min": 10.404, "episode_reward_mean": 13.120410000000001, "episode_len_mean": 48.68, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.664, 11.451, 13.506999999999998, 13.012, 14.038000000000002, 12.821, 12.914000000000001, 12.494000000000003, 13.66, 13.100999999999999, 12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587], "episode_lengths": [63, 40, 47, 46, 52, 51, 50, 50, 57, 45, 42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5402056352063436, "mean_inference_ms": 1.2024393593405958, "mean_action_processing_ms": 0.08437560644149517, "mean_env_wait_ms": 5.001354307745342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004794597625732422, "ViewRequirementAgentConnector_ms": 0.30562829971313477}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35838, "num_agent_steps_trained": 0, "num_env_steps_sampled": 35840, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.157621363551861, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 35840, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 35838, "timers": {"training_iteration_time_ms": 125775.636, "sample_time_ms": 4371.97, "synch_weights_time_ms": 82.102}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 0, "num_agent_steps_sampled": 35838, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 669, "training_iteration": 70, "trial_id": "default", "date": "2025-12-19_18-53-30", "timestamp": 1766141610, "time_this_iter_s": 123.15062880516052, "time_total_s": 5714.411369562149, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5714.411369562149, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 96.19085714285715, "ram_util_percent": 32.84857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.6335875619202852}, "default_policy": {"total_loss": 0.6335875619202852, "policy_loss": -0.029021223401650788, "vf_loss": 2.652077431976795, "vf_loss_unclipped": 10.30412865281105, "vf_explained_var": -0.10484377071261405, "entropy": 0.6114388596266508, "mean_kl_loss": 0.008034659020830759, "gradients_default_optimizer_global_norm": 1.45628839507699, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 36352, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36350, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19.524, "episode_reward_min": 10.404, "episode_reward_mean": 13.132729999999999, "episode_len_mean": 48.63, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042], "episode_lengths": [42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5425894411477993, "mean_inference_ms": 1.209759973472259, "mean_action_processing_ms": 0.08477301441329103, "mean_env_wait_ms": 5.018285267157232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005026578903198242, "ViewRequirementAgentConnector_ms": 0.31360745429992676}}, "episode_reward_max": 19.524, "episode_reward_min": 10.404, "episode_reward_mean": 13.132729999999999, "episode_len_mean": 48.63, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.045000000000002, 11.879000000000001, 11.870999999999999, 13.43, 12.793, 11.294, 14.280000000000001, 12.994, 11.330000000000002, 11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042], "episode_lengths": [42, 47, 43, 49, 45, 36, 54, 50, 42, 38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5425894411477993, "mean_inference_ms": 1.209759973472259, "mean_action_processing_ms": 0.08477301441329103, "mean_env_wait_ms": 5.018285267157232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005026578903198242, "ViewRequirementAgentConnector_ms": 0.31360745429992676}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36350, "num_agent_steps_trained": 0, "num_env_steps_sampled": 36352, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.239302657651805, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 36352, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 36350, "timers": {"training_iteration_time_ms": 126041.235, "sample_time_ms": 4494.099, "synch_weights_time_ms": 80.876}, "counters": {"num_env_steps_sampled": 36352, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36350, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 679, "training_iteration": 71, "trial_id": "default", "date": "2025-12-19_18-55-30", "timestamp": 1766141730, "time_this_iter_s": 120.78022646903992, "time_total_s": 5835.191596031189, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5835.191596031189, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 96.33488372093022, "ram_util_percent": 32.830232558139535}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.555632964707911}, "default_policy": {"total_loss": 0.555632964707911, "policy_loss": -0.03319319309666753, "vf_loss": 2.3569812554866076, "vf_loss_unclipped": 9.29996675439179, "vf_explained_var": -0.1251738741993904, "entropy": 0.6423799891024828, "mean_kl_loss": 0.008928664719758617, "gradients_default_optimizer_global_norm": 1.5521372370421886, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 36864, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36862, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19.524, "episode_reward_min": 10.404, "episode_reward_mean": 13.31149, "episode_len_mean": 49.48, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24], "episode_lengths": [38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5447533076781031, "mean_inference_ms": 1.2165000098878316, "mean_action_processing_ms": 0.08514764964164033, "mean_env_wait_ms": 5.033909993597725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0050182342529296875, "ViewRequirementAgentConnector_ms": 0.31426548957824707}}, "episode_reward_max": 19.524, "episode_reward_min": 10.404, "episode_reward_mean": 13.31149, "episode_len_mean": 49.48, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.934, 11.126, 11.404000000000002, 12.775, 11.66, 14.462000000000002, 13.402000000000001, 17.422, 16.667, 11.746000000000002, 12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24], "episode_lengths": [38, 40, 38, 46, 43, 56, 47, 75, 63, 41, 42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5447533076781031, "mean_inference_ms": 1.2165000098878316, "mean_action_processing_ms": 0.08514764964164033, "mean_env_wait_ms": 5.033909993597725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0050182342529296875, "ViewRequirementAgentConnector_ms": 0.31426548957824707}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36862, "num_agent_steps_trained": 0, "num_env_steps_sampled": 36864, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.138645881608869, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 36864, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 36862, "timers": {"training_iteration_time_ms": 125630.852, "sample_time_ms": 4483.126, "synch_weights_time_ms": 78.362}, "counters": {"num_env_steps_sampled": 36864, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36862, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 688, "training_iteration": 72, "trial_id": "default", "date": "2025-12-19_18-57-38", "timestamp": 1766141858, "time_this_iter_s": 123.71480798721313, "time_total_s": 5958.906404018402, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5958.906404018402, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 95.7292817679558, "ram_util_percent": 33.26408839779006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.6138764187693596}, "default_policy": {"total_loss": 0.6138764187693596, "policy_loss": -0.032403989182785156, "vf_loss": 2.586384838819504, "vf_loss_unclipped": 9.736817283928394, "vf_explained_var": -0.044051962345838545, "entropy": 0.554088992625475, "mean_kl_loss": 0.009531784521460907, "gradients_default_optimizer_global_norm": 1.2320777449756861, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 37376, "num_env_steps_trained": 0, "num_agent_steps_sampled": 37374, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19.524, "episode_reward_min": 10.404, "episode_reward_mean": 13.40879, "episode_len_mean": 50.02, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999], "episode_lengths": [42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5470180464883398, "mean_inference_ms": 1.223671921036375, "mean_action_processing_ms": 0.08553456398618987, "mean_env_wait_ms": 5.050697738250156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0050716400146484375, "ViewRequirementAgentConnector_ms": 0.3143916130065918}}, "episode_reward_max": 19.524, "episode_reward_min": 10.404, "episode_reward_mean": 13.40879, "episode_len_mean": 50.02, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.252, 13.342, 12.271, 11.406, 11.664, 12.342, 12.266, 12.040000000000001, 14.421, 12.789, 13.866999999999999, 10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999], "episode_lengths": [42, 48, 45, 36, 42, 50, 43, 39, 58, 44, 53, 41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5470180464883398, "mean_inference_ms": 1.223671921036375, "mean_action_processing_ms": 0.08553456398618987, "mean_env_wait_ms": 5.050697738250156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0050716400146484375, "ViewRequirementAgentConnector_ms": 0.3143916130065918}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37374, "num_agent_steps_trained": 0, "num_env_steps_sampled": 37376, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.097917967988157, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37376, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 37374, "timers": {"training_iteration_time_ms": 124882.408, "sample_time_ms": 4494.431, "synch_weights_time_ms": 76.769}, "counters": {"num_env_steps_sampled": 37376, "num_env_steps_trained": 0, "num_agent_steps_sampled": 37374, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 698, "training_iteration": 73, "trial_id": "default", "date": "2025-12-19_18-59-43", "timestamp": 1766141983, "time_this_iter_s": 124.94442415237427, "time_total_s": 6083.850828170776, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6083.850828170776, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 96.04293785310733, "ram_util_percent": 33.793785310734464}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.6687753584235907}, "default_policy": {"total_loss": 0.6687753584235907, "policy_loss": -0.029424903623294085, "vf_loss": 2.794221067428589, "vf_loss_unclipped": 10.554770749807357, "vf_explained_var": -0.09941566064953804, "entropy": 0.5175235718488693, "mean_kl_loss": 0.0065007882235789795, "gradients_default_optimizer_global_norm": 1.0691361483186483, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 37888, "num_env_steps_trained": 0, "num_agent_steps_sampled": 37886, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19.524, "episode_reward_min": 10.404, "episode_reward_mean": 13.46243, "episode_len_mean": 50.43, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001], "episode_lengths": [41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5494492190958941, "mean_inference_ms": 1.2314037112925953, "mean_action_processing_ms": 0.0859550149538021, "mean_env_wait_ms": 5.068739600990957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00506901741027832, "ViewRequirementAgentConnector_ms": 0.3138730525970459}}, "episode_reward_max": 19.524, "episode_reward_min": 10.404, "episode_reward_mean": 13.46243, "episode_len_mean": 50.43, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.926, 14.171000000000001, 12.587000000000002, 13.951, 11.942, 12.052, 14.580000000000002, 14.198, 14.689, 11.971, 15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001], "episode_lengths": [41, 53, 55, 50, 38, 40, 56, 64, 55, 41, 65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5494492190958941, "mean_inference_ms": 1.2314037112925953, "mean_action_processing_ms": 0.0859550149538021, "mean_env_wait_ms": 5.068739600990957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00506901741027832, "ViewRequirementAgentConnector_ms": 0.3138730525970459}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37886, "num_agent_steps_trained": 0, "num_env_steps_sampled": 37888, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.172671777439313, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37888, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 37886, "timers": {"training_iteration_time_ms": 124873.693, "sample_time_ms": 4497.136, "synch_weights_time_ms": 77.125}, "counters": {"num_env_steps_sampled": 37888, "num_env_steps_trained": 0, "num_agent_steps_sampled": 37886, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 709, "training_iteration": 74, "trial_id": "default", "date": "2025-12-19_19-01-45", "timestamp": 1766142105, "time_this_iter_s": 122.70689964294434, "time_total_s": 6206.557727813721, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6206.557727813721, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 96.31257142857146, "ram_util_percent": 33.62228571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.6529691964387894}, "default_policy": {"total_loss": 0.6529691964387894, "policy_loss": -0.031726025091484186, "vf_loss": 2.7400872252881525, "vf_loss_unclipped": 9.97854114100337, "vf_explained_var": -0.10124140903353691, "entropy": 0.564057445898652, "mean_kl_loss": 0.00949872277523891, "gradients_default_optimizer_global_norm": 1.3262681279331445, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 38400, "num_env_steps_trained": 0, "num_agent_steps_sampled": 38398, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19.524, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 13.5074, "episode_len_mean": 50.71, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001], "episode_lengths": [65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5516275618852248, "mean_inference_ms": 1.238242723300695, "mean_action_processing_ms": 0.08632757333014113, "mean_env_wait_ms": 5.084773753370719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005109548568725586, "ViewRequirementAgentConnector_ms": 0.3144686222076416}}, "episode_reward_max": 19.524, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 13.5074, "episode_len_mean": 50.71, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.607000000000001, 13.083, 14.368, 11.799, 10.404, 11.641000000000002, 15.772, 11.525, 11.548, 10.742, 12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001], "episode_lengths": [65, 43, 69, 46, 36, 42, 68, 38, 42, 42, 47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5516275618852248, "mean_inference_ms": 1.238242723300695, "mean_action_processing_ms": 0.08632757333014113, "mean_env_wait_ms": 5.084773753370719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005109548568725586, "ViewRequirementAgentConnector_ms": 0.3144686222076416}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38398, "num_agent_steps_trained": 0, "num_env_steps_sampled": 38400, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.026396193228748, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 38400, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 38398, "timers": {"training_iteration_time_ms": 125476.791, "sample_time_ms": 4500.613, "synch_weights_time_ms": 79.545}, "counters": {"num_env_steps_sampled": 38400, "num_env_steps_trained": 0, "num_agent_steps_sampled": 38398, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 719, "training_iteration": 75, "trial_id": "default", "date": "2025-12-19_19-03-53", "timestamp": 1766142233, "time_this_iter_s": 127.16436409950256, "time_total_s": 6333.722091913223, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6333.722091913223, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 96.06388888888888, "ram_util_percent": 31.453888888888894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.604594473913312}, "default_policy": {"total_loss": 0.604594473913312, "policy_loss": -0.031772422790527347, "vf_loss": 2.546600115299225, "vf_loss_unclipped": 9.362338608503341, "vf_explained_var": -0.09313191920518875, "entropy": 0.5057795625180006, "mean_kl_loss": 0.008905743144900752, "gradients_default_optimizer_global_norm": 1.0293769884854556, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 38912, "num_env_steps_trained": 0, "num_agent_steps_sampled": 38910, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 22.347, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 13.602730000000001, "episode_len_mean": 50.85, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001, 12.487000000000002, 12.003, 22.347, 14.482000000000003, 12.136000000000001, 12.983, 12.364, 13.504000000000001, 12.076, 11.64], "episode_lengths": [47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31, 44, 44, 106, 54, 39, 43, 44, 48, 43, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539413991372286, "mean_inference_ms": 1.2455178255619743, "mean_action_processing_ms": 0.08672799557046502, "mean_env_wait_ms": 5.101300818125898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00524449348449707, "ViewRequirementAgentConnector_ms": 0.31909728050231934}}, "episode_reward_max": 22.347, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 13.602730000000001, "episode_len_mean": 50.85, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.312999999999999, 13.486, 11.969999999999999, 14.012, 11.347, 12.658999999999999, 13.665000000000001, 13.211, 12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001, 12.487000000000002, 12.003, 22.347, 14.482000000000003, 12.136000000000001, 12.983, 12.364, 13.504000000000001, 12.076, 11.64], "episode_lengths": [47, 53, 43, 55, 42, 42, 51, 48, 45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31, 44, 44, 106, 54, 39, 43, 44, 48, 43, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539413991372286, "mean_inference_ms": 1.2455178255619743, "mean_action_processing_ms": 0.08672799557046502, "mean_env_wait_ms": 5.101300818125898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00524449348449707, "ViewRequirementAgentConnector_ms": 0.31909728050231934}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38910, "num_agent_steps_trained": 0, "num_env_steps_sampled": 38912, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 3.9034074114272763, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 38912, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 38910, "timers": {"training_iteration_time_ms": 126300.355, "sample_time_ms": 4558.377, "synch_weights_time_ms": 78.043}, "counters": {"num_env_steps_sampled": 38912, "num_env_steps_trained": 0, "num_agent_steps_sampled": 38910, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 729, "training_iteration": 76, "trial_id": "default", "date": "2025-12-19_19-06-04", "timestamp": 1766142364, "time_this_iter_s": 131.1709065437317, "time_total_s": 6464.892998456955, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6464.892998456955, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 95.41390374331552, "ram_util_percent": 32.411764705882355}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.5064766585826874}, "default_policy": {"total_loss": 0.5064766585826874, "policy_loss": -0.03189659108174965, "vf_loss": 2.155351450294256, "vf_loss_unclipped": 7.677671027928591, "vf_explained_var": -0.04804803729057312, "entropy": 0.6185281995683909, "mean_kl_loss": 0.006156386911751887, "gradients_default_optimizer_global_norm": 1.8489183768630029, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 0, "num_agent_steps_sampled": 39422, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 22.347, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 13.839519999999998, "episode_len_mean": 51.93, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001, 12.487000000000002, 12.003, 22.347, 14.482000000000003, 12.136000000000001, 12.983, 12.364, 13.504000000000001, 12.076, 11.64, 13.926000000000002, 15.991999999999997, 15.619, 16.671999999999997, 15.666000000000004, 16.424000000000003, 15.933000000000002, 16.11], "episode_lengths": [45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31, 44, 44, 106, 54, 39, 43, 44, 48, 43, 40, 53, 63, 60, 64, 62, 60, 59, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556471226461798, "mean_inference_ms": 1.2511338046946912, "mean_action_processing_ms": 0.0870309935562732, "mean_env_wait_ms": 5.113989901286035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005316495895385742, "ViewRequirementAgentConnector_ms": 0.321547269821167}}, "episode_reward_max": 22.347, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 13.839519999999998, "episode_len_mean": 51.93, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.075, 13.2, 17.227000000000004, 19.040999999999997, 11.933, 13.621, 16.277, 13.924999999999999, 12.337, 12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001, 12.487000000000002, 12.003, 22.347, 14.482000000000003, 12.136000000000001, 12.983, 12.364, 13.504000000000001, 12.076, 11.64, 13.926000000000002, 15.991999999999997, 15.619, 16.671999999999997, 15.666000000000004, 16.424000000000003, 15.933000000000002, 16.11], "episode_lengths": [45, 45, 64, 78, 50, 47, 66, 47, 51, 50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31, 44, 44, 106, 54, 39, 43, 44, 48, 43, 40, 53, 63, 60, 64, 62, 60, 59, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556471226461798, "mean_inference_ms": 1.2511338046946912, "mean_action_processing_ms": 0.0870309935562732, "mean_env_wait_ms": 5.113989901286035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005316495895385742, "ViewRequirementAgentConnector_ms": 0.321547269821167}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39422, "num_agent_steps_trained": 0, "num_env_steps_sampled": 39424, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 3.9593891279247306, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 39424, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 39422, "timers": {"training_iteration_time_ms": 127053.086, "sample_time_ms": 4572.914, "synch_weights_time_ms": 78.967}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 0, "num_agent_steps_sampled": 39422, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 737, "training_iteration": 77, "trial_id": "default", "date": "2025-12-19_19-08-17", "timestamp": 1766142497, "time_this_iter_s": 129.31662487983704, "time_total_s": 6594.209623336792, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6594.209623336792, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 95.45319148936173, "ram_util_percent": 33.680851063829785}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.5722612814977766}, "default_policy": {"total_loss": 0.5722612814977766, "policy_loss": -0.033048747514840215, "vf_loss": 2.422806416451931, "vf_loss_unclipped": 8.90145292878151, "vf_explained_var": -0.13205045983195304, "entropy": 0.6126731626689434, "mean_kl_loss": 0.008843667126382116, "gradients_default_optimizer_global_norm": 1.5060640744864942, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 39936, "num_env_steps_trained": 0, "num_agent_steps_sampled": 39934, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 22.347, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 13.86009, "episode_len_mean": 52.19, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001, 12.487000000000002, 12.003, 22.347, 14.482000000000003, 12.136000000000001, 12.983, 12.364, 13.504000000000001, 12.076, 11.64, 13.926000000000002, 15.991999999999997, 15.619, 16.671999999999997, 15.666000000000004, 16.424000000000003, 15.933000000000002, 16.11, 12.71, 15.884000000000002, 19.678, 16.223000000000003, 11.155999999999999, 13.095, 12.893, 14.263, 15.790999999999997], "episode_lengths": [50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31, 44, 44, 106, 54, 39, 43, 44, 48, 43, 40, 53, 63, 60, 64, 62, 60, 59, 68, 56, 68, 80, 61, 43, 45, 46, 53, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578240934252111, "mean_inference_ms": 1.258173226834869, "mean_action_processing_ms": 0.08742506922906475, "mean_env_wait_ms": 5.128890572693938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00551152229309082, "ViewRequirementAgentConnector_ms": 0.32627296447753906}}, "episode_reward_max": 22.347, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 13.86009, "episode_len_mean": 52.19, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.949, 13.732, 13.434000000000001, 11.965, 15.560000000000002, 12.067, 15.019, 13.127000000000002, 19.524, 15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001, 12.487000000000002, 12.003, 22.347, 14.482000000000003, 12.136000000000001, 12.983, 12.364, 13.504000000000001, 12.076, 11.64, 13.926000000000002, 15.991999999999997, 15.619, 16.671999999999997, 15.666000000000004, 16.424000000000003, 15.933000000000002, 16.11, 12.71, 15.884000000000002, 19.678, 16.223000000000003, 11.155999999999999, 13.095, 12.893, 14.263, 15.790999999999997], "episode_lengths": [50, 47, 49, 41, 65, 42, 56, 48, 84, 53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31, 44, 44, 106, 54, 39, 43, 44, 48, 43, 40, 53, 63, 60, 64, 62, 60, 59, 68, 56, 68, 80, 61, 43, 45, 46, 53, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578240934252111, "mean_inference_ms": 1.258173226834869, "mean_action_processing_ms": 0.08742506922906475, "mean_env_wait_ms": 5.128890572693938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00551152229309082, "ViewRequirementAgentConnector_ms": 0.32627296447753906}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39934, "num_agent_steps_trained": 0, "num_env_steps_sampled": 39936, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 3.8881419449311245, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 39936, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 39934, "timers": {"training_iteration_time_ms": 127745.459, "sample_time_ms": 4614.335, "synch_weights_time_ms": 78.837}, "counters": {"num_env_steps_sampled": 39936, "num_env_steps_trained": 0, "num_agent_steps_sampled": 39934, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 746, "training_iteration": 78, "trial_id": "default", "date": "2025-12-19_19-10-29", "timestamp": 1766142629, "time_this_iter_s": 131.6868872642517, "time_total_s": 6725.896510601044, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6725.896510601044, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 95.70265957446807, "ram_util_percent": 34.70531914893617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.5718999087810517}, "default_policy": {"total_loss": 0.5718999087810517, "policy_loss": -0.03446064218878746, "vf_loss": 2.427204320207238, "vf_loss_unclipped": 9.159906421974302, "vf_explained_var": -0.012690544128417969, "entropy": 0.6625894617289305, "mean_kl_loss": 0.008881737549944545, "gradients_default_optimizer_global_norm": 1.2714354533702135, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 40448, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40446, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 22.347, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 13.892679999999999, "episode_len_mean": 52.39, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001, 12.487000000000002, 12.003, 22.347, 14.482000000000003, 12.136000000000001, 12.983, 12.364, 13.504000000000001, 12.076, 11.64, 13.926000000000002, 15.991999999999997, 15.619, 16.671999999999997, 15.666000000000004, 16.424000000000003, 15.933000000000002, 16.11, 12.71, 15.884000000000002, 19.678, 16.223000000000003, 11.155999999999999, 13.095, 12.893, 14.263, 15.790999999999997, 19.523000000000003, 13.703, 13.866999999999999, 11.631, 12.793, 13.924, 16.216, 18.416, 10.563], "episode_lengths": [53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31, 44, 44, 106, 54, 39, 43, 44, 48, 43, 40, 53, 63, 60, 64, 62, 60, 59, 68, 56, 68, 80, 61, 43, 45, 46, 53, 67, 78, 56, 58, 38, 44, 49, 68, 78, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5598808768623236, "mean_inference_ms": 1.2649246277701607, "mean_action_processing_ms": 0.08779739509421422, "mean_env_wait_ms": 5.143298332656511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005442619323730469, "ViewRequirementAgentConnector_ms": 0.3242769241333008}}, "episode_reward_max": 22.347, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 13.892679999999999, "episode_len_mean": 52.39, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.192, 11.007000000000001, 14.701, 11.317, 14.04, 12.462, 11.308, 11.832, 13.547, 12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001, 12.487000000000002, 12.003, 22.347, 14.482000000000003, 12.136000000000001, 12.983, 12.364, 13.504000000000001, 12.076, 11.64, 13.926000000000002, 15.991999999999997, 15.619, 16.671999999999997, 15.666000000000004, 16.424000000000003, 15.933000000000002, 16.11, 12.71, 15.884000000000002, 19.678, 16.223000000000003, 11.155999999999999, 13.095, 12.893, 14.263, 15.790999999999997, 19.523000000000003, 13.703, 13.866999999999999, 11.631, 12.793, 13.924, 16.216, 18.416, 10.563], "episode_lengths": [53, 37, 56, 40, 52, 41, 36, 40, 51, 43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31, 44, 44, 106, 54, 39, 43, 44, 48, 43, 40, 53, 63, 60, 64, 62, 60, 59, 68, 56, 68, 80, 61, 43, 45, 46, 53, 67, 78, 56, 58, 38, 44, 49, 68, 78, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5598808768623236, "mean_inference_ms": 1.2649246277701607, "mean_action_processing_ms": 0.08779739509421422, "mean_env_wait_ms": 5.143298332656511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005442619323730469, "ViewRequirementAgentConnector_ms": 0.3242769241333008}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40446, "num_agent_steps_trained": 0, "num_env_steps_sampled": 40448, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 3.9554731420030036, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 40448, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 40446, "timers": {"training_iteration_time_ms": 126404.247, "sample_time_ms": 4594.633, "synch_weights_time_ms": 76.262}, "counters": {"num_env_steps_sampled": 40448, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40446, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 755, "training_iteration": 79, "trial_id": "default", "date": "2025-12-19_19-12-38", "timestamp": 1766142758, "time_this_iter_s": 129.4445903301239, "time_total_s": 6855.341100931168, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6855.341100931168, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 95.83152173913044, "ram_util_percent": 35.50326086956521}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.5564280182123185}, "default_policy": {"total_loss": 0.5564280182123185, "policy_loss": -0.02627506114076823, "vf_loss": 2.3329453870654104, "vf_loss_unclipped": 9.230053487420083, "vf_explained_var": -0.0003070123493671417, "entropy": 0.6608223438262939, "mean_kl_loss": 0.005102842805132468, "gradients_default_optimizer_global_norm": 1.6267066583037377, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40958, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 22.347, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 13.99072, "episode_len_mean": 52.89, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001, 12.487000000000002, 12.003, 22.347, 14.482000000000003, 12.136000000000001, 12.983, 12.364, 13.504000000000001, 12.076, 11.64, 13.926000000000002, 15.991999999999997, 15.619, 16.671999999999997, 15.666000000000004, 16.424000000000003, 15.933000000000002, 16.11, 12.71, 15.884000000000002, 19.678, 16.223000000000003, 11.155999999999999, 13.095, 12.893, 14.263, 15.790999999999997, 19.523000000000003, 13.703, 13.866999999999999, 11.631, 12.793, 13.924, 16.216, 18.416, 10.563, 13.533, 14.38, 14.053, 14.788, 16.306, 11.907, 14.673, 11.639000000000001, 13.931], "episode_lengths": [43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31, 44, 44, 106, 54, 39, 43, 44, 48, 43, 40, 53, 63, 60, 64, 62, 60, 59, 68, 56, 68, 80, 61, 43, 45, 46, 53, 67, 78, 56, 58, 38, 44, 49, 68, 78, 33, 50, 55, 52, 56, 65, 38, 53, 39, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5615512137629651, "mean_inference_ms": 1.2703088265994322, "mean_action_processing_ms": 0.08808107789198942, "mean_env_wait_ms": 5.156291279330652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005321979522705078, "ViewRequirementAgentConnector_ms": 0.3216683864593506}}, "episode_reward_max": 22.347, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 13.99072, "episode_len_mean": 52.89, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.190000000000001, 12.268, 12.344999999999999, 16.177, 10.587, 12.809000000000001, 14.172, 16.228, 12.213, 13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001, 12.487000000000002, 12.003, 22.347, 14.482000000000003, 12.136000000000001, 12.983, 12.364, 13.504000000000001, 12.076, 11.64, 13.926000000000002, 15.991999999999997, 15.619, 16.671999999999997, 15.666000000000004, 16.424000000000003, 15.933000000000002, 16.11, 12.71, 15.884000000000002, 19.678, 16.223000000000003, 11.155999999999999, 13.095, 12.893, 14.263, 15.790999999999997, 19.523000000000003, 13.703, 13.866999999999999, 11.631, 12.793, 13.924, 16.216, 18.416, 10.563, 13.533, 14.38, 14.053, 14.788, 16.306, 11.907, 14.673, 11.639000000000001, 13.931], "episode_lengths": [43, 42, 40, 67, 34, 46, 52, 72, 48, 43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31, 44, 44, 106, 54, 39, 43, 44, 48, 43, 40, 53, 63, 60, 64, 62, 60, 59, 68, 56, 68, 80, 61, 43, 45, 46, 53, 67, 78, 56, 58, 38, 44, 49, 68, 78, 33, 50, 55, 52, 56, 65, 38, 53, 39, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5615512137629651, "mean_inference_ms": 1.2703088265994322, "mean_action_processing_ms": 0.08808107789198942, "mean_env_wait_ms": 5.156291279330652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005321979522705078, "ViewRequirementAgentConnector_ms": 0.3216683864593506}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40958, "num_agent_steps_trained": 0, "num_env_steps_sampled": 40960, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 3.8463155633413177, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 40960, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 40958, "timers": {"training_iteration_time_ms": 127400.952, "sample_time_ms": 4588.198, "synch_weights_time_ms": 76.813}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40958, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 764, "training_iteration": 80, "trial_id": "default", "date": "2025-12-19_19-14-51", "timestamp": 1766142891, "time_this_iter_s": 133.11745357513428, "time_total_s": 6988.458554506302, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6988.458554506302, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 94.82275132275132, "ram_util_percent": 35.374074074074066}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.5755871500819921}, "default_policy": {"total_loss": 0.5755871500819921, "policy_loss": -0.033325770823284986, "vf_loss": 2.437315398082137, "vf_loss_unclipped": 9.14906368367374, "vf_explained_var": 0.08759853914380074, "entropy": 0.6379227034747601, "mean_kl_loss": 0.00887988333765577, "gradients_default_optimizer_global_norm": 1.5524779181927442, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 41472, "num_env_steps_trained": 0, "num_agent_steps_sampled": 41470, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 24.791000000000007, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 14.067279999999998, "episode_len_mean": 53.34, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001, 12.487000000000002, 12.003, 22.347, 14.482000000000003, 12.136000000000001, 12.983, 12.364, 13.504000000000001, 12.076, 11.64, 13.926000000000002, 15.991999999999997, 15.619, 16.671999999999997, 15.666000000000004, 16.424000000000003, 15.933000000000002, 16.11, 12.71, 15.884000000000002, 19.678, 16.223000000000003, 11.155999999999999, 13.095, 12.893, 14.263, 15.790999999999997, 19.523000000000003, 13.703, 13.866999999999999, 11.631, 12.793, 13.924, 16.216, 18.416, 10.563, 13.533, 14.38, 14.053, 14.788, 16.306, 11.907, 14.673, 11.639000000000001, 13.931, 24.791000000000007, 14.378, 11.503000000000002, 12.083, 12.587000000000002, 12.213999999999999, 11.668000000000001, 16.582, 10.839], "episode_lengths": [43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31, 44, 44, 106, 54, 39, 43, 44, 48, 43, 40, 53, 63, 60, 64, 62, 60, 59, 68, 56, 68, 80, 61, 43, 45, 46, 53, 67, 78, 56, 58, 38, 44, 49, 68, 78, 33, 50, 55, 52, 56, 65, 38, 53, 39, 48, 114, 52, 37, 47, 45, 49, 43, 65, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5636521648781389, "mean_inference_ms": 1.2772704745206331, "mean_action_processing_ms": 0.08847805051737953, "mean_env_wait_ms": 5.171053141744044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005452871322631836, "ViewRequirementAgentConnector_ms": 0.32561707496643066}}, "episode_reward_max": 24.791000000000007, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 14.067279999999998, "episode_len_mean": 53.34, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.07, 13.404, 13.299, 12.45, 13.206999999999999, 13.042, 14.993000000000002, 15.177000000000001, 14.076, 11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001, 12.487000000000002, 12.003, 22.347, 14.482000000000003, 12.136000000000001, 12.983, 12.364, 13.504000000000001, 12.076, 11.64, 13.926000000000002, 15.991999999999997, 15.619, 16.671999999999997, 15.666000000000004, 16.424000000000003, 15.933000000000002, 16.11, 12.71, 15.884000000000002, 19.678, 16.223000000000003, 11.155999999999999, 13.095, 12.893, 14.263, 15.790999999999997, 19.523000000000003, 13.703, 13.866999999999999, 11.631, 12.793, 13.924, 16.216, 18.416, 10.563, 13.533, 14.38, 14.053, 14.788, 16.306, 11.907, 14.673, 11.639000000000001, 13.931, 24.791000000000007, 14.378, 11.503000000000002, 12.083, 12.587000000000002, 12.213999999999999, 11.668000000000001, 16.582, 10.839], "episode_lengths": [43, 47, 56, 40, 46, 46, 55, 66, 56, 45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31, 44, 44, 106, 54, 39, 43, 44, 48, 43, 40, 53, 63, 60, 64, 62, 60, 59, 68, 56, 68, 80, 61, 43, 45, 46, 53, 67, 78, 56, 58, 38, 44, 49, 68, 78, 33, 50, 55, 52, 56, 65, 38, 53, 39, 48, 114, 52, 37, 47, 45, 49, 43, 65, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5636521648781389, "mean_inference_ms": 1.2772704745206331, "mean_action_processing_ms": 0.08847805051737953, "mean_env_wait_ms": 5.171053141744044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.005452871322631836, "ViewRequirementAgentConnector_ms": 0.32561707496643066}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41470, "num_agent_steps_trained": 0, "num_env_steps_sampled": 41472, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.499953054497831, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 41472, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 41470, "timers": {"training_iteration_time_ms": 126701.39, "sample_time_ms": 4592.048, "synch_weights_time_ms": 75.137}, "counters": {"num_env_steps_sampled": 41472, "num_env_steps_trained": 0, "num_agent_steps_sampled": 41470, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 773, "training_iteration": 81, "trial_id": "default", "date": "2025-12-19_19-16-45", "timestamp": 1766143005, "time_this_iter_s": 113.78256320953369, "time_total_s": 7102.241117715836, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7102.241117715836, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 96.09753086419752, "ram_util_percent": 31.364814814814817}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.5652758240699768}, "default_policy": {"total_loss": 0.5652758240699768, "policy_loss": -0.037661001761443914, "vf_loss": 2.4135059513151647, "vf_loss_unclipped": 9.296864054352046, "vf_explained_var": 0.02458520531654358, "entropy": 0.6893619172275066, "mean_kl_loss": 0.009987749801587143, "gradients_default_optimizer_global_norm": 1.397299287840724, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 41984, "num_env_steps_trained": 0, "num_agent_steps_sampled": 41982, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 24.791000000000007, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 14.291220000000001, "episode_len_mean": 54.58, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001, 12.487000000000002, 12.003, 22.347, 14.482000000000003, 12.136000000000001, 12.983, 12.364, 13.504000000000001, 12.076, 11.64, 13.926000000000002, 15.991999999999997, 15.619, 16.671999999999997, 15.666000000000004, 16.424000000000003, 15.933000000000002, 16.11, 12.71, 15.884000000000002, 19.678, 16.223000000000003, 11.155999999999999, 13.095, 12.893, 14.263, 15.790999999999997, 19.523000000000003, 13.703, 13.866999999999999, 11.631, 12.793, 13.924, 16.216, 18.416, 10.563, 13.533, 14.38, 14.053, 14.788, 16.306, 11.907, 14.673, 11.639000000000001, 13.931, 24.791000000000007, 14.378, 11.503000000000002, 12.083, 12.587000000000002, 12.213999999999999, 11.668000000000001, 16.582, 10.839, 16.791, 13.253, 16.044, 12.359, 17.453, 21.307999999999996, 16.840999999999998, 13.654, 17.409], "episode_lengths": [45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31, 44, 44, 106, 54, 39, 43, 44, 48, 43, 40, 53, 63, 60, 64, 62, 60, 59, 68, 56, 68, 80, 61, 43, 45, 46, 53, 67, 78, 56, 58, 38, 44, 49, 68, 78, 33, 50, 55, 52, 56, 65, 38, 53, 39, 48, 114, 52, 37, 47, 45, 49, 43, 65, 37, 71, 53, 65, 42, 72, 90, 66, 51, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5656557460707151, "mean_inference_ms": 1.2838146206446939, "mean_action_processing_ms": 0.08885002082466213, "mean_env_wait_ms": 5.185193225356724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0052988529205322266, "ViewRequirementAgentConnector_ms": 0.3215363025665283}}, "episode_reward_max": 24.791000000000007, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 14.291220000000001, "episode_len_mean": 54.58, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.795, 16.902, 11.722, 16.262999999999998, 16.624, 12.24, 16.457, 13.53, 13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001, 12.487000000000002, 12.003, 22.347, 14.482000000000003, 12.136000000000001, 12.983, 12.364, 13.504000000000001, 12.076, 11.64, 13.926000000000002, 15.991999999999997, 15.619, 16.671999999999997, 15.666000000000004, 16.424000000000003, 15.933000000000002, 16.11, 12.71, 15.884000000000002, 19.678, 16.223000000000003, 11.155999999999999, 13.095, 12.893, 14.263, 15.790999999999997, 19.523000000000003, 13.703, 13.866999999999999, 11.631, 12.793, 13.924, 16.216, 18.416, 10.563, 13.533, 14.38, 14.053, 14.788, 16.306, 11.907, 14.673, 11.639000000000001, 13.931, 24.791000000000007, 14.378, 11.503000000000002, 12.083, 12.587000000000002, 12.213999999999999, 11.668000000000001, 16.582, 10.839, 16.791, 13.253, 16.044, 12.359, 17.453, 21.307999999999996, 16.840999999999998, 13.654, 17.409], "episode_lengths": [45, 66, 37, 63, 66, 39, 75, 50, 50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31, 44, 44, 106, 54, 39, 43, 44, 48, 43, 40, 53, 63, 60, 64, 62, 60, 59, 68, 56, 68, 80, 61, 43, 45, 46, 53, 67, 78, 56, 58, 38, 44, 49, 68, 78, 33, 50, 55, 52, 56, 65, 38, 53, 39, 48, 114, 52, 37, 47, 45, 49, 43, 65, 37, 71, 53, 65, 42, 72, 90, 66, 51, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5656557460707151, "mean_inference_ms": 1.2838146206446939, "mean_action_processing_ms": 0.08885002082466213, "mean_env_wait_ms": 5.185193225356724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0052988529205322266, "ViewRequirementAgentConnector_ms": 0.3215363025665283}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41982, "num_agent_steps_trained": 0, "num_env_steps_sampled": 41984, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 5.161151974046911, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 41984, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 41982, "timers": {"training_iteration_time_ms": 124250.461, "sample_time_ms": 4582.627, "synch_weights_time_ms": 75.731}, "counters": {"num_env_steps_sampled": 41984, "num_env_steps_trained": 0, "num_agent_steps_sampled": 41982, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 782, "training_iteration": 82, "trial_id": "default", "date": "2025-12-19_19-18-28", "timestamp": 1766143108, "time_this_iter_s": 99.2054967880249, "time_total_s": 7201.4466145038605, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7201.4466145038605, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 95.61232876712327, "ram_util_percent": 24.748630136986304}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 512.0, "total_loss": 0.5125762227457017}, "default_policy": {"total_loss": 0.5125762227457017, "policy_loss": -0.03619956250768155, "vf_loss": 2.19685758985579, "vf_loss_unclipped": 8.393945434316993, "vf_explained_var": 0.020447445660829545, "entropy": 0.6578311450779438, "mean_kl_loss": 0.008768163023629382, "gradients_default_optimizer_global_norm": 1.462673920765519, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 42496, "num_env_steps_trained": 0, "num_agent_steps_sampled": 42494, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 24.791000000000007, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 14.371490000000005, "episode_len_mean": 55.07, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001, 12.487000000000002, 12.003, 22.347, 14.482000000000003, 12.136000000000001, 12.983, 12.364, 13.504000000000001, 12.076, 11.64, 13.926000000000002, 15.991999999999997, 15.619, 16.671999999999997, 15.666000000000004, 16.424000000000003, 15.933000000000002, 16.11, 12.71, 15.884000000000002, 19.678, 16.223000000000003, 11.155999999999999, 13.095, 12.893, 14.263, 15.790999999999997, 19.523000000000003, 13.703, 13.866999999999999, 11.631, 12.793, 13.924, 16.216, 18.416, 10.563, 13.533, 14.38, 14.053, 14.788, 16.306, 11.907, 14.673, 11.639000000000001, 13.931, 24.791000000000007, 14.378, 11.503000000000002, 12.083, 12.587000000000002, 12.213999999999999, 11.668000000000001, 16.582, 10.839, 16.791, 13.253, 16.044, 12.359, 17.453, 21.307999999999996, 16.840999999999998, 13.654, 17.409, 17.216, 16.740000000000002, 21.340999999999998, 15.794, 11.958000000000002, 13.142, 12.987, 14.382000000000001], "episode_lengths": [50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31, 44, 44, 106, 54, 39, 43, 44, 48, 43, 40, 53, 63, 60, 64, 62, 60, 59, 68, 56, 68, 80, 61, 43, 45, 46, 53, 67, 78, 56, 58, 38, 44, 49, 68, 78, 33, 50, 55, 52, 56, 65, 38, 53, 39, 48, 114, 52, 37, 47, 45, 49, 43, 65, 37, 71, 53, 65, 42, 72, 90, 66, 51, 69, 68, 73, 94, 65, 41, 52, 44, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5672000987217863, "mean_inference_ms": 1.288821211421112, "mean_action_processing_ms": 0.08913446430023683, "mean_env_wait_ms": 5.196230013969383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00520634651184082, "ViewRequirementAgentConnector_ms": 0.3170294761657715}}, "episode_reward_max": 24.791000000000007, "episode_reward_min": 10.354000000000001, "episode_reward_mean": 14.371490000000005, "episode_len_mean": 55.07, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.733000000000002, 13.618, 16.005, 13.672999999999998, 15.280000000000001, 11.945, 13.312, 14.774999999999999, 11.854, 13.462000000000002, 13.903, 16.045, 12.367999999999999, 12.610000000000001, 12.463999999999999, 12.037, 13.829999999999998, 14.905000000000001, 10.546000000000001, 16.152, 12.434000000000001, 14.434000000000001, 13.651, 10.908000000000001, 14.859000000000002, 11.935, 16.961000000000006, 13.876000000000001, 10.354000000000001, 12.487000000000002, 12.003, 22.347, 14.482000000000003, 12.136000000000001, 12.983, 12.364, 13.504000000000001, 12.076, 11.64, 13.926000000000002, 15.991999999999997, 15.619, 16.671999999999997, 15.666000000000004, 16.424000000000003, 15.933000000000002, 16.11, 12.71, 15.884000000000002, 19.678, 16.223000000000003, 11.155999999999999, 13.095, 12.893, 14.263, 15.790999999999997, 19.523000000000003, 13.703, 13.866999999999999, 11.631, 12.793, 13.924, 16.216, 18.416, 10.563, 13.533, 14.38, 14.053, 14.788, 16.306, 11.907, 14.673, 11.639000000000001, 13.931, 24.791000000000007, 14.378, 11.503000000000002, 12.083, 12.587000000000002, 12.213999999999999, 11.668000000000001, 16.582, 10.839, 16.791, 13.253, 16.044, 12.359, 17.453, 21.307999999999996, 16.840999999999998, 13.654, 17.409, 17.216, 16.740000000000002, 21.340999999999998, 15.794, 11.958000000000002, 13.142, 12.987, 14.382000000000001], "episode_lengths": [50, 48, 65, 53, 57, 42, 48, 53, 41, 55, 53, 67, 42, 50, 46, 39, 50, 57, 41, 63, 50, 63, 50, 37, 61, 41, 72, 53, 31, 44, 44, 106, 54, 39, 43, 44, 48, 43, 40, 53, 63, 60, 64, 62, 60, 59, 68, 56, 68, 80, 61, 43, 45, 46, 53, 67, 78, 56, 58, 38, 44, 49, 68, 78, 33, 50, 55, 52, 56, 65, 38, 53, 39, 48, 114, 52, 37, 47, 45, 49, 43, 65, 37, 71, 53, 65, 42, 72, 90, 66, 51, 69, 68, 73, 94, 65, 41, 52, 44, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5672000987217863, "mean_inference_ms": 1.288821211421112, "mean_action_processing_ms": 0.08913446430023683, "mean_env_wait_ms": 5.196230013969383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00520634651184082, "ViewRequirementAgentConnector_ms": 0.3170294761657715}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42494, "num_agent_steps_trained": 0, "num_env_steps_sampled": 42496, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.637580976438652, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 42496, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 42494, "timers": {"training_iteration_time_ms": 119469.966, "sample_time_ms": 4499.814, "synch_weights_time_ms": 74.744}, "counters": {"num_env_steps_sampled": 42496, "num_env_steps_trained": 0, "num_agent_steps_sampled": 42494, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 790, "training_iteration": 83, "trial_id": "default", "date": "2025-12-19_19-19-45", "timestamp": 1766143185, "time_this_iter_s": 77.13917684555054, "time_total_s": 7278.585791349411, "pid": 290684, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 512, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71b8ab2f1a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x71b8a9eb32e0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7278.585791349411, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 95.34000000000002, "ram_util_percent": 22.07363636363638}}
