{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1022.0, "total_loss": 0.024285078600223643}, "default_policy": {"total_loss": 0.024285078600223643, "policy_loss": -0.004260344686917961, "vf_loss": 0.123150497849565, "vf_loss_unclipped": 0.123150497849565, "vf_explained_var": -0.06130587942898273, "entropy": 2.255395207554102, "mean_kl_loss": 6.595229498027322e-05, "gradients_default_optimizer_global_norm": 0.24228258007206022, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1022, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.242000000000003, "episode_reward_min": 2.724, "episode_reward_mean": 7.771750000000003, "episode_len_mean": 223.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003], "episode_lengths": [226, 228, 220, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43861280407821923, "mean_inference_ms": 1.1793017155013352, "mean_action_processing_ms": 0.08384921165005273, "mean_env_wait_ms": 5.088044886003461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003546476364135742, "ViewRequirementAgentConnector_ms": 0.2521932125091553}}, "episode_reward_max": 12.242000000000003, "episode_reward_min": 2.724, "episode_reward_mean": 7.771750000000003, "episode_len_mean": 223.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003], "episode_lengths": [226, 228, 220, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43861280407821923, "mean_inference_ms": 1.1793017155013352, "mean_action_processing_ms": 0.08384921165005273, "mean_env_wait_ms": 5.088044886003461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003546476364135742, "ViewRequirementAgentConnector_ms": 0.2521932125091553}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1022, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.871885914586908, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1024, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1022, "timers": {"training_iteration_time_ms": 149012.868, "sample_time_ms": 6993.005, "synch_weights_time_ms": 56.57}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1022, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 1, "trial_id": "default", "date": "2025-12-19_19-29-05", "timestamp": 1766143745, "time_this_iter_s": 149.0149998664856, "time_total_s": 149.0149998664856, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 149.0149998664856, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 94.35943396226413, "ram_util_percent": 20.569811320754717}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.005505589745007455}, "default_policy": {"total_loss": 0.005505589745007455, "policy_loss": -0.005783084942959249, "vf_loss": 0.05401688125675719, "vf_loss_unclipped": 0.05401688125675719, "vf_explained_var": -0.3636550072580576, "entropy": 2.2214250952005385, "mean_kl_loss": 5.879828605428461e-05, "gradients_default_optimizer_global_norm": 0.20216789469122887, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2046, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.242000000000003, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 6.105000000000002, "episode_len_mean": 224.75, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4365685886942937, "mean_inference_ms": 1.1689538665047465, "mean_action_processing_ms": 0.08293079875343362, "mean_env_wait_ms": 5.078854757748866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033527612686157227, "ViewRequirementAgentConnector_ms": 0.24212002754211426}}, "episode_reward_max": 12.242000000000003, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 6.105000000000002, "episode_len_mean": 224.75, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4365685886942937, "mean_inference_ms": 1.1689538665047465, "mean_action_processing_ms": 0.08293079875343362, "mean_env_wait_ms": 5.078854757748866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033527612686157227, "ViewRequirementAgentConnector_ms": 0.24212002754211426}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2046, "num_agent_steps_trained": 0, "num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.978114221808245, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 2048, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2046, "timers": {"training_iteration_time_ms": 147878.647, "sample_time_ms": 6940.782, "synch_weights_time_ms": 53.99}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2046, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 2, "trial_id": "default", "date": "2025-12-19_19-31-40", "timestamp": 1766143900, "time_this_iter_s": 146.74937105178833, "time_total_s": 295.7643709182739, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 295.7643709182739, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 89.83846153846152, "ram_util_percent": 21.127149321266963}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.01745788278058171}, "default_policy": {"total_loss": 0.01745788278058171, "policy_loss": -0.008299950463697314, "vf_loss": 0.11188686023415358, "vf_loss_unclipped": 0.11188686023415358, "vf_explained_var": -0.09432248473167419, "entropy": 2.222610852122307, "mean_kl_loss": 0.00017450043352538192, "gradients_default_optimizer_global_norm": 0.2891769973561168, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3070, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.242000000000003, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 6.2345000000000015, "episode_len_mean": 227.41666666666666, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4355899495724958, "mean_inference_ms": 1.1637340255512743, "mean_action_processing_ms": 0.08241745993845088, "mean_env_wait_ms": 5.0717501638586535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033020973205566406, "ViewRequirementAgentConnector_ms": 0.23897290229797363}}, "episode_reward_max": 12.242000000000003, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 6.2345000000000015, "episode_len_mean": 227.41666666666666, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4355899495724958, "mean_inference_ms": 1.1637340255512743, "mean_action_processing_ms": 0.08241745993845088, "mean_env_wait_ms": 5.0717501638586535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033020973205566406, "ViewRequirementAgentConnector_ms": 0.23897290229797363}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3070, "num_agent_steps_trained": 0, "num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.921152483184033, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 3072, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3070, "timers": {"training_iteration_time_ms": 147903.161, "sample_time_ms": 6919.222, "synch_weights_time_ms": 53.98}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3070, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 3, "trial_id": "default", "date": "2025-12-19_19-34-08", "timestamp": 1766144048, "time_this_iter_s": 147.95396757125854, "time_total_s": 443.71833848953247, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 443.71833848953247, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 94.80521327014219, "ram_util_percent": 20.676777251184834}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.01315214847563766}, "default_policy": {"total_loss": 0.01315214847563766, "policy_loss": -0.010411634901538491, "vf_loss": 0.10291454429097939, "vf_loss_unclipped": 0.10291454429097939, "vf_explained_var": 0.10777335092425347, "entropy": 2.1722663059830665, "mean_kl_loss": 0.00029635860186498774, "gradients_default_optimizer_global_norm": 0.31228399323299527, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.012500000186264515}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4094, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.540000000000004, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 6.691062500000003, "episode_len_mean": 227.375, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4351136164668861, "mean_inference_ms": 1.1605605737224516, "mean_action_processing_ms": 0.082093233535553, "mean_env_wait_ms": 5.067671183364899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033468008041381836, "ViewRequirementAgentConnector_ms": 0.23950785398483276}}, "episode_reward_max": 12.540000000000004, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 6.691062500000003, "episode_len_mean": 227.375, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4351136164668861, "mean_inference_ms": 1.1605605737224516, "mean_action_processing_ms": 0.082093233535553, "mean_env_wait_ms": 5.067671183364899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033468008041381836, "ViewRequirementAgentConnector_ms": 0.23950785398483276}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4094, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.944549651265263, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4096, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4094, "timers": {"training_iteration_time_ms": 147790.804, "sample_time_ms": 6912.638, "synch_weights_time_ms": 51.287}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4094, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 4, "trial_id": "default", "date": "2025-12-19_19-36-36", "timestamp": 1766144196, "time_this_iter_s": 147.45554065704346, "time_total_s": 591.1738791465759, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 591.1738791465759, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 94.69761904761904, "ram_util_percent": 20.835714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.007512139325262979}, "default_policy": {"total_loss": 0.007512139325262979, "policy_loss": -0.011015408637467772, "vf_loss": 0.08276375626737717, "vf_loss_unclipped": 0.08276375626737717, "vf_explained_var": -0.03045533560216427, "entropy": 2.166923077404499, "mean_kl_loss": 0.00028262962538189715, "gradients_default_optimizer_global_norm": 0.3378185423091054, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.0062500000931322575}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5118, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.540000000000004, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 6.851000000000003, "episode_len_mean": 229.27272727272728, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4354761475936082, "mean_inference_ms": 1.15765567679261, "mean_action_processing_ms": 0.08176765501631744, "mean_env_wait_ms": 5.063677271799301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033877112648703837, "ViewRequirementAgentConnector_ms": 0.24057084863836115}}, "episode_reward_max": 12.540000000000004, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 6.851000000000003, "episode_len_mean": 229.27272727272728, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4354761475936082, "mean_inference_ms": 1.15765567679261, "mean_action_processing_ms": 0.08176765501631744, "mean_env_wait_ms": 5.063677271799301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033877112648703837, "ViewRequirementAgentConnector_ms": 0.24057084863836115}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5118, "num_agent_steps_trained": 0, "num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.0788263743915945, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 5120, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 5118, "timers": {"training_iteration_time_ms": 147163.984, "sample_time_ms": 6910.111, "synch_weights_time_ms": 51.868}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5118, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 5, "trial_id": "default", "date": "2025-12-19_19-39-00", "timestamp": 1766144340, "time_this_iter_s": 144.65864181518555, "time_total_s": 735.8325209617615, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 735.8325209617615, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 94.71747572815535, "ram_util_percent": 21.27572815533981}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.06563001063186676}, "default_policy": {"total_loss": 0.06563001063186676, "policy_loss": -0.008763347985222936, "vf_loss": 0.306285281208693, "vf_loss_unclipped": 0.5938725215470185, "vf_explained_var": 0.05029037408530712, "entropy": 2.179600124061108, "mean_kl_loss": 0.0002619754045879219, "gradients_default_optimizer_global_norm": 0.392270544404164, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.0031250000465661287}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6142, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.163000000000004, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 7.211769230769232, "episode_len_mean": 228.73076923076923, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43564626209769497, "mean_inference_ms": 1.1565028374056037, "mean_action_processing_ms": 0.08163099005513894, "mean_env_wait_ms": 5.061925851728597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033690379216120793, "ViewRequirementAgentConnector_ms": 0.24116130975576547}}, "episode_reward_max": 17.163000000000004, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 7.211769230769232, "episode_len_mean": 228.73076923076923, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43564626209769497, "mean_inference_ms": 1.1565028374056037, "mean_action_processing_ms": 0.08163099005513894, "mean_env_wait_ms": 5.061925851728597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033690379216120793, "ViewRequirementAgentConnector_ms": 0.24116130975576547}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6142, "num_agent_steps_trained": 0, "num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.977194556475794, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 6144, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 6142, "timers": {"training_iteration_time_ms": 147097.29, "sample_time_ms": 6909.603, "synch_weights_time_ms": 51.279}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6142, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 6, "trial_id": "default", "date": "2025-12-19_19-41-27", "timestamp": 1766144487, "time_this_iter_s": 146.7656946182251, "time_total_s": 882.5982155799866, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 882.5982155799866, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 94.66778846153846, "ram_util_percent": 20.434134615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.1202636849571718}, "default_policy": {"total_loss": 0.1202636849571718, "policy_loss": -0.011360130598768592, "vf_loss": 0.5351349787553772, "vf_loss_unclipped": 1.045445985510014, "vf_explained_var": 0.10166537761688232, "entropy": 2.1614514753222465, "mean_kl_loss": 0.0004872184254559375, "gradients_default_optimizer_global_norm": 0.5258591538760811, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.0015625000232830644}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7166, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.163000000000004, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 8.081193548387098, "episode_len_mean": 225.03225806451613, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43605525178748505, "mean_inference_ms": 1.1556532077489248, "mean_action_processing_ms": 0.08152329677466649, "mean_env_wait_ms": 5.0600875174421684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033317073698966733, "ViewRequirementAgentConnector_ms": 0.23961913201116747}}, "episode_reward_max": 17.163000000000004, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 8.081193548387098, "episode_len_mean": 225.03225806451613, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43605525178748505, "mean_inference_ms": 1.1556532077489248, "mean_action_processing_ms": 0.08152329677466649, "mean_env_wait_ms": 5.0600875174421684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033317073698966733, "ViewRequirementAgentConnector_ms": 0.23961913201116747}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7166, "num_agent_steps_trained": 0, "num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.078814170633364, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 7168, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 7166, "timers": {"training_iteration_time_ms": 146748.667, "sample_time_ms": 6902.375, "synch_weights_time_ms": 52.292}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7166, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 31, "training_iteration": 7, "trial_id": "default", "date": "2025-12-19_19-44-00", "timestamp": 1766144640, "time_this_iter_s": 144.65913081169128, "time_total_s": 1027.2573463916779, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1027.2573463916779, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 89.80183486238532, "ram_util_percent": 21.059633027522935}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.0014948568525142037}, "default_policy": {"total_loss": 0.0014948568525142037, "policy_loss": -0.01875534190912731, "vf_loss": 0.0896774934255518, "vf_loss_unclipped": 0.0896774934255518, "vf_explained_var": 0.16490019224584102, "entropy": 2.170741330832243, "mean_kl_loss": 0.0010044431405631827, "gradients_default_optimizer_global_norm": 0.46042453730478883, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.0007812500116415322}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8190, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.163000000000004, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 8.180472222222226, "episode_len_mean": 225.52777777777777, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43607425735726835, "mean_inference_ms": 1.1543431236492854, "mean_action_processing_ms": 0.08140097488275855, "mean_env_wait_ms": 5.057936259398565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033034218682183158, "ViewRequirementAgentConnector_ms": 0.23863249354892307}}, "episode_reward_max": 17.163000000000004, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 8.180472222222226, "episode_len_mean": 225.52777777777777, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43607425735726835, "mean_inference_ms": 1.1543431236492854, "mean_action_processing_ms": 0.08140097488275855, "mean_env_wait_ms": 5.057936259398565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033034218682183158, "ViewRequirementAgentConnector_ms": 0.23863249354892307}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8190, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.897695125091449, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8192, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 8190, "timers": {"training_iteration_time_ms": 146962.002, "sample_time_ms": 6905.063, "synch_weights_time_ms": 50.993}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8190, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 36, "training_iteration": 8, "trial_id": "default", "date": "2025-12-19_19-46-29", "timestamp": 1766144789, "time_this_iter_s": 148.45749831199646, "time_total_s": 1175.7148447036743, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1175.7148447036743, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 94.85377358490567, "ram_util_percent": 20.985377358490563}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.09143691356584896}, "default_policy": {"total_loss": 0.09143691356584896, "policy_loss": -0.015003539645113051, "vf_loss": 0.43402269468642773, "vf_loss_unclipped": 0.6098368091974408, "vf_explained_var": 0.3609398741275072, "entropy": 2.066451983898878, "mean_kl_loss": 0.0015842482407924408, "gradients_default_optimizer_global_norm": 0.7937081245705485, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.0003906250058207661}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9214, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 25.226999999999986, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 9.168975000000001, "episode_len_mean": 223.95, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4362230992419834, "mean_inference_ms": 1.1562699662937763, "mean_action_processing_ms": 0.08134432766882704, "mean_env_wait_ms": 5.05700605340842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003319382667541504, "ViewRequirementAgentConnector_ms": 0.2395111322402954}}, "episode_reward_max": 25.226999999999986, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 9.168975000000001, "episode_len_mean": 223.95, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4362230992419834, "mean_inference_ms": 1.1562699662937763, "mean_action_processing_ms": 0.08134432766882704, "mean_env_wait_ms": 5.05700605340842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003319382667541504, "ViewRequirementAgentConnector_ms": 0.2395111322402954}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9214, "num_agent_steps_trained": 0, "num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.887612716700519, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 9216, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 9214, "timers": {"training_iteration_time_ms": 147152.074, "sample_time_ms": 6929.875, "synch_weights_time_ms": 50.915}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9214, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 40, "training_iteration": 9, "trial_id": "default", "date": "2025-12-19_19-48-58", "timestamp": 1766144938, "time_this_iter_s": 148.67702198028564, "time_total_s": 1324.39186668396, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1324.39186668396, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 94.78056872037914, "ram_util_percent": 20.975355450236965}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.2998980171578296}, "default_policy": {"total_loss": 0.2998980171578296, "policy_loss": -0.015814147738274185, "vf_loss": 1.2711901811300776, "vf_loss_unclipped": 1.9972792880027554, "vf_explained_var": 0.2957995567470789, "entropy": 2.085805045813322, "mean_kl_loss": 0.0010829953259367641, "gradients_default_optimizer_global_norm": 1.1634815779514611, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.00019531250291038305}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10238, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 26.11500000000001, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 10.401148936170214, "episode_len_mean": 216.06382978723406, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4365134015350729, "mean_inference_ms": 1.157773366864484, "mean_action_processing_ms": 0.08125184337896955, "mean_env_wait_ms": 5.0546677204805395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003296263674472241, "ViewRequirementAgentConnector_ms": 0.23907093291587017}}, "episode_reward_max": 26.11500000000001, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 10.401148936170214, "episode_len_mean": 216.06382978723406, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4365134015350729, "mean_inference_ms": 1.157773366864484, "mean_action_processing_ms": 0.08125184337896955, "mean_env_wait_ms": 5.0546677204805395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003296263674472241, "ViewRequirementAgentConnector_ms": 0.23907093291587017}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10238, "num_agent_steps_trained": 0, "num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.047023069085594, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 10240, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 10238, "timers": {"training_iteration_time_ms": 146967.821, "sample_time_ms": 6924.782, "synch_weights_time_ms": 52.231}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10238, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 47, "training_iteration": 10, "trial_id": "default", "date": "2025-12-19_19-51-23", "timestamp": 1766145083, "time_this_iter_s": 145.3123197555542, "time_total_s": 1469.7041864395142, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1469.7041864395142, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 94.71014492753623, "ram_util_percent": 21.11690821256039}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.3220622056074717}, "default_policy": {"total_loss": 0.3220622056074717, "policy_loss": -0.015435309219174086, "vf_loss": 1.3583450075238943, "vf_loss_unclipped": 2.04456770606339, "vf_explained_var": 0.2245552022010088, "entropy": 2.089055821299553, "mean_kl_loss": 0.0016445796775827804, "gradients_default_optimizer_global_norm": 1.081128259934485, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 9.765625145519152e-05}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11262, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.500999999999994, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 11.342222222222222, "episode_len_mean": 206.16666666666666, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43702584427453467, "mean_inference_ms": 1.1597882860044444, "mean_action_processing_ms": 0.08120857987634078, "mean_env_wait_ms": 5.053256947557769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003280904557969835, "ViewRequirementAgentConnector_ms": 0.2387139532301161}}, "episode_reward_max": 28.500999999999994, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 11.342222222222222, "episode_len_mean": 206.16666666666666, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43702584427453467, "mean_inference_ms": 1.1597882860044444, "mean_action_processing_ms": 0.08120857987634078, "mean_env_wait_ms": 5.053256947557769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003280904557969835, "ViewRequirementAgentConnector_ms": 0.2387139532301161}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11262, "num_agent_steps_trained": 0, "num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.896833711793609, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 11264, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 11262, "timers": {"training_iteration_time_ms": 146913.923, "sample_time_ms": 6910.989, "synch_weights_time_ms": 51.527}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11262, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 54, "training_iteration": 11, "trial_id": "default", "date": "2025-12-19_19-53-52", "timestamp": 1766145232, "time_this_iter_s": 148.47606325149536, "time_total_s": 1618.1802496910095, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1618.1802496910095, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 94.73744075829383, "ram_util_percent": 20.756872037914697}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.36955618673018764}, "default_policy": {"total_loss": 0.36955618673018764, "policy_loss": -0.01852965753059834, "vf_loss": 1.5605128875002265, "vf_loss_unclipped": 2.1772933250293134, "vf_explained_var": 0.048365456610918046, "entropy": 2.0425510078668596, "mean_kl_loss": 0.0018399866869622916, "gradients_default_optimizer_global_norm": 1.6683124160394072, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 4.882812572759576e-05}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12286, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.500999999999994, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 12.081666666666672, "episode_len_mean": 199.81666666666666, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43726018792805027, "mean_inference_ms": 1.1603648377790419, "mean_action_processing_ms": 0.08115311396931325, "mean_env_wait_ms": 5.051420985350306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.23816426595052084}}, "episode_reward_max": 28.500999999999994, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 12.081666666666672, "episode_len_mean": 199.81666666666666, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43726018792805027, "mean_inference_ms": 1.1603648377790419, "mean_action_processing_ms": 0.08115311396931325, "mean_env_wait_ms": 5.051420985350306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032663345336914062, "ViewRequirementAgentConnector_ms": 0.23816426595052084}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12286, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.853411968486409, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12288, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 12286, "timers": {"training_iteration_time_ms": 147180.939, "sample_time_ms": 6902.042, "synch_weights_time_ms": 51.91}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12286, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 60, "training_iteration": 12, "trial_id": "default", "date": "2025-12-19_19-56-30", "timestamp": 1766145390, "time_this_iter_s": 149.4171895980835, "time_total_s": 1767.597439289093, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1767.597439289093, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 90.16933333333333, "ram_util_percent": 21.282666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.4167572935806675}, "default_policy": {"total_loss": 0.4167572935806675, "policy_loss": -0.018457217724062502, "vf_loss": 1.7489171443507074, "vf_loss_unclipped": 2.4981653014197946, "vf_explained_var": 0.20022292211651802, "entropy": 2.014872492104769, "mean_kl_loss": 0.0019322372235694551, "gradients_default_optimizer_global_norm": 1.3830398256890475, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 2.441406286379788e-05}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13310, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 36.74200000000001, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 13.183411764705886, "episode_len_mean": 194.3235294117647, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437, 21.644, 14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119, 193, 105, 102, 145, 68, 214, 214, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43777912908970157, "mean_inference_ms": 1.1641646998895296, "mean_action_processing_ms": 0.08111632303094274, "mean_env_wait_ms": 5.050039251445085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032551148358513325, "ViewRequirementAgentConnector_ms": 0.23744036169613109}}, "episode_reward_max": 36.74200000000001, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 13.183411764705886, "episode_len_mean": 194.3235294117647, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437, 21.644, 14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119, 193, 105, 102, 145, 68, 214, 214, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43777912908970157, "mean_inference_ms": 1.1641646998895296, "mean_action_processing_ms": 0.08111632303094274, "mean_env_wait_ms": 5.050039251445085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032551148358513325, "ViewRequirementAgentConnector_ms": 0.23744036169613109}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13310, "num_agent_steps_trained": 0, "num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.961511788777041, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 13312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 13310, "timers": {"training_iteration_time_ms": 147095.164, "sample_time_ms": 6925.925, "synch_weights_time_ms": 51.73}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13310, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 68, "training_iteration": 13, "trial_id": "default", "date": "2025-12-19_19-58-57", "timestamp": 1766145537, "time_this_iter_s": 147.0975694656372, "time_total_s": 1914.6950087547302, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1914.6950087547302, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 94.64593301435407, "ram_util_percent": 20.492822966507177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5584389715284488}, "default_policy": {"total_loss": 0.5584389715284488, "policy_loss": -0.014561491552740335, "vf_loss": 2.2998053724411873, "vf_loss_unclipped": 3.3981070483569056, "vf_explained_var": 0.22703649029135703, "entropy": 1.950922466814518, "mean_kl_loss": 0.0017000481334358496, "gradients_default_optimizer_global_norm": 1.5277206383645534, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.220703143189894e-05}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14334, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 36.74200000000001, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 13.541518987341771, "episode_len_mean": 179.9367088607595, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437, 21.644, 14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991, 14.468, 14.840000000000003, 14.809999999999999, 12.675, 18.182000000000002, 12.928, 15.027000000000001, 19.256, 12.522, 20.798000000000002, 17.802000000000003], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119, 193, 105, 102, 145, 68, 214, 214, 184, 84, 65, 78, 67, 115, 62, 115, 96, 78, 139, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4387321129156877, "mean_inference_ms": 1.1674762434556636, "mean_action_processing_ms": 0.08110346735416032, "mean_env_wait_ms": 5.047929701233015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003256978867929193, "ViewRequirementAgentConnector_ms": 0.23724036880686314}}, "episode_reward_max": 36.74200000000001, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 13.541518987341771, "episode_len_mean": 179.9367088607595, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437, 21.644, 14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991, 14.468, 14.840000000000003, 14.809999999999999, 12.675, 18.182000000000002, 12.928, 15.027000000000001, 19.256, 12.522, 20.798000000000002, 17.802000000000003], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119, 193, 105, 102, 145, 68, 214, 214, 184, 84, 65, 78, 67, 115, 62, 115, 96, 78, 139, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4387321129156877, "mean_inference_ms": 1.1674762434556636, "mean_action_processing_ms": 0.08110346735416032, "mean_env_wait_ms": 5.047929701233015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003256978867929193, "ViewRequirementAgentConnector_ms": 0.23724036880686314}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14334, "num_agent_steps_trained": 0, "num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.9676163798023625, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 14336, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 14334, "timers": {"training_iteration_time_ms": 147046.346, "sample_time_ms": 6937.672, "synch_weights_time_ms": 52.34}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14334, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 79, "training_iteration": 14, "trial_id": "default", "date": "2025-12-19_20-01-24", "timestamp": 1766145684, "time_this_iter_s": 146.97073602676392, "time_total_s": 2061.665744781494, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2061.665744781494, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 94.70904761904762, "ram_util_percent": 21.19}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5069824701175094}, "default_policy": {"total_loss": 0.5069824701175094, "policy_loss": -0.013416797434911133, "vf_loss": 2.0893618101254106, "vf_loss_unclipped": 3.171933972090483, "vf_explained_var": 0.1589444510638714, "entropy": 1.941193637996912, "mean_kl_loss": 0.0013752805793647127, "gradients_default_optimizer_global_norm": 2.1790264040231704, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 6.10351571594947e-06}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15358, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 36.74200000000001, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 13.96561797752809, "episode_len_mean": 171.61797752808988, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437, 21.644, 14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991, 14.468, 14.840000000000003, 14.809999999999999, 12.675, 18.182000000000002, 12.928, 15.027000000000001, 19.256, 12.522, 20.798000000000002, 17.802000000000003, 19.255000000000003, 17.982000000000003, 19.669000000000004, 19.775000000000002, 13.947000000000001, 18.422000000000004, 13.786999999999999, 15.063000000000002, 14.617, 20.643], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119, 193, 105, 102, 145, 68, 214, 214, 184, 84, 65, 78, 67, 115, 62, 115, 96, 78, 139, 102, 130, 96, 97, 140, 73, 100, 87, 107, 99, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.439653696182723, "mean_inference_ms": 1.169372774863204, "mean_action_processing_ms": 0.08110449020492962, "mean_env_wait_ms": 5.046446362405556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003252940231494689, "ViewRequirementAgentConnector_ms": 0.23799558703819018}}, "episode_reward_max": 36.74200000000001, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 13.96561797752809, "episode_len_mean": 171.61797752808988, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437, 21.644, 14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991, 14.468, 14.840000000000003, 14.809999999999999, 12.675, 18.182000000000002, 12.928, 15.027000000000001, 19.256, 12.522, 20.798000000000002, 17.802000000000003, 19.255000000000003, 17.982000000000003, 19.669000000000004, 19.775000000000002, 13.947000000000001, 18.422000000000004, 13.786999999999999, 15.063000000000002, 14.617, 20.643], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119, 193, 105, 102, 145, 68, 214, 214, 184, 84, 65, 78, 67, 115, 62, 115, 96, 78, 139, 102, 130, 96, 97, 140, 73, 100, 87, 107, 99, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.439653696182723, "mean_inference_ms": 1.169372774863204, "mean_action_processing_ms": 0.08110449020492962, "mean_env_wait_ms": 5.046446362405556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003252940231494689, "ViewRequirementAgentConnector_ms": 0.23799558703819018}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15358, "num_agent_steps_trained": 0, "num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.035307663889923, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 15360, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 15358, "timers": {"training_iteration_time_ms": 147135.827, "sample_time_ms": 6948.147, "synch_weights_time_ms": 50.849}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15358, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 89, "training_iteration": 15, "trial_id": "default", "date": "2025-12-19_20-03-50", "timestamp": 1766145830, "time_this_iter_s": 145.55390286445618, "time_total_s": 2207.2196476459503, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2207.2196476459503, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 94.59371980676329, "ram_util_percent": 20.818840579710155}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.4818250763732067}, "default_policy": {"total_loss": 0.4818250763732067, "policy_loss": -0.014118058554595336, "vf_loss": 1.9914844402577727, "vf_loss_unclipped": 3.26858164309524, "vf_explained_var": 0.2786897372454405, "entropy": 1.9279811009764671, "mean_kl_loss": 0.0015293964376404735, "gradients_default_optimizer_global_norm": 2.1018587481230497, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 3.051757857974735e-06}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16382, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 36.74200000000001, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 14.258444444444446, "episode_len_mean": 164.04040404040404, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437, 21.644, 14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991, 14.468, 14.840000000000003, 14.809999999999999, 12.675, 18.182000000000002, 12.928, 15.027000000000001, 19.256, 12.522, 20.798000000000002, 17.802000000000003, 19.255000000000003, 17.982000000000003, 19.669000000000004, 19.775000000000002, 13.947000000000001, 18.422000000000004, 13.786999999999999, 15.063000000000002, 14.617, 20.643, 12.861, 17.903, 22.488, 13.242, 15.444, 16.036, 18.529, 15.784000000000002, 20.064999999999998, 16.294000000000004], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119, 193, 105, 102, 145, 68, 214, 214, 184, 84, 65, 78, 67, 115, 62, 115, 96, 78, 139, 102, 130, 96, 97, 140, 73, 100, 87, 107, 99, 130, 60, 94, 149, 81, 77, 111, 97, 91, 126, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44052717038344497, "mean_inference_ms": 1.1706672777990292, "mean_action_processing_ms": 0.08110077553737441, "mean_env_wait_ms": 5.044868423246961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003239602753610322, "ViewRequirementAgentConnector_ms": 0.23742131512574474}}, "episode_reward_max": 36.74200000000001, "episode_reward_min": 1.9999999999999998, "episode_reward_mean": 14.258444444444446, "episode_len_mean": 164.04040404040404, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.16, 2.724, 6.961000000000006, 12.242000000000003, 6.451000000000007, 4.156000000000001, 1.9999999999999998, 5.146000000000002, 9.376000000000001, 7.840000000000007, 4.755000000000001, 4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437, 21.644, 14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991, 14.468, 14.840000000000003, 14.809999999999999, 12.675, 18.182000000000002, 12.928, 15.027000000000001, 19.256, 12.522, 20.798000000000002, 17.802000000000003, 19.255000000000003, 17.982000000000003, 19.669000000000004, 19.775000000000002, 13.947000000000001, 18.422000000000004, 13.786999999999999, 15.063000000000002, 14.617, 20.643, 12.861, 17.903, 22.488, 13.242, 15.444, 16.036, 18.529, 15.784000000000002, 20.064999999999998, 16.294000000000004], "episode_lengths": [226, 228, 220, 218, 225, 223, 223, 235, 228, 229, 235, 239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119, 193, 105, 102, 145, 68, 214, 214, 184, 84, 65, 78, 67, 115, 62, 115, 96, 78, 139, 102, 130, 96, 97, 140, 73, 100, 87, 107, 99, 130, 60, 94, 149, 81, 77, 111, 97, 91, 126, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44052717038344497, "mean_inference_ms": 1.1706672777990292, "mean_action_processing_ms": 0.08110077553737441, "mean_env_wait_ms": 5.044868423246961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003239602753610322, "ViewRequirementAgentConnector_ms": 0.23742131512574474}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16382, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.975345802518541, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16384, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16382, "timers": {"training_iteration_time_ms": 147139.717, "sample_time_ms": 6942.943, "synch_weights_time_ms": 51.17}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16382, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 99, "training_iteration": 16, "trial_id": "default", "date": "2025-12-19_20-06-16", "timestamp": 1766145976, "time_this_iter_s": 146.80530309677124, "time_total_s": 2354.0249507427216, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2354.0249507427216, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 94.80717703349282, "ram_util_percent": 21.040191387559812}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.4937013552349526}, "default_policy": {"total_loss": 0.4937013552349526, "policy_loss": -0.018951052334159613, "vf_loss": 2.0581353655550627, "vf_loss_unclipped": 3.965523630240932, "vf_explained_var": 0.17996973358094692, "entropy": 1.8814315535128117, "mean_kl_loss": 0.0022550812085498696, "gradients_default_optimizer_global_norm": 2.125246847420931, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.5258789289873675e-06}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17406, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 36.74200000000001, "episode_reward_min": 2.4759999999999973, "episode_reward_mean": 15.225760000000001, "episode_len_mean": 147.31, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437, 21.644, 14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991, 14.468, 14.840000000000003, 14.809999999999999, 12.675, 18.182000000000002, 12.928, 15.027000000000001, 19.256, 12.522, 20.798000000000002, 17.802000000000003, 19.255000000000003, 17.982000000000003, 19.669000000000004, 19.775000000000002, 13.947000000000001, 18.422000000000004, 13.786999999999999, 15.063000000000002, 14.617, 20.643, 12.861, 17.903, 22.488, 13.242, 15.444, 16.036, 18.529, 15.784000000000002, 20.064999999999998, 16.294000000000004, 16.196, 13.294, 20.620999999999995, 13.479, 13.101, 22.760000000000005, 13.618000000000002, 12.622, 12.742, 16.719000000000005, 11.737, 14.912], "episode_lengths": [239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119, 193, 105, 102, 145, 68, 214, 214, 184, 84, 65, 78, 67, 115, 62, 115, 96, 78, 139, 102, 130, 96, 97, 140, 73, 100, 87, 107, 99, 130, 60, 94, 149, 81, 77, 111, 97, 91, 126, 80, 74, 82, 103, 60, 60, 125, 97, 63, 59, 85, 92, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44213090487915535, "mean_inference_ms": 1.172206899562685, "mean_action_processing_ms": 0.08092021551904459, "mean_env_wait_ms": 5.039426713694898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032377243041992188, "ViewRequirementAgentConnector_ms": 0.23672747611999512}}, "episode_reward_max": 36.74200000000001, "episode_reward_min": 2.4759999999999973, "episode_reward_mean": 15.225760000000001, "episode_len_mean": 147.31, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.002999999999999, 6.461000000000003, 9.007000000000003, 12.540000000000004, 4.235, 8.633000000000004, 4.185999999999996, 6.864999999999998, 8.056000000000006, 10.202999999999994, 5.721999999999997, 17.163000000000004, 4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437, 21.644, 14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991, 14.468, 14.840000000000003, 14.809999999999999, 12.675, 18.182000000000002, 12.928, 15.027000000000001, 19.256, 12.522, 20.798000000000002, 17.802000000000003, 19.255000000000003, 17.982000000000003, 19.669000000000004, 19.775000000000002, 13.947000000000001, 18.422000000000004, 13.786999999999999, 15.063000000000002, 14.617, 20.643, 12.861, 17.903, 22.488, 13.242, 15.444, 16.036, 18.529, 15.784000000000002, 20.064999999999998, 16.294000000000004, 16.196, 13.294, 20.620999999999995, 13.479, 13.101, 22.760000000000005, 13.618000000000002, 12.622, 12.742, 16.719000000000005, 11.737, 14.912], "episode_lengths": [239, 228, 233, 223, 225, 235, 230, 224, 239, 243, 235, 216, 218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119, 193, 105, 102, 145, 68, 214, 214, 184, 84, 65, 78, 67, 115, 62, 115, 96, 78, 139, 102, 130, 96, 97, 140, 73, 100, 87, 107, 99, 130, 60, 94, 149, 81, 77, 111, 97, 91, 126, 80, 74, 82, 103, 60, 60, 125, 97, 63, 59, 85, 92, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44213090487915535, "mean_inference_ms": 1.172206899562685, "mean_action_processing_ms": 0.08092021551904459, "mean_env_wait_ms": 5.039426713694898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032377243041992188, "ViewRequirementAgentConnector_ms": 0.23672747611999512}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17406, "num_agent_steps_trained": 0, "num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.079507284760501, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 17408, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 17406, "timers": {"training_iteration_time_ms": 147138.302, "sample_time_ms": 6940.218, "synch_weights_time_ms": 50.49}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17406, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 111, "training_iteration": 17, "trial_id": "default", "date": "2025-12-19_20-08-50", "timestamp": 1766146130, "time_this_iter_s": 144.6453902721405, "time_total_s": 2498.670341014862, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2498.670341014862, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 89.72672811059907, "ram_util_percent": 21.205069124423964}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.45916369194164874}, "default_policy": {"total_loss": 0.45916369194164874, "policy_loss": -0.019032697833608836, "vf_loss": 1.9201921174302696, "vf_loss_unclipped": 4.344438520260155, "vf_explained_var": 0.12128052413463593, "entropy": 1.8516398571431636, "mean_kl_loss": 0.0021520369681226727, "gradients_default_optimizer_global_norm": 2.09766723588109, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 7.629394644936838e-07}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18430, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 36.74200000000001, "episode_reward_min": 2.4759999999999973, "episode_reward_mean": 16.39912, "episode_len_mean": 130.9, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437, 21.644, 14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991, 14.468, 14.840000000000003, 14.809999999999999, 12.675, 18.182000000000002, 12.928, 15.027000000000001, 19.256, 12.522, 20.798000000000002, 17.802000000000003, 19.255000000000003, 17.982000000000003, 19.669000000000004, 19.775000000000002, 13.947000000000001, 18.422000000000004, 13.786999999999999, 15.063000000000002, 14.617, 20.643, 12.861, 17.903, 22.488, 13.242, 15.444, 16.036, 18.529, 15.784000000000002, 20.064999999999998, 16.294000000000004, 16.196, 13.294, 20.620999999999995, 13.479, 13.101, 22.760000000000005, 13.618000000000002, 12.622, 12.742, 16.719000000000005, 11.737, 14.912, 26.519000000000005, 17.94, 26.535000000000007, 10.978000000000002, 13.915, 19.404000000000003, 14.209000000000001, 15.151, 18.189000000000004, 14.157, 16.972, 20.441000000000003], "episode_lengths": [218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119, 193, 105, 102, 145, 68, 214, 214, 184, 84, 65, 78, 67, 115, 62, 115, 96, 78, 139, 102, 130, 96, 97, 140, 73, 100, 87, 107, 99, 130, 60, 94, 149, 81, 77, 111, 97, 91, 126, 80, 74, 82, 103, 60, 60, 125, 97, 63, 59, 85, 92, 81, 158, 101, 153, 42, 80, 114, 58, 79, 77, 71, 98, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4440269177395378, "mean_inference_ms": 1.174819918506179, "mean_action_processing_ms": 0.08090000912167536, "mean_env_wait_ms": 5.035379485340405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003214597702026367, "ViewRequirementAgentConnector_ms": 0.23677897453308105}}, "episode_reward_max": 36.74200000000001, "episode_reward_min": 2.4759999999999973, "episode_reward_mean": 16.39912, "episode_len_mean": 130.9, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.555000000000002, 12.590000000000009, 2.4759999999999973, 11.202000000000007, 6.6840000000000055, 16.335, 13.116000000000012, 15.674000000000003, 10.50300000000001, 4.842999999999998, 11.064000000000004, 11.424999999999992, 6.1450000000000005, 9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437, 21.644, 14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991, 14.468, 14.840000000000003, 14.809999999999999, 12.675, 18.182000000000002, 12.928, 15.027000000000001, 19.256, 12.522, 20.798000000000002, 17.802000000000003, 19.255000000000003, 17.982000000000003, 19.669000000000004, 19.775000000000002, 13.947000000000001, 18.422000000000004, 13.786999999999999, 15.063000000000002, 14.617, 20.643, 12.861, 17.903, 22.488, 13.242, 15.444, 16.036, 18.529, 15.784000000000002, 20.064999999999998, 16.294000000000004, 16.196, 13.294, 20.620999999999995, 13.479, 13.101, 22.760000000000005, 13.618000000000002, 12.622, 12.742, 16.719000000000005, 11.737, 14.912, 26.519000000000005, 17.94, 26.535000000000007, 10.978000000000002, 13.915, 19.404000000000003, 14.209000000000001, 15.151, 18.189000000000004, 14.157, 16.972, 20.441000000000003], "episode_lengths": [218, 234, 235, 236, 247, 152, 234, 160, 239, 220, 223, 228, 233, 244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119, 193, 105, 102, 145, 68, 214, 214, 184, 84, 65, 78, 67, 115, 62, 115, 96, 78, 139, 102, 130, 96, 97, 140, 73, 100, 87, 107, 99, 130, 60, 94, 149, 81, 77, 111, 97, 91, 126, 80, 74, 82, 103, 60, 60, 125, 97, 63, 59, 85, 92, 81, 158, 101, 153, 42, 80, 114, 58, 79, 77, 71, 98, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4440269177395378, "mean_inference_ms": 1.174819918506179, "mean_action_processing_ms": 0.08090000912167536, "mean_env_wait_ms": 5.035379485340405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003214597702026367, "ViewRequirementAgentConnector_ms": 0.23677897453308105}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18430, "num_agent_steps_trained": 0, "num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.982535030092403, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 18432, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 18430, "timers": {"training_iteration_time_ms": 146957.925, "sample_time_ms": 6936.721, "synch_weights_time_ms": 51.107}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18430, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 123, "training_iteration": 18, "trial_id": "default", "date": "2025-12-19_20-11-16", "timestamp": 1766146276, "time_this_iter_s": 146.6541337966919, "time_total_s": 2645.324474811554, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2645.324474811554, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 94.75789473684212, "ram_util_percent": 20.82535885167464}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1025.0, "total_loss": 0.48932328858407015}, "default_policy": {"total_loss": 0.48932328858407015, "policy_loss": -0.015028707908686274, "vf_loss": 2.0247885840279713, "vf_loss_unclipped": 5.210595943912956, "vf_explained_var": 0.0938002330175838, "entropy": 1.8451499835304592, "mean_kl_loss": 0.0022168984225003647, "gradients_default_optimizer_global_norm": 2.1404663135546333, "default_optimizer_lr": 3.0000000000000008e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 3.814697322468419e-07}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19455, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 36.74200000000001, "episode_reward_min": 9.610000000000005, "episode_reward_mean": 17.26427, "episode_len_mean": 113.11, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437, 21.644, 14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991, 14.468, 14.840000000000003, 14.809999999999999, 12.675, 18.182000000000002, 12.928, 15.027000000000001, 19.256, 12.522, 20.798000000000002, 17.802000000000003, 19.255000000000003, 17.982000000000003, 19.669000000000004, 19.775000000000002, 13.947000000000001, 18.422000000000004, 13.786999999999999, 15.063000000000002, 14.617, 20.643, 12.861, 17.903, 22.488, 13.242, 15.444, 16.036, 18.529, 15.784000000000002, 20.064999999999998, 16.294000000000004, 16.196, 13.294, 20.620999999999995, 13.479, 13.101, 22.760000000000005, 13.618000000000002, 12.622, 12.742, 16.719000000000005, 11.737, 14.912, 26.519000000000005, 17.94, 26.535000000000007, 10.978000000000002, 13.915, 19.404000000000003, 14.209000000000001, 15.151, 18.189000000000004, 14.157, 16.972, 20.441000000000003, 15.691, 15.71, 16.688000000000002, 16.706000000000003, 13.817, 13.405, 15.451, 21.870000000000005, 17.157, 13.402000000000001, 17.042, 16.134, 20.054000000000002], "episode_lengths": [244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119, 193, 105, 102, 145, 68, 214, 214, 184, 84, 65, 78, 67, 115, 62, 115, 96, 78, 139, 102, 130, 96, 97, 140, 73, 100, 87, 107, 99, 130, 60, 94, 149, 81, 77, 111, 97, 91, 126, 80, 74, 82, 103, 60, 60, 125, 97, 63, 59, 85, 92, 81, 158, 101, 153, 42, 80, 114, 58, 79, 77, 71, 98, 98, 71, 77, 91, 96, 80, 65, 66, 96, 78, 67, 107, 69, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4463052292590636, "mean_inference_ms": 1.1788041494689363, "mean_action_processing_ms": 0.08092851675208676, "mean_env_wait_ms": 5.032202796167215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003216266632080078, "ViewRequirementAgentConnector_ms": 0.236968994140625}}, "episode_reward_max": 36.74200000000001, "episode_reward_min": 9.610000000000005, "episode_reward_mean": 17.26427, "episode_len_mean": 113.11, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.610000000000005, 17.653000000000002, 25.226999999999986, 19.772000000000002, 17.371, 26.11500000000001, 14.664, 11.506000000000007, 23.07, 15.117, 14.251999999999999, 14.891000000000002, 19.203, 28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437, 21.644, 14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991, 14.468, 14.840000000000003, 14.809999999999999, 12.675, 18.182000000000002, 12.928, 15.027000000000001, 19.256, 12.522, 20.798000000000002, 17.802000000000003, 19.255000000000003, 17.982000000000003, 19.669000000000004, 19.775000000000002, 13.947000000000001, 18.422000000000004, 13.786999999999999, 15.063000000000002, 14.617, 20.643, 12.861, 17.903, 22.488, 13.242, 15.444, 16.036, 18.529, 15.784000000000002, 20.064999999999998, 16.294000000000004, 16.196, 13.294, 20.620999999999995, 13.479, 13.101, 22.760000000000005, 13.618000000000002, 12.622, 12.742, 16.719000000000005, 11.737, 14.912, 26.519000000000005, 17.94, 26.535000000000007, 10.978000000000002, 13.915, 19.404000000000003, 14.209000000000001, 15.151, 18.189000000000004, 14.157, 16.972, 20.441000000000003, 15.691, 15.71, 16.688000000000002, 16.706000000000003, 13.817, 13.405, 15.451, 21.870000000000005, 17.157, 13.402000000000001, 17.042, 16.134, 20.054000000000002], "episode_lengths": [244, 222, 232, 141, 244, 182, 117, 237, 187, 108, 122, 131, 105, 219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119, 193, 105, 102, 145, 68, 214, 214, 184, 84, 65, 78, 67, 115, 62, 115, 96, 78, 139, 102, 130, 96, 97, 140, 73, 100, 87, 107, 99, 130, 60, 94, 149, 81, 77, 111, 97, 91, 126, 80, 74, 82, 103, 60, 60, 125, 97, 63, 59, 85, 92, 81, 158, 101, 153, 42, 80, 114, 58, 79, 77, 71, 98, 98, 71, 77, 91, 96, 80, 65, 66, 96, 78, 67, 107, 69, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4463052292590636, "mean_inference_ms": 1.1788041494689363, "mean_action_processing_ms": 0.08092851675208676, "mean_env_wait_ms": 5.032202796167215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003216266632080078, "ViewRequirementAgentConnector_ms": 0.236968994140625}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19455, "num_agent_steps_trained": 0, "num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.087318760347389, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 19456, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 19455, "timers": {"training_iteration_time_ms": 146538.997, "sample_time_ms": 6910.935, "synch_weights_time_ms": 51.364}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19455, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 136, "training_iteration": 19, "trial_id": "default", "date": "2025-12-19_20-13-41", "timestamp": 1766146421, "time_this_iter_s": 144.48639917373657, "time_total_s": 2789.8108739852905, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2789.8108739852905, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 94.73592233009708, "ram_util_percent": 21.41407766990291}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.48054583839839327}, "default_policy": {"total_loss": 0.48054583839839327, "policy_loss": -0.017062481975881384, "vf_loss": 1.9973926443606616, "vf_loss_unclipped": 5.364017567038536, "vf_explained_var": 0.0466838251799345, "entropy": 1.7398405641317367, "mean_kl_loss": 0.002446964181017286, "gradients_default_optimizer_global_norm": 1.6451203390955924, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.9073486612342094e-07}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20479, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 36.74200000000001, "episode_reward_min": 10.978000000000002, "episode_reward_mean": 16.942, "episode_len_mean": 100.39, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437, 21.644, 14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991, 14.468, 14.840000000000003, 14.809999999999999, 12.675, 18.182000000000002, 12.928, 15.027000000000001, 19.256, 12.522, 20.798000000000002, 17.802000000000003, 19.255000000000003, 17.982000000000003, 19.669000000000004, 19.775000000000002, 13.947000000000001, 18.422000000000004, 13.786999999999999, 15.063000000000002, 14.617, 20.643, 12.861, 17.903, 22.488, 13.242, 15.444, 16.036, 18.529, 15.784000000000002, 20.064999999999998, 16.294000000000004, 16.196, 13.294, 20.620999999999995, 13.479, 13.101, 22.760000000000005, 13.618000000000002, 12.622, 12.742, 16.719000000000005, 11.737, 14.912, 26.519000000000005, 17.94, 26.535000000000007, 10.978000000000002, 13.915, 19.404000000000003, 14.209000000000001, 15.151, 18.189000000000004, 14.157, 16.972, 20.441000000000003, 15.691, 15.71, 16.688000000000002, 16.706000000000003, 13.817, 13.405, 15.451, 21.870000000000005, 17.157, 13.402000000000001, 17.042, 16.134, 20.054000000000002, 14.789000000000001, 18.856, 15.619000000000002, 19.063000000000002, 11.265, 11.298, 19.438000000000002, 13.852, 14.989, 13.582, 15.243000000000002, 16.177, 12.052999999999999], "episode_lengths": [219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119, 193, 105, 102, 145, 68, 214, 214, 184, 84, 65, 78, 67, 115, 62, 115, 96, 78, 139, 102, 130, 96, 97, 140, 73, 100, 87, 107, 99, 130, 60, 94, 149, 81, 77, 111, 97, 91, 126, 80, 74, 82, 103, 60, 60, 125, 97, 63, 59, 85, 92, 81, 158, 101, 153, 42, 80, 114, 58, 79, 77, 71, 98, 98, 71, 77, 91, 96, 80, 65, 66, 96, 78, 67, 107, 69, 117, 59, 84, 80, 94, 51, 68, 101, 80, 83, 76, 79, 85, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4485152245208788, "mean_inference_ms": 1.1792248677564703, "mean_action_processing_ms": 0.0809360334847092, "mean_env_wait_ms": 5.028660673008045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032100677490234375, "ViewRequirementAgentConnector_ms": 0.23624205589294434}}, "episode_reward_max": 36.74200000000001, "episode_reward_min": 10.978000000000002, "episode_reward_mean": 16.942, "episode_len_mean": 100.39, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.500999999999994, 14.281, 17.990000000000002, 12.929, 15.831000000000001, 20.051000000000005, 17.700999999999997, 19.724999999999994, 21.229000000000006, 17.277, 16.437, 21.644, 14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991, 14.468, 14.840000000000003, 14.809999999999999, 12.675, 18.182000000000002, 12.928, 15.027000000000001, 19.256, 12.522, 20.798000000000002, 17.802000000000003, 19.255000000000003, 17.982000000000003, 19.669000000000004, 19.775000000000002, 13.947000000000001, 18.422000000000004, 13.786999999999999, 15.063000000000002, 14.617, 20.643, 12.861, 17.903, 22.488, 13.242, 15.444, 16.036, 18.529, 15.784000000000002, 20.064999999999998, 16.294000000000004, 16.196, 13.294, 20.620999999999995, 13.479, 13.101, 22.760000000000005, 13.618000000000002, 12.622, 12.742, 16.719000000000005, 11.737, 14.912, 26.519000000000005, 17.94, 26.535000000000007, 10.978000000000002, 13.915, 19.404000000000003, 14.209000000000001, 15.151, 18.189000000000004, 14.157, 16.972, 20.441000000000003, 15.691, 15.71, 16.688000000000002, 16.706000000000003, 13.817, 13.405, 15.451, 21.870000000000005, 17.157, 13.402000000000001, 17.042, 16.134, 20.054000000000002, 14.789000000000001, 18.856, 15.619000000000002, 19.063000000000002, 11.265, 11.298, 19.438000000000002, 13.852, 14.989, 13.582, 15.243000000000002, 16.177, 12.052999999999999], "episode_lengths": [219, 83, 230, 92, 118, 165, 183, 106, 163, 120, 119, 193, 105, 102, 145, 68, 214, 214, 184, 84, 65, 78, 67, 115, 62, 115, 96, 78, 139, 102, 130, 96, 97, 140, 73, 100, 87, 107, 99, 130, 60, 94, 149, 81, 77, 111, 97, 91, 126, 80, 74, 82, 103, 60, 60, 125, 97, 63, 59, 85, 92, 81, 158, 101, 153, 42, 80, 114, 58, 79, 77, 71, 98, 98, 71, 77, 91, 96, 80, 65, 66, 96, 78, 67, 107, 69, 117, 59, 84, 80, 94, 51, 68, 101, 80, 83, 76, 79, 85, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4485152245208788, "mean_inference_ms": 1.1792248677564703, "mean_action_processing_ms": 0.0809360334847092, "mean_env_wait_ms": 5.028660673008045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032100677490234375, "ViewRequirementAgentConnector_ms": 0.23624205589294434}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20479, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.008040489688918, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20480, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 20479, "timers": {"training_iteration_time_ms": 146619.827, "sample_time_ms": 6910.282, "synch_weights_time_ms": 50.443}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20479, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 149, "training_iteration": 20, "trial_id": "default", "date": "2025-12-19_20-16-07", "timestamp": 1766146567, "time_this_iter_s": 146.12365651130676, "time_total_s": 2935.9345304965973, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2935.9345304965973, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 94.69326923076922, "ram_util_percent": 21.003365384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1023.0, "total_loss": 0.4139822547593212}, "default_policy": {"total_loss": 0.4139822547593212, "policy_loss": -0.01709954282268882, "vf_loss": 1.7311227476689965, "vf_loss_unclipped": 5.271249605203048, "vf_explained_var": 0.13311182484030723, "entropy": 1.698887860774994, "mean_kl_loss": 0.002432232282887714, "gradients_default_optimizer_global_norm": 1.5259038671851157, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 9.536743306171047e-08}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 0, "num_agent_steps_sampled": 21502, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 36.74200000000001, "episode_reward_min": 10.978000000000002, "episode_reward_mean": 16.727070000000005, "episode_len_mean": 92.14, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991, 14.468, 14.840000000000003, 14.809999999999999, 12.675, 18.182000000000002, 12.928, 15.027000000000001, 19.256, 12.522, 20.798000000000002, 17.802000000000003, 19.255000000000003, 17.982000000000003, 19.669000000000004, 19.775000000000002, 13.947000000000001, 18.422000000000004, 13.786999999999999, 15.063000000000002, 14.617, 20.643, 12.861, 17.903, 22.488, 13.242, 15.444, 16.036, 18.529, 15.784000000000002, 20.064999999999998, 16.294000000000004, 16.196, 13.294, 20.620999999999995, 13.479, 13.101, 22.760000000000005, 13.618000000000002, 12.622, 12.742, 16.719000000000005, 11.737, 14.912, 26.519000000000005, 17.94, 26.535000000000007, 10.978000000000002, 13.915, 19.404000000000003, 14.209000000000001, 15.151, 18.189000000000004, 14.157, 16.972, 20.441000000000003, 15.691, 15.71, 16.688000000000002, 16.706000000000003, 13.817, 13.405, 15.451, 21.870000000000005, 17.157, 13.402000000000001, 17.042, 16.134, 20.054000000000002, 14.789000000000001, 18.856, 15.619000000000002, 19.063000000000002, 11.265, 11.298, 19.438000000000002, 13.852, 14.989, 13.582, 15.243000000000002, 16.177, 12.052999999999999, 28.65300000000001, 19.548999999999996, 15.097, 14.315999999999999, 18.399, 13.064, 16.041, 14.701, 14.079000000000002, 16.277, 17.661, 14.266000000000002], "episode_lengths": [105, 102, 145, 68, 214, 214, 184, 84, 65, 78, 67, 115, 62, 115, 96, 78, 139, 102, 130, 96, 97, 140, 73, 100, 87, 107, 99, 130, 60, 94, 149, 81, 77, 111, 97, 91, 126, 80, 74, 82, 103, 60, 60, 125, 97, 63, 59, 85, 92, 81, 158, 101, 153, 42, 80, 114, 58, 79, 77, 71, 98, 98, 71, 77, 91, 96, 80, 65, 66, 96, 78, 67, 107, 69, 117, 59, 84, 80, 94, 51, 68, 101, 80, 83, 76, 79, 85, 60, 151, 86, 79, 70, 93, 57, 72, 72, 57, 82, 86, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45048380944899125, "mean_inference_ms": 1.1790616073977966, "mean_action_processing_ms": 0.08094499065218999, "mean_env_wait_ms": 5.0257465274382636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003217458724975586, "ViewRequirementAgentConnector_ms": 0.23618364334106445}}, "episode_reward_max": 36.74200000000001, "episode_reward_min": 10.978000000000002, "episode_reward_mean": 16.727070000000005, "episode_len_mean": 92.14, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.864, 16.417, 18.915, 12.059, 36.74200000000001, 23.94, 26.991, 14.468, 14.840000000000003, 14.809999999999999, 12.675, 18.182000000000002, 12.928, 15.027000000000001, 19.256, 12.522, 20.798000000000002, 17.802000000000003, 19.255000000000003, 17.982000000000003, 19.669000000000004, 19.775000000000002, 13.947000000000001, 18.422000000000004, 13.786999999999999, 15.063000000000002, 14.617, 20.643, 12.861, 17.903, 22.488, 13.242, 15.444, 16.036, 18.529, 15.784000000000002, 20.064999999999998, 16.294000000000004, 16.196, 13.294, 20.620999999999995, 13.479, 13.101, 22.760000000000005, 13.618000000000002, 12.622, 12.742, 16.719000000000005, 11.737, 14.912, 26.519000000000005, 17.94, 26.535000000000007, 10.978000000000002, 13.915, 19.404000000000003, 14.209000000000001, 15.151, 18.189000000000004, 14.157, 16.972, 20.441000000000003, 15.691, 15.71, 16.688000000000002, 16.706000000000003, 13.817, 13.405, 15.451, 21.870000000000005, 17.157, 13.402000000000001, 17.042, 16.134, 20.054000000000002, 14.789000000000001, 18.856, 15.619000000000002, 19.063000000000002, 11.265, 11.298, 19.438000000000002, 13.852, 14.989, 13.582, 15.243000000000002, 16.177, 12.052999999999999, 28.65300000000001, 19.548999999999996, 15.097, 14.315999999999999, 18.399, 13.064, 16.041, 14.701, 14.079000000000002, 16.277, 17.661, 14.266000000000002], "episode_lengths": [105, 102, 145, 68, 214, 214, 184, 84, 65, 78, 67, 115, 62, 115, 96, 78, 139, 102, 130, 96, 97, 140, 73, 100, 87, 107, 99, 130, 60, 94, 149, 81, 77, 111, 97, 91, 126, 80, 74, 82, 103, 60, 60, 125, 97, 63, 59, 85, 92, 81, 158, 101, 153, 42, 80, 114, 58, 79, 77, 71, 98, 98, 71, 77, 91, 96, 80, 65, 66, 96, 78, 67, 107, 69, 117, 59, 84, 80, 94, 51, 68, 101, 80, 83, 76, 79, 85, 60, 151, 86, 79, 70, 93, 57, 72, 72, 57, 82, 86, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45048380944899125, "mean_inference_ms": 1.1790616073977966, "mean_action_processing_ms": 0.08094499065218999, "mean_env_wait_ms": 5.0257465274382636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003217458724975586, "ViewRequirementAgentConnector_ms": 0.23618364334106445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21502, "num_agent_steps_trained": 0, "num_env_steps_sampled": 21504, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.0398140905838344, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 21504, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 21502, "timers": {"training_iteration_time_ms": 146318.272, "sample_time_ms": 6909.906, "synch_weights_time_ms": 50.651}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 0, "num_agent_steps_sampled": 21502, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 161, "training_iteration": 21, "trial_id": "default", "date": "2025-12-19_20-18-32", "timestamp": 1766146712, "time_this_iter_s": 145.46102905273438, "time_total_s": 3081.3955595493317, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3081.3955595493317, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 94.53961352657004, "ram_util_percent": 21.293236714975848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5153772240970284}, "default_policy": {"total_loss": 0.5153772240970284, "policy_loss": -0.016797834614408202, "vf_loss": 2.1356884986162186, "vf_loss_unclipped": 6.63295171558857, "vf_explained_var": 0.03690989390015602, "entropy": 1.747065395116806, "mean_kl_loss": 0.0020491671921270436, "gradients_default_optimizer_global_norm": 1.6579047836363316, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 4.7683716530855236e-08}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 0, "num_agent_steps_sampled": 22526, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.65300000000001, "episode_reward_min": 10.978000000000002, "episode_reward_mean": 16.17355, "episode_len_mean": 85.61, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.522, 20.798000000000002, 17.802000000000003, 19.255000000000003, 17.982000000000003, 19.669000000000004, 19.775000000000002, 13.947000000000001, 18.422000000000004, 13.786999999999999, 15.063000000000002, 14.617, 20.643, 12.861, 17.903, 22.488, 13.242, 15.444, 16.036, 18.529, 15.784000000000002, 20.064999999999998, 16.294000000000004, 16.196, 13.294, 20.620999999999995, 13.479, 13.101, 22.760000000000005, 13.618000000000002, 12.622, 12.742, 16.719000000000005, 11.737, 14.912, 26.519000000000005, 17.94, 26.535000000000007, 10.978000000000002, 13.915, 19.404000000000003, 14.209000000000001, 15.151, 18.189000000000004, 14.157, 16.972, 20.441000000000003, 15.691, 15.71, 16.688000000000002, 16.706000000000003, 13.817, 13.405, 15.451, 21.870000000000005, 17.157, 13.402000000000001, 17.042, 16.134, 20.054000000000002, 14.789000000000001, 18.856, 15.619000000000002, 19.063000000000002, 11.265, 11.298, 19.438000000000002, 13.852, 14.989, 13.582, 15.243000000000002, 16.177, 12.052999999999999, 28.65300000000001, 19.548999999999996, 15.097, 14.315999999999999, 18.399, 13.064, 16.041, 14.701, 14.079000000000002, 16.277, 17.661, 14.266000000000002, 13.030000000000001, 14.206000000000001, 17.394000000000002, 16.092, 11.435, 11.66, 16.052, 14.415000000000001, 14.276, 17.316, 14.858, 12.343000000000002, 15.994000000000003, 12.437, 15.254000000000001], "episode_lengths": [78, 139, 102, 130, 96, 97, 140, 73, 100, 87, 107, 99, 130, 60, 94, 149, 81, 77, 111, 97, 91, 126, 80, 74, 82, 103, 60, 60, 125, 97, 63, 59, 85, 92, 81, 158, 101, 153, 42, 80, 114, 58, 79, 77, 71, 98, 98, 71, 77, 91, 96, 80, 65, 66, 96, 78, 67, 107, 69, 117, 59, 84, 80, 94, 51, 68, 101, 80, 83, 76, 79, 85, 60, 151, 86, 79, 70, 93, 57, 72, 72, 57, 82, 86, 61, 60, 75, 75, 68, 55, 77, 89, 86, 71, 80, 77, 51, 78, 47, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4526081800678228, "mean_inference_ms": 1.1749335454643435, "mean_action_processing_ms": 0.0809071473753059, "mean_env_wait_ms": 5.021409230975271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032045841217041016, "ViewRequirementAgentConnector_ms": 0.23594260215759277}}, "episode_reward_max": 28.65300000000001, "episode_reward_min": 10.978000000000002, "episode_reward_mean": 16.17355, "episode_len_mean": 85.61, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.522, 20.798000000000002, 17.802000000000003, 19.255000000000003, 17.982000000000003, 19.669000000000004, 19.775000000000002, 13.947000000000001, 18.422000000000004, 13.786999999999999, 15.063000000000002, 14.617, 20.643, 12.861, 17.903, 22.488, 13.242, 15.444, 16.036, 18.529, 15.784000000000002, 20.064999999999998, 16.294000000000004, 16.196, 13.294, 20.620999999999995, 13.479, 13.101, 22.760000000000005, 13.618000000000002, 12.622, 12.742, 16.719000000000005, 11.737, 14.912, 26.519000000000005, 17.94, 26.535000000000007, 10.978000000000002, 13.915, 19.404000000000003, 14.209000000000001, 15.151, 18.189000000000004, 14.157, 16.972, 20.441000000000003, 15.691, 15.71, 16.688000000000002, 16.706000000000003, 13.817, 13.405, 15.451, 21.870000000000005, 17.157, 13.402000000000001, 17.042, 16.134, 20.054000000000002, 14.789000000000001, 18.856, 15.619000000000002, 19.063000000000002, 11.265, 11.298, 19.438000000000002, 13.852, 14.989, 13.582, 15.243000000000002, 16.177, 12.052999999999999, 28.65300000000001, 19.548999999999996, 15.097, 14.315999999999999, 18.399, 13.064, 16.041, 14.701, 14.079000000000002, 16.277, 17.661, 14.266000000000002, 13.030000000000001, 14.206000000000001, 17.394000000000002, 16.092, 11.435, 11.66, 16.052, 14.415000000000001, 14.276, 17.316, 14.858, 12.343000000000002, 15.994000000000003, 12.437, 15.254000000000001], "episode_lengths": [78, 139, 102, 130, 96, 97, 140, 73, 100, 87, 107, 99, 130, 60, 94, 149, 81, 77, 111, 97, 91, 126, 80, 74, 82, 103, 60, 60, 125, 97, 63, 59, 85, 92, 81, 158, 101, 153, 42, 80, 114, 58, 79, 77, 71, 98, 98, 71, 77, 91, 96, 80, 65, 66, 96, 78, 67, 107, 69, 117, 59, 84, 80, 94, 51, 68, 101, 80, 83, 76, 79, 85, 60, 151, 86, 79, 70, 93, 57, 72, 72, 57, 82, 86, 61, 60, 75, 75, 68, 55, 77, 89, 86, 71, 80, 77, 51, 78, 47, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4526081800678228, "mean_inference_ms": 1.1749335454643435, "mean_action_processing_ms": 0.0809071473753059, "mean_env_wait_ms": 5.021409230975271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032045841217041016, "ViewRequirementAgentConnector_ms": 0.23594260215759277}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22526, "num_agent_steps_trained": 0, "num_env_steps_sampled": 22528, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.058896528325748, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 22528, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 22526, "timers": {"training_iteration_time_ms": 145883.325, "sample_time_ms": 6913.863, "synch_weights_time_ms": 49.711}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 0, "num_agent_steps_sampled": 22526, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 176, "training_iteration": 22, "trial_id": "default", "date": "2025-12-19_20-21-06", "timestamp": 1766146866, "time_this_iter_s": 145.06778717041016, "time_total_s": 3226.463346719742, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3226.463346719742, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 89.67981651376147, "ram_util_percent": 21.03577981651376}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.4535232024267316}, "default_policy": {"total_loss": 0.4535232024267316, "policy_loss": -0.017115679051494227, "vf_loss": 1.889076211117208, "vf_loss_unclipped": 6.208302306942642, "vf_explained_var": 0.07017341032624244, "entropy": 1.6301635794341565, "mean_kl_loss": 0.0021177132209547088, "gradients_default_optimizer_global_norm": 1.711863536387682, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 2.3841858265427618e-08}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 0, "num_agent_steps_sampled": 23550, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.65300000000001, "episode_reward_min": 10.978000000000002, "episode_reward_mean": 16.08981, "episode_len_mean": 81.43, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.903, 22.488, 13.242, 15.444, 16.036, 18.529, 15.784000000000002, 20.064999999999998, 16.294000000000004, 16.196, 13.294, 20.620999999999995, 13.479, 13.101, 22.760000000000005, 13.618000000000002, 12.622, 12.742, 16.719000000000005, 11.737, 14.912, 26.519000000000005, 17.94, 26.535000000000007, 10.978000000000002, 13.915, 19.404000000000003, 14.209000000000001, 15.151, 18.189000000000004, 14.157, 16.972, 20.441000000000003, 15.691, 15.71, 16.688000000000002, 16.706000000000003, 13.817, 13.405, 15.451, 21.870000000000005, 17.157, 13.402000000000001, 17.042, 16.134, 20.054000000000002, 14.789000000000001, 18.856, 15.619000000000002, 19.063000000000002, 11.265, 11.298, 19.438000000000002, 13.852, 14.989, 13.582, 15.243000000000002, 16.177, 12.052999999999999, 28.65300000000001, 19.548999999999996, 15.097, 14.315999999999999, 18.399, 13.064, 16.041, 14.701, 14.079000000000002, 16.277, 17.661, 14.266000000000002, 13.030000000000001, 14.206000000000001, 17.394000000000002, 16.092, 11.435, 11.66, 16.052, 14.415000000000001, 14.276, 17.316, 14.858, 12.343000000000002, 15.994000000000003, 12.437, 15.254000000000001, 14.054, 12.713000000000001, 21.979000000000003, 15.350000000000001, 14.804000000000002, 15.209000000000001, 14.870999999999999, 14.008, 17.276, 16.232, 17.715, 23.573, 14.799000000000001, 16.186], "episode_lengths": [94, 149, 81, 77, 111, 97, 91, 126, 80, 74, 82, 103, 60, 60, 125, 97, 63, 59, 85, 92, 81, 158, 101, 153, 42, 80, 114, 58, 79, 77, 71, 98, 98, 71, 77, 91, 96, 80, 65, 66, 96, 78, 67, 107, 69, 117, 59, 84, 80, 94, 51, 68, 101, 80, 83, 76, 79, 85, 60, 151, 86, 79, 70, 93, 57, 72, 72, 57, 82, 86, 61, 60, 75, 75, 68, 55, 77, 89, 86, 71, 80, 77, 51, 78, 47, 72, 48, 47, 102, 65, 63, 59, 66, 65, 81, 79, 94, 119, 64, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45475780754630124, "mean_inference_ms": 1.174301127352712, "mean_action_processing_ms": 0.08089354559380726, "mean_env_wait_ms": 5.018826570006446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032160282135009766, "ViewRequirementAgentConnector_ms": 0.23567724227905273}}, "episode_reward_max": 28.65300000000001, "episode_reward_min": 10.978000000000002, "episode_reward_mean": 16.08981, "episode_len_mean": 81.43, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.903, 22.488, 13.242, 15.444, 16.036, 18.529, 15.784000000000002, 20.064999999999998, 16.294000000000004, 16.196, 13.294, 20.620999999999995, 13.479, 13.101, 22.760000000000005, 13.618000000000002, 12.622, 12.742, 16.719000000000005, 11.737, 14.912, 26.519000000000005, 17.94, 26.535000000000007, 10.978000000000002, 13.915, 19.404000000000003, 14.209000000000001, 15.151, 18.189000000000004, 14.157, 16.972, 20.441000000000003, 15.691, 15.71, 16.688000000000002, 16.706000000000003, 13.817, 13.405, 15.451, 21.870000000000005, 17.157, 13.402000000000001, 17.042, 16.134, 20.054000000000002, 14.789000000000001, 18.856, 15.619000000000002, 19.063000000000002, 11.265, 11.298, 19.438000000000002, 13.852, 14.989, 13.582, 15.243000000000002, 16.177, 12.052999999999999, 28.65300000000001, 19.548999999999996, 15.097, 14.315999999999999, 18.399, 13.064, 16.041, 14.701, 14.079000000000002, 16.277, 17.661, 14.266000000000002, 13.030000000000001, 14.206000000000001, 17.394000000000002, 16.092, 11.435, 11.66, 16.052, 14.415000000000001, 14.276, 17.316, 14.858, 12.343000000000002, 15.994000000000003, 12.437, 15.254000000000001, 14.054, 12.713000000000001, 21.979000000000003, 15.350000000000001, 14.804000000000002, 15.209000000000001, 14.870999999999999, 14.008, 17.276, 16.232, 17.715, 23.573, 14.799000000000001, 16.186], "episode_lengths": [94, 149, 81, 77, 111, 97, 91, 126, 80, 74, 82, 103, 60, 60, 125, 97, 63, 59, 85, 92, 81, 158, 101, 153, 42, 80, 114, 58, 79, 77, 71, 98, 98, 71, 77, 91, 96, 80, 65, 66, 96, 78, 67, 107, 69, 117, 59, 84, 80, 94, 51, 68, 101, 80, 83, 76, 79, 85, 60, 151, 86, 79, 70, 93, 57, 72, 72, 57, 82, 86, 61, 60, 75, 75, 68, 55, 77, 89, 86, 71, 80, 77, 51, 78, 47, 72, 48, 47, 102, 65, 63, 59, 66, 65, 81, 79, 94, 119, 64, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45475780754630124, "mean_inference_ms": 1.174301127352712, "mean_action_processing_ms": 0.08089354559380726, "mean_env_wait_ms": 5.018826570006446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032160282135009766, "ViewRequirementAgentConnector_ms": 0.23567724227905273}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23550, "num_agent_steps_trained": 0, "num_env_steps_sampled": 23552, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.00688089426531, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 23552, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 23550, "timers": {"training_iteration_time_ms": 145788.082, "sample_time_ms": 6888.38, "synch_weights_time_ms": 48.81}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 0, "num_agent_steps_sampled": 23550, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 190, "training_iteration": 23, "trial_id": "default", "date": "2025-12-19_20-23-33", "timestamp": 1766147013, "time_this_iter_s": 146.1449203491211, "time_total_s": 3372.608267068863, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3372.608267068863, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 94.73413461538462, "ram_util_percent": 21.14471153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5330796854104847}, "default_policy": {"total_loss": 0.5330796854104847, "policy_loss": -0.017290897463681176, "vf_loss": 2.2080949261784553, "vf_loss_unclipped": 7.594947245717049, "vf_explained_var": -0.06845604218542575, "entropy": 1.6531431674957275, "mean_kl_loss": 0.0026698937600346364, "gradients_default_optimizer_global_norm": 1.128852028772235, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.1920929132713809e-08}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24574, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.65300000000001, "episode_reward_min": 10.978000000000002, "episode_reward_mean": 15.811100000000001, "episode_len_mean": 76.99, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.622, 12.742, 16.719000000000005, 11.737, 14.912, 26.519000000000005, 17.94, 26.535000000000007, 10.978000000000002, 13.915, 19.404000000000003, 14.209000000000001, 15.151, 18.189000000000004, 14.157, 16.972, 20.441000000000003, 15.691, 15.71, 16.688000000000002, 16.706000000000003, 13.817, 13.405, 15.451, 21.870000000000005, 17.157, 13.402000000000001, 17.042, 16.134, 20.054000000000002, 14.789000000000001, 18.856, 15.619000000000002, 19.063000000000002, 11.265, 11.298, 19.438000000000002, 13.852, 14.989, 13.582, 15.243000000000002, 16.177, 12.052999999999999, 28.65300000000001, 19.548999999999996, 15.097, 14.315999999999999, 18.399, 13.064, 16.041, 14.701, 14.079000000000002, 16.277, 17.661, 14.266000000000002, 13.030000000000001, 14.206000000000001, 17.394000000000002, 16.092, 11.435, 11.66, 16.052, 14.415000000000001, 14.276, 17.316, 14.858, 12.343000000000002, 15.994000000000003, 12.437, 15.254000000000001, 14.054, 12.713000000000001, 21.979000000000003, 15.350000000000001, 14.804000000000002, 15.209000000000001, 14.870999999999999, 14.008, 17.276, 16.232, 17.715, 23.573, 14.799000000000001, 16.186, 19.448, 15.062000000000001, 13.737, 12.11, 14.443, 14.632000000000001, 12.827000000000002, 13.803, 15.403000000000002, 17.392, 17.304999999999996, 21.598000000000003, 13.936, 12.035, 11.924, 15.328000000000003], "episode_lengths": [63, 59, 85, 92, 81, 158, 101, 153, 42, 80, 114, 58, 79, 77, 71, 98, 98, 71, 77, 91, 96, 80, 65, 66, 96, 78, 67, 107, 69, 117, 59, 84, 80, 94, 51, 68, 101, 80, 83, 76, 79, 85, 60, 151, 86, 79, 70, 93, 57, 72, 72, 57, 82, 86, 61, 60, 75, 75, 68, 55, 77, 89, 86, 71, 80, 77, 51, 78, 47, 72, 48, 47, 102, 65, 63, 59, 66, 65, 81, 79, 94, 119, 64, 68, 108, 70, 73, 51, 55, 63, 54, 57, 77, 80, 70, 97, 62, 43, 44, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45663209425742607, "mean_inference_ms": 1.1710439304083604, "mean_action_processing_ms": 0.08083470713405973, "mean_env_wait_ms": 5.014630526742229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003212451934814453, "ViewRequirementAgentConnector_ms": 0.2357189655303955}}, "episode_reward_max": 28.65300000000001, "episode_reward_min": 10.978000000000002, "episode_reward_mean": 15.811100000000001, "episode_len_mean": 76.99, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.622, 12.742, 16.719000000000005, 11.737, 14.912, 26.519000000000005, 17.94, 26.535000000000007, 10.978000000000002, 13.915, 19.404000000000003, 14.209000000000001, 15.151, 18.189000000000004, 14.157, 16.972, 20.441000000000003, 15.691, 15.71, 16.688000000000002, 16.706000000000003, 13.817, 13.405, 15.451, 21.870000000000005, 17.157, 13.402000000000001, 17.042, 16.134, 20.054000000000002, 14.789000000000001, 18.856, 15.619000000000002, 19.063000000000002, 11.265, 11.298, 19.438000000000002, 13.852, 14.989, 13.582, 15.243000000000002, 16.177, 12.052999999999999, 28.65300000000001, 19.548999999999996, 15.097, 14.315999999999999, 18.399, 13.064, 16.041, 14.701, 14.079000000000002, 16.277, 17.661, 14.266000000000002, 13.030000000000001, 14.206000000000001, 17.394000000000002, 16.092, 11.435, 11.66, 16.052, 14.415000000000001, 14.276, 17.316, 14.858, 12.343000000000002, 15.994000000000003, 12.437, 15.254000000000001, 14.054, 12.713000000000001, 21.979000000000003, 15.350000000000001, 14.804000000000002, 15.209000000000001, 14.870999999999999, 14.008, 17.276, 16.232, 17.715, 23.573, 14.799000000000001, 16.186, 19.448, 15.062000000000001, 13.737, 12.11, 14.443, 14.632000000000001, 12.827000000000002, 13.803, 15.403000000000002, 17.392, 17.304999999999996, 21.598000000000003, 13.936, 12.035, 11.924, 15.328000000000003], "episode_lengths": [63, 59, 85, 92, 81, 158, 101, 153, 42, 80, 114, 58, 79, 77, 71, 98, 98, 71, 77, 91, 96, 80, 65, 66, 96, 78, 67, 107, 69, 117, 59, 84, 80, 94, 51, 68, 101, 80, 83, 76, 79, 85, 60, 151, 86, 79, 70, 93, 57, 72, 72, 57, 82, 86, 61, 60, 75, 75, 68, 55, 77, 89, 86, 71, 80, 77, 51, 78, 47, 72, 48, 47, 102, 65, 63, 59, 66, 65, 81, 79, 94, 119, 64, 68, 108, 70, 73, 51, 55, 63, 54, 57, 77, 80, 70, 97, 62, 43, 44, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45663209425742607, "mean_inference_ms": 1.1710439304083604, "mean_action_processing_ms": 0.08083470713405973, "mean_env_wait_ms": 5.014630526742229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003212451934814453, "ViewRequirementAgentConnector_ms": 0.2357189655303955}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24574, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24576, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.025387705188376, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24576, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 24574, "timers": {"training_iteration_time_ms": 145667.231, "sample_time_ms": 6873.802, "synch_weights_time_ms": 48.612}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24574, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 206, "training_iteration": 24, "trial_id": "default", "date": "2025-12-19_20-25-58", "timestamp": 1766147158, "time_this_iter_s": 145.75983929634094, "time_total_s": 3518.368106365204, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3518.368106365204, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 94.75192307692306, "ram_util_percent": 21.18653846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5103213870897889}, "default_policy": {"total_loss": 0.5103213870897889, "policy_loss": -0.01932082788553089, "vf_loss": 2.1247483409941195, "vf_loss_unclipped": 7.0195436254143715, "vf_explained_var": 0.06260484531521797, "entropy": 1.5448738001286983, "mean_kl_loss": 0.0028506179802878506, "gradients_default_optimizer_global_norm": 1.518833889439702, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 5.9604645663569045e-09}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 0, "num_agent_steps_sampled": 25598, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.65300000000001, "episode_reward_min": 11.265, "episode_reward_mean": 15.622459999999998, "episode_len_mean": 73.67, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.972, 20.441000000000003, 15.691, 15.71, 16.688000000000002, 16.706000000000003, 13.817, 13.405, 15.451, 21.870000000000005, 17.157, 13.402000000000001, 17.042, 16.134, 20.054000000000002, 14.789000000000001, 18.856, 15.619000000000002, 19.063000000000002, 11.265, 11.298, 19.438000000000002, 13.852, 14.989, 13.582, 15.243000000000002, 16.177, 12.052999999999999, 28.65300000000001, 19.548999999999996, 15.097, 14.315999999999999, 18.399, 13.064, 16.041, 14.701, 14.079000000000002, 16.277, 17.661, 14.266000000000002, 13.030000000000001, 14.206000000000001, 17.394000000000002, 16.092, 11.435, 11.66, 16.052, 14.415000000000001, 14.276, 17.316, 14.858, 12.343000000000002, 15.994000000000003, 12.437, 15.254000000000001, 14.054, 12.713000000000001, 21.979000000000003, 15.350000000000001, 14.804000000000002, 15.209000000000001, 14.870999999999999, 14.008, 17.276, 16.232, 17.715, 23.573, 14.799000000000001, 16.186, 19.448, 15.062000000000001, 13.737, 12.11, 14.443, 14.632000000000001, 12.827000000000002, 13.803, 15.403000000000002, 17.392, 17.304999999999996, 21.598000000000003, 13.936, 12.035, 11.924, 15.328000000000003, 15.158000000000001, 14.317, 17.926000000000005, 17.669000000000004, 13.506, 14.802000000000001, 13.237000000000002, 15.450000000000003, 16.831, 14.943999999999999, 12.818999999999999, 14.739, 15.875, 14.262, 15.33], "episode_lengths": [98, 98, 71, 77, 91, 96, 80, 65, 66, 96, 78, 67, 107, 69, 117, 59, 84, 80, 94, 51, 68, 101, 80, 83, 76, 79, 85, 60, 151, 86, 79, 70, 93, 57, 72, 72, 57, 82, 86, 61, 60, 75, 75, 68, 55, 77, 89, 86, 71, 80, 77, 51, 78, 47, 72, 48, 47, 102, 65, 63, 59, 66, 65, 81, 79, 94, 119, 64, 68, 108, 70, 73, 51, 55, 63, 54, 57, 77, 80, 70, 97, 62, 43, 44, 59, 56, 50, 88, 76, 66, 82, 59, 59, 74, 59, 51, 65, 80, 51, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45872812811479574, "mean_inference_ms": 1.1709569974376983, "mean_action_processing_ms": 0.08083468612659557, "mean_env_wait_ms": 5.012361851030389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003229379653930664, "ViewRequirementAgentConnector_ms": 0.2357954978942871}}, "episode_reward_max": 28.65300000000001, "episode_reward_min": 11.265, "episode_reward_mean": 15.622459999999998, "episode_len_mean": 73.67, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.972, 20.441000000000003, 15.691, 15.71, 16.688000000000002, 16.706000000000003, 13.817, 13.405, 15.451, 21.870000000000005, 17.157, 13.402000000000001, 17.042, 16.134, 20.054000000000002, 14.789000000000001, 18.856, 15.619000000000002, 19.063000000000002, 11.265, 11.298, 19.438000000000002, 13.852, 14.989, 13.582, 15.243000000000002, 16.177, 12.052999999999999, 28.65300000000001, 19.548999999999996, 15.097, 14.315999999999999, 18.399, 13.064, 16.041, 14.701, 14.079000000000002, 16.277, 17.661, 14.266000000000002, 13.030000000000001, 14.206000000000001, 17.394000000000002, 16.092, 11.435, 11.66, 16.052, 14.415000000000001, 14.276, 17.316, 14.858, 12.343000000000002, 15.994000000000003, 12.437, 15.254000000000001, 14.054, 12.713000000000001, 21.979000000000003, 15.350000000000001, 14.804000000000002, 15.209000000000001, 14.870999999999999, 14.008, 17.276, 16.232, 17.715, 23.573, 14.799000000000001, 16.186, 19.448, 15.062000000000001, 13.737, 12.11, 14.443, 14.632000000000001, 12.827000000000002, 13.803, 15.403000000000002, 17.392, 17.304999999999996, 21.598000000000003, 13.936, 12.035, 11.924, 15.328000000000003, 15.158000000000001, 14.317, 17.926000000000005, 17.669000000000004, 13.506, 14.802000000000001, 13.237000000000002, 15.450000000000003, 16.831, 14.943999999999999, 12.818999999999999, 14.739, 15.875, 14.262, 15.33], "episode_lengths": [98, 98, 71, 77, 91, 96, 80, 65, 66, 96, 78, 67, 107, 69, 117, 59, 84, 80, 94, 51, 68, 101, 80, 83, 76, 79, 85, 60, 151, 86, 79, 70, 93, 57, 72, 72, 57, 82, 86, 61, 60, 75, 75, 68, 55, 77, 89, 86, 71, 80, 77, 51, 78, 47, 72, 48, 47, 102, 65, 63, 59, 66, 65, 81, 79, 94, 119, 64, 68, 108, 70, 73, 51, 55, 63, 54, 57, 77, 80, 70, 97, 62, 43, 44, 59, 56, 50, 88, 76, 66, 82, 59, 59, 74, 59, 51, 65, 80, 51, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45872812811479574, "mean_inference_ms": 1.1709569974376983, "mean_action_processing_ms": 0.08083468612659557, "mean_env_wait_ms": 5.012361851030389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003229379653930664, "ViewRequirementAgentConnector_ms": 0.2357954978942871}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25598, "num_agent_steps_trained": 0, "num_env_steps_sampled": 25600, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.014639286388959, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 25600, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 25598, "timers": {"training_iteration_time_ms": 145710.118, "sample_time_ms": 6858.266, "synch_weights_time_ms": 49.45}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 0, "num_agent_steps_sampled": 25598, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 221, "training_iteration": 25, "trial_id": "default", "date": "2025-12-19_20-28-24", "timestamp": 1766147304, "time_this_iter_s": 145.9833948612213, "time_total_s": 3664.351501226425, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3664.351501226425, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 94.60386473429952, "ram_util_percent": 20.899516908212554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.48373682238161564}, "default_policy": {"total_loss": 0.48373682238161564, "policy_loss": -0.015935375494882463, "vf_loss": 2.004671294428408, "vf_loss_unclipped": 6.779854311607778, "vf_explained_var": 0.09645196348428726, "entropy": 1.495628584176302, "mean_kl_loss": 0.0021036154429905805, "gradients_default_optimizer_global_norm": 1.356227281689644, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 2.9802322831784522e-09}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 0, "num_agent_steps_sampled": 26622, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.65300000000001, "episode_reward_min": 11.265, "episode_reward_mean": 15.59684, "episode_len_mean": 71.58, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.789000000000001, 18.856, 15.619000000000002, 19.063000000000002, 11.265, 11.298, 19.438000000000002, 13.852, 14.989, 13.582, 15.243000000000002, 16.177, 12.052999999999999, 28.65300000000001, 19.548999999999996, 15.097, 14.315999999999999, 18.399, 13.064, 16.041, 14.701, 14.079000000000002, 16.277, 17.661, 14.266000000000002, 13.030000000000001, 14.206000000000001, 17.394000000000002, 16.092, 11.435, 11.66, 16.052, 14.415000000000001, 14.276, 17.316, 14.858, 12.343000000000002, 15.994000000000003, 12.437, 15.254000000000001, 14.054, 12.713000000000001, 21.979000000000003, 15.350000000000001, 14.804000000000002, 15.209000000000001, 14.870999999999999, 14.008, 17.276, 16.232, 17.715, 23.573, 14.799000000000001, 16.186, 19.448, 15.062000000000001, 13.737, 12.11, 14.443, 14.632000000000001, 12.827000000000002, 13.803, 15.403000000000002, 17.392, 17.304999999999996, 21.598000000000003, 13.936, 12.035, 11.924, 15.328000000000003, 15.158000000000001, 14.317, 17.926000000000005, 17.669000000000004, 13.506, 14.802000000000001, 13.237000000000002, 15.450000000000003, 16.831, 14.943999999999999, 12.818999999999999, 14.739, 15.875, 14.262, 15.33, 13.974, 19.231, 21.536, 16.017, 18.186999999999998, 14.222999999999999, 12.855, 16.480999999999998, 15.51, 21.188, 13.907, 14.483, 12.808000000000002, 17.87, 19.708000000000002], "episode_lengths": [59, 84, 80, 94, 51, 68, 101, 80, 83, 76, 79, 85, 60, 151, 86, 79, 70, 93, 57, 72, 72, 57, 82, 86, 61, 60, 75, 75, 68, 55, 77, 89, 86, 71, 80, 77, 51, 78, 47, 72, 48, 47, 102, 65, 63, 59, 66, 65, 81, 79, 94, 119, 64, 68, 108, 70, 73, 51, 55, 63, 54, 57, 77, 80, 70, 97, 62, 43, 44, 59, 56, 50, 88, 76, 66, 82, 59, 59, 74, 59, 51, 65, 80, 51, 65, 62, 89, 98, 68, 75, 55, 55, 67, 66, 104, 59, 52, 46, 84, 87]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.460545459932069, "mean_inference_ms": 1.1701477162374538, "mean_action_processing_ms": 0.0808181824930011, "mean_env_wait_ms": 5.00981756567221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032396316528320312, "ViewRequirementAgentConnector_ms": 0.23600387573242188}}, "episode_reward_max": 28.65300000000001, "episode_reward_min": 11.265, "episode_reward_mean": 15.59684, "episode_len_mean": 71.58, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.789000000000001, 18.856, 15.619000000000002, 19.063000000000002, 11.265, 11.298, 19.438000000000002, 13.852, 14.989, 13.582, 15.243000000000002, 16.177, 12.052999999999999, 28.65300000000001, 19.548999999999996, 15.097, 14.315999999999999, 18.399, 13.064, 16.041, 14.701, 14.079000000000002, 16.277, 17.661, 14.266000000000002, 13.030000000000001, 14.206000000000001, 17.394000000000002, 16.092, 11.435, 11.66, 16.052, 14.415000000000001, 14.276, 17.316, 14.858, 12.343000000000002, 15.994000000000003, 12.437, 15.254000000000001, 14.054, 12.713000000000001, 21.979000000000003, 15.350000000000001, 14.804000000000002, 15.209000000000001, 14.870999999999999, 14.008, 17.276, 16.232, 17.715, 23.573, 14.799000000000001, 16.186, 19.448, 15.062000000000001, 13.737, 12.11, 14.443, 14.632000000000001, 12.827000000000002, 13.803, 15.403000000000002, 17.392, 17.304999999999996, 21.598000000000003, 13.936, 12.035, 11.924, 15.328000000000003, 15.158000000000001, 14.317, 17.926000000000005, 17.669000000000004, 13.506, 14.802000000000001, 13.237000000000002, 15.450000000000003, 16.831, 14.943999999999999, 12.818999999999999, 14.739, 15.875, 14.262, 15.33, 13.974, 19.231, 21.536, 16.017, 18.186999999999998, 14.222999999999999, 12.855, 16.480999999999998, 15.51, 21.188, 13.907, 14.483, 12.808000000000002, 17.87, 19.708000000000002], "episode_lengths": [59, 84, 80, 94, 51, 68, 101, 80, 83, 76, 79, 85, 60, 151, 86, 79, 70, 93, 57, 72, 72, 57, 82, 86, 61, 60, 75, 75, 68, 55, 77, 89, 86, 71, 80, 77, 51, 78, 47, 72, 48, 47, 102, 65, 63, 59, 66, 65, 81, 79, 94, 119, 64, 68, 108, 70, 73, 51, 55, 63, 54, 57, 77, 80, 70, 97, 62, 43, 44, 59, 56, 50, 88, 76, 66, 82, 59, 59, 74, 59, 51, 65, 80, 51, 65, 62, 89, 98, 68, 75, 55, 55, 67, 66, 104, 59, 52, 46, 84, 87]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.460545459932069, "mean_inference_ms": 1.1701477162374538, "mean_action_processing_ms": 0.0808181824930011, "mean_env_wait_ms": 5.00981756567221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032396316528320312, "ViewRequirementAgentConnector_ms": 0.23600387573242188}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26622, "num_agent_steps_trained": 0, "num_env_steps_sampled": 26624, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.90773199104973, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 26624, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 26622, "timers": {"training_iteration_time_ms": 145853.81, "sample_time_ms": 6856.386, "synch_weights_time_ms": 49.271}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 0, "num_agent_steps_sampled": 26622, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 236, "training_iteration": 26, "trial_id": "default", "date": "2025-12-19_20-30-53", "timestamp": 1766147453, "time_this_iter_s": 148.24280881881714, "time_total_s": 3812.5943100452423, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3812.5943100452423, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 94.90616113744075, "ram_util_percent": 21.297156398104267}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5382709183730185}, "default_policy": {"total_loss": 0.5382709183730185, "policy_loss": -0.015613266319269315, "vf_loss": 2.2215089812874793, "vf_loss_unclipped": 7.479097171127796, "vf_explained_var": 0.10737061277031898, "entropy": 1.4930619612336158, "mean_kl_loss": 0.002127886870384188, "gradients_default_optimizer_global_norm": 1.4484855324029922, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.4901161415892261e-09}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 0, "num_agent_steps_sampled": 27646, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 23.573, "episode_reward_min": 11.148, "episode_reward_mean": 15.531, "episode_len_mean": 68.8, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.315999999999999, 18.399, 13.064, 16.041, 14.701, 14.079000000000002, 16.277, 17.661, 14.266000000000002, 13.030000000000001, 14.206000000000001, 17.394000000000002, 16.092, 11.435, 11.66, 16.052, 14.415000000000001, 14.276, 17.316, 14.858, 12.343000000000002, 15.994000000000003, 12.437, 15.254000000000001, 14.054, 12.713000000000001, 21.979000000000003, 15.350000000000001, 14.804000000000002, 15.209000000000001, 14.870999999999999, 14.008, 17.276, 16.232, 17.715, 23.573, 14.799000000000001, 16.186, 19.448, 15.062000000000001, 13.737, 12.11, 14.443, 14.632000000000001, 12.827000000000002, 13.803, 15.403000000000002, 17.392, 17.304999999999996, 21.598000000000003, 13.936, 12.035, 11.924, 15.328000000000003, 15.158000000000001, 14.317, 17.926000000000005, 17.669000000000004, 13.506, 14.802000000000001, 13.237000000000002, 15.450000000000003, 16.831, 14.943999999999999, 12.818999999999999, 14.739, 15.875, 14.262, 15.33, 13.974, 19.231, 21.536, 16.017, 18.186999999999998, 14.222999999999999, 12.855, 16.480999999999998, 15.51, 21.188, 13.907, 14.483, 12.808000000000002, 17.87, 19.708000000000002, 14.617, 20.322000000000003, 16.630000000000003, 15.904000000000002, 17.406000000000002, 14.419, 13.847999999999999, 14.767000000000001, 15.943000000000001, 17.400000000000002, 15.455, 11.148, 13.463000000000001, 15.419, 22.285, 13.913], "episode_lengths": [70, 93, 57, 72, 72, 57, 82, 86, 61, 60, 75, 75, 68, 55, 77, 89, 86, 71, 80, 77, 51, 78, 47, 72, 48, 47, 102, 65, 63, 59, 66, 65, 81, 79, 94, 119, 64, 68, 108, 70, 73, 51, 55, 63, 54, 57, 77, 80, 70, 97, 62, 43, 44, 59, 56, 50, 88, 76, 66, 82, 59, 59, 74, 59, 51, 65, 80, 51, 65, 62, 89, 98, 68, 75, 55, 55, 67, 66, 104, 59, 52, 46, 84, 87, 55, 92, 70, 56, 69, 62, 54, 55, 65, 74, 61, 43, 55, 68, 99, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4620597671129563, "mean_inference_ms": 1.16760826059398, "mean_action_processing_ms": 0.08077030891673612, "mean_env_wait_ms": 5.006256686871823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003246307373046875, "ViewRequirementAgentConnector_ms": 0.2361149787902832}}, "episode_reward_max": 23.573, "episode_reward_min": 11.148, "episode_reward_mean": 15.531, "episode_len_mean": 68.8, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.315999999999999, 18.399, 13.064, 16.041, 14.701, 14.079000000000002, 16.277, 17.661, 14.266000000000002, 13.030000000000001, 14.206000000000001, 17.394000000000002, 16.092, 11.435, 11.66, 16.052, 14.415000000000001, 14.276, 17.316, 14.858, 12.343000000000002, 15.994000000000003, 12.437, 15.254000000000001, 14.054, 12.713000000000001, 21.979000000000003, 15.350000000000001, 14.804000000000002, 15.209000000000001, 14.870999999999999, 14.008, 17.276, 16.232, 17.715, 23.573, 14.799000000000001, 16.186, 19.448, 15.062000000000001, 13.737, 12.11, 14.443, 14.632000000000001, 12.827000000000002, 13.803, 15.403000000000002, 17.392, 17.304999999999996, 21.598000000000003, 13.936, 12.035, 11.924, 15.328000000000003, 15.158000000000001, 14.317, 17.926000000000005, 17.669000000000004, 13.506, 14.802000000000001, 13.237000000000002, 15.450000000000003, 16.831, 14.943999999999999, 12.818999999999999, 14.739, 15.875, 14.262, 15.33, 13.974, 19.231, 21.536, 16.017, 18.186999999999998, 14.222999999999999, 12.855, 16.480999999999998, 15.51, 21.188, 13.907, 14.483, 12.808000000000002, 17.87, 19.708000000000002, 14.617, 20.322000000000003, 16.630000000000003, 15.904000000000002, 17.406000000000002, 14.419, 13.847999999999999, 14.767000000000001, 15.943000000000001, 17.400000000000002, 15.455, 11.148, 13.463000000000001, 15.419, 22.285, 13.913], "episode_lengths": [70, 93, 57, 72, 72, 57, 82, 86, 61, 60, 75, 75, 68, 55, 77, 89, 86, 71, 80, 77, 51, 78, 47, 72, 48, 47, 102, 65, 63, 59, 66, 65, 81, 79, 94, 119, 64, 68, 108, 70, 73, 51, 55, 63, 54, 57, 77, 80, 70, 97, 62, 43, 44, 59, 56, 50, 88, 76, 66, 82, 59, 59, 74, 59, 51, 65, 80, 51, 65, 62, 89, 98, 68, 75, 55, 55, 67, 66, 104, 59, 52, 46, 84, 87, 55, 92, 70, 56, 69, 62, 54, 55, 65, 74, 61, 43, 55, 68, 99, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4620597671129563, "mean_inference_ms": 1.16760826059398, "mean_action_processing_ms": 0.08077030891673612, "mean_env_wait_ms": 5.006256686871823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003246307373046875, "ViewRequirementAgentConnector_ms": 0.2361149787902832}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27646, "num_agent_steps_trained": 0, "num_env_steps_sampled": 27648, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.947390970596941, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 27648, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 27646, "timers": {"training_iteration_time_ms": 146128.872, "sample_time_ms": 6859.588, "synch_weights_time_ms": 48.672}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 0, "num_agent_steps_sampled": 27646, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 252, "training_iteration": 27, "trial_id": "default", "date": "2025-12-19_20-33-30", "timestamp": 1766147610, "time_this_iter_s": 147.3962459564209, "time_total_s": 3959.990556001663, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3959.990556001663, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 89.38251121076233, "ram_util_percent": 20.831838565022423}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.4758424377068877}, "default_policy": {"total_loss": 0.4758424377068877, "policy_loss": -0.009613574587274343, "vf_loss": 1.9477671911939978, "vf_loss_unclipped": 6.326451847516, "vf_explained_var": 0.15152523778378962, "entropy": 1.4857871927320958, "mean_kl_loss": 0.0013812815813109224, "gradients_default_optimizer_global_norm": 1.4176737893372775, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 7.450580707946131e-10}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28670, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 25.25, "episode_reward_min": 11.148, "episode_reward_mean": 15.762920000000001, "episode_len_mean": 68.97, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.66, 16.052, 14.415000000000001, 14.276, 17.316, 14.858, 12.343000000000002, 15.994000000000003, 12.437, 15.254000000000001, 14.054, 12.713000000000001, 21.979000000000003, 15.350000000000001, 14.804000000000002, 15.209000000000001, 14.870999999999999, 14.008, 17.276, 16.232, 17.715, 23.573, 14.799000000000001, 16.186, 19.448, 15.062000000000001, 13.737, 12.11, 14.443, 14.632000000000001, 12.827000000000002, 13.803, 15.403000000000002, 17.392, 17.304999999999996, 21.598000000000003, 13.936, 12.035, 11.924, 15.328000000000003, 15.158000000000001, 14.317, 17.926000000000005, 17.669000000000004, 13.506, 14.802000000000001, 13.237000000000002, 15.450000000000003, 16.831, 14.943999999999999, 12.818999999999999, 14.739, 15.875, 14.262, 15.33, 13.974, 19.231, 21.536, 16.017, 18.186999999999998, 14.222999999999999, 12.855, 16.480999999999998, 15.51, 21.188, 13.907, 14.483, 12.808000000000002, 17.87, 19.708000000000002, 14.617, 20.322000000000003, 16.630000000000003, 15.904000000000002, 17.406000000000002, 14.419, 13.847999999999999, 14.767000000000001, 15.943000000000001, 17.400000000000002, 15.455, 11.148, 13.463000000000001, 15.419, 22.285, 13.913, 12.509, 17.578000000000003, 18.874000000000002, 17.702, 18.735, 20.796999999999997, 25.25, 14.576, 16.058, 14.286, 14.127000000000002, 13.814, 13.454, 16.393], "episode_lengths": [77, 89, 86, 71, 80, 77, 51, 78, 47, 72, 48, 47, 102, 65, 63, 59, 66, 65, 81, 79, 94, 119, 64, 68, 108, 70, 73, 51, 55, 63, 54, 57, 77, 80, 70, 97, 62, 43, 44, 59, 56, 50, 88, 76, 66, 82, 59, 59, 74, 59, 51, 65, 80, 51, 65, 62, 89, 98, 68, 75, 55, 55, 67, 66, 104, 59, 52, 46, 84, 87, 55, 92, 70, 56, 69, 62, 54, 55, 65, 74, 61, 43, 55, 68, 99, 60, 46, 69, 97, 79, 77, 101, 113, 58, 81, 59, 52, 61, 43, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4634384830246526, "mean_inference_ms": 1.166379345093313, "mean_action_processing_ms": 0.08074819193201303, "mean_env_wait_ms": 5.003998113137486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032622814178466797, "ViewRequirementAgentConnector_ms": 0.23704266548156738}}, "episode_reward_max": 25.25, "episode_reward_min": 11.148, "episode_reward_mean": 15.762920000000001, "episode_len_mean": 68.97, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.66, 16.052, 14.415000000000001, 14.276, 17.316, 14.858, 12.343000000000002, 15.994000000000003, 12.437, 15.254000000000001, 14.054, 12.713000000000001, 21.979000000000003, 15.350000000000001, 14.804000000000002, 15.209000000000001, 14.870999999999999, 14.008, 17.276, 16.232, 17.715, 23.573, 14.799000000000001, 16.186, 19.448, 15.062000000000001, 13.737, 12.11, 14.443, 14.632000000000001, 12.827000000000002, 13.803, 15.403000000000002, 17.392, 17.304999999999996, 21.598000000000003, 13.936, 12.035, 11.924, 15.328000000000003, 15.158000000000001, 14.317, 17.926000000000005, 17.669000000000004, 13.506, 14.802000000000001, 13.237000000000002, 15.450000000000003, 16.831, 14.943999999999999, 12.818999999999999, 14.739, 15.875, 14.262, 15.33, 13.974, 19.231, 21.536, 16.017, 18.186999999999998, 14.222999999999999, 12.855, 16.480999999999998, 15.51, 21.188, 13.907, 14.483, 12.808000000000002, 17.87, 19.708000000000002, 14.617, 20.322000000000003, 16.630000000000003, 15.904000000000002, 17.406000000000002, 14.419, 13.847999999999999, 14.767000000000001, 15.943000000000001, 17.400000000000002, 15.455, 11.148, 13.463000000000001, 15.419, 22.285, 13.913, 12.509, 17.578000000000003, 18.874000000000002, 17.702, 18.735, 20.796999999999997, 25.25, 14.576, 16.058, 14.286, 14.127000000000002, 13.814, 13.454, 16.393], "episode_lengths": [77, 89, 86, 71, 80, 77, 51, 78, 47, 72, 48, 47, 102, 65, 63, 59, 66, 65, 81, 79, 94, 119, 64, 68, 108, 70, 73, 51, 55, 63, 54, 57, 77, 80, 70, 97, 62, 43, 44, 59, 56, 50, 88, 76, 66, 82, 59, 59, 74, 59, 51, 65, 80, 51, 65, 62, 89, 98, 68, 75, 55, 55, 67, 66, 104, 59, 52, 46, 84, 87, 55, 92, 70, 56, 69, 62, 54, 55, 65, 74, 61, 43, 55, 68, 99, 60, 46, 69, 97, 79, 77, 101, 113, 58, 81, 59, 52, 61, 43, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4634384830246526, "mean_inference_ms": 1.166379345093313, "mean_action_processing_ms": 0.08074819193201303, "mean_env_wait_ms": 5.003998113137486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032622814178466797, "ViewRequirementAgentConnector_ms": 0.23704266548156738}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28670, "num_agent_steps_trained": 0, "num_env_steps_sampled": 28672, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.033038060021485, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 28672, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 28670, "timers": {"training_iteration_time_ms": 146023.56, "sample_time_ms": 6868.883, "synch_weights_time_ms": 48.244}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28670, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 266, "training_iteration": 28, "trial_id": "default", "date": "2025-12-19_20-35-55", "timestamp": 1766147755, "time_this_iter_s": 145.6037232875824, "time_total_s": 4105.594279289246, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4105.594279289246, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 94.72932692307693, "ram_util_percent": 21.40817307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.4782566327601671}, "default_policy": {"total_loss": 0.4782566327601671, "policy_loss": -0.018157807685201987, "vf_loss": 1.991428292542696, "vf_loss_unclipped": 6.783178911358118, "vf_explained_var": 0.07206534929573535, "entropy": 1.4426361061632633, "mean_kl_loss": 0.0025783795710296433, "gradients_default_optimizer_global_norm": 1.370368494465947, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 3.7252903539730653e-10}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 0, "num_agent_steps_sampled": 29694, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 25.25, "episode_reward_min": 11.148, "episode_reward_mean": 16.07889, "episode_len_mean": 69.06, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.804000000000002, 15.209000000000001, 14.870999999999999, 14.008, 17.276, 16.232, 17.715, 23.573, 14.799000000000001, 16.186, 19.448, 15.062000000000001, 13.737, 12.11, 14.443, 14.632000000000001, 12.827000000000002, 13.803, 15.403000000000002, 17.392, 17.304999999999996, 21.598000000000003, 13.936, 12.035, 11.924, 15.328000000000003, 15.158000000000001, 14.317, 17.926000000000005, 17.669000000000004, 13.506, 14.802000000000001, 13.237000000000002, 15.450000000000003, 16.831, 14.943999999999999, 12.818999999999999, 14.739, 15.875, 14.262, 15.33, 13.974, 19.231, 21.536, 16.017, 18.186999999999998, 14.222999999999999, 12.855, 16.480999999999998, 15.51, 21.188, 13.907, 14.483, 12.808000000000002, 17.87, 19.708000000000002, 14.617, 20.322000000000003, 16.630000000000003, 15.904000000000002, 17.406000000000002, 14.419, 13.847999999999999, 14.767000000000001, 15.943000000000001, 17.400000000000002, 15.455, 11.148, 13.463000000000001, 15.419, 22.285, 13.913, 12.509, 17.578000000000003, 18.874000000000002, 17.702, 18.735, 20.796999999999997, 25.25, 14.576, 16.058, 14.286, 14.127000000000002, 13.814, 13.454, 16.393, 14.966, 17.4, 18.369999999999997, 12.234000000000002, 13.287000000000003, 14.533000000000001, 20.459000000000003, 15.241, 22.527, 16.172, 17.213, 15.994000000000003, 21.851, 20.051000000000002], "episode_lengths": [63, 59, 66, 65, 81, 79, 94, 119, 64, 68, 108, 70, 73, 51, 55, 63, 54, 57, 77, 80, 70, 97, 62, 43, 44, 59, 56, 50, 88, 76, 66, 82, 59, 59, 74, 59, 51, 65, 80, 51, 65, 62, 89, 98, 68, 75, 55, 55, 67, 66, 104, 59, 52, 46, 84, 87, 55, 92, 70, 56, 69, 62, 54, 55, 65, 74, 61, 43, 55, 68, 99, 60, 46, 69, 97, 79, 77, 101, 113, 58, 81, 59, 52, 61, 43, 64, 57, 74, 77, 48, 48, 52, 88, 60, 104, 64, 75, 64, 96, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4649723300891098, "mean_inference_ms": 1.1668314308765924, "mean_action_processing_ms": 0.08076922741620778, "mean_env_wait_ms": 5.00313653410982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032541751861572266, "ViewRequirementAgentConnector_ms": 0.23710393905639648}}, "episode_reward_max": 25.25, "episode_reward_min": 11.148, "episode_reward_mean": 16.07889, "episode_len_mean": 69.06, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.804000000000002, 15.209000000000001, 14.870999999999999, 14.008, 17.276, 16.232, 17.715, 23.573, 14.799000000000001, 16.186, 19.448, 15.062000000000001, 13.737, 12.11, 14.443, 14.632000000000001, 12.827000000000002, 13.803, 15.403000000000002, 17.392, 17.304999999999996, 21.598000000000003, 13.936, 12.035, 11.924, 15.328000000000003, 15.158000000000001, 14.317, 17.926000000000005, 17.669000000000004, 13.506, 14.802000000000001, 13.237000000000002, 15.450000000000003, 16.831, 14.943999999999999, 12.818999999999999, 14.739, 15.875, 14.262, 15.33, 13.974, 19.231, 21.536, 16.017, 18.186999999999998, 14.222999999999999, 12.855, 16.480999999999998, 15.51, 21.188, 13.907, 14.483, 12.808000000000002, 17.87, 19.708000000000002, 14.617, 20.322000000000003, 16.630000000000003, 15.904000000000002, 17.406000000000002, 14.419, 13.847999999999999, 14.767000000000001, 15.943000000000001, 17.400000000000002, 15.455, 11.148, 13.463000000000001, 15.419, 22.285, 13.913, 12.509, 17.578000000000003, 18.874000000000002, 17.702, 18.735, 20.796999999999997, 25.25, 14.576, 16.058, 14.286, 14.127000000000002, 13.814, 13.454, 16.393, 14.966, 17.4, 18.369999999999997, 12.234000000000002, 13.287000000000003, 14.533000000000001, 20.459000000000003, 15.241, 22.527, 16.172, 17.213, 15.994000000000003, 21.851, 20.051000000000002], "episode_lengths": [63, 59, 66, 65, 81, 79, 94, 119, 64, 68, 108, 70, 73, 51, 55, 63, 54, 57, 77, 80, 70, 97, 62, 43, 44, 59, 56, 50, 88, 76, 66, 82, 59, 59, 74, 59, 51, 65, 80, 51, 65, 62, 89, 98, 68, 75, 55, 55, 67, 66, 104, 59, 52, 46, 84, 87, 55, 92, 70, 56, 69, 62, 54, 55, 65, 74, 61, 43, 55, 68, 99, 60, 46, 69, 97, 79, 77, 101, 113, 58, 81, 59, 52, 61, 43, 64, 57, 74, 77, 48, 48, 52, 88, 60, 104, 64, 75, 64, 96, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4649723300891098, "mean_inference_ms": 1.1668314308765924, "mean_action_processing_ms": 0.08076922741620778, "mean_env_wait_ms": 5.00313653410982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032541751861572266, "ViewRequirementAgentConnector_ms": 0.23710393905639648}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29694, "num_agent_steps_trained": 0, "num_env_steps_sampled": 29696, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.870976194521028, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 29696, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 29694, "timers": {"training_iteration_time_ms": 146478.487, "sample_time_ms": 6872.35, "synch_weights_time_ms": 47.934}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 0, "num_agent_steps_sampled": 29694, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 280, "training_iteration": 29, "trial_id": "default", "date": "2025-12-19_20-38-24", "timestamp": 1766147904, "time_this_iter_s": 149.0353262424469, "time_total_s": 4254.6296055316925, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4254.6296055316925, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 94.62830188679244, "ram_util_percent": 20.890094339622646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5171101945452392}, "default_policy": {"total_loss": 0.5171101945452392, "policy_loss": -0.010654461185913533, "vf_loss": 2.1168119955807922, "vf_loss_unclipped": 6.739100233837962, "vf_explained_var": 0.1356755007058382, "entropy": 1.4383415758609772, "mean_kl_loss": 0.0013519436260413186, "gradients_default_optimizer_global_norm": 1.549666655063629, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.8626451769865326e-10}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 0, "num_agent_steps_sampled": 30718, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 27.450000000000003, "episode_reward_min": 11.148, "episode_reward_mean": 16.19003, "episode_len_mean": 68.33, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.632000000000001, 12.827000000000002, 13.803, 15.403000000000002, 17.392, 17.304999999999996, 21.598000000000003, 13.936, 12.035, 11.924, 15.328000000000003, 15.158000000000001, 14.317, 17.926000000000005, 17.669000000000004, 13.506, 14.802000000000001, 13.237000000000002, 15.450000000000003, 16.831, 14.943999999999999, 12.818999999999999, 14.739, 15.875, 14.262, 15.33, 13.974, 19.231, 21.536, 16.017, 18.186999999999998, 14.222999999999999, 12.855, 16.480999999999998, 15.51, 21.188, 13.907, 14.483, 12.808000000000002, 17.87, 19.708000000000002, 14.617, 20.322000000000003, 16.630000000000003, 15.904000000000002, 17.406000000000002, 14.419, 13.847999999999999, 14.767000000000001, 15.943000000000001, 17.400000000000002, 15.455, 11.148, 13.463000000000001, 15.419, 22.285, 13.913, 12.509, 17.578000000000003, 18.874000000000002, 17.702, 18.735, 20.796999999999997, 25.25, 14.576, 16.058, 14.286, 14.127000000000002, 13.814, 13.454, 16.393, 14.966, 17.4, 18.369999999999997, 12.234000000000002, 13.287000000000003, 14.533000000000001, 20.459000000000003, 15.241, 22.527, 16.172, 17.213, 15.994000000000003, 21.851, 20.051000000000002, 17.089000000000006, 17.215000000000003, 18.258999999999997, 15.589, 12.84, 19.397, 15.442999999999998, 14.801, 17.677, 13.289000000000001, 12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002], "episode_lengths": [63, 54, 57, 77, 80, 70, 97, 62, 43, 44, 59, 56, 50, 88, 76, 66, 82, 59, 59, 74, 59, 51, 65, 80, 51, 65, 62, 89, 98, 68, 75, 55, 55, 67, 66, 104, 59, 52, 46, 84, 87, 55, 92, 70, 56, 69, 62, 54, 55, 65, 74, 61, 43, 55, 68, 99, 60, 46, 69, 97, 79, 77, 101, 113, 58, 81, 59, 52, 61, 43, 64, 57, 74, 77, 48, 48, 52, 88, 60, 104, 64, 75, 64, 96, 92, 79, 85, 83, 57, 42, 81, 54, 59, 87, 44, 49, 126, 52, 83, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4662706855195216, "mean_inference_ms": 1.1657413803439423, "mean_action_processing_ms": 0.08075580555253174, "mean_env_wait_ms": 5.001227650516904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003263235092163086, "ViewRequirementAgentConnector_ms": 0.23735475540161133}}, "episode_reward_max": 27.450000000000003, "episode_reward_min": 11.148, "episode_reward_mean": 16.19003, "episode_len_mean": 68.33, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.632000000000001, 12.827000000000002, 13.803, 15.403000000000002, 17.392, 17.304999999999996, 21.598000000000003, 13.936, 12.035, 11.924, 15.328000000000003, 15.158000000000001, 14.317, 17.926000000000005, 17.669000000000004, 13.506, 14.802000000000001, 13.237000000000002, 15.450000000000003, 16.831, 14.943999999999999, 12.818999999999999, 14.739, 15.875, 14.262, 15.33, 13.974, 19.231, 21.536, 16.017, 18.186999999999998, 14.222999999999999, 12.855, 16.480999999999998, 15.51, 21.188, 13.907, 14.483, 12.808000000000002, 17.87, 19.708000000000002, 14.617, 20.322000000000003, 16.630000000000003, 15.904000000000002, 17.406000000000002, 14.419, 13.847999999999999, 14.767000000000001, 15.943000000000001, 17.400000000000002, 15.455, 11.148, 13.463000000000001, 15.419, 22.285, 13.913, 12.509, 17.578000000000003, 18.874000000000002, 17.702, 18.735, 20.796999999999997, 25.25, 14.576, 16.058, 14.286, 14.127000000000002, 13.814, 13.454, 16.393, 14.966, 17.4, 18.369999999999997, 12.234000000000002, 13.287000000000003, 14.533000000000001, 20.459000000000003, 15.241, 22.527, 16.172, 17.213, 15.994000000000003, 21.851, 20.051000000000002, 17.089000000000006, 17.215000000000003, 18.258999999999997, 15.589, 12.84, 19.397, 15.442999999999998, 14.801, 17.677, 13.289000000000001, 12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002], "episode_lengths": [63, 54, 57, 77, 80, 70, 97, 62, 43, 44, 59, 56, 50, 88, 76, 66, 82, 59, 59, 74, 59, 51, 65, 80, 51, 65, 62, 89, 98, 68, 75, 55, 55, 67, 66, 104, 59, 52, 46, 84, 87, 55, 92, 70, 56, 69, 62, 54, 55, 65, 74, 61, 43, 55, 68, 99, 60, 46, 69, 97, 79, 77, 101, 113, 58, 81, 59, 52, 61, 43, 64, 57, 74, 77, 48, 48, 52, 88, 60, 104, 64, 75, 64, 96, 92, 79, 85, 83, 57, 42, 81, 54, 59, 87, 44, 49, 126, 52, 83, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4662706855195216, "mean_inference_ms": 1.1657413803439423, "mean_action_processing_ms": 0.08075580555253174, "mean_env_wait_ms": 5.001227650516904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003263235092163086, "ViewRequirementAgentConnector_ms": 0.23735475540161133}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30718, "num_agent_steps_trained": 0, "num_env_steps_sampled": 30720, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.04191134728151, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 30720, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 30718, "timers": {"training_iteration_time_ms": 146408.206, "sample_time_ms": 6873.501, "synch_weights_time_ms": 47.617}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 0, "num_agent_steps_sampled": 30718, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 295, "training_iteration": 30, "trial_id": "default", "date": "2025-12-19_20-40-50", "timestamp": 1766148050, "time_this_iter_s": 145.41841340065002, "time_total_s": 4400.0480189323425, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4400.0480189323425, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 94.67874396135265, "ram_util_percent": 21.69903381642512}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5236354565713555}, "default_policy": {"total_loss": 0.5236354565713555, "policy_loss": -0.012014587386511266, "vf_loss": 2.1484152641147376, "vf_loss_unclipped": 6.683130189776421, "vf_explained_var": 0.15549654476344585, "entropy": 1.4537723332643508, "mean_kl_loss": 0.0013133885680067792, "gradients_default_optimizer_global_norm": 1.8176826912909747, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 9.313225884932663e-11}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 0, "num_agent_steps_sampled": 31742, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 29.421, "episode_reward_min": 11.148, "episode_reward_mean": 16.35592, "episode_len_mean": 68.79, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.506, 14.802000000000001, 13.237000000000002, 15.450000000000003, 16.831, 14.943999999999999, 12.818999999999999, 14.739, 15.875, 14.262, 15.33, 13.974, 19.231, 21.536, 16.017, 18.186999999999998, 14.222999999999999, 12.855, 16.480999999999998, 15.51, 21.188, 13.907, 14.483, 12.808000000000002, 17.87, 19.708000000000002, 14.617, 20.322000000000003, 16.630000000000003, 15.904000000000002, 17.406000000000002, 14.419, 13.847999999999999, 14.767000000000001, 15.943000000000001, 17.400000000000002, 15.455, 11.148, 13.463000000000001, 15.419, 22.285, 13.913, 12.509, 17.578000000000003, 18.874000000000002, 17.702, 18.735, 20.796999999999997, 25.25, 14.576, 16.058, 14.286, 14.127000000000002, 13.814, 13.454, 16.393, 14.966, 17.4, 18.369999999999997, 12.234000000000002, 13.287000000000003, 14.533000000000001, 20.459000000000003, 15.241, 22.527, 16.172, 17.213, 15.994000000000003, 21.851, 20.051000000000002, 17.089000000000006, 17.215000000000003, 18.258999999999997, 15.589, 12.84, 19.397, 15.442999999999998, 14.801, 17.677, 13.289000000000001, 12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002, 13.589, 14.604, 15.375, 15.753, 19.648000000000007, 12.882, 29.421, 15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126], "episode_lengths": [66, 82, 59, 59, 74, 59, 51, 65, 80, 51, 65, 62, 89, 98, 68, 75, 55, 55, 67, 66, 104, 59, 52, 46, 84, 87, 55, 92, 70, 56, 69, 62, 54, 55, 65, 74, 61, 43, 55, 68, 99, 60, 46, 69, 97, 79, 77, 101, 113, 58, 81, 59, 52, 61, 43, 64, 57, 74, 77, 48, 48, 52, 88, 60, 104, 64, 75, 64, 96, 92, 79, 85, 83, 57, 42, 81, 54, 59, 87, 44, 49, 126, 52, 83, 61, 49, 60, 70, 62, 81, 46, 126, 61, 51, 102, 49, 56, 66, 69, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46757986081022096, "mean_inference_ms": 1.1652532644539244, "mean_action_processing_ms": 0.08074981462506951, "mean_env_wait_ms": 4.999728443420484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032553672790527344, "ViewRequirementAgentConnector_ms": 0.23675274848937988}}, "episode_reward_max": 29.421, "episode_reward_min": 11.148, "episode_reward_mean": 16.35592, "episode_len_mean": 68.79, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.506, 14.802000000000001, 13.237000000000002, 15.450000000000003, 16.831, 14.943999999999999, 12.818999999999999, 14.739, 15.875, 14.262, 15.33, 13.974, 19.231, 21.536, 16.017, 18.186999999999998, 14.222999999999999, 12.855, 16.480999999999998, 15.51, 21.188, 13.907, 14.483, 12.808000000000002, 17.87, 19.708000000000002, 14.617, 20.322000000000003, 16.630000000000003, 15.904000000000002, 17.406000000000002, 14.419, 13.847999999999999, 14.767000000000001, 15.943000000000001, 17.400000000000002, 15.455, 11.148, 13.463000000000001, 15.419, 22.285, 13.913, 12.509, 17.578000000000003, 18.874000000000002, 17.702, 18.735, 20.796999999999997, 25.25, 14.576, 16.058, 14.286, 14.127000000000002, 13.814, 13.454, 16.393, 14.966, 17.4, 18.369999999999997, 12.234000000000002, 13.287000000000003, 14.533000000000001, 20.459000000000003, 15.241, 22.527, 16.172, 17.213, 15.994000000000003, 21.851, 20.051000000000002, 17.089000000000006, 17.215000000000003, 18.258999999999997, 15.589, 12.84, 19.397, 15.442999999999998, 14.801, 17.677, 13.289000000000001, 12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002, 13.589, 14.604, 15.375, 15.753, 19.648000000000007, 12.882, 29.421, 15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126], "episode_lengths": [66, 82, 59, 59, 74, 59, 51, 65, 80, 51, 65, 62, 89, 98, 68, 75, 55, 55, 67, 66, 104, 59, 52, 46, 84, 87, 55, 92, 70, 56, 69, 62, 54, 55, 65, 74, 61, 43, 55, 68, 99, 60, 46, 69, 97, 79, 77, 101, 113, 58, 81, 59, 52, 61, 43, 64, 57, 74, 77, 48, 48, 52, 88, 60, 104, 64, 75, 64, 96, 92, 79, 85, 83, 57, 42, 81, 54, 59, 87, 44, 49, 126, 52, 83, 61, 49, 60, 70, 62, 81, 46, 126, 61, 51, 102, 49, 56, 66, 69, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46757986081022096, "mean_inference_ms": 1.1652532644539244, "mean_action_processing_ms": 0.08074981462506951, "mean_env_wait_ms": 4.999728443420484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032553672790527344, "ViewRequirementAgentConnector_ms": 0.23675274848937988}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31742, "num_agent_steps_trained": 0, "num_env_steps_sampled": 31744, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.967697787747543, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 31744, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 31742, "timers": {"training_iteration_time_ms": 146558.757, "sample_time_ms": 6873.643, "synch_weights_time_ms": 46.876}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 0, "num_agent_steps_sampled": 31742, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 310, "training_iteration": 31, "trial_id": "default", "date": "2025-12-19_20-43-17", "timestamp": 1766148197, "time_this_iter_s": 146.96686458587646, "time_total_s": 4547.014883518219, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4547.014883518219, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 94.80861244019138, "ram_util_percent": 21.42535885167464}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.39844597422052175}, "default_policy": {"total_loss": 0.39844597422052175, "policy_loss": -0.013848844327731058, "vf_loss": 1.6548475036397576, "vf_loss_unclipped": 5.677192465402186, "vf_explained_var": 0.1837190944701433, "entropy": 1.4170564413070679, "mean_kl_loss": 0.0015297305179407417, "gradients_default_optimizer_global_norm": 2.090258574858308, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 4.6566129424663316e-11}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32766, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 29.421, "episode_reward_min": 11.148, "episode_reward_mean": 16.88488, "episode_len_mean": 71.65, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.974, 19.231, 21.536, 16.017, 18.186999999999998, 14.222999999999999, 12.855, 16.480999999999998, 15.51, 21.188, 13.907, 14.483, 12.808000000000002, 17.87, 19.708000000000002, 14.617, 20.322000000000003, 16.630000000000003, 15.904000000000002, 17.406000000000002, 14.419, 13.847999999999999, 14.767000000000001, 15.943000000000001, 17.400000000000002, 15.455, 11.148, 13.463000000000001, 15.419, 22.285, 13.913, 12.509, 17.578000000000003, 18.874000000000002, 17.702, 18.735, 20.796999999999997, 25.25, 14.576, 16.058, 14.286, 14.127000000000002, 13.814, 13.454, 16.393, 14.966, 17.4, 18.369999999999997, 12.234000000000002, 13.287000000000003, 14.533000000000001, 20.459000000000003, 15.241, 22.527, 16.172, 17.213, 15.994000000000003, 21.851, 20.051000000000002, 17.089000000000006, 17.215000000000003, 18.258999999999997, 15.589, 12.84, 19.397, 15.442999999999998, 14.801, 17.677, 13.289000000000001, 12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002, 13.589, 14.604, 15.375, 15.753, 19.648000000000007, 12.882, 29.421, 15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126, 26.21699999999999, 15.178, 27.833999999999996, 12.474, 22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587], "episode_lengths": [62, 89, 98, 68, 75, 55, 55, 67, 66, 104, 59, 52, 46, 84, 87, 55, 92, 70, 56, 69, 62, 54, 55, 65, 74, 61, 43, 55, 68, 99, 60, 46, 69, 97, 79, 77, 101, 113, 58, 81, 59, 52, 61, 43, 64, 57, 74, 77, 48, 48, 52, 88, 60, 104, 64, 75, 64, 96, 92, 79, 85, 83, 57, 42, 81, 54, 59, 87, 44, 49, 126, 52, 83, 61, 49, 60, 70, 62, 81, 46, 126, 61, 51, 102, 49, 56, 66, 69, 74, 137, 64, 137, 50, 104, 130, 56, 120, 59, 68, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686064990894158, "mean_inference_ms": 1.1658901014913663, "mean_action_processing_ms": 0.08076460797968882, "mean_env_wait_ms": 4.999422042889125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032427310943603516, "ViewRequirementAgentConnector_ms": 0.23662471771240234}}, "episode_reward_max": 29.421, "episode_reward_min": 11.148, "episode_reward_mean": 16.88488, "episode_len_mean": 71.65, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.974, 19.231, 21.536, 16.017, 18.186999999999998, 14.222999999999999, 12.855, 16.480999999999998, 15.51, 21.188, 13.907, 14.483, 12.808000000000002, 17.87, 19.708000000000002, 14.617, 20.322000000000003, 16.630000000000003, 15.904000000000002, 17.406000000000002, 14.419, 13.847999999999999, 14.767000000000001, 15.943000000000001, 17.400000000000002, 15.455, 11.148, 13.463000000000001, 15.419, 22.285, 13.913, 12.509, 17.578000000000003, 18.874000000000002, 17.702, 18.735, 20.796999999999997, 25.25, 14.576, 16.058, 14.286, 14.127000000000002, 13.814, 13.454, 16.393, 14.966, 17.4, 18.369999999999997, 12.234000000000002, 13.287000000000003, 14.533000000000001, 20.459000000000003, 15.241, 22.527, 16.172, 17.213, 15.994000000000003, 21.851, 20.051000000000002, 17.089000000000006, 17.215000000000003, 18.258999999999997, 15.589, 12.84, 19.397, 15.442999999999998, 14.801, 17.677, 13.289000000000001, 12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002, 13.589, 14.604, 15.375, 15.753, 19.648000000000007, 12.882, 29.421, 15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126, 26.21699999999999, 15.178, 27.833999999999996, 12.474, 22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587], "episode_lengths": [62, 89, 98, 68, 75, 55, 55, 67, 66, 104, 59, 52, 46, 84, 87, 55, 92, 70, 56, 69, 62, 54, 55, 65, 74, 61, 43, 55, 68, 99, 60, 46, 69, 97, 79, 77, 101, 113, 58, 81, 59, 52, 61, 43, 64, 57, 74, 77, 48, 48, 52, 88, 60, 104, 64, 75, 64, 96, 92, 79, 85, 83, 57, 42, 81, 54, 59, 87, 44, 49, 126, 52, 83, 61, 49, 60, 70, 62, 81, 46, 126, 61, 51, 102, 49, 56, 66, 69, 74, 137, 64, 137, 50, 104, 130, 56, 120, 59, 68, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686064990894158, "mean_inference_ms": 1.1658901014913663, "mean_action_processing_ms": 0.08076460797968882, "mean_env_wait_ms": 4.999422042889125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032427310943603516, "ViewRequirementAgentConnector_ms": 0.23662471771240234}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32766, "num_agent_steps_trained": 0, "num_env_steps_sampled": 32768, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.058778206712436, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 32768, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 32766, "timers": {"training_iteration_time_ms": 146558.998, "sample_time_ms": 6872.203, "synch_weights_time_ms": 46.335}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32766, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 321, "training_iteration": 32, "trial_id": "default", "date": "2025-12-19_20-45-55", "timestamp": 1766148355, "time_this_iter_s": 145.07333207130432, "time_total_s": 4692.088215589523, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4692.088215589523, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 87.56785714285715, "ram_util_percent": 21.535267857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.4186808908358216}, "default_policy": {"total_loss": 0.4186808908358216, "policy_loss": -0.011716305138543248, "vf_loss": 1.7270346006378532, "vf_loss_unclipped": 6.057483185641468, "vf_explained_var": 0.052004650235176086, "entropy": 1.3614553175866604, "mean_kl_loss": 0.0014959173176812613, "gradients_default_optimizer_global_norm": 1.8937059205025435, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 2.3283064712331658e-11}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 0, "num_agent_steps_sampled": 33790, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 36.498999999999995, "episode_reward_min": 11.148, "episode_reward_mean": 17.230829999999997, "episode_len_mean": 73.15, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.808000000000002, 17.87, 19.708000000000002, 14.617, 20.322000000000003, 16.630000000000003, 15.904000000000002, 17.406000000000002, 14.419, 13.847999999999999, 14.767000000000001, 15.943000000000001, 17.400000000000002, 15.455, 11.148, 13.463000000000001, 15.419, 22.285, 13.913, 12.509, 17.578000000000003, 18.874000000000002, 17.702, 18.735, 20.796999999999997, 25.25, 14.576, 16.058, 14.286, 14.127000000000002, 13.814, 13.454, 16.393, 14.966, 17.4, 18.369999999999997, 12.234000000000002, 13.287000000000003, 14.533000000000001, 20.459000000000003, 15.241, 22.527, 16.172, 17.213, 15.994000000000003, 21.851, 20.051000000000002, 17.089000000000006, 17.215000000000003, 18.258999999999997, 15.589, 12.84, 19.397, 15.442999999999998, 14.801, 17.677, 13.289000000000001, 12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002, 13.589, 14.604, 15.375, 15.753, 19.648000000000007, 12.882, 29.421, 15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126, 26.21699999999999, 15.178, 27.833999999999996, 12.474, 22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587, 17.668000000000003, 19.65, 36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001], "episode_lengths": [46, 84, 87, 55, 92, 70, 56, 69, 62, 54, 55, 65, 74, 61, 43, 55, 68, 99, 60, 46, 69, 97, 79, 77, 101, 113, 58, 81, 59, 52, 61, 43, 64, 57, 74, 77, 48, 48, 52, 88, 60, 104, 64, 75, 64, 96, 92, 79, 85, 83, 57, 42, 81, 54, 59, 87, 44, 49, 126, 52, 83, 61, 49, 60, 70, 62, 81, 46, 126, 61, 51, 102, 49, 56, 66, 69, 74, 137, 64, 137, 50, 104, 130, 56, 120, 59, 68, 72, 68, 87, 175, 85, 92, 48, 57, 52, 69, 89, 123, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46921520396783584, "mean_inference_ms": 1.1644901208240186, "mean_action_processing_ms": 0.08073902497283976, "mean_env_wait_ms": 4.997818539333316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003248453140258789, "ViewRequirementAgentConnector_ms": 0.23688793182373047}}, "episode_reward_max": 36.498999999999995, "episode_reward_min": 11.148, "episode_reward_mean": 17.230829999999997, "episode_len_mean": 73.15, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.808000000000002, 17.87, 19.708000000000002, 14.617, 20.322000000000003, 16.630000000000003, 15.904000000000002, 17.406000000000002, 14.419, 13.847999999999999, 14.767000000000001, 15.943000000000001, 17.400000000000002, 15.455, 11.148, 13.463000000000001, 15.419, 22.285, 13.913, 12.509, 17.578000000000003, 18.874000000000002, 17.702, 18.735, 20.796999999999997, 25.25, 14.576, 16.058, 14.286, 14.127000000000002, 13.814, 13.454, 16.393, 14.966, 17.4, 18.369999999999997, 12.234000000000002, 13.287000000000003, 14.533000000000001, 20.459000000000003, 15.241, 22.527, 16.172, 17.213, 15.994000000000003, 21.851, 20.051000000000002, 17.089000000000006, 17.215000000000003, 18.258999999999997, 15.589, 12.84, 19.397, 15.442999999999998, 14.801, 17.677, 13.289000000000001, 12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002, 13.589, 14.604, 15.375, 15.753, 19.648000000000007, 12.882, 29.421, 15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126, 26.21699999999999, 15.178, 27.833999999999996, 12.474, 22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587, 17.668000000000003, 19.65, 36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001], "episode_lengths": [46, 84, 87, 55, 92, 70, 56, 69, 62, 54, 55, 65, 74, 61, 43, 55, 68, 99, 60, 46, 69, 97, 79, 77, 101, 113, 58, 81, 59, 52, 61, 43, 64, 57, 74, 77, 48, 48, 52, 88, 60, 104, 64, 75, 64, 96, 92, 79, 85, 83, 57, 42, 81, 54, 59, 87, 44, 49, 126, 52, 83, 61, 49, 60, 70, 62, 81, 46, 126, 61, 51, 102, 49, 56, 66, 69, 74, 137, 64, 137, 50, 104, 130, 56, 120, 59, 68, 72, 68, 87, 175, 85, 92, 48, 57, 52, 69, 89, 123, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46921520396783584, "mean_inference_ms": 1.1644901208240186, "mean_action_processing_ms": 0.08073902497283976, "mean_env_wait_ms": 4.997818539333316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003248453140258789, "ViewRequirementAgentConnector_ms": 0.23688793182373047}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33790, "num_agent_steps_trained": 0, "num_env_steps_sampled": 33792, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.924872222800365, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 33792, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 33790, "timers": {"training_iteration_time_ms": 146732.069, "sample_time_ms": 6872.176, "synch_weights_time_ms": 47.989}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 0, "num_agent_steps_sampled": 33790, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 333, "training_iteration": 33, "trial_id": "default", "date": "2025-12-19_20-48-23", "timestamp": 1766148503, "time_this_iter_s": 147.87539792060852, "time_total_s": 4839.963613510132, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4839.963613510132, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 94.66540284360188, "ram_util_percent": 20.566350710900473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.36392704527825115}, "default_policy": {"total_loss": 0.36392704527825115, "policy_loss": -0.0101578907109797, "vf_loss": 1.5018814235460014, "vf_loss_unclipped": 4.925859199790284, "vf_explained_var": 0.20367007777094842, "entropy": 1.3854183092713357, "mean_kl_loss": 0.0014816860595468385, "gradients_default_optimizer_global_norm": 1.686744549497962, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.1641532356165829e-11}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 0, "num_agent_steps_sampled": 34814, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 36.498999999999995, "episode_reward_min": 11.148, "episode_reward_mean": 17.802970000000002, "episode_len_mean": 76.35, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.943000000000001, 17.400000000000002, 15.455, 11.148, 13.463000000000001, 15.419, 22.285, 13.913, 12.509, 17.578000000000003, 18.874000000000002, 17.702, 18.735, 20.796999999999997, 25.25, 14.576, 16.058, 14.286, 14.127000000000002, 13.814, 13.454, 16.393, 14.966, 17.4, 18.369999999999997, 12.234000000000002, 13.287000000000003, 14.533000000000001, 20.459000000000003, 15.241, 22.527, 16.172, 17.213, 15.994000000000003, 21.851, 20.051000000000002, 17.089000000000006, 17.215000000000003, 18.258999999999997, 15.589, 12.84, 19.397, 15.442999999999998, 14.801, 17.677, 13.289000000000001, 12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002, 13.589, 14.604, 15.375, 15.753, 19.648000000000007, 12.882, 29.421, 15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126, 26.21699999999999, 15.178, 27.833999999999996, 12.474, 22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587, 17.668000000000003, 19.65, 36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119], "episode_lengths": [65, 74, 61, 43, 55, 68, 99, 60, 46, 69, 97, 79, 77, 101, 113, 58, 81, 59, 52, 61, 43, 64, 57, 74, 77, 48, 48, 52, 88, 60, 104, 64, 75, 64, 96, 92, 79, 85, 83, 57, 42, 81, 54, 59, 87, 44, 49, 126, 52, 83, 61, 49, 60, 70, 62, 81, 46, 126, 61, 51, 102, 49, 56, 66, 69, 74, 137, 64, 137, 50, 104, 130, 56, 120, 59, 68, 72, 68, 87, 175, 85, 92, 48, 57, 52, 69, 89, 123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46957664034597796, "mean_inference_ms": 1.16277803507885, "mean_action_processing_ms": 0.08070568899213063, "mean_env_wait_ms": 4.996046342010935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032541751861572266, "ViewRequirementAgentConnector_ms": 0.23723196983337402}}, "episode_reward_max": 36.498999999999995, "episode_reward_min": 11.148, "episode_reward_mean": 17.802970000000002, "episode_len_mean": 76.35, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.943000000000001, 17.400000000000002, 15.455, 11.148, 13.463000000000001, 15.419, 22.285, 13.913, 12.509, 17.578000000000003, 18.874000000000002, 17.702, 18.735, 20.796999999999997, 25.25, 14.576, 16.058, 14.286, 14.127000000000002, 13.814, 13.454, 16.393, 14.966, 17.4, 18.369999999999997, 12.234000000000002, 13.287000000000003, 14.533000000000001, 20.459000000000003, 15.241, 22.527, 16.172, 17.213, 15.994000000000003, 21.851, 20.051000000000002, 17.089000000000006, 17.215000000000003, 18.258999999999997, 15.589, 12.84, 19.397, 15.442999999999998, 14.801, 17.677, 13.289000000000001, 12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002, 13.589, 14.604, 15.375, 15.753, 19.648000000000007, 12.882, 29.421, 15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126, 26.21699999999999, 15.178, 27.833999999999996, 12.474, 22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587, 17.668000000000003, 19.65, 36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119], "episode_lengths": [65, 74, 61, 43, 55, 68, 99, 60, 46, 69, 97, 79, 77, 101, 113, 58, 81, 59, 52, 61, 43, 64, 57, 74, 77, 48, 48, 52, 88, 60, 104, 64, 75, 64, 96, 92, 79, 85, 83, 57, 42, 81, 54, 59, 87, 44, 49, 126, 52, 83, 61, 49, 60, 70, 62, 81, 46, 126, 61, 51, 102, 49, 56, 66, 69, 74, 137, 64, 137, 50, 104, 130, 56, 120, 59, 68, 72, 68, 87, 175, 85, 92, 48, 57, 52, 69, 89, 123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46957664034597796, "mean_inference_ms": 1.16277803507885, "mean_action_processing_ms": 0.08070568899213063, "mean_env_wait_ms": 4.996046342010935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032541751861572266, "ViewRequirementAgentConnector_ms": 0.23723196983337402}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34814, "num_agent_steps_trained": 0, "num_env_steps_sampled": 34816, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.92515539316497, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 34816, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 34814, "timers": {"training_iteration_time_ms": 146943.034, "sample_time_ms": 6872.238, "synch_weights_time_ms": 48.325}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 0, "num_agent_steps_sampled": 34814, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 344, "training_iteration": 34, "trial_id": "default", "date": "2025-12-19_20-50-51", "timestamp": 1766148651, "time_this_iter_s": 147.8692376613617, "time_total_s": 4987.8328511714935, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4987.8328511714935, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 94.87238095238094, "ram_util_percent": 21.06904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5303417972289026}, "default_policy": {"total_loss": 0.5303417972289026, "policy_loss": -0.009671720874030143, "vf_loss": 2.1656230963766574, "vf_loss_unclipped": 7.046943395212293, "vf_explained_var": 0.1421975765377283, "entropy": 1.392258606851101, "mean_kl_loss": 0.0012683654053254668, "gradients_default_optimizer_global_norm": 1.879132666066289, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 5.8207661780829145e-12}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 0, "num_agent_steps_sampled": 35838, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 36.498999999999995, "episode_reward_min": 11.667, "episode_reward_mean": 17.722189999999998, "episode_len_mean": 75.71, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.576, 16.058, 14.286, 14.127000000000002, 13.814, 13.454, 16.393, 14.966, 17.4, 18.369999999999997, 12.234000000000002, 13.287000000000003, 14.533000000000001, 20.459000000000003, 15.241, 22.527, 16.172, 17.213, 15.994000000000003, 21.851, 20.051000000000002, 17.089000000000006, 17.215000000000003, 18.258999999999997, 15.589, 12.84, 19.397, 15.442999999999998, 14.801, 17.677, 13.289000000000001, 12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002, 13.589, 14.604, 15.375, 15.753, 19.648000000000007, 12.882, 29.421, 15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126, 26.21699999999999, 15.178, 27.833999999999996, 12.474, 22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587, 17.668000000000003, 19.65, 36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624], "episode_lengths": [58, 81, 59, 52, 61, 43, 64, 57, 74, 77, 48, 48, 52, 88, 60, 104, 64, 75, 64, 96, 92, 79, 85, 83, 57, 42, 81, 54, 59, 87, 44, 49, 126, 52, 83, 61, 49, 60, 70, 62, 81, 46, 126, 61, 51, 102, 49, 56, 66, 69, 74, 137, 64, 137, 50, 104, 130, 56, 120, 59, 68, 72, 68, 87, 175, 85, 92, 48, 57, 52, 69, 89, 123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4705854521521544, "mean_inference_ms": 1.163298213973643, "mean_action_processing_ms": 0.080722630731303, "mean_env_wait_ms": 4.995496371336056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032584667205810547, "ViewRequirementAgentConnector_ms": 0.23640775680541992}}, "episode_reward_max": 36.498999999999995, "episode_reward_min": 11.667, "episode_reward_mean": 17.722189999999998, "episode_len_mean": 75.71, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.576, 16.058, 14.286, 14.127000000000002, 13.814, 13.454, 16.393, 14.966, 17.4, 18.369999999999997, 12.234000000000002, 13.287000000000003, 14.533000000000001, 20.459000000000003, 15.241, 22.527, 16.172, 17.213, 15.994000000000003, 21.851, 20.051000000000002, 17.089000000000006, 17.215000000000003, 18.258999999999997, 15.589, 12.84, 19.397, 15.442999999999998, 14.801, 17.677, 13.289000000000001, 12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002, 13.589, 14.604, 15.375, 15.753, 19.648000000000007, 12.882, 29.421, 15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126, 26.21699999999999, 15.178, 27.833999999999996, 12.474, 22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587, 17.668000000000003, 19.65, 36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624], "episode_lengths": [58, 81, 59, 52, 61, 43, 64, 57, 74, 77, 48, 48, 52, 88, 60, 104, 64, 75, 64, 96, 92, 79, 85, 83, 57, 42, 81, 54, 59, 87, 44, 49, 126, 52, 83, 61, 49, 60, 70, 62, 81, 46, 126, 61, 51, 102, 49, 56, 66, 69, 74, 137, 64, 137, 50, 104, 130, 56, 120, 59, 68, 72, 68, 87, 175, 85, 92, 48, 57, 52, 69, 89, 123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4705854521521544, "mean_inference_ms": 1.163298213973643, "mean_action_processing_ms": 0.080722630731303, "mean_env_wait_ms": 4.995496371336056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032584667205810547, "ViewRequirementAgentConnector_ms": 0.23640775680541992}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35838, "num_agent_steps_trained": 0, "num_env_steps_sampled": 35840, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.95866752352306, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 35840, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 35838, "timers": {"training_iteration_time_ms": 147060.453, "sample_time_ms": 6877.087, "synch_weights_time_ms": 50.232}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 0, "num_agent_steps_sampled": 35838, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 359, "training_iteration": 35, "trial_id": "default", "date": "2025-12-19_20-53-18", "timestamp": 1766148798, "time_this_iter_s": 147.15726971626282, "time_total_s": 5134.990120887756, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5134.990120887756, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 94.72870813397127, "ram_util_percent": 20.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.35624179446604104}, "default_policy": {"total_loss": 0.35624179446604104, "policy_loss": -0.012018804263789207, "vf_loss": 1.478355006314814, "vf_loss_unclipped": 4.979417949728668, "vf_explained_var": 0.2243392772972584, "entropy": 1.3281557127833366, "mean_kl_loss": 0.0011438169677047583, "gradients_default_optimizer_global_norm": 1.7021000750362874, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 2.9103830890414573e-12}}, "num_env_steps_sampled": 36864, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36862, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 36.498999999999995, "episode_reward_min": 11.667, "episode_reward_mean": 18.38737, "episode_len_mean": 79.25, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.287000000000003, 14.533000000000001, 20.459000000000003, 15.241, 22.527, 16.172, 17.213, 15.994000000000003, 21.851, 20.051000000000002, 17.089000000000006, 17.215000000000003, 18.258999999999997, 15.589, 12.84, 19.397, 15.442999999999998, 14.801, 17.677, 13.289000000000001, 12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002, 13.589, 14.604, 15.375, 15.753, 19.648000000000007, 12.882, 29.421, 15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126, 26.21699999999999, 15.178, 27.833999999999996, 12.474, 22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587, 17.668000000000003, 19.65, 36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013], "episode_lengths": [48, 52, 88, 60, 104, 64, 75, 64, 96, 92, 79, 85, 83, 57, 42, 81, 54, 59, 87, 44, 49, 126, 52, 83, 61, 49, 60, 70, 62, 81, 46, 126, 61, 51, 102, 49, 56, 66, 69, 74, 137, 64, 137, 50, 104, 130, 56, 120, 59, 68, 72, 68, 87, 175, 85, 92, 48, 57, 52, 69, 89, 123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47124399886347507, "mean_inference_ms": 1.1638794211460681, "mean_action_processing_ms": 0.08074110197904856, "mean_env_wait_ms": 4.995311019122821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032546520233154297, "ViewRequirementAgentConnector_ms": 0.23653626441955566}}, "episode_reward_max": 36.498999999999995, "episode_reward_min": 11.667, "episode_reward_mean": 18.38737, "episode_len_mean": 79.25, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.287000000000003, 14.533000000000001, 20.459000000000003, 15.241, 22.527, 16.172, 17.213, 15.994000000000003, 21.851, 20.051000000000002, 17.089000000000006, 17.215000000000003, 18.258999999999997, 15.589, 12.84, 19.397, 15.442999999999998, 14.801, 17.677, 13.289000000000001, 12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002, 13.589, 14.604, 15.375, 15.753, 19.648000000000007, 12.882, 29.421, 15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126, 26.21699999999999, 15.178, 27.833999999999996, 12.474, 22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587, 17.668000000000003, 19.65, 36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013], "episode_lengths": [48, 52, 88, 60, 104, 64, 75, 64, 96, 92, 79, 85, 83, 57, 42, 81, 54, 59, 87, 44, 49, 126, 52, 83, 61, 49, 60, 70, 62, 81, 46, 126, 61, 51, 102, 49, 56, 66, 69, 74, 137, 64, 137, 50, 104, 130, 56, 120, 59, 68, 72, 68, 87, 175, 85, 92, 48, 57, 52, 69, 89, 123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47124399886347507, "mean_inference_ms": 1.1638794211460681, "mean_action_processing_ms": 0.08074110197904856, "mean_env_wait_ms": 4.995311019122821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032546520233154297, "ViewRequirementAgentConnector_ms": 0.23653626441955566}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36862, "num_agent_steps_trained": 0, "num_env_steps_sampled": 36864, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.839955200388898, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 36864, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 36862, "timers": {"training_iteration_time_ms": 147207.343, "sample_time_ms": 6879.951, "synch_weights_time_ms": 50.91}, "counters": {"num_env_steps_sampled": 36864, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36862, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 370, "training_iteration": 36, "trial_id": "default", "date": "2025-12-19_20-55-48", "timestamp": 1766148948, "time_this_iter_s": 149.71379494667053, "time_total_s": 5284.703915834427, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5284.703915834427, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 94.77605633802817, "ram_util_percent": 20.45117370892018}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.401244717463851}, "default_policy": {"total_loss": 0.401244717463851, "policy_loss": -0.00648769048275426, "vf_loss": 1.6360571960918606, "vf_loss_unclipped": 4.774500270467252, "vf_explained_var": 0.3292884163558483, "entropy": 1.281891031563282, "mean_kl_loss": 0.0005263950242847315, "gradients_default_optimizer_global_norm": 2.2739389907568692, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.4551915445207286e-12}}, "num_env_steps_sampled": 37888, "num_env_steps_trained": 0, "num_agent_steps_sampled": 37886, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 36.498999999999995, "episode_reward_min": 11.667, "episode_reward_mean": 18.52579, "episode_len_mean": 80.07, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.089000000000006, 17.215000000000003, 18.258999999999997, 15.589, 12.84, 19.397, 15.442999999999998, 14.801, 17.677, 13.289000000000001, 12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002, 13.589, 14.604, 15.375, 15.753, 19.648000000000007, 12.882, 29.421, 15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126, 26.21699999999999, 15.178, 27.833999999999996, 12.474, 22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587, 17.668000000000003, 19.65, 36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083], "episode_lengths": [79, 85, 83, 57, 42, 81, 54, 59, 87, 44, 49, 126, 52, 83, 61, 49, 60, 70, 62, 81, 46, 126, 61, 51, 102, 49, 56, 66, 69, 74, 137, 64, 137, 50, 104, 130, 56, 120, 59, 68, 72, 68, 87, 175, 85, 92, 48, 57, 52, 69, 89, 123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.471715746910272, "mean_inference_ms": 1.1639887663045827, "mean_action_processing_ms": 0.08074520967608499, "mean_env_wait_ms": 4.994779035897323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003255128860473633, "ViewRequirementAgentConnector_ms": 0.23633074760437012}}, "episode_reward_max": 36.498999999999995, "episode_reward_min": 11.667, "episode_reward_mean": 18.52579, "episode_len_mean": 80.07, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.089000000000006, 17.215000000000003, 18.258999999999997, 15.589, 12.84, 19.397, 15.442999999999998, 14.801, 17.677, 13.289000000000001, 12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002, 13.589, 14.604, 15.375, 15.753, 19.648000000000007, 12.882, 29.421, 15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126, 26.21699999999999, 15.178, 27.833999999999996, 12.474, 22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587, 17.668000000000003, 19.65, 36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083], "episode_lengths": [79, 85, 83, 57, 42, 81, 54, 59, 87, 44, 49, 126, 52, 83, 61, 49, 60, 70, 62, 81, 46, 126, 61, 51, 102, 49, 56, 66, 69, 74, 137, 64, 137, 50, 104, 130, 56, 120, 59, 68, 72, 68, 87, 175, 85, 92, 48, 57, 52, 69, 89, 123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.471715746910272, "mean_inference_ms": 1.1639887663045827, "mean_action_processing_ms": 0.08074520967608499, "mean_env_wait_ms": 4.994779035897323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003255128860473633, "ViewRequirementAgentConnector_ms": 0.23633074760437012}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37886, "num_agent_steps_trained": 0, "num_env_steps_sampled": 37888, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.996301252972001, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37888, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 37886, "timers": {"training_iteration_time_ms": 147104.303, "sample_time_ms": 6874.031, "synch_weights_time_ms": 51.073}, "counters": {"num_env_steps_sampled": 37888, "num_env_steps_trained": 0, "num_agent_steps_sampled": 37886, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 380, "training_iteration": 37, "trial_id": "default", "date": "2025-12-19_20-58-27", "timestamp": 1766149107, "time_this_iter_s": 146.36584305763245, "time_total_s": 5431.069758892059, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5431.069758892059, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 87.59070796460178, "ram_util_percent": 20.266371681415926}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.3134508213028312}, "default_policy": {"total_loss": 0.3134508213028312, "policy_loss": -0.012265462172217667, "vf_loss": 1.3080050084739923, "vf_loss_unclipped": 4.054578303173185, "vf_explained_var": 0.23975901454687118, "entropy": 1.2849643416702747, "mean_kl_loss": 0.001473264897238824, "gradients_default_optimizer_global_norm": 1.9520535763353108, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 7.275957722603643e-13}}, "num_env_steps_sampled": 38912, "num_env_steps_trained": 0, "num_agent_steps_sampled": 38910, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 36.85999999999999, "episode_reward_min": 11.667, "episode_reward_mean": 19.296540000000004, "episode_len_mean": 85.23, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002, 13.589, 14.604, 15.375, 15.753, 19.648000000000007, 12.882, 29.421, 15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126, 26.21699999999999, 15.178, 27.833999999999996, 12.474, 22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587, 17.668000000000003, 19.65, 36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005], "episode_lengths": [49, 126, 52, 83, 61, 49, 60, 70, 62, 81, 46, 126, 61, 51, 102, 49, 56, 66, 69, 74, 137, 64, 137, 50, 104, 130, 56, 120, 59, 68, 72, 68, 87, 175, 85, 92, 48, 57, 52, 69, 89, 123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47164782316347226, "mean_inference_ms": 1.1621363150143906, "mean_action_processing_ms": 0.08069573147728674, "mean_env_wait_ms": 4.992726224632309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032668113708496094, "ViewRequirementAgentConnector_ms": 0.23611092567443848}}, "episode_reward_max": 36.85999999999999, "episode_reward_min": 11.667, "episode_reward_mean": 19.296540000000004, "episode_len_mean": 85.23, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.47, 27.450000000000003, 15.389000000000001, 17.032000000000004, 16.647000000000002, 13.589, 14.604, 15.375, 15.753, 19.648000000000007, 12.882, 29.421, 15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126, 26.21699999999999, 15.178, 27.833999999999996, 12.474, 22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587, 17.668000000000003, 19.65, 36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005], "episode_lengths": [49, 126, 52, 83, 61, 49, 60, 70, 62, 81, 46, 126, 61, 51, 102, 49, 56, 66, 69, 74, 137, 64, 137, 50, 104, 130, 56, 120, 59, 68, 72, 68, 87, 175, 85, 92, 48, 57, 52, 69, 89, 123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47164782316347226, "mean_inference_ms": 1.1621363150143906, "mean_action_processing_ms": 0.08069573147728674, "mean_env_wait_ms": 4.992726224632309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032668113708496094, "ViewRequirementAgentConnector_ms": 0.23611092567443848}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38910, "num_agent_steps_trained": 0, "num_env_steps_sampled": 38912, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.8500312561571, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 38912, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 38910, "timers": {"training_iteration_time_ms": 147493.29, "sample_time_ms": 6859.606, "synch_weights_time_ms": 50.898}, "counters": {"num_env_steps_sampled": 38912, "num_env_steps_trained": 0, "num_agent_steps_sampled": 38910, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 390, "training_iteration": 38, "trial_id": "default", "date": "2025-12-19_21-00-56", "timestamp": 1766149256, "time_this_iter_s": 149.49077653884888, "time_total_s": 5580.560535430908, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5580.560535430908, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 94.97840375586851, "ram_util_percent": 20.21173708920188}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.4265948597341776}, "default_policy": {"total_loss": 0.4265948597341776, "policy_loss": -0.009666243218816817, "vf_loss": 1.7500948761589825, "vf_loss_unclipped": 5.766585445124656, "vf_explained_var": 0.33272498697042463, "entropy": 1.2626136638224126, "mean_kl_loss": 0.0013636782578466899, "gradients_default_optimizer_global_norm": 1.6846154475584627, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 3.6379788613018216e-13}}, "num_env_steps_sampled": 39936, "num_env_steps_trained": 0, "num_agent_steps_sampled": 39934, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 36.85999999999999, "episode_reward_min": 11.667, "episode_reward_mean": 19.605779999999996, "episode_len_mean": 86.36, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126, 26.21699999999999, 15.178, 27.833999999999996, 12.474, 22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587, 17.668000000000003, 19.65, 36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586], "episode_lengths": [61, 51, 102, 49, 56, 66, 69, 74, 137, 64, 137, 50, 104, 130, 56, 120, 59, 68, 72, 68, 87, 175, 85, 92, 48, 57, 52, 69, 89, 123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4717769352157453, "mean_inference_ms": 1.161180026955006, "mean_action_processing_ms": 0.08066885780530086, "mean_env_wait_ms": 4.991345827820222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032660961151123047, "ViewRequirementAgentConnector_ms": 0.2359020709991455}}, "episode_reward_max": 36.85999999999999, "episode_reward_min": 11.667, "episode_reward_mean": 19.605779999999996, "episode_len_mean": 86.36, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.642, 14.344, 20.657, 11.667, 13.385000000000002, 16.169999999999998, 16.579, 18.126, 26.21699999999999, 15.178, 27.833999999999996, 12.474, 22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587, 17.668000000000003, 19.65, 36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586], "episode_lengths": [61, 51, 102, 49, 56, 66, 69, 74, 137, 64, 137, 50, 104, 130, 56, 120, 59, 68, 72, 68, 87, 175, 85, 92, 48, 57, 52, 69, 89, 123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4717769352157453, "mean_inference_ms": 1.161180026955006, "mean_action_processing_ms": 0.08066885780530086, "mean_env_wait_ms": 4.991345827820222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032660961151123047, "ViewRequirementAgentConnector_ms": 0.2359020709991455}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39934, "num_agent_steps_trained": 0, "num_env_steps_sampled": 39936, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.042677096904408, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 39936, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 39934, "timers": {"training_iteration_time_ms": 147129.948, "sample_time_ms": 6853.366, "synch_weights_time_ms": 51.493}, "counters": {"num_env_steps_sampled": 39936, "num_env_steps_trained": 0, "num_agent_steps_sampled": 39934, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 402, "training_iteration": 39, "trial_id": "default", "date": "2025-12-19_21-03-22", "timestamp": 1766149402, "time_this_iter_s": 145.40192818641663, "time_total_s": 5725.962463617325, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5725.962463617325, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 94.79951690821257, "ram_util_percent": 20.32125603864734}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.4534533749567345}, "default_policy": {"total_loss": 0.4534533749567345, "policy_loss": -0.01150990092428401, "vf_loss": 1.8649475696496665, "vf_loss_unclipped": 5.87970057008788, "vf_explained_var": 0.23248452097177505, "entropy": 1.2736186601221562, "mean_kl_loss": 0.0017192687260522365, "gradients_default_optimizer_global_norm": 1.8463593885302543, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.8189894306509108e-13}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40958, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 39.81299999999997, "episode_reward_min": 12.513, "episode_reward_mean": 20.09956, "episode_len_mean": 88.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587, 17.668000000000003, 19.65, 36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465], "episode_lengths": [104, 130, 56, 120, 59, 68, 72, 68, 87, 175, 85, 92, 48, 57, 52, 69, 89, 123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47215243848915833, "mean_inference_ms": 1.1616785755996282, "mean_action_processing_ms": 0.08068548893412036, "mean_env_wait_ms": 4.99121809367898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032622814178466797, "ViewRequirementAgentConnector_ms": 0.23599600791931152}}, "episode_reward_max": 39.81299999999997, "episode_reward_min": 12.513, "episode_reward_mean": 20.09956, "episode_len_mean": 88.0, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.628000000000007, 29.116999999999997, 12.848, 22.078, 14.833000000000002, 15.897, 15.587, 17.668000000000003, 19.65, 36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465], "episode_lengths": [104, 130, 56, 120, 59, 68, 72, 68, 87, 175, 85, 92, 48, 57, 52, 69, 89, 123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47215243848915833, "mean_inference_ms": 1.1616785755996282, "mean_action_processing_ms": 0.08068548893412036, "mean_env_wait_ms": 4.99121809367898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032622814178466797, "ViewRequirementAgentConnector_ms": 0.23599600791931152}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40958, "num_agent_steps_trained": 0, "num_env_steps_sampled": 40960, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.954617816463278, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 40960, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 40958, "timers": {"training_iteration_time_ms": 147312.469, "sample_time_ms": 6846.883, "synch_weights_time_ms": 51.514}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40958, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 414, "training_iteration": 40, "trial_id": "default", "date": "2025-12-19_21-05-49", "timestamp": 1766149549, "time_this_iter_s": 147.24280214309692, "time_total_s": 5873.205265760422, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5873.205265760422, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 94.76619047619049, "ram_util_percent": 19.909047619047616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.32559940789360553}, "default_policy": {"total_loss": 0.32559940789360553, "policy_loss": -0.014179955003783107, "vf_loss": 1.3640628550201654, "vf_loss_unclipped": 4.614289781451225, "vf_explained_var": 0.13058681264519692, "entropy": 1.2363492913544178, "mean_kl_loss": 0.002018439750649037, "gradients_default_optimizer_global_norm": 2.13361368663609, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 9.094947153254554e-14}}, "num_env_steps_sampled": 41984, "num_env_steps_trained": 0, "num_agent_steps_sampled": 41982, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 39.81299999999997, "episode_reward_min": 12.513, "episode_reward_mean": 20.404780000000002, "episode_len_mean": 89.63, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002], "episode_lengths": [175, 85, 92, 48, 57, 52, 69, 89, 123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4722751652740796, "mean_inference_ms": 1.1614840239946644, "mean_action_processing_ms": 0.08068117882683853, "mean_env_wait_ms": 4.990637662752508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003258228302001953, "ViewRequirementAgentConnector_ms": 0.23542308807373047}}, "episode_reward_max": 39.81299999999997, "episode_reward_min": 12.513, "episode_reward_mean": 20.404780000000002, "episode_len_mean": 89.63, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.498999999999995, 20.159999999999997, 19.262000000000008, 14.517000000000003, 14.222, 12.974, 15.236, 19.896, 26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002], "episode_lengths": [175, 85, 92, 48, 57, 52, 69, 89, 123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4722751652740796, "mean_inference_ms": 1.1614840239946644, "mean_action_processing_ms": 0.08068117882683853, "mean_env_wait_ms": 4.990637662752508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003258228302001953, "ViewRequirementAgentConnector_ms": 0.23542308807373047}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41982, "num_agent_steps_trained": 0, "num_env_steps_sampled": 41984, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.535973844060055, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 41984, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 41982, "timers": {"training_iteration_time_ms": 148283.214, "sample_time_ms": 6849.39, "synch_weights_time_ms": 52.659}, "counters": {"num_env_steps_sampled": 41984, "num_env_steps_trained": 0, "num_agent_steps_sampled": 41982, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 423, "training_iteration": 41, "trial_id": "default", "date": "2025-12-19_21-08-26", "timestamp": 1766149706, "time_this_iter_s": 156.6742503643036, "time_total_s": 6029.879516124725, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6029.879516124725, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 94.8457399103139, "ram_util_percent": 20.734529147982066}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.2816680033225566}, "default_policy": {"total_loss": 0.2816680033225566, "policy_loss": -0.010802192613482475, "vf_loss": 1.1747100259177388, "vf_loss_unclipped": 3.818292675819248, "vf_explained_var": 0.25623182617127893, "entropy": 1.207314845919609, "mean_kl_loss": 0.0012172060982076794, "gradients_default_optimizer_global_norm": 1.6641300665214658, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 4.547473576627277e-14}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 0, "num_agent_steps_sampled": 43006, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 39.81299999999997, "episode_reward_min": 12.513, "episode_reward_mean": 21.15457, "episode_len_mean": 93.84, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003], "episode_lengths": [123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47233677697950627, "mean_inference_ms": 1.161195127950938, "mean_action_processing_ms": 0.08067417538235098, "mean_env_wait_ms": 4.990129740966372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032579898834228516, "ViewRequirementAgentConnector_ms": 0.23529434204101562}}, "episode_reward_max": 39.81299999999997, "episode_reward_min": 12.513, "episode_reward_mean": 21.15457, "episode_len_mean": 93.84, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.34899999999999, 15.754000000000001, 15.765, 19.277, 17.643, 22.49299999999999, 29.781999999999993, 20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003], "episode_lengths": [123, 55, 70, 90, 70, 102, 138, 90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47233677697950627, "mean_inference_ms": 1.161195127950938, "mean_action_processing_ms": 0.08067417538235098, "mean_env_wait_ms": 4.990129740966372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032579898834228516, "ViewRequirementAgentConnector_ms": 0.23529434204101562}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43006, "num_agent_steps_trained": 0, "num_env_steps_sampled": 43008, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.712894845693341, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 43008, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 43006, "timers": {"training_iteration_time_ms": 149030.677, "sample_time_ms": 6851.959, "synch_weights_time_ms": 53.408}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 0, "num_agent_steps_sampled": 43006, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 431, "training_iteration": 42, "trial_id": "default", "date": "2025-12-19_21-11-29", "timestamp": 1766149889, "time_this_iter_s": 152.54494547843933, "time_total_s": 6182.424461603165, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6182.424461603165, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 80.2876447876448, "ram_util_percent": 20.229343629343628}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.24813411089999135}, "default_policy": {"total_loss": 0.24813411089999135, "policy_loss": -0.012046056077815592, "vf_loss": 1.0454282796476035, "vf_loss_unclipped": 3.6014395704958586, "vf_explained_var": 0.19598488695919514, "entropy": 1.1768979713320733, "mean_kl_loss": 0.0014420568293515678, "gradients_default_optimizer_global_norm": 1.9259374234825373, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 2.2737367883136385e-14}}, "num_env_steps_sampled": 44032, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44030, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 39.81299999999997, "episode_reward_min": 12.513, "episode_reward_mean": 21.572639999999996, "episode_len_mean": 96.38, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536], "episode_lengths": [90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4721329986644042, "mean_inference_ms": 1.1597549330820895, "mean_action_processing_ms": 0.08063119951962626, "mean_env_wait_ms": 4.988504975993556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032541751861572266, "ViewRequirementAgentConnector_ms": 0.2352466583251953}}, "episode_reward_max": 39.81299999999997, "episode_reward_min": 12.513, "episode_reward_mean": 21.572639999999996, "episode_len_mean": 96.38, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.919000000000004, 32.82200000000001, 16.53, 19.076, 25.086999999999996, 16.119, 19.517000000000003, 15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536], "episode_lengths": [90, 156, 78, 78, 110, 68, 102, 55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4721329986644042, "mean_inference_ms": 1.1597549330820895, "mean_action_processing_ms": 0.08063119951962626, "mean_env_wait_ms": 4.988504975993556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032541751861572266, "ViewRequirementAgentConnector_ms": 0.2352466583251953}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44030, "num_agent_steps_trained": 0, "num_env_steps_sampled": 44032, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.762829644516797, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 44032, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 44030, "timers": {"training_iteration_time_ms": 149384.99, "sample_time_ms": 6853.61, "synch_weights_time_ms": 52.654}, "counters": {"num_env_steps_sampled": 44032, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44030, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 438, "training_iteration": 43, "trial_id": "default", "date": "2025-12-19_21-14-01", "timestamp": 1766150041, "time_this_iter_s": 151.41854238510132, "time_total_s": 6333.843003988266, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6333.843003988266, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 94.90833333333332, "ram_util_percent": 20.605092592592595}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.23161682495847344}, "default_policy": {"total_loss": 0.23161682495847344, "policy_loss": -0.012187592859845608, "vf_loss": 0.9795938145834953, "vf_loss_unclipped": 3.2596728887874633, "vf_explained_var": 0.35121225379407406, "entropy": 1.0940395902842284, "mean_kl_loss": 0.0017735898469167122, "gradients_default_optimizer_global_norm": 1.4671389946714044, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.1368683941568192e-14}}, "num_env_steps_sampled": 45056, "num_env_steps_trained": 0, "num_agent_steps_sampled": 45054, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 39.81299999999997, "episode_reward_min": 12.513, "episode_reward_mean": 21.980800000000002, "episode_len_mean": 99.6, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001], "episode_lengths": [55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4723894948033348, "mean_inference_ms": 1.1608693011170024, "mean_action_processing_ms": 0.08066611703382831, "mean_env_wait_ms": 4.989372687941373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003266572952270508, "ViewRequirementAgentConnector_ms": 0.23532915115356445}}, "episode_reward_max": 39.81299999999997, "episode_reward_min": 12.513, "episode_reward_mean": 21.980800000000002, "episode_len_mean": 99.6, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.737000000000002, 13.415000000000001, 13.371000000000002, 17.860000000000003, 15.608, 14.304, 15.884, 16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001], "episode_lengths": [55, 50, 49, 71, 67, 56, 73, 82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4723894948033348, "mean_inference_ms": 1.1608693011170024, "mean_action_processing_ms": 0.08066611703382831, "mean_env_wait_ms": 4.989372687941373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003266572952270508, "ViewRequirementAgentConnector_ms": 0.23532915115356445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45054, "num_agent_steps_trained": 0, "num_env_steps_sampled": 45056, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.825516274619535, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 45056, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 45054, "timers": {"training_iteration_time_ms": 149600.846, "sample_time_ms": 6858.57, "synch_weights_time_ms": 52.503}, "counters": {"num_env_steps_sampled": 45056, "num_env_steps_trained": 0, "num_agent_steps_sampled": 45054, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 445, "training_iteration": 44, "trial_id": "default", "date": "2025-12-19_21-16-31", "timestamp": 1766150191, "time_this_iter_s": 150.02784180641174, "time_total_s": 6483.870845794678, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6483.870845794678, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 94.79718309859156, "ram_util_percent": 20.375117370892017}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.19120156740536914}, "default_policy": {"total_loss": 0.19120156740536914, "policy_loss": -0.009363234229385852, "vf_loss": 0.8065429958514869, "vf_loss_unclipped": 2.705003625433892, "vf_explained_var": 0.2164870709180832, "entropy": 1.0709474392235279, "mean_kl_loss": 0.0011025726169008542, "gradients_default_optimizer_global_norm": 1.7534911634400487, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 5.684341970784096e-15}}, "num_env_steps_sampled": 46080, "num_env_steps_trained": 0, "num_agent_steps_sampled": 46078, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 39.81299999999997, "episode_reward_min": 12.513, "episode_reward_mean": 22.86563, "episode_len_mean": 105.51, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507], "episode_lengths": [82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4720738937722143, "mean_inference_ms": 1.1597862864885666, "mean_action_processing_ms": 0.08062582765216222, "mean_env_wait_ms": 4.987848985552663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00328826904296875, "ViewRequirementAgentConnector_ms": 0.2363440990447998}}, "episode_reward_max": 39.81299999999997, "episode_reward_min": 12.513, "episode_reward_mean": 22.86563, "episode_len_mean": 105.51, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.541999999999998, 22.039999999999996, 16.719, 16.468999999999998, 15.510000000000002, 18.793000000000003, 16.624, 15.263, 23.090999999999994, 20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507], "episode_lengths": [82, 96, 68, 64, 62, 82, 66, 57, 104, 91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4720738937722143, "mean_inference_ms": 1.1597862864885666, "mean_action_processing_ms": 0.08062582765216222, "mean_env_wait_ms": 4.987848985552663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00328826904296875, "ViewRequirementAgentConnector_ms": 0.2363440990447998}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46078, "num_agent_steps_trained": 0, "num_env_steps_sampled": 46080, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.6541351115209935, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 46080, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 46078, "timers": {"training_iteration_time_ms": 150274.309, "sample_time_ms": 6883.288, "synch_weights_time_ms": 50.595}, "counters": {"num_env_steps_sampled": 46080, "num_env_steps_trained": 0, "num_agent_steps_sampled": 46078, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 452, "training_iteration": 45, "trial_id": "default", "date": "2025-12-19_21-19-05", "timestamp": 1766150345, "time_this_iter_s": 153.89190125465393, "time_total_s": 6637.762747049332, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6637.762747049332, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 94.82557077625572, "ram_util_percent": 20.355251141552507}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.30539049110375344}, "default_policy": {"total_loss": 0.30539049110375344, "policy_loss": -0.014518177043646574, "vf_loss": 1.2841134717687965, "vf_loss_unclipped": 4.810276992432773, "vf_explained_var": 0.26246986389160154, "entropy": 1.1196918625384569, "mean_kl_loss": 0.0018824166718944824, "gradients_default_optimizer_global_norm": 1.9828254222869872, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 2.842170985392048e-15}}, "num_env_steps_sampled": 47104, "num_env_steps_trained": 0, "num_agent_steps_sampled": 47102, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 43.58499999999996, "episode_reward_min": 12.513, "episode_reward_mean": 23.639269999999993, "episode_len_mean": 110.24, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996], "episode_lengths": [91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4721554304668142, "mean_inference_ms": 1.160826891135028, "mean_action_processing_ms": 0.08064669386803852, "mean_env_wait_ms": 4.988317224591356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003264904022216797, "ViewRequirementAgentConnector_ms": 0.2358107566833496}}, "episode_reward_max": 43.58499999999996, "episode_reward_min": 12.513, "episode_reward_mean": 23.639269999999993, "episode_len_mean": 110.24, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.998, 15.457, 25.770999999999987, 20.045, 17.352000000000004, 31.25800000000001, 12.55, 21.066000000000003, 29.345000000000013, 18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996], "episode_lengths": [91, 62, 122, 80, 67, 152, 54, 91, 148, 88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4721554304668142, "mean_inference_ms": 1.160826891135028, "mean_action_processing_ms": 0.08064669386803852, "mean_env_wait_ms": 4.988317224591356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003264904022216797, "ViewRequirementAgentConnector_ms": 0.2358107566833496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47102, "num_agent_steps_trained": 0, "num_env_steps_sampled": 47104, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.924890667639291, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 47104, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 47102, "timers": {"training_iteration_time_ms": 150090.686, "sample_time_ms": 6884.649, "synch_weights_time_ms": 49.815}, "counters": {"num_env_steps_sampled": 47104, "num_env_steps_trained": 0, "num_agent_steps_sampled": 47102, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 461, "training_iteration": 46, "trial_id": "default", "date": "2025-12-19_21-21-32", "timestamp": 1766150492, "time_this_iter_s": 147.87823176383972, "time_total_s": 6785.640978813171, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6785.640978813171, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 94.90094786729858, "ram_util_percent": 20.85497630331754}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.3149767572467681}, "default_policy": {"total_loss": 0.3149767572467681, "policy_loss": -0.012091896682977676, "vf_loss": 1.3126228271517904, "vf_loss_unclipped": 5.02956291497685, "vf_explained_var": 0.058351612836122516, "entropy": 1.0870493255555629, "mean_kl_loss": 0.0013149264967765363, "gradients_default_optimizer_global_norm": 1.9377195613458753, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.421085492696024e-15}}, "num_env_steps_sampled": 48128, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48126, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 23.955999999999996, "episode_len_mean": 112.37, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975], "episode_lengths": [88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4721235443788921, "mean_inference_ms": 1.1614435087771666, "mean_action_processing_ms": 0.0806543804793391, "mean_env_wait_ms": 4.9883909214745925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032618045806884766, "ViewRequirementAgentConnector_ms": 0.23605990409851074}}, "episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 23.955999999999996, "episode_len_mean": 112.37, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.899000000000004, 15.360000000000003, 15.797, 12.885, 23.735000000000007, 20.840999999999994, 22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975], "episode_lengths": [88, 65, 62, 46, 103, 99, 100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4721235443788921, "mean_inference_ms": 1.1614435087771666, "mean_action_processing_ms": 0.0806543804793391, "mean_env_wait_ms": 4.9883909214745925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032618045806884766, "ViewRequirementAgentConnector_ms": 0.23605990409851074}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48126, "num_agent_steps_trained": 0, "num_env_steps_sampled": 48128, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.983620060273734, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 48128, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 48126, "timers": {"training_iteration_time_ms": 150117.262, "sample_time_ms": 6890.397, "synch_weights_time_ms": 50.459}, "counters": {"num_env_steps_sampled": 48128, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48126, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 470, "training_iteration": 47, "trial_id": "default", "date": "2025-12-19_21-24-45", "timestamp": 1766150685, "time_this_iter_s": 146.63539671897888, "time_total_s": 6932.27637553215, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6932.27637553215, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 73.86838235294118, "ram_util_percent": 19.241176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.16526302159763873}, "default_policy": {"total_loss": 0.16526302159763873, "policy_loss": -0.007302696444094181, "vf_loss": 0.6943644566927105, "vf_loss_unclipped": 2.400065968791023, "vf_explained_var": 0.16437559723854064, "entropy": 1.0253933243453504, "mean_kl_loss": 0.000832420337153561, "gradients_default_optimizer_global_norm": 1.8686774500645698, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 7.10542746348012e-16}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 0, "num_agent_steps_sampled": 49150, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 24.730339999999998, "episode_len_mean": 117.29, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915], "episode_lengths": [100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4718464335327024, "mean_inference_ms": 1.160783859918485, "mean_action_processing_ms": 0.08062907129495063, "mean_env_wait_ms": 4.987461633912435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032732486724853516, "ViewRequirementAgentConnector_ms": 0.2362980842590332}}, "episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 24.730339999999998, "episode_len_mean": 117.29, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.417, 34.093, 14.060000000000002, 13.083, 36.85999999999999, 26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915], "episode_lengths": [100, 156, 55, 51, 229, 115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4718464335327024, "mean_inference_ms": 1.160783859918485, "mean_action_processing_ms": 0.08062907129495063, "mean_env_wait_ms": 4.987461633912435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032732486724853516, "ViewRequirementAgentConnector_ms": 0.2362980842590332}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49150, "num_agent_steps_trained": 0, "num_env_steps_sampled": 49152, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.932167311209265, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 49152, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 49150, "timers": {"training_iteration_time_ms": 149940.14, "sample_time_ms": 6889.587, "synch_weights_time_ms": 52.421}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 0, "num_agent_steps_sampled": 49150, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 476, "training_iteration": 48, "trial_id": "default", "date": "2025-12-19_21-27-13", "timestamp": 1766150833, "time_this_iter_s": 147.71953797340393, "time_total_s": 7079.995913505554, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7079.995913505554, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 94.76380952380953, "ram_util_percent": 18.9652380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.1646634959615767}, "default_policy": {"total_loss": 0.1646634959615767, "policy_loss": -0.009087615134194493, "vf_loss": 0.6989458837779239, "vf_loss_unclipped": 2.5446851500542835, "vf_explained_var": 0.2559420019388199, "entropy": 0.9853584721684456, "mean_kl_loss": 0.000937457062898428, "gradients_default_optimizer_global_norm": 1.6703657353296877, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 3.55271373174006e-16}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 0, "num_agent_steps_sampled": 50174, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 25.133859999999995, "episode_len_mean": 119.64, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996], "episode_lengths": [115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4718189977275206, "mean_inference_ms": 1.161312146893304, "mean_action_processing_ms": 0.08064196351226187, "mean_env_wait_ms": 4.987762597883409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032737255096435547, "ViewRequirementAgentConnector_ms": 0.23631668090820312}}, "episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 25.133859999999995, "episode_len_mean": 119.64, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.577999999999996, 21.392000000000003, 29.803999999999995, 17.316000000000003, 17.735000000000003, 19.939999999999998, 21.436999999999994, 13.690000000000001, 33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996], "episode_lengths": [115, 111, 134, 81, 71, 85, 101, 51, 209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4718189977275206, "mean_inference_ms": 1.161312146893304, "mean_action_processing_ms": 0.08064196351226187, "mean_env_wait_ms": 4.987762597883409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032737255096435547, "ViewRequirementAgentConnector_ms": 0.23631668090820312}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50174, "num_agent_steps_trained": 0, "num_env_steps_sampled": 50176, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.9447143460719705, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 50176, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 50174, "timers": {"training_iteration_time_ms": 150145.239, "sample_time_ms": 6890.647, "synch_weights_time_ms": 53.476}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 0, "num_agent_steps_sampled": 50174, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 481, "training_iteration": 49, "trial_id": "default", "date": "2025-12-19_21-29-40", "timestamp": 1766150980, "time_this_iter_s": 147.45302820205688, "time_total_s": 7227.448941707611, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7227.448941707611, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 94.91428571428571, "ram_util_percent": 18.900000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.26926902690902355}, "default_policy": {"total_loss": 0.26926902690902355, "policy_loss": -0.00796086499467492, "vf_loss": 1.1129819604102522, "vf_loss_unclipped": 4.378491482371464, "vf_explained_var": 0.05305542908608914, "entropy": 1.0155960325151683, "mean_kl_loss": 0.0009407992228087636, "gradients_default_optimizer_global_norm": 2.292979777418077, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.77635686587003e-16}}, "num_env_steps_sampled": 51200, "num_env_steps_trained": 0, "num_agent_steps_sampled": 51198, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 25.720819999999993, "episode_len_mean": 123.5, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002], "episode_lengths": [209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47170490070791765, "mean_inference_ms": 1.1619631349757702, "mean_action_processing_ms": 0.08065524546519491, "mean_env_wait_ms": 4.987959624063596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032706260681152344, "ViewRequirementAgentConnector_ms": 0.23640823364257812}}, "episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 25.720819999999993, "episode_len_mean": 123.5, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.92200000000005, 18.360999999999997, 18.480000000000004, 15.536000000000001, 24.939, 16.887999999999998, 21.322999999999993, 18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002], "episode_lengths": [209, 75, 71, 55, 111, 59, 88, 66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47170490070791765, "mean_inference_ms": 1.1619631349757702, "mean_action_processing_ms": 0.08065524546519491, "mean_env_wait_ms": 4.987959624063596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032706260681152344, "ViewRequirementAgentConnector_ms": 0.23640823364257812}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51198, "num_agent_steps_trained": 0, "num_env_steps_sampled": 51200, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.885861620180609, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 51200, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 51198, "timers": {"training_iteration_time_ms": 150292.26, "sample_time_ms": 6893.237, "synch_weights_time_ms": 52.552}, "counters": {"num_env_steps_sampled": 51200, "num_env_steps_trained": 0, "num_agent_steps_sampled": 51198, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 489, "training_iteration": 50, "trial_id": "default", "date": "2025-12-19_21-32-09", "timestamp": 1766151129, "time_this_iter_s": 148.71362829208374, "time_total_s": 7376.162569999695, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7376.162569999695, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 94.84716981132075, "ram_util_percent": 18.900000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.27348844963125885}, "default_policy": {"total_loss": 0.27348844963125885, "policy_loss": -0.008241421298589558, "vf_loss": 1.1308297719340772, "vf_loss_unclipped": 4.579653296945617, "vf_explained_var": 0.16689184159040452, "entropy": 0.9775684185326099, "mean_kl_loss": 0.0011506912791368507, "gradients_default_optimizer_global_norm": 1.9617371400818229, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 8.88178432935015e-17}}, "num_env_steps_sampled": 52224, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52222, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 26.397839999999995, "episode_len_mean": 127.34, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994], "episode_lengths": [66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4713318019384048, "mean_inference_ms": 1.1613931185833835, "mean_action_processing_ms": 0.08063186639372961, "mean_env_wait_ms": 4.98704312733135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032668113708496094, "ViewRequirementAgentConnector_ms": 0.23619437217712402}}, "episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 26.397839999999995, "episode_len_mean": 127.34, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.249999999999996, 21.797000000000004, 26.417, 13.363000000000001, 30.243999999999986, 15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994], "episode_lengths": [66, 91, 117, 50, 132, 63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4713318019384048, "mean_inference_ms": 1.1613931185833835, "mean_action_processing_ms": 0.08063186639372961, "mean_env_wait_ms": 4.98704312733135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032668113708496094, "ViewRequirementAgentConnector_ms": 0.23619437217712402}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52222, "num_agent_steps_trained": 0, "num_env_steps_sampled": 52224, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.157409344579487, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 52224, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 52222, "timers": {"training_iteration_time_ms": 148931.979, "sample_time_ms": 6889.251, "synch_weights_time_ms": 51.609}, "counters": {"num_env_steps_sampled": 52224, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52222, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 496, "training_iteration": 51, "trial_id": "default", "date": "2025-12-19_21-34-32", "timestamp": 1766151272, "time_this_iter_s": 143.07399678230286, "time_total_s": 7519.236566781998, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7519.236566781998, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 94.69901477832514, "ram_util_percent": 18.71428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.0009776256105396897}, "default_policy": {"total_loss": 0.0009776256105396897, "policy_loss": -0.02556105477269739, "vf_loss": 0.10974729228764772, "vf_loss_unclipped": 0.10974729228764772, "vf_explained_var": 0.47615386433899404, "entropy": 0.8981441967189312, "mean_kl_loss": 0.004331008209420162, "gradients_default_optimizer_global_norm": 1.394270176999271, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 4.440892164675075e-17}}, "num_env_steps_sampled": 53248, "num_env_steps_trained": 0, "num_agent_steps_sampled": 53246, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 27.17921999999999, "episode_len_mean": 133.5, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916], "episode_lengths": [63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47132206354336625, "mean_inference_ms": 1.1622769792591892, "mean_action_processing_ms": 0.08065569097199693, "mean_env_wait_ms": 4.9877397347400025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032472610473632812, "ViewRequirementAgentConnector_ms": 0.2360374927520752}}, "episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 27.17921999999999, "episode_len_mean": 133.5, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.586, 30.565000000000005, 15.293, 15.007000000000001, 17.245, 16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916], "episode_lengths": [63, 139, 57, 54, 62, 65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47132206354336625, "mean_inference_ms": 1.1622769792591892, "mean_action_processing_ms": 0.08065569097199693, "mean_env_wait_ms": 4.9877397347400025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032472610473632812, "ViewRequirementAgentConnector_ms": 0.2360374927520752}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53246, "num_agent_steps_trained": 0, "num_env_steps_sampled": 53248, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.128177353443471, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 53248, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 53246, "timers": {"training_iteration_time_ms": 148043.279, "sample_time_ms": 6882.93, "synch_weights_time_ms": 51.974}, "counters": {"num_env_steps_sampled": 53248, "num_env_steps_trained": 0, "num_agent_steps_sampled": 53246, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 501, "training_iteration": 52, "trial_id": "default", "date": "2025-12-19_21-38-17", "timestamp": 1766151497, "time_this_iter_s": 143.65776991844177, "time_total_s": 7662.894336700439, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7662.894336700439, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 62.68107255520505, "ram_util_percent": 18.599999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.07167111057788134}, "default_policy": {"total_loss": 0.07167111057788134, "policy_loss": -0.007998040271922946, "vf_loss": 0.32206856095581315, "vf_loss_unclipped": 1.1805135433503893, "vf_explained_var": 0.40317335799336435, "entropy": 0.8479915287345647, "mean_kl_loss": 0.0009064500997187253, "gradients_default_optimizer_global_norm": 1.358862878754735, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 2.2204460823375376e-17}}, "num_env_steps_sampled": 54272, "num_env_steps_trained": 0, "num_agent_steps_sampled": 54270, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 28.001009999999994, "episode_len_mean": 139.24, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114], "episode_lengths": [65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47102433630272794, "mean_inference_ms": 1.162016774592375, "mean_action_processing_ms": 0.08064372781306105, "mean_env_wait_ms": 4.98727385104296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003252267837524414, "ViewRequirementAgentConnector_ms": 0.23601055145263672}}, "episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 28.001009999999994, "episode_len_mean": 139.24, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.83, 39.75199999999998, 39.81299999999997, 12.513, 14.470000000000002, 13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114], "episode_lengths": [65, 182, 191, 41, 57, 50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47102433630272794, "mean_inference_ms": 1.162016774592375, "mean_action_processing_ms": 0.08064372781306105, "mean_env_wait_ms": 4.98727385104296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003252267837524414, "ViewRequirementAgentConnector_ms": 0.23601055145263672}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54270, "num_agent_steps_trained": 0, "num_env_steps_sampled": 54272, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.205173687603813, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 54272, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 54270, "timers": {"training_iteration_time_ms": 147113.699, "sample_time_ms": 6878.589, "synch_weights_time_ms": 51.212}, "counters": {"num_env_steps_sampled": 54272, "num_env_steps_trained": 0, "num_agent_steps_sampled": 54270, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 506, "training_iteration": 53, "trial_id": "default", "date": "2025-12-19_21-40-39", "timestamp": 1766151639, "time_this_iter_s": 142.12252736091614, "time_total_s": 7805.016864061356, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7805.016864061356, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 94.65369458128077, "ram_util_percent": 18.599999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.002936849556863308}, "default_policy": {"total_loss": 0.002936849556863308, "policy_loss": -0.02016282284166664, "vf_loss": 0.09566525121335871, "vf_loss_unclipped": 0.09566525121335871, "vf_explained_var": 0.4598784428089857, "entropy": 0.8166408561170101, "mean_kl_loss": 0.002995935863003796, "gradients_default_optimizer_global_norm": 1.4487873941659928, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.1102230411687688e-17}}, "num_env_steps_sampled": 55296, "num_env_steps_trained": 0, "num_agent_steps_sampled": 55294, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 28.6364, "episode_len_mean": 144.48, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114, 37.666000000000004, 37.87600000000005, 36.176999999999964, 37.026000000000025, 38.17200000000002], "episode_lengths": [50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217, 218, 214, 209, 209, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47078865492778044, "mean_inference_ms": 1.1621068413023647, "mean_action_processing_ms": 0.08064254614146794, "mean_env_wait_ms": 4.987245004017886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032486915588378906, "ViewRequirementAgentConnector_ms": 0.23602724075317383}}, "episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 28.6364, "episode_len_mean": 144.48, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.802, 20.896, 21.465, 34.42699999999998, 14.719000000000001, 32.15199999999999, 37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114, 37.666000000000004, 37.87600000000005, 36.176999999999964, 37.026000000000025, 38.17200000000002], "episode_lengths": [50, 87, 95, 172, 62, 144, 218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217, 218, 214, 209, 209, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47078865492778044, "mean_inference_ms": 1.1621068413023647, "mean_action_processing_ms": 0.08064254614146794, "mean_env_wait_ms": 4.987245004017886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032486915588378906, "ViewRequirementAgentConnector_ms": 0.23602724075317383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55294, "num_agent_steps_trained": 0, "num_env_steps_sampled": 55296, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.20218484594271, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 55296, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 55294, "timers": {"training_iteration_time_ms": 146329.078, "sample_time_ms": 6870.712, "synch_weights_time_ms": 51.677}, "counters": {"num_env_steps_sampled": 55296, "num_env_steps_trained": 0, "num_agent_steps_sampled": 55294, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 511, "training_iteration": 54, "trial_id": "default", "date": "2025-12-19_21-43-01", "timestamp": 1766151781, "time_this_iter_s": 142.18156480789185, "time_total_s": 7947.198428869247, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7947.198428869247, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 94.69504950495049, "ram_util_percent": 18.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.13725870801135898}, "default_policy": {"total_loss": 0.13725870801135898, "policy_loss": -0.009546126890927552, "vf_loss": 0.5904638236039318, "vf_loss_unclipped": 2.5307903973036447, "vf_explained_var": 0.3904054567217827, "entropy": 0.8111299026757479, "mean_kl_loss": 0.001026082725392463, "gradients_default_optimizer_global_norm": 1.3233052466064692, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 5.551115205843844e-18}}, "num_env_steps_sampled": 56320, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56318, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 29.466659999999997, "episode_len_mean": 149.66, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114, 37.666000000000004, 37.87600000000005, 36.176999999999964, 37.026000000000025, 38.17200000000002, 37.16800000000004, 38.24600000000008, 36.98600000000001, 27.569999999999997, 43.150999999999996, 37.366000000000085], "episode_lengths": [218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217, 218, 214, 209, 209, 210, 206, 210, 208, 116, 185, 203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47049618367930385, "mean_inference_ms": 1.1622268105182538, "mean_action_processing_ms": 0.08064084237889216, "mean_env_wait_ms": 4.987175086504522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032444000244140625, "ViewRequirementAgentConnector_ms": 0.2360546588897705}}, "episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 29.466659999999997, "episode_len_mean": 149.66, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.034000000000006, 15.014000000000001, 18.645000000000003, 14.867000000000003, 19.864000000000004, 14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114, 37.666000000000004, 37.87600000000005, 36.176999999999964, 37.026000000000025, 38.17200000000002, 37.16800000000004, 38.24600000000008, 36.98600000000001, 27.569999999999997, 43.150999999999996, 37.366000000000085], "episode_lengths": [218, 57, 74, 58, 86, 56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217, 218, 214, 209, 209, 210, 206, 210, 208, 116, 185, 203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47049618367930385, "mean_inference_ms": 1.1622268105182538, "mean_action_processing_ms": 0.08064084237889216, "mean_env_wait_ms": 4.987175086504522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032444000244140625, "ViewRequirementAgentConnector_ms": 0.2360546588897705}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56318, "num_agent_steps_trained": 0, "num_env_steps_sampled": 56320, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.1576059520604565, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 56320, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 56318, "timers": {"training_iteration_time_ms": 145246.613, "sample_time_ms": 6838.478, "synch_weights_time_ms": 51.036}, "counters": {"num_env_steps_sampled": 56320, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56318, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 517, "training_iteration": 55, "trial_id": "default", "date": "2025-12-19_21-45-24", "timestamp": 1766151924, "time_this_iter_s": 143.07047486305237, "time_total_s": 8090.2689037323, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8090.2689037323, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 94.71617647058825, "ram_util_percent": 18.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.14105295594781636}, "default_policy": {"total_loss": 0.14105295594781636, "policy_loss": -0.005583008751273155, "vf_loss": 0.5895892154658213, "vf_loss_unclipped": 2.611811452754773, "vf_explained_var": 0.2007329773157835, "entropy": 0.7613401941955089, "mean_kl_loss": 0.0006800237324653402, "gradients_default_optimizer_global_norm": 1.4767223067581654, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 2.775557602921922e-18}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 0, "num_agent_steps_sampled": 57342, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 30.150780000000005, "episode_len_mean": 153.62, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114, 37.666000000000004, 37.87600000000005, 36.176999999999964, 37.026000000000025, 38.17200000000002, 37.16800000000004, 38.24600000000008, 36.98600000000001, 27.569999999999997, 43.150999999999996, 37.366000000000085, 39.28800000000004, 36.203, 25.807999999999986, 36.30899999999997, 36.22799999999998], "episode_lengths": [56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217, 218, 214, 209, 209, 210, 206, 210, 208, 116, 185, 203, 209, 202, 106, 215, 157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4704478300738873, "mean_inference_ms": 1.1634621111332164, "mean_action_processing_ms": 0.08067394683729127, "mean_env_wait_ms": 4.988228291384742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032532215118408203, "ViewRequirementAgentConnector_ms": 0.23638701438903809}}, "episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 30.150780000000005, "episode_len_mean": 153.62, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.106000000000002, 35.082000000000015, 24.846000000000004, 33.782999999999994, 24.31300000000001, 38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114, 37.666000000000004, 37.87600000000005, 36.176999999999964, 37.026000000000025, 38.17200000000002, 37.16800000000004, 38.24600000000008, 36.98600000000001, 27.569999999999997, 43.150999999999996, 37.366000000000085, 39.28800000000004, 36.203, 25.807999999999986, 36.30899999999997, 36.22799999999998], "episode_lengths": [56, 215, 113, 162, 110, 178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217, 218, 214, 209, 209, 210, 206, 210, 208, 116, 185, 203, 209, 202, 106, 215, 157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4704478300738873, "mean_inference_ms": 1.1634621111332164, "mean_action_processing_ms": 0.08067394683729127, "mean_env_wait_ms": 4.988228291384742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032532215118408203, "ViewRequirementAgentConnector_ms": 0.23638701438903809}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57342, "num_agent_steps_trained": 0, "num_env_steps_sampled": 57344, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.1296787856547, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 57344, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 57342, "timers": {"training_iteration_time_ms": 144821.877, "sample_time_ms": 6833.929, "synch_weights_time_ms": 50.775}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 0, "num_agent_steps_sampled": 57342, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 522, "training_iteration": 56, "trial_id": "default", "date": "2025-12-19_21-47-48", "timestamp": 1766152068, "time_this_iter_s": 143.63033819198608, "time_total_s": 8233.899241924286, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8233.899241924286, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 94.54852941176472, "ram_util_percent": 18.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": -0.001916667225304991}, "default_policy": {"total_loss": -0.001916667225304991, "policy_loss": -0.01837346056709066, "vf_loss": 0.06869076091388707, "vf_loss_unclipped": 0.06869076091388707, "vf_explained_var": 0.4865346010774374, "entropy": 0.7158938683569431, "mean_kl_loss": 0.002918148136803822, "gradients_default_optimizer_global_norm": 1.287312260363251, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.387778801460961e-18}}, "num_env_steps_sampled": 58368, "num_env_steps_trained": 0, "num_agent_steps_sampled": 58366, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 30.753650000000004, "episode_len_mean": 157.41, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114, 37.666000000000004, 37.87600000000005, 36.176999999999964, 37.026000000000025, 38.17200000000002, 37.16800000000004, 38.24600000000008, 36.98600000000001, 27.569999999999997, 43.150999999999996, 37.366000000000085, 39.28800000000004, 36.203, 25.807999999999986, 36.30899999999997, 36.22799999999998, 39.17400000000002, 38.309999999999924, 38.52300000000009, 37.79199999999994, 38.61799999999999], "episode_lengths": [178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217, 218, 214, 209, 209, 210, 206, 210, 208, 116, 185, 203, 209, 202, 106, 215, 157, 210, 208, 208, 204, 205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4699906600698316, "mean_inference_ms": 1.1627939758082946, "mean_action_processing_ms": 0.08064902027528571, "mean_env_wait_ms": 4.987411656599662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032434463500976562, "ViewRequirementAgentConnector_ms": 0.2362964153289795}}, "episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 30.753650000000004, "episode_len_mean": 157.41, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.65499999999997, 38.35999999999996, 16.381, 16.325000000000003, 38.644000000000005, 37.272000000000006, 13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114, 37.666000000000004, 37.87600000000005, 36.176999999999964, 37.026000000000025, 38.17200000000002, 37.16800000000004, 38.24600000000008, 36.98600000000001, 27.569999999999997, 43.150999999999996, 37.366000000000085, 39.28800000000004, 36.203, 25.807999999999986, 36.30899999999997, 36.22799999999998, 39.17400000000002, 38.309999999999924, 38.52300000000009, 37.79199999999994, 38.61799999999999], "episode_lengths": [178, 178, 63, 69, 187, 218, 61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217, 218, 214, 209, 209, 210, 206, 210, 208, 116, 185, 203, 209, 202, 106, 215, 157, 210, 208, 208, 204, 205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4699906600698316, "mean_inference_ms": 1.1627939758082946, "mean_action_processing_ms": 0.08064902027528571, "mean_env_wait_ms": 4.987411656599662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032434463500976562, "ViewRequirementAgentConnector_ms": 0.2362964153289795}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58366, "num_agent_steps_trained": 0, "num_env_steps_sampled": 58368, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.034809190485567, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 58368, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 58366, "timers": {"training_iteration_time_ms": 144715.181, "sample_time_ms": 6825.857, "synch_weights_time_ms": 50.304}, "counters": {"num_env_steps_sampled": 58368, "num_env_steps_trained": 0, "num_agent_steps_sampled": 58366, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 527, "training_iteration": 57, "trial_id": "default", "date": "2025-12-19_21-51-56", "timestamp": 1766152316, "time_this_iter_s": 145.56446385383606, "time_total_s": 8379.463705778122, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8379.463705778122, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 58.06571428571429, "ram_util_percent": 18.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.20712475175969303}, "default_policy": {"total_loss": 0.20712475175969303, "policy_loss": -0.00794247044250369, "vf_loss": 0.8631421059602872, "vf_loss_unclipped": 4.29184471371118, "vf_explained_var": 0.16444981954991816, "entropy": 0.7183050379157067, "mean_kl_loss": 0.0014206730844854576, "gradients_default_optimizer_global_norm": 1.563879745081067, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 6.938894007304805e-19}}, "num_env_steps_sampled": 59392, "num_env_steps_trained": 0, "num_agent_steps_sampled": 59390, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 30.921460000000007, "episode_len_mean": 158.25, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114, 37.666000000000004, 37.87600000000005, 36.176999999999964, 37.026000000000025, 38.17200000000002, 37.16800000000004, 38.24600000000008, 36.98600000000001, 27.569999999999997, 43.150999999999996, 37.366000000000085, 39.28800000000004, 36.203, 25.807999999999986, 36.30899999999997, 36.22799999999998, 39.17400000000002, 38.309999999999924, 38.52300000000009, 37.79199999999994, 38.61799999999999, 37.93400000000007, 18.782, 33.600999999999985, 36.16800000000001, 37.78500000000008, 38.147999999999946], "episode_lengths": [61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217, 218, 214, 209, 209, 210, 206, 210, 208, 116, 185, 203, 209, 202, 106, 215, 157, 210, 208, 208, 204, 205, 205, 74, 140, 148, 203, 207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4697941341336129, "mean_inference_ms": 1.1636444063435762, "mean_action_processing_ms": 0.0806692900037543, "mean_env_wait_ms": 4.988000773805786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032427310943603516, "ViewRequirementAgentConnector_ms": 0.23613190650939941}}, "episode_reward_max": 43.58499999999996, "episode_reward_min": 11.772, "episode_reward_mean": 30.921460000000007, "episode_len_mean": 158.25, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.632000000000001, 34.42099999999997, 31.706999999999994, 14.658000000000001, 18.536, 33.20500000000004, 28.624999999999986, 22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114, 37.666000000000004, 37.87600000000005, 36.176999999999964, 37.026000000000025, 38.17200000000002, 37.16800000000004, 38.24600000000008, 36.98600000000001, 27.569999999999997, 43.150999999999996, 37.366000000000085, 39.28800000000004, 36.203, 25.807999999999986, 36.30899999999997, 36.22799999999998, 39.17400000000002, 38.309999999999924, 38.52300000000009, 37.79199999999994, 38.61799999999999, 37.93400000000007, 18.782, 33.600999999999985, 36.16800000000001, 37.78500000000008, 38.147999999999946], "episode_lengths": [61, 163, 142, 58, 73, 213, 148, 104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217, 218, 214, 209, 209, 210, 206, 210, 208, 116, 185, 203, 209, 202, 106, 215, 157, 210, 208, 208, 204, 205, 205, 74, 140, 148, 203, 207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4697941341336129, "mean_inference_ms": 1.1636444063435762, "mean_action_processing_ms": 0.0806692900037543, "mean_env_wait_ms": 4.988000773805786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032427310943603516, "ViewRequirementAgentConnector_ms": 0.23613190650939941}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59390, "num_agent_steps_trained": 0, "num_env_steps_sampled": 59392, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.078217754482345, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 59392, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 59390, "timers": {"training_iteration_time_ms": 144410.382, "sample_time_ms": 6828.177, "synch_weights_time_ms": 49.599}, "counters": {"num_env_steps_sampled": 59392, "num_env_steps_trained": 0, "num_agent_steps_sampled": 59390, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 533, "training_iteration": 58, "trial_id": "default", "date": "2025-12-19_21-54-21", "timestamp": 1766152461, "time_this_iter_s": 144.67170691490173, "time_total_s": 8524.135412693024, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8524.135412693024, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 94.77815533980583, "ram_util_percent": 18.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.20873230448924004}, "default_policy": {"total_loss": 0.20873230448924004, "policy_loss": -0.009013453515945003, "vf_loss": 0.8738847906468437, "vf_loss_unclipped": 4.462062314036302, "vf_explained_var": 0.29378099665045737, "entropy": 0.7254372775554657, "mean_kl_loss": 0.0008856347480051818, "gradients_default_optimizer_global_norm": 1.5465625219978392, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 3.4694470036524025e-19}}, "num_env_steps_sampled": 60416, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60414, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 48.086000000000055, "episode_reward_min": 11.772, "episode_reward_mean": 31.585450000000005, "episode_len_mean": 161.35, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114, 37.666000000000004, 37.87600000000005, 36.176999999999964, 37.026000000000025, 38.17200000000002, 37.16800000000004, 38.24600000000008, 36.98600000000001, 27.569999999999997, 43.150999999999996, 37.366000000000085, 39.28800000000004, 36.203, 25.807999999999986, 36.30899999999997, 36.22799999999998, 39.17400000000002, 38.309999999999924, 38.52300000000009, 37.79199999999994, 38.61799999999999, 37.93400000000007, 18.782, 33.600999999999985, 36.16800000000001, 37.78500000000008, 38.147999999999946, 38.946000000000026, 22.808999999999994, 38.71199999999998, 38.06799999999998, 14.983, 39.57899999999996, 48.086000000000055], "episode_lengths": [104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217, 218, 214, 209, 209, 210, 206, 210, 208, 116, 185, 203, 209, 202, 106, 215, 157, 210, 208, 208, 204, 205, 205, 74, 140, 148, 203, 207, 212, 85, 207, 206, 51, 204, 203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46942503392964224, "mean_inference_ms": 1.1640717578845226, "mean_action_processing_ms": 0.0806752058077324, "mean_env_wait_ms": 4.988240313494603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032269954681396484, "ViewRequirementAgentConnector_ms": 0.23575067520141602}}, "episode_reward_max": 48.086000000000055, "episode_reward_min": 11.772, "episode_reward_mean": 31.585450000000005, "episode_len_mean": 161.35, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.981000000000005, 18.096999999999998, 31.736999999999995, 26.675000000000004, 29.56600000000001, 36.03000000000002, 36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114, 37.666000000000004, 37.87600000000005, 36.176999999999964, 37.026000000000025, 38.17200000000002, 37.16800000000004, 38.24600000000008, 36.98600000000001, 27.569999999999997, 43.150999999999996, 37.366000000000085, 39.28800000000004, 36.203, 25.807999999999986, 36.30899999999997, 36.22799999999998, 39.17400000000002, 38.309999999999924, 38.52300000000009, 37.79199999999994, 38.61799999999999, 37.93400000000007, 18.782, 33.600999999999985, 36.16800000000001, 37.78500000000008, 38.147999999999946, 38.946000000000026, 22.808999999999994, 38.71199999999998, 38.06799999999998, 14.983, 39.57899999999996, 48.086000000000055], "episode_lengths": [104, 67, 213, 118, 141, 213, 215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217, 218, 214, 209, 209, 210, 206, 210, 208, 116, 185, 203, 209, 202, 106, 215, 157, 210, 208, 208, 204, 205, 205, 74, 140, 148, 203, 207, 212, 85, 207, 206, 51, 204, 203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46942503392964224, "mean_inference_ms": 1.1640717578845226, "mean_action_processing_ms": 0.0806752058077324, "mean_env_wait_ms": 4.988240313494603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032269954681396484, "ViewRequirementAgentConnector_ms": 0.23575067520141602}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60414, "num_agent_steps_trained": 0, "num_env_steps_sampled": 60416, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.168626667575045, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 60416, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 60414, "timers": {"training_iteration_time_ms": 143949.824, "sample_time_ms": 6826.678, "synch_weights_time_ms": 48.034}, "counters": {"num_env_steps_sampled": 60416, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60414, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 540, "training_iteration": 59, "trial_id": "default", "date": "2025-12-19_21-56-44", "timestamp": 1766152604, "time_this_iter_s": 142.84689736366272, "time_total_s": 8666.982310056686, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8666.982310056686, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 94.59014778325121, "ram_util_percent": 18.599999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.14183410616242326}, "default_policy": {"total_loss": 0.14183410616242326, "policy_loss": -0.005305226927157491, "vf_loss": 0.5915039027226158, "vf_loss_unclipped": 3.158655085612554, "vf_explained_var": 0.4561636094003916, "entropy": 0.736646869033575, "mean_kl_loss": 0.0007994950806920808, "gradients_default_optimizer_global_norm": 1.1944983841851353, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.7347235018262012e-19}}, "num_env_steps_sampled": 61440, "num_env_steps_trained": 0, "num_agent_steps_sampled": 61438, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 48.086000000000055, "episode_reward_min": 11.772, "episode_reward_mean": 31.83801, "episode_len_mean": 162.29, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114, 37.666000000000004, 37.87600000000005, 36.176999999999964, 37.026000000000025, 38.17200000000002, 37.16800000000004, 38.24600000000008, 36.98600000000001, 27.569999999999997, 43.150999999999996, 37.366000000000085, 39.28800000000004, 36.203, 25.807999999999986, 36.30899999999997, 36.22799999999998, 39.17400000000002, 38.309999999999924, 38.52300000000009, 37.79199999999994, 38.61799999999999, 37.93400000000007, 18.782, 33.600999999999985, 36.16800000000001, 37.78500000000008, 38.147999999999946, 38.946000000000026, 22.808999999999994, 38.71199999999998, 38.06799999999998, 14.983, 39.57899999999996, 48.086000000000055, 39.47300000000005, 23.751999999999995, 38.26199999999993, 12.801, 38.89499999999997, 37.15900000000002], "episode_lengths": [215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217, 218, 214, 209, 209, 210, 206, 210, 208, 116, 185, 203, 209, 202, 106, 215, 157, 210, 208, 208, 204, 205, 205, 74, 140, 148, 203, 207, 212, 85, 207, 206, 51, 204, 203, 203, 96, 204, 38, 206, 203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46912987880647916, "mean_inference_ms": 1.1643817969005652, "mean_action_processing_ms": 0.08068137694482636, "mean_env_wait_ms": 4.98843551519076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032050609588623047, "ViewRequirementAgentConnector_ms": 0.2353191375732422}}, "episode_reward_max": 48.086000000000055, "episode_reward_min": 11.772, "episode_reward_mean": 31.83801, "episode_len_mean": 162.29, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.48899999999995, 23.519000000000005, 15.126000000000001, 34.358999999999966, 23.632000000000005, 25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114, 37.666000000000004, 37.87600000000005, 36.176999999999964, 37.026000000000025, 38.17200000000002, 37.16800000000004, 38.24600000000008, 36.98600000000001, 27.569999999999997, 43.150999999999996, 37.366000000000085, 39.28800000000004, 36.203, 25.807999999999986, 36.30899999999997, 36.22799999999998, 39.17400000000002, 38.309999999999924, 38.52300000000009, 37.79199999999994, 38.61799999999999, 37.93400000000007, 18.782, 33.600999999999985, 36.16800000000001, 37.78500000000008, 38.147999999999946, 38.946000000000026, 22.808999999999994, 38.71199999999998, 38.06799999999998, 14.983, 39.57899999999996, 48.086000000000055, 39.47300000000005, 23.751999999999995, 38.26199999999993, 12.801, 38.89499999999997, 37.15900000000002], "episode_lengths": [215, 100, 57, 216, 102, 109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217, 218, 214, 209, 209, 210, 206, 210, 208, 116, 185, 203, 209, 202, 106, 215, 157, 210, 208, 208, 204, 205, 205, 74, 140, 148, 203, 207, 212, 85, 207, 206, 51, 204, 203, 203, 96, 204, 38, 206, 203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46912987880647916, "mean_inference_ms": 1.1643817969005652, "mean_action_processing_ms": 0.08068137694482636, "mean_env_wait_ms": 4.98843551519076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032050609588623047, "ViewRequirementAgentConnector_ms": 0.2353191375732422}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61438, "num_agent_steps_trained": 0, "num_env_steps_sampled": 61440, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.1250312104041935, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 61440, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 61438, "timers": {"training_iteration_time_ms": 143450.637, "sample_time_ms": 6825.504, "synch_weights_time_ms": 48.955}, "counters": {"num_env_steps_sampled": 61440, "num_env_steps_trained": 0, "num_agent_steps_sampled": 61438, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 546, "training_iteration": 60, "trial_id": "default", "date": "2025-12-19_21-59-07", "timestamp": 1766152747, "time_this_iter_s": 143.7248673439026, "time_total_s": 8810.707177400589, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8810.707177400589, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 94.63529411764705, "ram_util_percent": 18.61078431372549}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": -0.0024658303940668703}, "default_policy": {"total_loss": -0.0024658303940668703, "policy_loss": -0.014363462285837158, "vf_loss": 0.05028903792554047, "vf_loss_unclipped": 0.05028903792554047, "vf_explained_var": 0.5647255651652813, "entropy": 0.674629469960928, "mean_kl_loss": 0.002470786001477254, "gradients_default_optimizer_global_norm": 1.0529992928728462, "default_optimizer_lr": 3.0000000000000004e-05, "curr_lr": 3e-05, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 8.673617509131006e-20}}, "num_env_steps_sampled": 62464, "num_env_steps_trained": 0, "num_agent_steps_sampled": 62462, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 48.086000000000055, "episode_reward_min": 11.772, "episode_reward_mean": 32.42924000000001, "episode_len_mean": 165.69, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114, 37.666000000000004, 37.87600000000005, 36.176999999999964, 37.026000000000025, 38.17200000000002, 37.16800000000004, 38.24600000000008, 36.98600000000001, 27.569999999999997, 43.150999999999996, 37.366000000000085, 39.28800000000004, 36.203, 25.807999999999986, 36.30899999999997, 36.22799999999998, 39.17400000000002, 38.309999999999924, 38.52300000000009, 37.79199999999994, 38.61799999999999, 37.93400000000007, 18.782, 33.600999999999985, 36.16800000000001, 37.78500000000008, 38.147999999999946, 38.946000000000026, 22.808999999999994, 38.71199999999998, 38.06799999999998, 14.983, 39.57899999999996, 48.086000000000055, 39.47300000000005, 23.751999999999995, 38.26199999999993, 12.801, 38.89499999999997, 37.15900000000002, 38.30100000000008, 38.00900000000001, 38.474000000000025, 38.38900000000001, 39.07499999999999], "episode_lengths": [109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217, 218, 214, 209, 209, 210, 206, 210, 208, 116, 185, 203, 209, 202, 106, 215, 157, 210, 208, 208, 204, 205, 205, 74, 140, 148, 203, 207, 212, 85, 207, 206, 51, 204, 203, 203, 96, 204, 38, 206, 203, 203, 209, 205, 207, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46871687097547116, "mean_inference_ms": 1.163699689106428, "mean_action_processing_ms": 0.08066337587106834, "mean_env_wait_ms": 4.9879408280320225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003187894821166992, "ViewRequirementAgentConnector_ms": 0.23462796211242676}}, "episode_reward_max": 48.086000000000055, "episode_reward_min": 11.772, "episode_reward_mean": 32.42924000000001, "episode_len_mean": 165.69, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.507, 31.04799999999999, 34.205, 18.561999999999998, 21.060000000000002, 35.88799999999993, 15.305000000000001, 14.908, 23.854000000000006, 43.58499999999996, 22.147, 30.44900000000001, 36.06099999999993, 14.676000000000002, 17.58, 19.037, 35.328000000000024, 11.772, 38.464999999999975, 22.744, 37.008000000000045, 24.722, 27.330000000000005, 35.693, 37.453999999999915, 37.21499999999992, 35.447000000000045, 22.641, 32.48399999999999, 33.077999999999996, 35.365000000000045, 24.35200000000001, 19.561, 38.60999999999992, 13.236, 39.017, 21.168000000000006, 35.27900000000002, 35.78100000000002, 14.579000000000004, 36.363999999999955, 30.38799999999999, 37.18799999999998, 41.13200000000001, 21.718999999999994, 36.291999999999916, 36.68999999999997, 39.32400000000006, 37.93099999999993, 37.971999999999916, 36.28400000000008, 38.36100000000002, 23.226999999999997, 38.11000000000006, 39.893000000000114, 37.666000000000004, 37.87600000000005, 36.176999999999964, 37.026000000000025, 38.17200000000002, 37.16800000000004, 38.24600000000008, 36.98600000000001, 27.569999999999997, 43.150999999999996, 37.366000000000085, 39.28800000000004, 36.203, 25.807999999999986, 36.30899999999997, 36.22799999999998, 39.17400000000002, 38.309999999999924, 38.52300000000009, 37.79199999999994, 38.61799999999999, 37.93400000000007, 18.782, 33.600999999999985, 36.16800000000001, 37.78500000000008, 38.147999999999946, 38.946000000000026, 22.808999999999994, 38.71199999999998, 38.06799999999998, 14.983, 39.57899999999996, 48.086000000000055, 39.47300000000005, 23.751999999999995, 38.26199999999993, 12.801, 38.89499999999997, 37.15900000000002, 38.30100000000008, 38.00900000000001, 38.474000000000025, 38.38900000000001, 39.07499999999999], "episode_lengths": [109, 142, 214, 88, 86, 210, 55, 54, 100, 205, 99, 133, 214, 51, 70, 82, 163, 48, 220, 91, 213, 104, 116, 211, 220, 219, 209, 98, 145, 155, 218, 103, 74, 209, 50, 185, 89, 207, 214, 49, 170, 131, 205, 192, 91, 211, 217, 218, 214, 212, 213, 213, 90, 216, 217, 218, 214, 209, 209, 210, 206, 210, 208, 116, 185, 203, 209, 202, 106, 215, 157, 210, 208, 208, 204, 205, 205, 74, 140, 148, 203, 207, 212, 85, 207, 206, 51, 204, 203, 203, 96, 204, 38, 206, 203, 203, 209, 205, 207, 206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46871687097547116, "mean_inference_ms": 1.163699689106428, "mean_action_processing_ms": 0.08066337587106834, "mean_env_wait_ms": 4.9879408280320225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003187894821166992, "ViewRequirementAgentConnector_ms": 0.23462796211242676}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62462, "num_agent_steps_trained": 0, "num_env_steps_sampled": 62464, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.84827036502487, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 62464, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 62462, "timers": {"training_iteration_time_ms": 144096.463, "sample_time_ms": 6826.153, "synch_weights_time_ms": 49.591}, "counters": {"num_env_steps_sampled": 62464, "num_env_steps_trained": 0, "num_agent_steps_sampled": 62462, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 551, "training_iteration": 61, "trial_id": "default", "date": "2025-12-19_22-01-37", "timestamp": 1766152897, "time_this_iter_s": 149.52997422218323, "time_total_s": 8960.237151622772, "pid": 2567369, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x779399b2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7793986ab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8960.237151622772, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 94.78638497652582, "ram_util_percent": 18.43474178403756}}
