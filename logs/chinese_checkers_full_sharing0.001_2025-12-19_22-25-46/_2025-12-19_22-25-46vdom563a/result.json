{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1022.0, "total_loss": -0.022165678848978132}, "default_policy": {"total_loss": -0.022165678848978132, "policy_loss": -0.036828089971095324, "vf_loss": 0.0654300264432095, "vf_loss_unclipped": 0.0654300264432095, "vf_explained_var": -0.10608073808252812, "entropy": 2.181759721040726, "mean_kl_loss": 0.0024333222287759525, "gradients_default_optimizer_global_norm": 0.22650600750930608, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1022, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 9.113000000000003, "episode_reward_min": 4.345, "episode_reward_mean": 6.5100000000000025, "episode_len_mean": 232.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065], "episode_lengths": [235, 236, 233, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5384390814262524, "mean_inference_ms": 1.5876332686426113, "mean_action_processing_ms": 0.1078049341837565, "mean_env_wait_ms": 6.264295029593723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004678964614868164, "ViewRequirementAgentConnector_ms": 0.29631853103637695}}, "episode_reward_max": 9.113000000000003, "episode_reward_min": 4.345, "episode_reward_mean": 6.5100000000000025, "episode_len_mean": 232.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065], "episode_lengths": [235, 236, 233, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5384390814262524, "mean_inference_ms": 1.5876332686426113, "mean_action_processing_ms": 0.1078049341837565, "mean_env_wait_ms": 6.264295029593723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004678964614868164, "ViewRequirementAgentConnector_ms": 0.29631853103637695}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1022, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.101653323245373, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1024, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1022, "timers": {"training_iteration_time_ms": 249655.286, "sample_time_ms": 8753.686, "synch_weights_time_ms": 81.989}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1022, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 1, "trial_id": "default", "date": "2025-12-19_22-29-59", "timestamp": 1766154599, "time_this_iter_s": 249.65798163414001, "time_total_s": 249.65798163414001, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 249.65798163414001, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 95.14394366197185, "ram_util_percent": 32.48309859154929}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": -0.035880615445785226}, "default_policy": {"total_loss": -0.035880615445785226, "policy_loss": -0.05075837103649974, "vf_loss": 0.06593579213949852, "vf_loss_unclipped": 0.06593579213949852, "vf_explained_var": 0.09161527603864669, "entropy": 2.1795634374022486, "mean_kl_loss": 0.00573369693600938, "gradients_default_optimizer_global_norm": 0.27881347965449094, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2046, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.470000000000004, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 6.937000000000003, "episode_len_mean": 229.75, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5389513181834125, "mean_inference_ms": 1.5865097375533406, "mean_action_processing_ms": 0.10712894966931846, "mean_env_wait_ms": 6.232954541915823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00451207160949707, "ViewRequirementAgentConnector_ms": 0.296899676322937}}, "episode_reward_max": 12.470000000000004, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 6.937000000000003, "episode_len_mean": 229.75, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5389513181834125, "mean_inference_ms": 1.5865097375533406, "mean_action_processing_ms": 0.10712894966931846, "mean_env_wait_ms": 6.232954541915823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00451207160949707, "ViewRequirementAgentConnector_ms": 0.296899676322937}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2046, "num_agent_steps_trained": 0, "num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.271434527983338, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 2048, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2046, "timers": {"training_iteration_time_ms": 244693.656, "sample_time_ms": 8678.134, "synch_weights_time_ms": 93.064}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2046, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 2, "trial_id": "default", "date": "2025-12-19_22-34-11", "timestamp": 1766154851, "time_this_iter_s": 239.73689770698547, "time_total_s": 489.3948793411255, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 489.3948793411255, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 94.56750700280112, "ram_util_percent": 32.332212885154064}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": -0.025234889118291904}, "default_policy": {"total_loss": -0.025234889118291904, "policy_loss": -0.05982539146207273, "vf_loss": 0.14266113459598273, "vf_loss_unclipped": 0.14266113459598273, "vf_explained_var": 0.39056478850543497, "entropy": 2.1162834987044334, "mean_kl_loss": 0.010415063029605065, "gradients_default_optimizer_global_norm": 0.4397914716042578, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3070, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 17.49900000000001, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 9.407250000000003, "episode_len_mean": 231.41666666666666, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5429894156602253, "mean_inference_ms": 1.6013310401310885, "mean_action_processing_ms": 0.10738061367459144, "mean_env_wait_ms": 6.25317649231603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004591544469197591, "ViewRequirementAgentConnector_ms": 0.30440489451090497}}, "episode_reward_max": 17.49900000000001, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 9.407250000000003, "episode_len_mean": 231.41666666666666, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5429894156602253, "mean_inference_ms": 1.6013310401310885, "mean_action_processing_ms": 0.10738061367459144, "mean_env_wait_ms": 6.25317649231603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004591544469197591, "ViewRequirementAgentConnector_ms": 0.30440489451090497}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3070, "num_agent_steps_trained": 0, "num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.101327267313028, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 3072, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3070, "timers": {"training_iteration_time_ms": 246354.174, "sample_time_ms": 8830.399, "synch_weights_time_ms": 84.221}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3070, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 3, "trial_id": "default", "date": "2025-12-19_22-38-20", "timestamp": 1766155100, "time_this_iter_s": 249.67806577682495, "time_total_s": 739.0729451179504, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 739.0729451179504, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 95.69971830985914, "ram_util_percent": 32.96253521126761}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.04640924413688481}, "default_policy": {"total_loss": 0.04640924413688481, "policy_loss": -0.04726213905960321, "vf_loss": 0.37894981005229056, "vf_loss_unclipped": 0.5473717174027115, "vf_explained_var": 0.3692487321794033, "entropy": 2.065065998584032, "mean_kl_loss": 0.009989885666377063, "gradients_default_optimizer_global_norm": 0.6352117290720344, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4094, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 23.206000000000017, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 10.829588235294123, "episode_len_mean": 227.88235294117646, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5472321333324919, "mean_inference_ms": 1.6131243250351606, "mean_action_processing_ms": 0.1076489967986261, "mean_env_wait_ms": 6.257715159051526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004517330842859605, "ViewRequirementAgentConnector_ms": 0.3011282752541935}}, "episode_reward_max": 23.206000000000017, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 10.829588235294123, "episode_len_mean": 227.88235294117646, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5472321333324919, "mean_inference_ms": 1.6131243250351606, "mean_action_processing_ms": 0.1076489967986261, "mean_env_wait_ms": 6.257715159051526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004517330842859605, "ViewRequirementAgentConnector_ms": 0.3011282752541935}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4094, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.357041203691881, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4096, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4094, "timers": {"training_iteration_time_ms": 243521.077, "sample_time_ms": 8788.307, "synch_weights_time_ms": 81.159}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4094, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 17, "training_iteration": 4, "trial_id": "default", "date": "2025-12-19_22-42-15", "timestamp": 1766155335, "time_this_iter_s": 235.0241093635559, "time_total_s": 974.0970544815063, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 974.0970544815063, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 95.4125748502994, "ram_util_percent": 30.63802395209581}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.16217676616215612}, "default_policy": {"total_loss": 0.16217676616215612, "policy_loss": -0.03685358068905771, "vf_loss": 0.8007733619771897, "vf_loss_unclipped": 1.14825332229957, "vf_explained_var": 0.33206625543534757, "entropy": 2.037743291258812, "mean_kl_loss": 0.008747536099264153, "gradients_default_optimizer_global_norm": 0.9786465941928327, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5118, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 24.23, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 12.89022727272728, "episode_len_mean": 217.36363636363637, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016, 24.23, 19.60900000000001, 21.42500000000002, 17.64, 16.578000000000003], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230, 164, 226, 232, 155, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5479346275720212, "mean_inference_ms": 1.6139726003122357, "mean_action_processing_ms": 0.10743399999573976, "mean_env_wait_ms": 6.253355240421509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00450719486583363, "ViewRequirementAgentConnector_ms": 0.2985683354464444}}, "episode_reward_max": 24.23, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 12.89022727272728, "episode_len_mean": 217.36363636363637, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016, 24.23, 19.60900000000001, 21.42500000000002, 17.64, 16.578000000000003], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230, 164, 226, 232, 155, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5479346275720212, "mean_inference_ms": 1.6139726003122357, "mean_action_processing_ms": 0.10743399999573976, "mean_env_wait_ms": 6.253355240421509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00450719486583363, "ViewRequirementAgentConnector_ms": 0.2985683354464444}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5118, "num_agent_steps_trained": 0, "num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.174970977388066, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 5120, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 5118, "timers": {"training_iteration_time_ms": 243871.083, "sample_time_ms": 8779.882, "synch_weights_time_ms": 79.295}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5118, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 5, "trial_id": "default", "date": "2025-12-19_22-46-21", "timestamp": 1766155581, "time_this_iter_s": 245.2739975452423, "time_total_s": 1219.3710520267487, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1219.3710520267487, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 95.66005747126437, "ram_util_percent": 31.43706896551725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.3852012583171017}, "default_policy": {"total_loss": 0.3852012583171017, "policy_loss": -0.04465781634207815, "vf_loss": 1.7223796451464295, "vf_loss_unclipped": 2.4161402264609935, "vf_explained_var": 0.26108431853353975, "entropy": 1.946293231099844, "mean_kl_loss": 0.012104564064663492, "gradients_default_optimizer_global_norm": 1.3801963094621896, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6142, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 29.86799999999999, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 14.558645161290327, "episode_len_mean": 192.67741935483872, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016, 24.23, 19.60900000000001, 21.42500000000002, 17.64, 16.578000000000003, 29.86799999999999, 11.57, 20.556999999999995, 18.582, 12.103000000000002, 13.004999999999994, 15.242000000000003, 17.680999999999997, 29.12499999999998], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230, 164, 226, 232, 155, 131, 187, 78, 126, 97, 80, 226, 99, 151, 147]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5512255235132337, "mean_inference_ms": 1.6181181076545936, "mean_action_processing_ms": 0.10732129547388368, "mean_env_wait_ms": 6.250204585439993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00446458016672442, "ViewRequirementAgentConnector_ms": 0.29602127690469066}}, "episode_reward_max": 29.86799999999999, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 14.558645161290327, "episode_len_mean": 192.67741935483872, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016, 24.23, 19.60900000000001, 21.42500000000002, 17.64, 16.578000000000003, 29.86799999999999, 11.57, 20.556999999999995, 18.582, 12.103000000000002, 13.004999999999994, 15.242000000000003, 17.680999999999997, 29.12499999999998], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230, 164, 226, 232, 155, 131, 187, 78, 126, 97, 80, 226, 99, 151, 147]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5512255235132337, "mean_inference_ms": 1.6181181076545936, "mean_action_processing_ms": 0.10732129547388368, "mean_env_wait_ms": 6.250204585439993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00446458016672442, "ViewRequirementAgentConnector_ms": 0.29602127690469066}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6142, "num_agent_steps_trained": 0, "num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.180117701059153, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 6144, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 6142, "timers": {"training_iteration_time_ms": 244054.086, "sample_time_ms": 8762.966, "synch_weights_time_ms": 76.597}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6142, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 31, "training_iteration": 6, "trial_id": "default", "date": "2025-12-19_22-50-26", "timestamp": 1766155826, "time_this_iter_s": 244.97189116477966, "time_total_s": 1464.3429431915283, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1464.3429431915283, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 95.36206896551724, "ram_util_percent": 32.08505747126436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.48450948756508294}, "default_policy": {"total_loss": 0.48450948756508294, "policy_loss": -0.04186853885184973, "vf_loss": 2.1088179260492326, "vf_loss_unclipped": 2.935059992223978, "vf_explained_var": 0.23647908717393876, "entropy": 1.881839172542095, "mean_kl_loss": 0.010553808061288094, "gradients_default_optimizer_global_norm": 1.6124523997306823, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7166, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 29.86799999999999, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 15.569390243902442, "episode_len_mean": 173.73170731707316, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016, 24.23, 19.60900000000001, 21.42500000000002, 17.64, 16.578000000000003, 29.86799999999999, 11.57, 20.556999999999995, 18.582, 12.103000000000002, 13.004999999999994, 15.242000000000003, 17.680999999999997, 29.12499999999998, 22.488, 20.186000000000003, 15.921000000000001, 13.260999999999997, 14.105, 29.229000000000006, 19.435000000000002, 16.037, 19.5, 16.865], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230, 164, 226, 232, 155, 131, 187, 78, 126, 97, 80, 226, 99, 151, 147, 170, 135, 91, 79, 97, 176, 102, 99, 100, 101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539032277551401, "mean_inference_ms": 1.6203765007586997, "mean_action_processing_ms": 0.10712520086937434, "mean_env_wait_ms": 6.241375883650447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004475291182355183, "ViewRequirementAgentConnector_ms": 0.2962769531622166}}, "episode_reward_max": 29.86799999999999, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 15.569390243902442, "episode_len_mean": 173.73170731707316, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016, 24.23, 19.60900000000001, 21.42500000000002, 17.64, 16.578000000000003, 29.86799999999999, 11.57, 20.556999999999995, 18.582, 12.103000000000002, 13.004999999999994, 15.242000000000003, 17.680999999999997, 29.12499999999998, 22.488, 20.186000000000003, 15.921000000000001, 13.260999999999997, 14.105, 29.229000000000006, 19.435000000000002, 16.037, 19.5, 16.865], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230, 164, 226, 232, 155, 131, 187, 78, 126, 97, 80, 226, 99, 151, 147, 170, 135, 91, 79, 97, 176, 102, 99, 100, 101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539032277551401, "mean_inference_ms": 1.6203765007586997, "mean_action_processing_ms": 0.10712520086937434, "mean_env_wait_ms": 6.241375883650447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004475291182355183, "ViewRequirementAgentConnector_ms": 0.2962769531622166}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7166, "num_agent_steps_trained": 0, "num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.1922107849403565, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 7168, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 7166, "timers": {"training_iteration_time_ms": 244083.853, "sample_time_ms": 8749.268, "synch_weights_time_ms": 81.102}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7166, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 41, "training_iteration": 7, "trial_id": "default", "date": "2025-12-19_22-54-41", "timestamp": 1766156081, "time_this_iter_s": 244.2677867412567, "time_total_s": 1708.610729932785, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1708.610729932785, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 94.55082872928175, "ram_util_percent": 31.858839779005525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.4211690935539082}, "default_policy": {"total_loss": 0.4211690935539082, "policy_loss": -0.04668581015430391, "vf_loss": 1.873377151414752, "vf_loss_unclipped": 2.981665627285838, "vf_explained_var": 0.32118817381560805, "entropy": 1.8509755961596965, "mean_kl_loss": 0.013615938691657448, "gradients_default_optimizer_global_norm": 1.7748751778155565, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8190, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 29.86799999999999, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 16.210260000000005, "episode_len_mean": 161.74, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016, 24.23, 19.60900000000001, 21.42500000000002, 17.64, 16.578000000000003, 29.86799999999999, 11.57, 20.556999999999995, 18.582, 12.103000000000002, 13.004999999999994, 15.242000000000003, 17.680999999999997, 29.12499999999998, 22.488, 20.186000000000003, 15.921000000000001, 13.260999999999997, 14.105, 29.229000000000006, 19.435000000000002, 16.037, 19.5, 16.865, 25.236999999999995, 18.564, 18.438000000000002, 18.563, 15.417000000000002, 14.799000000000001, 19.78, 22.145, 19.225], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230, 164, 226, 232, 155, 131, 187, 78, 126, 97, 80, 226, 99, 151, 147, 170, 135, 91, 79, 97, 176, 102, 99, 100, 101, 178, 96, 114, 91, 74, 69, 126, 118, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5557741972304922, "mean_inference_ms": 1.621373838820319, "mean_action_processing_ms": 0.10697422345215596, "mean_env_wait_ms": 6.233922497623834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004594326019287109, "ViewRequirementAgentConnector_ms": 0.2991042137145996}}, "episode_reward_max": 29.86799999999999, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 16.210260000000005, "episode_len_mean": 161.74, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016, 24.23, 19.60900000000001, 21.42500000000002, 17.64, 16.578000000000003, 29.86799999999999, 11.57, 20.556999999999995, 18.582, 12.103000000000002, 13.004999999999994, 15.242000000000003, 17.680999999999997, 29.12499999999998, 22.488, 20.186000000000003, 15.921000000000001, 13.260999999999997, 14.105, 29.229000000000006, 19.435000000000002, 16.037, 19.5, 16.865, 25.236999999999995, 18.564, 18.438000000000002, 18.563, 15.417000000000002, 14.799000000000001, 19.78, 22.145, 19.225], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230, 164, 226, 232, 155, 131, 187, 78, 126, 97, 80, 226, 99, 151, 147, 170, 135, 91, 79, 97, 176, 102, 99, 100, 101, 178, 96, 114, 91, 74, 69, 126, 118, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5557741972304922, "mean_inference_ms": 1.621373838820319, "mean_action_processing_ms": 0.10697422345215596, "mean_env_wait_ms": 6.233922497623834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004594326019287109, "ViewRequirementAgentConnector_ms": 0.2991042137145996}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8190, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 4.822806441318363, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8192, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 8190, "timers": {"training_iteration_time_ms": 240113.928, "sample_time_ms": 8747.117, "synch_weights_time_ms": 77.883}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8190, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 50, "training_iteration": 8, "trial_id": "default", "date": "2025-12-19_22-58-13", "timestamp": 1766156293, "time_this_iter_s": 212.3268141746521, "time_total_s": 1920.9375441074371, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1920.9375441074371, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 95.96976744186047, "ram_util_percent": 27.762126245847174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.4778502375993412}, "default_policy": {"total_loss": 0.4778502375993412, "policy_loss": -0.04980520418321248, "vf_loss": 2.111555452644825, "vf_loss_unclipped": 4.964333046972752, "vf_explained_var": 0.1982728499919176, "entropy": 1.7383859187364579, "mean_kl_loss": 0.015049643445527039, "gradients_default_optimizer_global_norm": 1.4237765818834305, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9214, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 29.86799999999999, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 16.38945161290323, "episode_len_mean": 147.88709677419354, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016, 24.23, 19.60900000000001, 21.42500000000002, 17.64, 16.578000000000003, 29.86799999999999, 11.57, 20.556999999999995, 18.582, 12.103000000000002, 13.004999999999994, 15.242000000000003, 17.680999999999997, 29.12499999999998, 22.488, 20.186000000000003, 15.921000000000001, 13.260999999999997, 14.105, 29.229000000000006, 19.435000000000002, 16.037, 19.5, 16.865, 25.236999999999995, 18.564, 18.438000000000002, 18.563, 15.417000000000002, 14.799000000000001, 19.78, 22.145, 19.225, 17.023000000000003, 12.944, 22.369, 15.442000000000004, 19.464000000000006, 15.606000000000003, 14.21, 13.257, 15.445, 26.339999999999996, 15.455000000000002, 18.078000000000003], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230, 164, 226, 232, 155, 131, 187, 78, 126, 97, 80, 226, 99, 151, 147, 170, 135, 91, 79, 97, 176, 102, 99, 100, 101, 178, 96, 114, 91, 74, 69, 126, 118, 98, 101, 73, 104, 76, 93, 97, 89, 58, 71, 126, 82, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577664337765759, "mean_inference_ms": 1.6199914373388546, "mean_action_processing_ms": 0.10670719468024957, "mean_env_wait_ms": 6.219066333696414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004503034776256931, "ViewRequirementAgentConnector_ms": 0.29581285292102444}}, "episode_reward_max": 29.86799999999999, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 16.38945161290323, "episode_len_mean": 147.88709677419354, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016, 24.23, 19.60900000000001, 21.42500000000002, 17.64, 16.578000000000003, 29.86799999999999, 11.57, 20.556999999999995, 18.582, 12.103000000000002, 13.004999999999994, 15.242000000000003, 17.680999999999997, 29.12499999999998, 22.488, 20.186000000000003, 15.921000000000001, 13.260999999999997, 14.105, 29.229000000000006, 19.435000000000002, 16.037, 19.5, 16.865, 25.236999999999995, 18.564, 18.438000000000002, 18.563, 15.417000000000002, 14.799000000000001, 19.78, 22.145, 19.225, 17.023000000000003, 12.944, 22.369, 15.442000000000004, 19.464000000000006, 15.606000000000003, 14.21, 13.257, 15.445, 26.339999999999996, 15.455000000000002, 18.078000000000003], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230, 164, 226, 232, 155, 131, 187, 78, 126, 97, 80, 226, 99, 151, 147, 170, 135, 91, 79, 97, 176, 102, 99, 100, 101, 178, 96, 114, 91, 74, 69, 126, 118, 98, 101, 73, 104, 76, 93, 97, 89, 58, 71, 126, 82, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577664337765759, "mean_inference_ms": 1.6199914373388546, "mean_action_processing_ms": 0.10670719468024957, "mean_env_wait_ms": 6.219066333696414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004503034776256931, "ViewRequirementAgentConnector_ms": 0.29581285292102444}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9214, "num_agent_steps_trained": 0, "num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.602104016954652, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 9216, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 9214, "timers": {"training_iteration_time_ms": 230668.161, "sample_time_ms": 8679.631, "synch_weights_time_ms": 73.633}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9214, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 62, "training_iteration": 9, "trial_id": "default", "date": "2025-12-19_23-00-48", "timestamp": 1766156448, "time_this_iter_s": 155.10444617271423, "time_total_s": 2076.0419902801514, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2076.0419902801514, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 96.71221719457012, "ram_util_percent": 15.135294117647062}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5407113657754963}, "default_policy": {"total_loss": 0.5407113657754963, "policy_loss": -0.03930055038072169, "vf_loss": 2.3211986722424625, "vf_loss_unclipped": 6.307300485856831, "vf_explained_var": 0.06084325909614563, "entropy": 1.681460338830948, "mean_kl_loss": 0.013937165712538047, "gradients_default_optimizer_global_norm": 1.9622210707515477, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10238, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 29.86799999999999, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 16.317565789473687, "episode_len_mean": 134.1578947368421, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016, 24.23, 19.60900000000001, 21.42500000000002, 17.64, 16.578000000000003, 29.86799999999999, 11.57, 20.556999999999995, 18.582, 12.103000000000002, 13.004999999999994, 15.242000000000003, 17.680999999999997, 29.12499999999998, 22.488, 20.186000000000003, 15.921000000000001, 13.260999999999997, 14.105, 29.229000000000006, 19.435000000000002, 16.037, 19.5, 16.865, 25.236999999999995, 18.564, 18.438000000000002, 18.563, 15.417000000000002, 14.799000000000001, 19.78, 22.145, 19.225, 17.023000000000003, 12.944, 22.369, 15.442000000000004, 19.464000000000006, 15.606000000000003, 14.21, 13.257, 15.445, 26.339999999999996, 15.455000000000002, 18.078000000000003, 14.930000000000001, 12.105, 16.103, 17.798000000000002, 14.165, 14.759, 14.843000000000002, 12.700000000000001, 16.308999999999997, 18.427, 13.953, 19.528, 17.617000000000004, 20.752], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230, 164, 226, 232, 155, 131, 187, 78, 126, 97, 80, 226, 99, 151, 147, 170, 135, 91, 79, 97, 176, 102, 99, 100, 101, 178, 96, 114, 91, 74, 69, 126, 118, 98, 101, 73, 104, 76, 93, 97, 89, 58, 71, 126, 82, 112, 65, 44, 74, 84, 58, 62, 63, 61, 94, 84, 60, 108, 75, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.558345271507061, "mean_inference_ms": 1.6118176689514772, "mean_action_processing_ms": 0.10611159930170745, "mean_env_wait_ms": 6.186330766630149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004279613494873047, "ViewRequirementAgentConnector_ms": 0.2848327159881592}}, "episode_reward_max": 29.86799999999999, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 16.317565789473687, "episode_len_mean": 134.1578947368421, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016, 24.23, 19.60900000000001, 21.42500000000002, 17.64, 16.578000000000003, 29.86799999999999, 11.57, 20.556999999999995, 18.582, 12.103000000000002, 13.004999999999994, 15.242000000000003, 17.680999999999997, 29.12499999999998, 22.488, 20.186000000000003, 15.921000000000001, 13.260999999999997, 14.105, 29.229000000000006, 19.435000000000002, 16.037, 19.5, 16.865, 25.236999999999995, 18.564, 18.438000000000002, 18.563, 15.417000000000002, 14.799000000000001, 19.78, 22.145, 19.225, 17.023000000000003, 12.944, 22.369, 15.442000000000004, 19.464000000000006, 15.606000000000003, 14.21, 13.257, 15.445, 26.339999999999996, 15.455000000000002, 18.078000000000003, 14.930000000000001, 12.105, 16.103, 17.798000000000002, 14.165, 14.759, 14.843000000000002, 12.700000000000001, 16.308999999999997, 18.427, 13.953, 19.528, 17.617000000000004, 20.752], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230, 164, 226, 232, 155, 131, 187, 78, 126, 97, 80, 226, 99, 151, 147, 170, 135, 91, 79, 97, 176, 102, 99, 100, 101, 178, 96, 114, 91, 74, 69, 126, 118, 98, 101, 73, 104, 76, 93, 97, 89, 58, 71, 126, 82, 112, 65, 44, 74, 84, 58, 62, 63, 61, 94, 84, 60, 108, 75, 95]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.558345271507061, "mean_inference_ms": 1.6118176689514772, "mean_action_processing_ms": 0.10611159930170745, "mean_env_wait_ms": 6.186330766630149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.004279613494873047, "ViewRequirementAgentConnector_ms": 0.2848327159881592}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10238, "num_agent_steps_trained": 0, "num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.703501424810032, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 10240, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 10238, "timers": {"training_iteration_time_ms": 222876.94, "sample_time_ms": 8498.727, "synch_weights_time_ms": 70.167}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10238, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 76, "training_iteration": 10, "trial_id": "default", "date": "2025-12-19_23-03-21", "timestamp": 1766156601, "time_this_iter_s": 152.75871396064758, "time_total_s": 2228.800704240799, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2228.800704240799, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 95.0175115207373, "ram_util_percent": 14.691244239631336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5304104752838612}, "default_policy": {"total_loss": 0.5304104752838612, "policy_loss": -0.037967737420694904, "vf_loss": 2.2744369568303227, "vf_loss_unclipped": 6.824442608840764, "vf_explained_var": 0.06704305410385132, "entropy": 1.605898067355156, "mean_kl_loss": 0.013748736024189157, "gradients_default_optimizer_global_norm": 1.3314128886908292, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11262, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 29.86799999999999, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 16.08503296703297, "episode_len_mean": 122.85714285714286, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016, 24.23, 19.60900000000001, 21.42500000000002, 17.64, 16.578000000000003, 29.86799999999999, 11.57, 20.556999999999995, 18.582, 12.103000000000002, 13.004999999999994, 15.242000000000003, 17.680999999999997, 29.12499999999998, 22.488, 20.186000000000003, 15.921000000000001, 13.260999999999997, 14.105, 29.229000000000006, 19.435000000000002, 16.037, 19.5, 16.865, 25.236999999999995, 18.564, 18.438000000000002, 18.563, 15.417000000000002, 14.799000000000001, 19.78, 22.145, 19.225, 17.023000000000003, 12.944, 22.369, 15.442000000000004, 19.464000000000006, 15.606000000000003, 14.21, 13.257, 15.445, 26.339999999999996, 15.455000000000002, 18.078000000000003, 14.930000000000001, 12.105, 16.103, 17.798000000000002, 14.165, 14.759, 14.843000000000002, 12.700000000000001, 16.308999999999997, 18.427, 13.953, 19.528, 17.617000000000004, 20.752, 14.751000000000001, 16.732000000000003, 17.329, 16.310000000000002, 14.072000000000001, 13.102, 14.856000000000002, 16.407000000000004, 15.128, 12.225, 19.559000000000005, 15.572, 14.323999999999998, 11.774, 11.462], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230, 164, 226, 232, 155, 131, 187, 78, 126, 97, 80, 226, 99, 151, 147, 170, 135, 91, 79, 97, 176, 102, 99, 100, 101, 178, 96, 114, 91, 74, 69, 126, 118, 98, 101, 73, 104, 76, 93, 97, 89, 58, 71, 126, 82, 112, 65, 44, 74, 84, 58, 62, 63, 61, 94, 84, 60, 108, 75, 95, 67, 72, 86, 74, 58, 50, 55, 68, 61, 48, 103, 73, 64, 39, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577738724800871, "mean_inference_ms": 1.599399683768686, "mean_action_processing_ms": 0.10532310098482793, "mean_env_wait_ms": 6.145011126796541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0041107555012126545, "ViewRequirementAgentConnector_ms": 0.2760203330071418}}, "episode_reward_max": 29.86799999999999, "episode_reward_min": 3.3000000000000007, "episode_reward_mean": 16.08503296703297, "episode_len_mean": 122.85714285714286, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.762000000000001, 9.113000000000003, 4.345, 5.8200000000000065, 3.3000000000000007, 12.470000000000004, 7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016, 24.23, 19.60900000000001, 21.42500000000002, 17.64, 16.578000000000003, 29.86799999999999, 11.57, 20.556999999999995, 18.582, 12.103000000000002, 13.004999999999994, 15.242000000000003, 17.680999999999997, 29.12499999999998, 22.488, 20.186000000000003, 15.921000000000001, 13.260999999999997, 14.105, 29.229000000000006, 19.435000000000002, 16.037, 19.5, 16.865, 25.236999999999995, 18.564, 18.438000000000002, 18.563, 15.417000000000002, 14.799000000000001, 19.78, 22.145, 19.225, 17.023000000000003, 12.944, 22.369, 15.442000000000004, 19.464000000000006, 15.606000000000003, 14.21, 13.257, 15.445, 26.339999999999996, 15.455000000000002, 18.078000000000003, 14.930000000000001, 12.105, 16.103, 17.798000000000002, 14.165, 14.759, 14.843000000000002, 12.700000000000001, 16.308999999999997, 18.427, 13.953, 19.528, 17.617000000000004, 20.752, 14.751000000000001, 16.732000000000003, 17.329, 16.310000000000002, 14.072000000000001, 13.102, 14.856000000000002, 16.407000000000004, 15.128, 12.225, 19.559000000000005, 15.572, 14.323999999999998, 11.774, 11.462], "episode_lengths": [235, 236, 233, 224, 224, 224, 237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230, 164, 226, 232, 155, 131, 187, 78, 126, 97, 80, 226, 99, 151, 147, 170, 135, 91, 79, 97, 176, 102, 99, 100, 101, 178, 96, 114, 91, 74, 69, 126, 118, 98, 101, 73, 104, 76, 93, 97, 89, 58, 71, 126, 82, 112, 65, 44, 74, 84, 58, 62, 63, 61, 94, 84, 60, 108, 75, 95, 67, 72, 86, 74, 58, 50, 55, 68, 61, 48, 103, 73, 64, 39, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5577738724800871, "mean_inference_ms": 1.599399683768686, "mean_action_processing_ms": 0.10532310098482793, "mean_env_wait_ms": 6.145011126796541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0041107555012126545, "ViewRequirementAgentConnector_ms": 0.2760203330071418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11262, "num_agent_steps_trained": 0, "num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.778151397658359, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 11264, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 11262, "timers": {"training_iteration_time_ms": 213018.768, "sample_time_ms": 8308.98, "synch_weights_time_ms": 67.881}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11262, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 91, "training_iteration": 11, "trial_id": "default", "date": "2025-12-19_23-05-52", "timestamp": 1766156752, "time_this_iter_s": 151.08014512062073, "time_total_s": 2379.8808493614197, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2379.8808493614197, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 94.89813953488371, "ram_util_percent": 14.411627906976744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.49722670391201973}, "default_policy": {"total_loss": 0.49722670391201973, "policy_loss": -0.03779651519726031, "vf_loss": 2.140852175839245, "vf_loss_unclipped": 7.010460249520838, "vf_explained_var": 0.02039329186081886, "entropy": 1.5206028625369072, "mean_kl_loss": 0.013307769065443153, "gradients_default_optimizer_global_norm": 1.2696934837847949, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12286, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 29.86799999999999, "episode_reward_min": 6.334000000000001, "episode_reward_mean": 16.63153, "episode_len_mean": 108.58, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016, 24.23, 19.60900000000001, 21.42500000000002, 17.64, 16.578000000000003, 29.86799999999999, 11.57, 20.556999999999995, 18.582, 12.103000000000002, 13.004999999999994, 15.242000000000003, 17.680999999999997, 29.12499999999998, 22.488, 20.186000000000003, 15.921000000000001, 13.260999999999997, 14.105, 29.229000000000006, 19.435000000000002, 16.037, 19.5, 16.865, 25.236999999999995, 18.564, 18.438000000000002, 18.563, 15.417000000000002, 14.799000000000001, 19.78, 22.145, 19.225, 17.023000000000003, 12.944, 22.369, 15.442000000000004, 19.464000000000006, 15.606000000000003, 14.21, 13.257, 15.445, 26.339999999999996, 15.455000000000002, 18.078000000000003, 14.930000000000001, 12.105, 16.103, 17.798000000000002, 14.165, 14.759, 14.843000000000002, 12.700000000000001, 16.308999999999997, 18.427, 13.953, 19.528, 17.617000000000004, 20.752, 14.751000000000001, 16.732000000000003, 17.329, 16.310000000000002, 14.072000000000001, 13.102, 14.856000000000002, 16.407000000000004, 15.128, 12.225, 19.559000000000005, 15.572, 14.323999999999998, 11.774, 11.462, 15.557000000000002, 17.976, 14.638000000000002, 14.688, 17.87, 15.752000000000002, 15.701999999999998, 21.006000000000004, 10.857999999999999, 15.345, 16.256, 16.777, 17.676000000000002, 11.315999999999999, 19.808], "episode_lengths": [237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230, 164, 226, 232, 155, 131, 187, 78, 126, 97, 80, 226, 99, 151, 147, 170, 135, 91, 79, 97, 176, 102, 99, 100, 101, 178, 96, 114, 91, 74, 69, 126, 118, 98, 101, 73, 104, 76, 93, 97, 89, 58, 71, 126, 82, 112, 65, 44, 74, 84, 58, 62, 63, 61, 94, 84, 60, 108, 75, 95, 67, 72, 86, 74, 58, 50, 55, 68, 61, 48, 103, 73, 64, 39, 66, 63, 78, 55, 69, 74, 81, 73, 95, 45, 63, 61, 80, 82, 46, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5572831966119199, "mean_inference_ms": 1.585129184907549, "mean_action_processing_ms": 0.10427241986782125, "mean_env_wait_ms": 6.093802941226846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003952980041503906, "ViewRequirementAgentConnector_ms": 0.2681279182434082}}, "episode_reward_max": 29.86799999999999, "episode_reward_min": 6.334000000000001, "episode_reward_mean": 16.63153, "episode_len_mean": 108.58, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.352000000000004, 6.334000000000001, 9.306000000000003, 13.106999999999998, 17.47900000000001, 17.49900000000001, 14.243000000000006, 16.637, 23.206000000000017, 7.034000000000003, 10.096000000000016, 24.23, 19.60900000000001, 21.42500000000002, 17.64, 16.578000000000003, 29.86799999999999, 11.57, 20.556999999999995, 18.582, 12.103000000000002, 13.004999999999994, 15.242000000000003, 17.680999999999997, 29.12499999999998, 22.488, 20.186000000000003, 15.921000000000001, 13.260999999999997, 14.105, 29.229000000000006, 19.435000000000002, 16.037, 19.5, 16.865, 25.236999999999995, 18.564, 18.438000000000002, 18.563, 15.417000000000002, 14.799000000000001, 19.78, 22.145, 19.225, 17.023000000000003, 12.944, 22.369, 15.442000000000004, 19.464000000000006, 15.606000000000003, 14.21, 13.257, 15.445, 26.339999999999996, 15.455000000000002, 18.078000000000003, 14.930000000000001, 12.105, 16.103, 17.798000000000002, 14.165, 14.759, 14.843000000000002, 12.700000000000001, 16.308999999999997, 18.427, 13.953, 19.528, 17.617000000000004, 20.752, 14.751000000000001, 16.732000000000003, 17.329, 16.310000000000002, 14.072000000000001, 13.102, 14.856000000000002, 16.407000000000004, 15.128, 12.225, 19.559000000000005, 15.572, 14.323999999999998, 11.774, 11.462, 15.557000000000002, 17.976, 14.638000000000002, 14.688, 17.87, 15.752000000000002, 15.701999999999998, 21.006000000000004, 10.857999999999999, 15.345, 16.256, 16.777, 17.676000000000002, 11.315999999999999, 19.808], "episode_lengths": [237, 225, 232, 238, 232, 237, 227, 235, 169, 236, 230, 164, 226, 232, 155, 131, 187, 78, 126, 97, 80, 226, 99, 151, 147, 170, 135, 91, 79, 97, 176, 102, 99, 100, 101, 178, 96, 114, 91, 74, 69, 126, 118, 98, 101, 73, 104, 76, 93, 97, 89, 58, 71, 126, 82, 112, 65, 44, 74, 84, 58, 62, 63, 61, 94, 84, 60, 108, 75, 95, 67, 72, 86, 74, 58, 50, 55, 68, 61, 48, 103, 73, 64, 39, 66, 63, 78, 55, 69, 74, 81, 73, 95, 45, 63, 61, 80, 82, 46, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5572831966119199, "mean_inference_ms": 1.585129184907549, "mean_action_processing_ms": 0.10427241986782125, "mean_env_wait_ms": 6.093802941226846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003952980041503906, "ViewRequirementAgentConnector_ms": 0.2681279182434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12286, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.739933999050759, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12288, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 12286, "timers": {"training_iteration_time_ms": 204238.586, "sample_time_ms": 8129.605, "synch_weights_time_ms": 63.309}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12286, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 106, "training_iteration": 12, "trial_id": "default", "date": "2025-12-19_23-08-33", "timestamp": 1766156913, "time_this_iter_s": 151.93365216255188, "time_total_s": 2531.8145015239716, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2531.8145015239716, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 90.28333333333333, "ram_util_percent": 14.585087719298247}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5128375366795808}, "default_policy": {"total_loss": 0.5128375366795808, "policy_loss": -0.036193088337313384, "vf_loss": 2.1969826789572835, "vf_loss_unclipped": 7.0119354838505386, "vf_explained_var": 0.11218688488006592, "entropy": 1.5631525687873364, "mean_kl_loss": 0.013481046944636432, "gradients_default_optimizer_global_norm": 1.30987664796412, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13310, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 29.86799999999999, "episode_reward_min": 10.857999999999999, "episode_reward_mean": 16.652320000000003, "episode_len_mean": 85.58, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.578000000000003, 29.86799999999999, 11.57, 20.556999999999995, 18.582, 12.103000000000002, 13.004999999999994, 15.242000000000003, 17.680999999999997, 29.12499999999998, 22.488, 20.186000000000003, 15.921000000000001, 13.260999999999997, 14.105, 29.229000000000006, 19.435000000000002, 16.037, 19.5, 16.865, 25.236999999999995, 18.564, 18.438000000000002, 18.563, 15.417000000000002, 14.799000000000001, 19.78, 22.145, 19.225, 17.023000000000003, 12.944, 22.369, 15.442000000000004, 19.464000000000006, 15.606000000000003, 14.21, 13.257, 15.445, 26.339999999999996, 15.455000000000002, 18.078000000000003, 14.930000000000001, 12.105, 16.103, 17.798000000000002, 14.165, 14.759, 14.843000000000002, 12.700000000000001, 16.308999999999997, 18.427, 13.953, 19.528, 17.617000000000004, 20.752, 14.751000000000001, 16.732000000000003, 17.329, 16.310000000000002, 14.072000000000001, 13.102, 14.856000000000002, 16.407000000000004, 15.128, 12.225, 19.559000000000005, 15.572, 14.323999999999998, 11.774, 11.462, 15.557000000000002, 17.976, 14.638000000000002, 14.688, 17.87, 15.752000000000002, 15.701999999999998, 21.006000000000004, 10.857999999999999, 15.345, 16.256, 16.777, 17.676000000000002, 11.315999999999999, 19.808, 15.774000000000004, 16.368000000000002, 14.298, 17.113, 13.548000000000002, 12.864999999999998, 14.373000000000001, 13.744, 11.909, 17.083999999999996, 23.209000000000007, 14.727, 15.842000000000002, 15.084999999999999, 11.337], "episode_lengths": [131, 187, 78, 126, 97, 80, 226, 99, 151, 147, 170, 135, 91, 79, 97, 176, 102, 99, 100, 101, 178, 96, 114, 91, 74, 69, 126, 118, 98, 101, 73, 104, 76, 93, 97, 89, 58, 71, 126, 82, 112, 65, 44, 74, 84, 58, 62, 63, 61, 94, 84, 60, 108, 75, 95, 67, 72, 86, 74, 58, 50, 55, 68, 61, 48, 103, 73, 64, 39, 66, 63, 78, 55, 69, 74, 81, 73, 95, 45, 63, 61, 80, 82, 46, 89, 79, 85, 48, 75, 59, 44, 54, 50, 47, 81, 108, 59, 75, 69, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564900759622203, "mean_inference_ms": 1.5631752407802402, "mean_action_processing_ms": 0.10285661223542986, "mean_env_wait_ms": 6.0212648605535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0037643909454345703, "ViewRequirementAgentConnector_ms": 0.2579996585845947}}, "episode_reward_max": 29.86799999999999, "episode_reward_min": 10.857999999999999, "episode_reward_mean": 16.652320000000003, "episode_len_mean": 85.58, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.578000000000003, 29.86799999999999, 11.57, 20.556999999999995, 18.582, 12.103000000000002, 13.004999999999994, 15.242000000000003, 17.680999999999997, 29.12499999999998, 22.488, 20.186000000000003, 15.921000000000001, 13.260999999999997, 14.105, 29.229000000000006, 19.435000000000002, 16.037, 19.5, 16.865, 25.236999999999995, 18.564, 18.438000000000002, 18.563, 15.417000000000002, 14.799000000000001, 19.78, 22.145, 19.225, 17.023000000000003, 12.944, 22.369, 15.442000000000004, 19.464000000000006, 15.606000000000003, 14.21, 13.257, 15.445, 26.339999999999996, 15.455000000000002, 18.078000000000003, 14.930000000000001, 12.105, 16.103, 17.798000000000002, 14.165, 14.759, 14.843000000000002, 12.700000000000001, 16.308999999999997, 18.427, 13.953, 19.528, 17.617000000000004, 20.752, 14.751000000000001, 16.732000000000003, 17.329, 16.310000000000002, 14.072000000000001, 13.102, 14.856000000000002, 16.407000000000004, 15.128, 12.225, 19.559000000000005, 15.572, 14.323999999999998, 11.774, 11.462, 15.557000000000002, 17.976, 14.638000000000002, 14.688, 17.87, 15.752000000000002, 15.701999999999998, 21.006000000000004, 10.857999999999999, 15.345, 16.256, 16.777, 17.676000000000002, 11.315999999999999, 19.808, 15.774000000000004, 16.368000000000002, 14.298, 17.113, 13.548000000000002, 12.864999999999998, 14.373000000000001, 13.744, 11.909, 17.083999999999996, 23.209000000000007, 14.727, 15.842000000000002, 15.084999999999999, 11.337], "episode_lengths": [131, 187, 78, 126, 97, 80, 226, 99, 151, 147, 170, 135, 91, 79, 97, 176, 102, 99, 100, 101, 178, 96, 114, 91, 74, 69, 126, 118, 98, 101, 73, 104, 76, 93, 97, 89, 58, 71, 126, 82, 112, 65, 44, 74, 84, 58, 62, 63, 61, 94, 84, 60, 108, 75, 95, 67, 72, 86, 74, 58, 50, 55, 68, 61, 48, 103, 73, 64, 39, 66, 63, 78, 55, 69, 74, 81, 73, 95, 45, 63, 61, 80, 82, 46, 89, 79, 85, 48, 75, 59, 44, 54, 50, 47, 81, 108, 59, 75, 69, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564900759622203, "mean_inference_ms": 1.5631752407802402, "mean_action_processing_ms": 0.10285661223542986, "mean_env_wait_ms": 6.0212648605535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0037643909454345703, "ViewRequirementAgentConnector_ms": 0.2579996585845947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13310, "num_agent_steps_trained": 0, "num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.7575229696366135, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 13312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 13310, "timers": {"training_iteration_time_ms": 194424.541, "sample_time_ms": 7901.596, "synch_weights_time_ms": 61.67}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13310, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 121, "training_iteration": 13, "trial_id": "default", "date": "2025-12-19_23-11-04", "timestamp": 1766157064, "time_this_iter_s": 151.54102063179016, "time_total_s": 2683.3555221557617, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2683.3555221557617, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 94.9986111111111, "ram_util_percent": 14.451388888888891}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5314544104039669}, "default_policy": {"total_loss": 0.5314544104039669, "policy_loss": -0.03334855320281349, "vf_loss": 2.2604122212156654, "vf_loss_unclipped": 6.6349013051018115, "vf_explained_var": 0.24331456422805786, "entropy": 1.5207073338329793, "mean_kl_loss": 0.012206128561038554, "gradients_default_optimizer_global_norm": 1.560150383040309, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14334, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 26.339999999999996, "episode_reward_min": 10.857999999999999, "episode_reward_mean": 16.12732, "episode_len_mean": 75.18, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.435000000000002, 16.037, 19.5, 16.865, 25.236999999999995, 18.564, 18.438000000000002, 18.563, 15.417000000000002, 14.799000000000001, 19.78, 22.145, 19.225, 17.023000000000003, 12.944, 22.369, 15.442000000000004, 19.464000000000006, 15.606000000000003, 14.21, 13.257, 15.445, 26.339999999999996, 15.455000000000002, 18.078000000000003, 14.930000000000001, 12.105, 16.103, 17.798000000000002, 14.165, 14.759, 14.843000000000002, 12.700000000000001, 16.308999999999997, 18.427, 13.953, 19.528, 17.617000000000004, 20.752, 14.751000000000001, 16.732000000000003, 17.329, 16.310000000000002, 14.072000000000001, 13.102, 14.856000000000002, 16.407000000000004, 15.128, 12.225, 19.559000000000005, 15.572, 14.323999999999998, 11.774, 11.462, 15.557000000000002, 17.976, 14.638000000000002, 14.688, 17.87, 15.752000000000002, 15.701999999999998, 21.006000000000004, 10.857999999999999, 15.345, 16.256, 16.777, 17.676000000000002, 11.315999999999999, 19.808, 15.774000000000004, 16.368000000000002, 14.298, 17.113, 13.548000000000002, 12.864999999999998, 14.373000000000001, 13.744, 11.909, 17.083999999999996, 23.209000000000007, 14.727, 15.842000000000002, 15.084999999999999, 11.337, 23.779, 15.321000000000002, 15.099999999999998, 17.803000000000004, 12.727, 13.251000000000001, 12.821000000000002, 14.014, 17.878, 12.838000000000001, 22.096, 14.261999999999999, 13.972000000000001, 11.934000000000001, 13.274000000000001, 15.931000000000001], "episode_lengths": [102, 99, 100, 101, 178, 96, 114, 91, 74, 69, 126, 118, 98, 101, 73, 104, 76, 93, 97, 89, 58, 71, 126, 82, 112, 65, 44, 74, 84, 58, 62, 63, 61, 94, 84, 60, 108, 75, 95, 67, 72, 86, 74, 58, 50, 55, 68, 61, 48, 103, 73, 64, 39, 66, 63, 78, 55, 69, 74, 81, 73, 95, 45, 63, 61, 80, 82, 46, 89, 79, 85, 48, 75, 59, 44, 54, 50, 47, 81, 108, 59, 75, 69, 42, 110, 67, 55, 84, 50, 50, 45, 52, 87, 45, 97, 55, 55, 58, 45, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530707743629519, "mean_inference_ms": 1.5337919103856092, "mean_action_processing_ms": 0.10113415159564593, "mean_env_wait_ms": 5.936368820346136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035576820373535156, "ViewRequirementAgentConnector_ms": 0.24795269966125488}}, "episode_reward_max": 26.339999999999996, "episode_reward_min": 10.857999999999999, "episode_reward_mean": 16.12732, "episode_len_mean": 75.18, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.435000000000002, 16.037, 19.5, 16.865, 25.236999999999995, 18.564, 18.438000000000002, 18.563, 15.417000000000002, 14.799000000000001, 19.78, 22.145, 19.225, 17.023000000000003, 12.944, 22.369, 15.442000000000004, 19.464000000000006, 15.606000000000003, 14.21, 13.257, 15.445, 26.339999999999996, 15.455000000000002, 18.078000000000003, 14.930000000000001, 12.105, 16.103, 17.798000000000002, 14.165, 14.759, 14.843000000000002, 12.700000000000001, 16.308999999999997, 18.427, 13.953, 19.528, 17.617000000000004, 20.752, 14.751000000000001, 16.732000000000003, 17.329, 16.310000000000002, 14.072000000000001, 13.102, 14.856000000000002, 16.407000000000004, 15.128, 12.225, 19.559000000000005, 15.572, 14.323999999999998, 11.774, 11.462, 15.557000000000002, 17.976, 14.638000000000002, 14.688, 17.87, 15.752000000000002, 15.701999999999998, 21.006000000000004, 10.857999999999999, 15.345, 16.256, 16.777, 17.676000000000002, 11.315999999999999, 19.808, 15.774000000000004, 16.368000000000002, 14.298, 17.113, 13.548000000000002, 12.864999999999998, 14.373000000000001, 13.744, 11.909, 17.083999999999996, 23.209000000000007, 14.727, 15.842000000000002, 15.084999999999999, 11.337, 23.779, 15.321000000000002, 15.099999999999998, 17.803000000000004, 12.727, 13.251000000000001, 12.821000000000002, 14.014, 17.878, 12.838000000000001, 22.096, 14.261999999999999, 13.972000000000001, 11.934000000000001, 13.274000000000001, 15.931000000000001], "episode_lengths": [102, 99, 100, 101, 178, 96, 114, 91, 74, 69, 126, 118, 98, 101, 73, 104, 76, 93, 97, 89, 58, 71, 126, 82, 112, 65, 44, 74, 84, 58, 62, 63, 61, 94, 84, 60, 108, 75, 95, 67, 72, 86, 74, 58, 50, 55, 68, 61, 48, 103, 73, 64, 39, 66, 63, 78, 55, 69, 74, 81, 73, 95, 45, 63, 61, 80, 82, 46, 89, 79, 85, 48, 75, 59, 44, 54, 50, 47, 81, 108, 59, 75, 69, 42, 110, 67, 55, 84, 50, 50, 45, 52, 87, 45, 97, 55, 55, 58, 45, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530707743629519, "mean_inference_ms": 1.5337919103856092, "mean_action_processing_ms": 0.10113415159564593, "mean_env_wait_ms": 5.936368820346136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035576820373535156, "ViewRequirementAgentConnector_ms": 0.24795269966125488}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14334, "num_agent_steps_trained": 0, "num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.760872445616687, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 14336, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 14334, "timers": {"training_iteration_time_ms": 186068.333, "sample_time_ms": 7718.815, "synch_weights_time_ms": 58.526}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14334, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 137, "training_iteration": 14, "trial_id": "default", "date": "2025-12-19_23-13-36", "timestamp": 1766157216, "time_this_iter_s": 151.465478181839, "time_total_s": 2834.8210003376007, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2834.8210003376007, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 94.97116279069769, "ram_util_percent": 14.577674418604655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.576780630120993}, "default_policy": {"total_loss": 0.576780630120993, "policy_loss": -0.028073194884927943, "vf_loss": 2.420354766398668, "vf_loss_unclipped": 7.854655449837447, "vf_explained_var": 0.0008899983018636704, "entropy": 1.4620458662509919, "mean_kl_loss": 0.012271800010014999, "gradients_default_optimizer_global_norm": 1.6090817144140601, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15358, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 26.339999999999996, "episode_reward_min": 10.857999999999999, "episode_reward_mean": 15.481990000000005, "episode_len_mean": 68.01, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.606000000000003, 14.21, 13.257, 15.445, 26.339999999999996, 15.455000000000002, 18.078000000000003, 14.930000000000001, 12.105, 16.103, 17.798000000000002, 14.165, 14.759, 14.843000000000002, 12.700000000000001, 16.308999999999997, 18.427, 13.953, 19.528, 17.617000000000004, 20.752, 14.751000000000001, 16.732000000000003, 17.329, 16.310000000000002, 14.072000000000001, 13.102, 14.856000000000002, 16.407000000000004, 15.128, 12.225, 19.559000000000005, 15.572, 14.323999999999998, 11.774, 11.462, 15.557000000000002, 17.976, 14.638000000000002, 14.688, 17.87, 15.752000000000002, 15.701999999999998, 21.006000000000004, 10.857999999999999, 15.345, 16.256, 16.777, 17.676000000000002, 11.315999999999999, 19.808, 15.774000000000004, 16.368000000000002, 14.298, 17.113, 13.548000000000002, 12.864999999999998, 14.373000000000001, 13.744, 11.909, 17.083999999999996, 23.209000000000007, 14.727, 15.842000000000002, 15.084999999999999, 11.337, 23.779, 15.321000000000002, 15.099999999999998, 17.803000000000004, 12.727, 13.251000000000001, 12.821000000000002, 14.014, 17.878, 12.838000000000001, 22.096, 14.261999999999999, 13.972000000000001, 11.934000000000001, 13.274000000000001, 15.931000000000001, 14.468, 11.264000000000001, 13.777000000000001, 13.612, 14.643999999999998, 14.447000000000001, 12.956000000000001, 12.783000000000001, 15.265, 16.77, 12.782, 17.969, 17.383000000000006, 15.680000000000003, 18.048000000000002, 15.536000000000003, 12.535, 16.795], "episode_lengths": [97, 89, 58, 71, 126, 82, 112, 65, 44, 74, 84, 58, 62, 63, 61, 94, 84, 60, 108, 75, 95, 67, 72, 86, 74, 58, 50, 55, 68, 61, 48, 103, 73, 64, 39, 66, 63, 78, 55, 69, 74, 81, 73, 95, 45, 63, 61, 80, 82, 46, 89, 79, 85, 48, 75, 59, 44, 54, 50, 47, 81, 108, 59, 75, 69, 42, 110, 67, 55, 84, 50, 50, 45, 52, 87, 45, 97, 55, 55, 58, 45, 75, 58, 39, 52, 49, 62, 63, 43, 48, 59, 81, 47, 81, 79, 61, 70, 69, 54, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5489964818744676, "mean_inference_ms": 1.5006184772446465, "mean_action_processing_ms": 0.09927243383480285, "mean_env_wait_ms": 5.841292313811664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003331422805786133, "ViewRequirementAgentConnector_ms": 0.23727846145629883}}, "episode_reward_max": 26.339999999999996, "episode_reward_min": 10.857999999999999, "episode_reward_mean": 15.481990000000005, "episode_len_mean": 68.01, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.606000000000003, 14.21, 13.257, 15.445, 26.339999999999996, 15.455000000000002, 18.078000000000003, 14.930000000000001, 12.105, 16.103, 17.798000000000002, 14.165, 14.759, 14.843000000000002, 12.700000000000001, 16.308999999999997, 18.427, 13.953, 19.528, 17.617000000000004, 20.752, 14.751000000000001, 16.732000000000003, 17.329, 16.310000000000002, 14.072000000000001, 13.102, 14.856000000000002, 16.407000000000004, 15.128, 12.225, 19.559000000000005, 15.572, 14.323999999999998, 11.774, 11.462, 15.557000000000002, 17.976, 14.638000000000002, 14.688, 17.87, 15.752000000000002, 15.701999999999998, 21.006000000000004, 10.857999999999999, 15.345, 16.256, 16.777, 17.676000000000002, 11.315999999999999, 19.808, 15.774000000000004, 16.368000000000002, 14.298, 17.113, 13.548000000000002, 12.864999999999998, 14.373000000000001, 13.744, 11.909, 17.083999999999996, 23.209000000000007, 14.727, 15.842000000000002, 15.084999999999999, 11.337, 23.779, 15.321000000000002, 15.099999999999998, 17.803000000000004, 12.727, 13.251000000000001, 12.821000000000002, 14.014, 17.878, 12.838000000000001, 22.096, 14.261999999999999, 13.972000000000001, 11.934000000000001, 13.274000000000001, 15.931000000000001, 14.468, 11.264000000000001, 13.777000000000001, 13.612, 14.643999999999998, 14.447000000000001, 12.956000000000001, 12.783000000000001, 15.265, 16.77, 12.782, 17.969, 17.383000000000006, 15.680000000000003, 18.048000000000002, 15.536000000000003, 12.535, 16.795], "episode_lengths": [97, 89, 58, 71, 126, 82, 112, 65, 44, 74, 84, 58, 62, 63, 61, 94, 84, 60, 108, 75, 95, 67, 72, 86, 74, 58, 50, 55, 68, 61, 48, 103, 73, 64, 39, 66, 63, 78, 55, 69, 74, 81, 73, 95, 45, 63, 61, 80, 82, 46, 89, 79, 85, 48, 75, 59, 44, 54, 50, 47, 81, 108, 59, 75, 69, 42, 110, 67, 55, 84, 50, 50, 45, 52, 87, 45, 97, 55, 55, 58, 45, 75, 58, 39, 52, 49, 62, 63, 43, 48, 59, 81, 47, 81, 79, 61, 70, 69, 54, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5489964818744676, "mean_inference_ms": 1.5006184772446465, "mean_action_processing_ms": 0.09927243383480285, "mean_env_wait_ms": 5.841292313811664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003331422805786133, "ViewRequirementAgentConnector_ms": 0.23727846145629883}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15358, "num_agent_steps_trained": 0, "num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.754601059325152, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 15360, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 15358, "timers": {"training_iteration_time_ms": 176701.254, "sample_time_ms": 7529.274, "synch_weights_time_ms": 57.453}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15358, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 155, "training_iteration": 15, "trial_id": "default", "date": "2025-12-19_23-16-07", "timestamp": 1766157367, "time_this_iter_s": 151.60418343544006, "time_total_s": 2986.4251837730408, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2986.4251837730408, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 94.91527777777776, "ram_util_percent": 14.513425925925928}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5955145652405918}, "default_policy": {"total_loss": 0.5955145652405918, "policy_loss": -0.0379198600538075, "vf_loss": 2.5340910498052835, "vf_loss_unclipped": 7.696262562647462, "vf_explained_var": 0.036188061162829396, "entropy": 1.4391480550169944, "mean_kl_loss": 0.013508061319933517, "gradients_default_optimizer_global_norm": 1.458851189352572, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16382, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 23.779, "episode_reward_min": 10.857999999999999, "episode_reward_mean": 15.340230000000002, "episode_len_mean": 65.46, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.427, 13.953, 19.528, 17.617000000000004, 20.752, 14.751000000000001, 16.732000000000003, 17.329, 16.310000000000002, 14.072000000000001, 13.102, 14.856000000000002, 16.407000000000004, 15.128, 12.225, 19.559000000000005, 15.572, 14.323999999999998, 11.774, 11.462, 15.557000000000002, 17.976, 14.638000000000002, 14.688, 17.87, 15.752000000000002, 15.701999999999998, 21.006000000000004, 10.857999999999999, 15.345, 16.256, 16.777, 17.676000000000002, 11.315999999999999, 19.808, 15.774000000000004, 16.368000000000002, 14.298, 17.113, 13.548000000000002, 12.864999999999998, 14.373000000000001, 13.744, 11.909, 17.083999999999996, 23.209000000000007, 14.727, 15.842000000000002, 15.084999999999999, 11.337, 23.779, 15.321000000000002, 15.099999999999998, 17.803000000000004, 12.727, 13.251000000000001, 12.821000000000002, 14.014, 17.878, 12.838000000000001, 22.096, 14.261999999999999, 13.972000000000001, 11.934000000000001, 13.274000000000001, 15.931000000000001, 14.468, 11.264000000000001, 13.777000000000001, 13.612, 14.643999999999998, 14.447000000000001, 12.956000000000001, 12.783000000000001, 15.265, 16.77, 12.782, 17.969, 17.383000000000006, 15.680000000000003, 18.048000000000002, 15.536000000000003, 12.535, 16.795, 13.644000000000002, 14.936000000000002, 13.217, 13.146999999999998, 15.056000000000001, 17.264, 14.288, 11.331, 13.751999999999999, 11.738, 16.37, 17.478, 17.519000000000005, 15.474000000000004, 17.325, 15.388000000000002], "episode_lengths": [84, 60, 108, 75, 95, 67, 72, 86, 74, 58, 50, 55, 68, 61, 48, 103, 73, 64, 39, 66, 63, 78, 55, 69, 74, 81, 73, 95, 45, 63, 61, 80, 82, 46, 89, 79, 85, 48, 75, 59, 44, 54, 50, 47, 81, 108, 59, 75, 69, 42, 110, 67, 55, 84, 50, 50, 45, 52, 87, 45, 97, 55, 55, 58, 45, 75, 58, 39, 52, 49, 62, 63, 43, 48, 59, 81, 47, 81, 79, 61, 70, 69, 54, 81, 59, 60, 58, 44, 56, 75, 56, 57, 53, 47, 78, 79, 68, 60, 75, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5451087788712502, "mean_inference_ms": 1.4733748381945708, "mean_action_processing_ms": 0.09774941889442662, "mean_env_wait_ms": 5.765250866827289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032918453216552734, "ViewRequirementAgentConnector_ms": 0.2336897850036621}}, "episode_reward_max": 23.779, "episode_reward_min": 10.857999999999999, "episode_reward_mean": 15.340230000000002, "episode_len_mean": 65.46, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.427, 13.953, 19.528, 17.617000000000004, 20.752, 14.751000000000001, 16.732000000000003, 17.329, 16.310000000000002, 14.072000000000001, 13.102, 14.856000000000002, 16.407000000000004, 15.128, 12.225, 19.559000000000005, 15.572, 14.323999999999998, 11.774, 11.462, 15.557000000000002, 17.976, 14.638000000000002, 14.688, 17.87, 15.752000000000002, 15.701999999999998, 21.006000000000004, 10.857999999999999, 15.345, 16.256, 16.777, 17.676000000000002, 11.315999999999999, 19.808, 15.774000000000004, 16.368000000000002, 14.298, 17.113, 13.548000000000002, 12.864999999999998, 14.373000000000001, 13.744, 11.909, 17.083999999999996, 23.209000000000007, 14.727, 15.842000000000002, 15.084999999999999, 11.337, 23.779, 15.321000000000002, 15.099999999999998, 17.803000000000004, 12.727, 13.251000000000001, 12.821000000000002, 14.014, 17.878, 12.838000000000001, 22.096, 14.261999999999999, 13.972000000000001, 11.934000000000001, 13.274000000000001, 15.931000000000001, 14.468, 11.264000000000001, 13.777000000000001, 13.612, 14.643999999999998, 14.447000000000001, 12.956000000000001, 12.783000000000001, 15.265, 16.77, 12.782, 17.969, 17.383000000000006, 15.680000000000003, 18.048000000000002, 15.536000000000003, 12.535, 16.795, 13.644000000000002, 14.936000000000002, 13.217, 13.146999999999998, 15.056000000000001, 17.264, 14.288, 11.331, 13.751999999999999, 11.738, 16.37, 17.478, 17.519000000000005, 15.474000000000004, 17.325, 15.388000000000002], "episode_lengths": [84, 60, 108, 75, 95, 67, 72, 86, 74, 58, 50, 55, 68, 61, 48, 103, 73, 64, 39, 66, 63, 78, 55, 69, 74, 81, 73, 95, 45, 63, 61, 80, 82, 46, 89, 79, 85, 48, 75, 59, 44, 54, 50, 47, 81, 108, 59, 75, 69, 42, 110, 67, 55, 84, 50, 50, 45, 52, 87, 45, 97, 55, 55, 58, 45, 75, 58, 39, 52, 49, 62, 63, 43, 48, 59, 81, 47, 81, 79, 61, 70, 69, 54, 81, 59, 60, 58, 44, 56, 75, 56, 57, 53, 47, 78, 79, 68, 60, 75, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5451087788712502, "mean_inference_ms": 1.4733748381945708, "mean_action_processing_ms": 0.09774941889442662, "mean_env_wait_ms": 5.765250866827289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032918453216552734, "ViewRequirementAgentConnector_ms": 0.2336897850036621}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16382, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.7082858177041045, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16384, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16382, "timers": {"training_iteration_time_ms": 167469.041, "sample_time_ms": 7348.765, "synch_weights_time_ms": 55.622}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16382, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 171, "training_iteration": 16, "trial_id": "default", "date": "2025-12-19_23-18-40", "timestamp": 1766157520, "time_this_iter_s": 152.64966583251953, "time_total_s": 3139.0748496055603, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3139.0748496055603, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 94.98248847926266, "ram_util_percent": 14.533640552995392}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5877932902658358}, "default_policy": {"total_loss": 0.5877932902658358, "policy_loss": -0.03223974561551586, "vf_loss": 2.4809605069458485, "vf_loss_unclipped": 7.9752541303634645, "vf_explained_var": 0.032930226624011995, "entropy": 1.4290116868913174, "mean_kl_loss": 0.012219296518404121, "gradients_default_optimizer_global_norm": 1.1501335673034192, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17406, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 23.779, "episode_reward_min": 10.857999999999999, "episode_reward_mean": 14.955509999999999, "episode_len_mean": 62.32, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.774, 11.462, 15.557000000000002, 17.976, 14.638000000000002, 14.688, 17.87, 15.752000000000002, 15.701999999999998, 21.006000000000004, 10.857999999999999, 15.345, 16.256, 16.777, 17.676000000000002, 11.315999999999999, 19.808, 15.774000000000004, 16.368000000000002, 14.298, 17.113, 13.548000000000002, 12.864999999999998, 14.373000000000001, 13.744, 11.909, 17.083999999999996, 23.209000000000007, 14.727, 15.842000000000002, 15.084999999999999, 11.337, 23.779, 15.321000000000002, 15.099999999999998, 17.803000000000004, 12.727, 13.251000000000001, 12.821000000000002, 14.014, 17.878, 12.838000000000001, 22.096, 14.261999999999999, 13.972000000000001, 11.934000000000001, 13.274000000000001, 15.931000000000001, 14.468, 11.264000000000001, 13.777000000000001, 13.612, 14.643999999999998, 14.447000000000001, 12.956000000000001, 12.783000000000001, 15.265, 16.77, 12.782, 17.969, 17.383000000000006, 15.680000000000003, 18.048000000000002, 15.536000000000003, 12.535, 16.795, 13.644000000000002, 14.936000000000002, 13.217, 13.146999999999998, 15.056000000000001, 17.264, 14.288, 11.331, 13.751999999999999, 11.738, 16.37, 17.478, 17.519000000000005, 15.474000000000004, 17.325, 15.388000000000002, 11.223, 14.199, 12.596999999999998, 12.029, 15.796, 11.882, 14.061, 14.952, 11.989, 14.889000000000003, 16.61, 20.105, 15.142000000000001, 13.923, 12.696, 15.029999999999998, 11.038, 14.011000000000001], "episode_lengths": [39, 66, 63, 78, 55, 69, 74, 81, 73, 95, 45, 63, 61, 80, 82, 46, 89, 79, 85, 48, 75, 59, 44, 54, 50, 47, 81, 108, 59, 75, 69, 42, 110, 67, 55, 84, 50, 50, 45, 52, 87, 45, 97, 55, 55, 58, 45, 75, 58, 39, 52, 49, 62, 63, 43, 48, 59, 81, 47, 81, 79, 61, 70, 69, 54, 81, 59, 60, 58, 44, 56, 75, 56, 57, 53, 47, 78, 79, 68, 60, 75, 60, 41, 50, 51, 51, 71, 45, 63, 59, 39, 64, 61, 89, 56, 58, 49, 60, 36, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5421344245670775, "mean_inference_ms": 1.4492743722188488, "mean_action_processing_ms": 0.09640658217792429, "mean_env_wait_ms": 5.696994426265023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033075809478759766, "ViewRequirementAgentConnector_ms": 0.2350475788116455}}, "episode_reward_max": 23.779, "episode_reward_min": 10.857999999999999, "episode_reward_mean": 14.955509999999999, "episode_len_mean": 62.32, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.774, 11.462, 15.557000000000002, 17.976, 14.638000000000002, 14.688, 17.87, 15.752000000000002, 15.701999999999998, 21.006000000000004, 10.857999999999999, 15.345, 16.256, 16.777, 17.676000000000002, 11.315999999999999, 19.808, 15.774000000000004, 16.368000000000002, 14.298, 17.113, 13.548000000000002, 12.864999999999998, 14.373000000000001, 13.744, 11.909, 17.083999999999996, 23.209000000000007, 14.727, 15.842000000000002, 15.084999999999999, 11.337, 23.779, 15.321000000000002, 15.099999999999998, 17.803000000000004, 12.727, 13.251000000000001, 12.821000000000002, 14.014, 17.878, 12.838000000000001, 22.096, 14.261999999999999, 13.972000000000001, 11.934000000000001, 13.274000000000001, 15.931000000000001, 14.468, 11.264000000000001, 13.777000000000001, 13.612, 14.643999999999998, 14.447000000000001, 12.956000000000001, 12.783000000000001, 15.265, 16.77, 12.782, 17.969, 17.383000000000006, 15.680000000000003, 18.048000000000002, 15.536000000000003, 12.535, 16.795, 13.644000000000002, 14.936000000000002, 13.217, 13.146999999999998, 15.056000000000001, 17.264, 14.288, 11.331, 13.751999999999999, 11.738, 16.37, 17.478, 17.519000000000005, 15.474000000000004, 17.325, 15.388000000000002, 11.223, 14.199, 12.596999999999998, 12.029, 15.796, 11.882, 14.061, 14.952, 11.989, 14.889000000000003, 16.61, 20.105, 15.142000000000001, 13.923, 12.696, 15.029999999999998, 11.038, 14.011000000000001], "episode_lengths": [39, 66, 63, 78, 55, 69, 74, 81, 73, 95, 45, 63, 61, 80, 82, 46, 89, 79, 85, 48, 75, 59, 44, 54, 50, 47, 81, 108, 59, 75, 69, 42, 110, 67, 55, 84, 50, 50, 45, 52, 87, 45, 97, 55, 55, 58, 45, 75, 58, 39, 52, 49, 62, 63, 43, 48, 59, 81, 47, 81, 79, 61, 70, 69, 54, 81, 59, 60, 58, 44, 56, 75, 56, 57, 53, 47, 78, 79, 68, 60, 75, 60, 41, 50, 51, 51, 71, 45, 63, 59, 39, 64, 61, 89, 56, 58, 49, 60, 36, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5421344245670775, "mean_inference_ms": 1.4492743722188488, "mean_action_processing_ms": 0.09640658217792429, "mean_env_wait_ms": 5.696994426265023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033075809478759766, "ViewRequirementAgentConnector_ms": 0.2350475788116455}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17406, "num_agent_steps_trained": 0, "num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.707725059660203, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 17408, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 17406, "timers": {"training_iteration_time_ms": 158308.771, "sample_time_ms": 7179.02, "synch_weights_time_ms": 50.516}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17406, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 189, "training_iteration": 17, "trial_id": "default", "date": "2025-12-19_23-21-21", "timestamp": 1766157681, "time_this_iter_s": 152.66324138641357, "time_total_s": 3291.738090991974, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3291.738090991974, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 90.46855895196508, "ram_util_percent": 14.620087336244543}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5892406451515854}, "default_policy": {"total_loss": 0.5892406451515854, "policy_loss": -0.03419794414658099, "vf_loss": 2.493940867483616, "vf_loss_unclipped": 7.518526348471641, "vf_explained_var": 0.09561064019799233, "entropy": 1.3703066311776637, "mean_kl_loss": 0.013236757164196433, "gradients_default_optimizer_global_norm": 1.3434799138456583, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18430, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 23.779, "episode_reward_min": 11.038, "episode_reward_mean": 14.871100000000002, "episode_len_mean": 60.76, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.368000000000002, 14.298, 17.113, 13.548000000000002, 12.864999999999998, 14.373000000000001, 13.744, 11.909, 17.083999999999996, 23.209000000000007, 14.727, 15.842000000000002, 15.084999999999999, 11.337, 23.779, 15.321000000000002, 15.099999999999998, 17.803000000000004, 12.727, 13.251000000000001, 12.821000000000002, 14.014, 17.878, 12.838000000000001, 22.096, 14.261999999999999, 13.972000000000001, 11.934000000000001, 13.274000000000001, 15.931000000000001, 14.468, 11.264000000000001, 13.777000000000001, 13.612, 14.643999999999998, 14.447000000000001, 12.956000000000001, 12.783000000000001, 15.265, 16.77, 12.782, 17.969, 17.383000000000006, 15.680000000000003, 18.048000000000002, 15.536000000000003, 12.535, 16.795, 13.644000000000002, 14.936000000000002, 13.217, 13.146999999999998, 15.056000000000001, 17.264, 14.288, 11.331, 13.751999999999999, 11.738, 16.37, 17.478, 17.519000000000005, 15.474000000000004, 17.325, 15.388000000000002, 11.223, 14.199, 12.596999999999998, 12.029, 15.796, 11.882, 14.061, 14.952, 11.989, 14.889000000000003, 16.61, 20.105, 15.142000000000001, 13.923, 12.696, 15.029999999999998, 11.038, 14.011000000000001, 14.575000000000001, 13.96, 14.072000000000003, 13.416, 18.016000000000002, 16.177, 15.634, 14.285000000000002, 15.146, 17.41100000000001, 13.882, 14.914000000000001, 18.855000000000004, 11.705, 11.89, 13.872, 19.229999999999997, 14.754000000000001], "episode_lengths": [85, 48, 75, 59, 44, 54, 50, 47, 81, 108, 59, 75, 69, 42, 110, 67, 55, 84, 50, 50, 45, 52, 87, 45, 97, 55, 55, 58, 45, 75, 58, 39, 52, 49, 62, 63, 43, 48, 59, 81, 47, 81, 79, 61, 70, 69, 54, 81, 59, 60, 58, 44, 56, 75, 56, 57, 53, 47, 78, 79, 68, 60, 75, 60, 41, 50, 51, 51, 71, 45, 63, 59, 39, 64, 61, 89, 56, 58, 49, 60, 36, 44, 54, 57, 50, 46, 79, 69, 71, 53, 58, 77, 54, 66, 74, 56, 42, 51, 74, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5400886701492624, "mean_inference_ms": 1.4297876392586766, "mean_action_processing_ms": 0.09532559544513472, "mean_env_wait_ms": 5.64168965758817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003341197967529297, "ViewRequirementAgentConnector_ms": 0.23591971397399902}}, "episode_reward_max": 23.779, "episode_reward_min": 11.038, "episode_reward_mean": 14.871100000000002, "episode_len_mean": 60.76, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.368000000000002, 14.298, 17.113, 13.548000000000002, 12.864999999999998, 14.373000000000001, 13.744, 11.909, 17.083999999999996, 23.209000000000007, 14.727, 15.842000000000002, 15.084999999999999, 11.337, 23.779, 15.321000000000002, 15.099999999999998, 17.803000000000004, 12.727, 13.251000000000001, 12.821000000000002, 14.014, 17.878, 12.838000000000001, 22.096, 14.261999999999999, 13.972000000000001, 11.934000000000001, 13.274000000000001, 15.931000000000001, 14.468, 11.264000000000001, 13.777000000000001, 13.612, 14.643999999999998, 14.447000000000001, 12.956000000000001, 12.783000000000001, 15.265, 16.77, 12.782, 17.969, 17.383000000000006, 15.680000000000003, 18.048000000000002, 15.536000000000003, 12.535, 16.795, 13.644000000000002, 14.936000000000002, 13.217, 13.146999999999998, 15.056000000000001, 17.264, 14.288, 11.331, 13.751999999999999, 11.738, 16.37, 17.478, 17.519000000000005, 15.474000000000004, 17.325, 15.388000000000002, 11.223, 14.199, 12.596999999999998, 12.029, 15.796, 11.882, 14.061, 14.952, 11.989, 14.889000000000003, 16.61, 20.105, 15.142000000000001, 13.923, 12.696, 15.029999999999998, 11.038, 14.011000000000001, 14.575000000000001, 13.96, 14.072000000000003, 13.416, 18.016000000000002, 16.177, 15.634, 14.285000000000002, 15.146, 17.41100000000001, 13.882, 14.914000000000001, 18.855000000000004, 11.705, 11.89, 13.872, 19.229999999999997, 14.754000000000001], "episode_lengths": [85, 48, 75, 59, 44, 54, 50, 47, 81, 108, 59, 75, 69, 42, 110, 67, 55, 84, 50, 50, 45, 52, 87, 45, 97, 55, 55, 58, 45, 75, 58, 39, 52, 49, 62, 63, 43, 48, 59, 81, 47, 81, 79, 61, 70, 69, 54, 81, 59, 60, 58, 44, 56, 75, 56, 57, 53, 47, 78, 79, 68, 60, 75, 60, 41, 50, 51, 51, 71, 45, 63, 59, 39, 64, 61, 89, 56, 58, 49, 60, 36, 44, 54, 57, 50, 46, 79, 69, 71, 53, 58, 77, 54, 66, 74, 56, 42, 51, 74, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5400886701492624, "mean_inference_ms": 1.4297876392586766, "mean_action_processing_ms": 0.09532559544513472, "mean_env_wait_ms": 5.64168965758817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003341197967529297, "ViewRequirementAgentConnector_ms": 0.23591971397399902}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18430, "num_agent_steps_trained": 0, "num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.682643990692281, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 18432, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 18430, "timers": {"training_iteration_time_ms": 152399.597, "sample_time_ms": 6993.481, "synch_weights_time_ms": 49.338}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18430, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 207, "training_iteration": 18, "trial_id": "default", "date": "2025-12-19_23-23-54", "timestamp": 1766157834, "time_this_iter_s": 153.2384638786316, "time_total_s": 3444.9765548706055, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3444.9765548706055, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 95.0151376146789, "ram_util_percent": 14.446330275229359}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6407710782252252}, "default_policy": {"total_loss": 0.6407710782252252, "policy_loss": -0.03948542080470361, "vf_loss": 2.7215846829116344, "vf_loss_unclipped": 8.35530641451478, "vf_explained_var": 0.08831497095525265, "entropy": 1.3558214791119099, "mean_kl_loss": 0.012161470772875304, "gradients_default_optimizer_global_norm": 1.1039483863860369, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19454, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 22.096, "episode_reward_min": 10.905000000000001, "episode_reward_mean": 14.58754, "episode_len_mean": 58.56, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.251000000000001, 12.821000000000002, 14.014, 17.878, 12.838000000000001, 22.096, 14.261999999999999, 13.972000000000001, 11.934000000000001, 13.274000000000001, 15.931000000000001, 14.468, 11.264000000000001, 13.777000000000001, 13.612, 14.643999999999998, 14.447000000000001, 12.956000000000001, 12.783000000000001, 15.265, 16.77, 12.782, 17.969, 17.383000000000006, 15.680000000000003, 18.048000000000002, 15.536000000000003, 12.535, 16.795, 13.644000000000002, 14.936000000000002, 13.217, 13.146999999999998, 15.056000000000001, 17.264, 14.288, 11.331, 13.751999999999999, 11.738, 16.37, 17.478, 17.519000000000005, 15.474000000000004, 17.325, 15.388000000000002, 11.223, 14.199, 12.596999999999998, 12.029, 15.796, 11.882, 14.061, 14.952, 11.989, 14.889000000000003, 16.61, 20.105, 15.142000000000001, 13.923, 12.696, 15.029999999999998, 11.038, 14.011000000000001, 14.575000000000001, 13.96, 14.072000000000003, 13.416, 18.016000000000002, 16.177, 15.634, 14.285000000000002, 15.146, 17.41100000000001, 13.882, 14.914000000000001, 18.855000000000004, 11.705, 11.89, 13.872, 19.229999999999997, 14.754000000000001, 16.257000000000005, 11.129, 16.483, 15.249, 15.738, 11.928999999999998, 12.747, 12.76, 12.611000000000002, 12.372, 10.905000000000001, 12.625000000000002, 14.876999999999999, 15.583000000000004, 17.75, 19.088, 13.014999999999999, 11.981, 14.777000000000001], "episode_lengths": [50, 45, 52, 87, 45, 97, 55, 55, 58, 45, 75, 58, 39, 52, 49, 62, 63, 43, 48, 59, 81, 47, 81, 79, 61, 70, 69, 54, 81, 59, 60, 58, 44, 56, 75, 56, 57, 53, 47, 78, 79, 68, 60, 75, 60, 41, 50, 51, 51, 71, 45, 63, 59, 39, 64, 61, 89, 56, 58, 49, 60, 36, 44, 54, 57, 50, 46, 79, 69, 71, 53, 58, 77, 54, 66, 74, 56, 42, 51, 74, 51, 63, 40, 65, 58, 60, 43, 41, 52, 44, 54, 39, 48, 67, 58, 69, 83, 60, 44, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5381117946317241, "mean_inference_ms": 1.4115556350230412, "mean_action_processing_ms": 0.09431101359502517, "mean_env_wait_ms": 5.592244679267744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003362894058227539, "ViewRequirementAgentConnector_ms": 0.2361454963684082}}, "episode_reward_max": 22.096, "episode_reward_min": 10.905000000000001, "episode_reward_mean": 14.58754, "episode_len_mean": 58.56, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.251000000000001, 12.821000000000002, 14.014, 17.878, 12.838000000000001, 22.096, 14.261999999999999, 13.972000000000001, 11.934000000000001, 13.274000000000001, 15.931000000000001, 14.468, 11.264000000000001, 13.777000000000001, 13.612, 14.643999999999998, 14.447000000000001, 12.956000000000001, 12.783000000000001, 15.265, 16.77, 12.782, 17.969, 17.383000000000006, 15.680000000000003, 18.048000000000002, 15.536000000000003, 12.535, 16.795, 13.644000000000002, 14.936000000000002, 13.217, 13.146999999999998, 15.056000000000001, 17.264, 14.288, 11.331, 13.751999999999999, 11.738, 16.37, 17.478, 17.519000000000005, 15.474000000000004, 17.325, 15.388000000000002, 11.223, 14.199, 12.596999999999998, 12.029, 15.796, 11.882, 14.061, 14.952, 11.989, 14.889000000000003, 16.61, 20.105, 15.142000000000001, 13.923, 12.696, 15.029999999999998, 11.038, 14.011000000000001, 14.575000000000001, 13.96, 14.072000000000003, 13.416, 18.016000000000002, 16.177, 15.634, 14.285000000000002, 15.146, 17.41100000000001, 13.882, 14.914000000000001, 18.855000000000004, 11.705, 11.89, 13.872, 19.229999999999997, 14.754000000000001, 16.257000000000005, 11.129, 16.483, 15.249, 15.738, 11.928999999999998, 12.747, 12.76, 12.611000000000002, 12.372, 10.905000000000001, 12.625000000000002, 14.876999999999999, 15.583000000000004, 17.75, 19.088, 13.014999999999999, 11.981, 14.777000000000001], "episode_lengths": [50, 45, 52, 87, 45, 97, 55, 55, 58, 45, 75, 58, 39, 52, 49, 62, 63, 43, 48, 59, 81, 47, 81, 79, 61, 70, 69, 54, 81, 59, 60, 58, 44, 56, 75, 56, 57, 53, 47, 78, 79, 68, 60, 75, 60, 41, 50, 51, 51, 71, 45, 63, 59, 39, 64, 61, 89, 56, 58, 49, 60, 36, 44, 54, 57, 50, 46, 79, 69, 71, 53, 58, 77, 54, 66, 74, 56, 42, 51, 74, 51, 63, 40, 65, 58, 60, 43, 41, 52, 44, 54, 39, 48, 67, 58, 69, 83, 60, 44, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5381117946317241, "mean_inference_ms": 1.4115556350230412, "mean_action_processing_ms": 0.09431101359502517, "mean_env_wait_ms": 5.592244679267744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003362894058227539, "ViewRequirementAgentConnector_ms": 0.2361454963684082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19454, "num_agent_steps_trained": 0, "num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.751289916460679, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 19456, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 19454, "timers": {"training_iteration_time_ms": 152056.863, "sample_time_ms": 6865.87, "synch_weights_time_ms": 51.513}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19454, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 226, "training_iteration": 19, "trial_id": "default", "date": "2025-12-19_23-26-26", "timestamp": 1766157986, "time_this_iter_s": 151.6777527332306, "time_total_s": 3596.654307603836, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3596.654307603836, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 94.8520930232558, "ram_util_percent": 14.75023255813954}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6072595607489347}, "default_policy": {"total_loss": 0.6072595607489347, "policy_loss": -0.03374239611439407, "vf_loss": 2.564724738895893, "vf_loss_unclipped": 8.016685046255589, "vf_explained_var": 0.0016041528433561325, "entropy": 1.2982516951858998, "mean_kl_loss": 0.01119025863652041, "gradients_default_optimizer_global_norm": 1.5362742934376001, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20478, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.105, "episode_reward_min": 10.905000000000001, "episode_reward_mean": 14.666679999999996, "episode_len_mean": 58.21, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.783000000000001, 15.265, 16.77, 12.782, 17.969, 17.383000000000006, 15.680000000000003, 18.048000000000002, 15.536000000000003, 12.535, 16.795, 13.644000000000002, 14.936000000000002, 13.217, 13.146999999999998, 15.056000000000001, 17.264, 14.288, 11.331, 13.751999999999999, 11.738, 16.37, 17.478, 17.519000000000005, 15.474000000000004, 17.325, 15.388000000000002, 11.223, 14.199, 12.596999999999998, 12.029, 15.796, 11.882, 14.061, 14.952, 11.989, 14.889000000000003, 16.61, 20.105, 15.142000000000001, 13.923, 12.696, 15.029999999999998, 11.038, 14.011000000000001, 14.575000000000001, 13.96, 14.072000000000003, 13.416, 18.016000000000002, 16.177, 15.634, 14.285000000000002, 15.146, 17.41100000000001, 13.882, 14.914000000000001, 18.855000000000004, 11.705, 11.89, 13.872, 19.229999999999997, 14.754000000000001, 16.257000000000005, 11.129, 16.483, 15.249, 15.738, 11.928999999999998, 12.747, 12.76, 12.611000000000002, 12.372, 10.905000000000001, 12.625000000000002, 14.876999999999999, 15.583000000000004, 17.75, 19.088, 13.014999999999999, 11.981, 14.777000000000001, 15.024000000000001, 13.799, 12.978, 14.22, 13.301000000000002, 13.591, 18.866999999999997, 17.283, 14.59, 14.027, 13.791, 14.860000000000001, 16.113000000000003, 16.477, 13.206, 13.668, 15.950000000000001, 13.608], "episode_lengths": [48, 59, 81, 47, 81, 79, 61, 70, 69, 54, 81, 59, 60, 58, 44, 56, 75, 56, 57, 53, 47, 78, 79, 68, 60, 75, 60, 41, 50, 51, 51, 71, 45, 63, 59, 39, 64, 61, 89, 56, 58, 49, 60, 36, 44, 54, 57, 50, 46, 79, 69, 71, 53, 58, 77, 54, 66, 74, 56, 42, 51, 74, 51, 63, 40, 65, 58, 60, 43, 41, 52, 44, 54, 39, 48, 67, 58, 69, 83, 60, 44, 54, 66, 47, 43, 47, 46, 50, 78, 67, 59, 51, 51, 51, 61, 57, 51, 56, 62, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5366947473285064, "mean_inference_ms": 1.3972215666192875, "mean_action_processing_ms": 0.09352277217100478, "mean_env_wait_ms": 5.552668323202154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033638477325439453, "ViewRequirementAgentConnector_ms": 0.23534417152404785}}, "episode_reward_max": 20.105, "episode_reward_min": 10.905000000000001, "episode_reward_mean": 14.666679999999996, "episode_len_mean": 58.21, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.783000000000001, 15.265, 16.77, 12.782, 17.969, 17.383000000000006, 15.680000000000003, 18.048000000000002, 15.536000000000003, 12.535, 16.795, 13.644000000000002, 14.936000000000002, 13.217, 13.146999999999998, 15.056000000000001, 17.264, 14.288, 11.331, 13.751999999999999, 11.738, 16.37, 17.478, 17.519000000000005, 15.474000000000004, 17.325, 15.388000000000002, 11.223, 14.199, 12.596999999999998, 12.029, 15.796, 11.882, 14.061, 14.952, 11.989, 14.889000000000003, 16.61, 20.105, 15.142000000000001, 13.923, 12.696, 15.029999999999998, 11.038, 14.011000000000001, 14.575000000000001, 13.96, 14.072000000000003, 13.416, 18.016000000000002, 16.177, 15.634, 14.285000000000002, 15.146, 17.41100000000001, 13.882, 14.914000000000001, 18.855000000000004, 11.705, 11.89, 13.872, 19.229999999999997, 14.754000000000001, 16.257000000000005, 11.129, 16.483, 15.249, 15.738, 11.928999999999998, 12.747, 12.76, 12.611000000000002, 12.372, 10.905000000000001, 12.625000000000002, 14.876999999999999, 15.583000000000004, 17.75, 19.088, 13.014999999999999, 11.981, 14.777000000000001, 15.024000000000001, 13.799, 12.978, 14.22, 13.301000000000002, 13.591, 18.866999999999997, 17.283, 14.59, 14.027, 13.791, 14.860000000000001, 16.113000000000003, 16.477, 13.206, 13.668, 15.950000000000001, 13.608], "episode_lengths": [48, 59, 81, 47, 81, 79, 61, 70, 69, 54, 81, 59, 60, 58, 44, 56, 75, 56, 57, 53, 47, 78, 79, 68, 60, 75, 60, 41, 50, 51, 51, 71, 45, 63, 59, 39, 64, 61, 89, 56, 58, 49, 60, 36, 44, 54, 57, 50, 46, 79, 69, 71, 53, 58, 77, 54, 66, 74, 56, 42, 51, 74, 51, 63, 40, 65, 58, 60, 43, 41, 52, 44, 54, 39, 48, 67, 58, 69, 83, 60, 44, 54, 66, 47, 43, 47, 46, 50, 78, 67, 59, 51, 51, 51, 61, 57, 51, 56, 62, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5366947473285064, "mean_inference_ms": 1.3972215666192875, "mean_action_processing_ms": 0.09352277217100478, "mean_env_wait_ms": 5.552668323202154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033638477325439453, "ViewRequirementAgentConnector_ms": 0.23534417152404785}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20478, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.7539228608012225, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20480, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 20478, "timers": {"training_iteration_time_ms": 151942.823, "sample_time_ms": 6861.61, "synch_weights_time_ms": 53.301}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20478, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 244, "training_iteration": 20, "trial_id": "default", "date": "2025-12-19_23-28-58", "timestamp": 1766158138, "time_this_iter_s": 151.6181616783142, "time_total_s": 3748.2724692821503, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3748.2724692821503, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 94.9912037037037, "ram_util_percent": 14.308796296296295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6236237509176135}, "default_policy": {"total_loss": 0.6236237509176135, "policy_loss": -0.03499035873683169, "vf_loss": 2.634889053180814, "vf_loss_unclipped": 8.920130583271384, "vf_explained_var": 0.027462945878505708, "entropy": 1.2848020695149898, "mean_kl_loss": 0.011766448863903633, "gradients_default_optimizer_global_norm": 1.3103974035009742, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 0, "num_agent_steps_sampled": 21502, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.418000000000006, "episode_reward_min": 10.905000000000001, "episode_reward_mean": 14.624579999999998, "episode_len_mean": 56.56, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.751999999999999, 11.738, 16.37, 17.478, 17.519000000000005, 15.474000000000004, 17.325, 15.388000000000002, 11.223, 14.199, 12.596999999999998, 12.029, 15.796, 11.882, 14.061, 14.952, 11.989, 14.889000000000003, 16.61, 20.105, 15.142000000000001, 13.923, 12.696, 15.029999999999998, 11.038, 14.011000000000001, 14.575000000000001, 13.96, 14.072000000000003, 13.416, 18.016000000000002, 16.177, 15.634, 14.285000000000002, 15.146, 17.41100000000001, 13.882, 14.914000000000001, 18.855000000000004, 11.705, 11.89, 13.872, 19.229999999999997, 14.754000000000001, 16.257000000000005, 11.129, 16.483, 15.249, 15.738, 11.928999999999998, 12.747, 12.76, 12.611000000000002, 12.372, 10.905000000000001, 12.625000000000002, 14.876999999999999, 15.583000000000004, 17.75, 19.088, 13.014999999999999, 11.981, 14.777000000000001, 15.024000000000001, 13.799, 12.978, 14.22, 13.301000000000002, 13.591, 18.866999999999997, 17.283, 14.59, 14.027, 13.791, 14.860000000000001, 16.113000000000003, 16.477, 13.206, 13.668, 15.950000000000001, 13.608, 11.656, 15.015, 19.511000000000003, 14.387, 16.416000000000004, 19.066, 20.418000000000006, 16.081000000000003, 13.479, 11.386, 15.239, 11.491999999999999, 14.312000000000001, 13.209000000000001, 11.017999999999999, 16.538, 12.559, 14.993, 13.443999999999999], "episode_lengths": [53, 47, 78, 79, 68, 60, 75, 60, 41, 50, 51, 51, 71, 45, 63, 59, 39, 64, 61, 89, 56, 58, 49, 60, 36, 44, 54, 57, 50, 46, 79, 69, 71, 53, 58, 77, 54, 66, 74, 56, 42, 51, 74, 51, 63, 40, 65, 58, 60, 43, 41, 52, 44, 54, 39, 48, 67, 58, 69, 83, 60, 44, 54, 66, 47, 43, 47, 46, 50, 78, 67, 59, 51, 51, 51, 61, 57, 51, 56, 62, 52, 35, 62, 73, 51, 61, 72, 86, 61, 47, 38, 55, 39, 58, 44, 38, 61, 48, 51, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5350409404185434, "mean_inference_ms": 1.3827605063260668, "mean_action_processing_ms": 0.09272535976224944, "mean_env_wait_ms": 5.514376352982026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033354759216308594, "ViewRequirementAgentConnector_ms": 0.23459792137145996}}, "episode_reward_max": 20.418000000000006, "episode_reward_min": 10.905000000000001, "episode_reward_mean": 14.624579999999998, "episode_len_mean": 56.56, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.751999999999999, 11.738, 16.37, 17.478, 17.519000000000005, 15.474000000000004, 17.325, 15.388000000000002, 11.223, 14.199, 12.596999999999998, 12.029, 15.796, 11.882, 14.061, 14.952, 11.989, 14.889000000000003, 16.61, 20.105, 15.142000000000001, 13.923, 12.696, 15.029999999999998, 11.038, 14.011000000000001, 14.575000000000001, 13.96, 14.072000000000003, 13.416, 18.016000000000002, 16.177, 15.634, 14.285000000000002, 15.146, 17.41100000000001, 13.882, 14.914000000000001, 18.855000000000004, 11.705, 11.89, 13.872, 19.229999999999997, 14.754000000000001, 16.257000000000005, 11.129, 16.483, 15.249, 15.738, 11.928999999999998, 12.747, 12.76, 12.611000000000002, 12.372, 10.905000000000001, 12.625000000000002, 14.876999999999999, 15.583000000000004, 17.75, 19.088, 13.014999999999999, 11.981, 14.777000000000001, 15.024000000000001, 13.799, 12.978, 14.22, 13.301000000000002, 13.591, 18.866999999999997, 17.283, 14.59, 14.027, 13.791, 14.860000000000001, 16.113000000000003, 16.477, 13.206, 13.668, 15.950000000000001, 13.608, 11.656, 15.015, 19.511000000000003, 14.387, 16.416000000000004, 19.066, 20.418000000000006, 16.081000000000003, 13.479, 11.386, 15.239, 11.491999999999999, 14.312000000000001, 13.209000000000001, 11.017999999999999, 16.538, 12.559, 14.993, 13.443999999999999], "episode_lengths": [53, 47, 78, 79, 68, 60, 75, 60, 41, 50, 51, 51, 71, 45, 63, 59, 39, 64, 61, 89, 56, 58, 49, 60, 36, 44, 54, 57, 50, 46, 79, 69, 71, 53, 58, 77, 54, 66, 74, 56, 42, 51, 74, 51, 63, 40, 65, 58, 60, 43, 41, 52, 44, 54, 39, 48, 67, 58, 69, 83, 60, 44, 54, 66, 47, 43, 47, 46, 50, 78, 67, 59, 51, 51, 51, 61, 57, 51, 56, 62, 52, 35, 62, 73, 51, 61, 72, 86, 61, 47, 38, 55, 39, 58, 44, 38, 61, 48, 51, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5350409404185434, "mean_inference_ms": 1.3827605063260668, "mean_action_processing_ms": 0.09272535976224944, "mean_env_wait_ms": 5.514376352982026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033354759216308594, "ViewRequirementAgentConnector_ms": 0.23459792137145996}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21502, "num_agent_steps_trained": 0, "num_env_steps_sampled": 21504, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.712109283385408, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 21504, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 21502, "timers": {"training_iteration_time_ms": 152091.471, "sample_time_ms": 6863.68, "synch_weights_time_ms": 53.541}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 0, "num_agent_steps_sampled": 21502, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 263, "training_iteration": 21, "trial_id": "default", "date": "2025-12-19_23-31-30", "timestamp": 1766158290, "time_this_iter_s": 152.56287550926208, "time_total_s": 3900.8353447914124, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3900.8353447914124, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 95.02534562211981, "ram_util_percent": 14.835483870967744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6215665374584205}, "default_policy": {"total_loss": 0.6215665374584205, "policy_loss": -0.037519053963478655, "vf_loss": 2.6367446199059486, "vf_loss_unclipped": 8.489098434895277, "vf_explained_var": 0.12678250819444656, "entropy": 1.230309709906578, "mean_kl_loss": 0.01129749392862891, "gradients_default_optimizer_global_norm": 1.0809016359969974, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 0, "num_agent_steps_sampled": 22526, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.418000000000006, "episode_reward_min": 10.905000000000001, "episode_reward_mean": 14.619760000000001, "episode_len_mean": 55.61, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.105, 15.142000000000001, 13.923, 12.696, 15.029999999999998, 11.038, 14.011000000000001, 14.575000000000001, 13.96, 14.072000000000003, 13.416, 18.016000000000002, 16.177, 15.634, 14.285000000000002, 15.146, 17.41100000000001, 13.882, 14.914000000000001, 18.855000000000004, 11.705, 11.89, 13.872, 19.229999999999997, 14.754000000000001, 16.257000000000005, 11.129, 16.483, 15.249, 15.738, 11.928999999999998, 12.747, 12.76, 12.611000000000002, 12.372, 10.905000000000001, 12.625000000000002, 14.876999999999999, 15.583000000000004, 17.75, 19.088, 13.014999999999999, 11.981, 14.777000000000001, 15.024000000000001, 13.799, 12.978, 14.22, 13.301000000000002, 13.591, 18.866999999999997, 17.283, 14.59, 14.027, 13.791, 14.860000000000001, 16.113000000000003, 16.477, 13.206, 13.668, 15.950000000000001, 13.608, 11.656, 15.015, 19.511000000000003, 14.387, 16.416000000000004, 19.066, 20.418000000000006, 16.081000000000003, 13.479, 11.386, 15.239, 11.491999999999999, 14.312000000000001, 13.209000000000001, 11.017999999999999, 16.538, 12.559, 14.993, 13.443999999999999, 13.276, 16.474, 13.841000000000001, 15.482000000000001, 13.249, 12.306000000000001, 16.204, 13.364, 13.628, 14.014, 17.697000000000003, 14.651000000000002, 11.946, 16.707, 16.449, 15.324000000000003, 11.440999999999999, 14.137999999999998, 14.597999999999999], "episode_lengths": [89, 56, 58, 49, 60, 36, 44, 54, 57, 50, 46, 79, 69, 71, 53, 58, 77, 54, 66, 74, 56, 42, 51, 74, 51, 63, 40, 65, 58, 60, 43, 41, 52, 44, 54, 39, 48, 67, 58, 69, 83, 60, 44, 54, 66, 47, 43, 47, 46, 50, 78, 67, 59, 51, 51, 51, 61, 57, 51, 56, 62, 52, 35, 62, 73, 51, 61, 72, 86, 61, 47, 38, 55, 39, 58, 44, 38, 61, 48, 51, 50, 51, 63, 54, 52, 59, 45, 51, 45, 51, 43, 67, 53, 39, 68, 65, 67, 34, 59, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5341721448181234, "mean_inference_ms": 1.3712416647264372, "mean_action_processing_ms": 0.0920913625528896, "mean_env_wait_ms": 5.482176698919022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033168792724609375, "ViewRequirementAgentConnector_ms": 0.23318052291870117}}, "episode_reward_max": 20.418000000000006, "episode_reward_min": 10.905000000000001, "episode_reward_mean": 14.619760000000001, "episode_len_mean": 55.61, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.105, 15.142000000000001, 13.923, 12.696, 15.029999999999998, 11.038, 14.011000000000001, 14.575000000000001, 13.96, 14.072000000000003, 13.416, 18.016000000000002, 16.177, 15.634, 14.285000000000002, 15.146, 17.41100000000001, 13.882, 14.914000000000001, 18.855000000000004, 11.705, 11.89, 13.872, 19.229999999999997, 14.754000000000001, 16.257000000000005, 11.129, 16.483, 15.249, 15.738, 11.928999999999998, 12.747, 12.76, 12.611000000000002, 12.372, 10.905000000000001, 12.625000000000002, 14.876999999999999, 15.583000000000004, 17.75, 19.088, 13.014999999999999, 11.981, 14.777000000000001, 15.024000000000001, 13.799, 12.978, 14.22, 13.301000000000002, 13.591, 18.866999999999997, 17.283, 14.59, 14.027, 13.791, 14.860000000000001, 16.113000000000003, 16.477, 13.206, 13.668, 15.950000000000001, 13.608, 11.656, 15.015, 19.511000000000003, 14.387, 16.416000000000004, 19.066, 20.418000000000006, 16.081000000000003, 13.479, 11.386, 15.239, 11.491999999999999, 14.312000000000001, 13.209000000000001, 11.017999999999999, 16.538, 12.559, 14.993, 13.443999999999999, 13.276, 16.474, 13.841000000000001, 15.482000000000001, 13.249, 12.306000000000001, 16.204, 13.364, 13.628, 14.014, 17.697000000000003, 14.651000000000002, 11.946, 16.707, 16.449, 15.324000000000003, 11.440999999999999, 14.137999999999998, 14.597999999999999], "episode_lengths": [89, 56, 58, 49, 60, 36, 44, 54, 57, 50, 46, 79, 69, 71, 53, 58, 77, 54, 66, 74, 56, 42, 51, 74, 51, 63, 40, 65, 58, 60, 43, 41, 52, 44, 54, 39, 48, 67, 58, 69, 83, 60, 44, 54, 66, 47, 43, 47, 46, 50, 78, 67, 59, 51, 51, 51, 61, 57, 51, 56, 62, 52, 35, 62, 73, 51, 61, 72, 86, 61, 47, 38, 55, 39, 58, 44, 38, 61, 48, 51, 50, 51, 63, 54, 52, 59, 45, 51, 45, 51, 43, 67, 53, 39, 68, 65, 67, 34, 59, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5341721448181234, "mean_inference_ms": 1.3712416647264372, "mean_action_processing_ms": 0.0920913625528896, "mean_env_wait_ms": 5.482176698919022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033168792724609375, "ViewRequirementAgentConnector_ms": 0.23318052291870117}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22526, "num_agent_steps_trained": 0, "num_env_steps_sampled": 22528, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.6549313627620075, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 22528, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 22526, "timers": {"training_iteration_time_ms": 152285.53, "sample_time_ms": 6864.546, "synch_weights_time_ms": 52.79}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 0, "num_agent_steps_sampled": 22526, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 282, "training_iteration": 22, "trial_id": "default", "date": "2025-12-19_23-34-12", "timestamp": 1766158452, "time_this_iter_s": 153.87374114990234, "time_total_s": 4054.7090859413147, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4054.7090859413147, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 90.85478260869564, "ram_util_percent": 14.428260869565218}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6211663249509002}, "default_policy": {"total_loss": 0.6211663249509002, "policy_loss": -0.03774366664001718, "vf_loss": 2.6364374220371247, "vf_loss_unclipped": 8.10267014503479, "vf_explained_var": 0.1498964700847864, "entropy": 1.1852921150624751, "mean_kl_loss": 0.009859283187915934, "gradients_default_optimizer_global_norm": 1.3998663615435363, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 0, "num_agent_steps_sampled": 23550, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.418000000000006, "episode_reward_min": 9.972999999999999, "episode_reward_mean": 14.276139999999998, "episode_len_mean": 53.03, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.89, 13.872, 19.229999999999997, 14.754000000000001, 16.257000000000005, 11.129, 16.483, 15.249, 15.738, 11.928999999999998, 12.747, 12.76, 12.611000000000002, 12.372, 10.905000000000001, 12.625000000000002, 14.876999999999999, 15.583000000000004, 17.75, 19.088, 13.014999999999999, 11.981, 14.777000000000001, 15.024000000000001, 13.799, 12.978, 14.22, 13.301000000000002, 13.591, 18.866999999999997, 17.283, 14.59, 14.027, 13.791, 14.860000000000001, 16.113000000000003, 16.477, 13.206, 13.668, 15.950000000000001, 13.608, 11.656, 15.015, 19.511000000000003, 14.387, 16.416000000000004, 19.066, 20.418000000000006, 16.081000000000003, 13.479, 11.386, 15.239, 11.491999999999999, 14.312000000000001, 13.209000000000001, 11.017999999999999, 16.538, 12.559, 14.993, 13.443999999999999, 13.276, 16.474, 13.841000000000001, 15.482000000000001, 13.249, 12.306000000000001, 16.204, 13.364, 13.628, 14.014, 17.697000000000003, 14.651000000000002, 11.946, 16.707, 16.449, 15.324000000000003, 11.440999999999999, 14.137999999999998, 14.597999999999999, 15.470000000000002, 12.813, 14.091000000000001, 14.041, 11.39, 12.116999999999999, 13.225, 12.873999999999999, 13.181000000000001, 15.048000000000002, 13.006, 9.972999999999999, 12.778, 16.03, 13.315, 14.666000000000002, 12.461, 12.719000000000001, 13.148, 12.562000000000001, 14.723000000000003], "episode_lengths": [42, 51, 74, 51, 63, 40, 65, 58, 60, 43, 41, 52, 44, 54, 39, 48, 67, 58, 69, 83, 60, 44, 54, 66, 47, 43, 47, 46, 50, 78, 67, 59, 51, 51, 51, 61, 57, 51, 56, 62, 52, 35, 62, 73, 51, 61, 72, 86, 61, 47, 38, 55, 39, 58, 44, 38, 61, 48, 51, 50, 51, 63, 54, 52, 59, 45, 51, 45, 51, 43, 67, 53, 39, 68, 65, 67, 34, 59, 54, 55, 47, 52, 50, 36, 40, 40, 46, 43, 56, 51, 28, 44, 65, 45, 54, 48, 40, 51, 56, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5338271750222795, "mean_inference_ms": 1.3608324609945885, "mean_action_processing_ms": 0.09152353231842168, "mean_env_wait_ms": 5.451848919514772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032837390899658203, "ViewRequirementAgentConnector_ms": 0.23212504386901855}}, "episode_reward_max": 20.418000000000006, "episode_reward_min": 9.972999999999999, "episode_reward_mean": 14.276139999999998, "episode_len_mean": 53.03, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.89, 13.872, 19.229999999999997, 14.754000000000001, 16.257000000000005, 11.129, 16.483, 15.249, 15.738, 11.928999999999998, 12.747, 12.76, 12.611000000000002, 12.372, 10.905000000000001, 12.625000000000002, 14.876999999999999, 15.583000000000004, 17.75, 19.088, 13.014999999999999, 11.981, 14.777000000000001, 15.024000000000001, 13.799, 12.978, 14.22, 13.301000000000002, 13.591, 18.866999999999997, 17.283, 14.59, 14.027, 13.791, 14.860000000000001, 16.113000000000003, 16.477, 13.206, 13.668, 15.950000000000001, 13.608, 11.656, 15.015, 19.511000000000003, 14.387, 16.416000000000004, 19.066, 20.418000000000006, 16.081000000000003, 13.479, 11.386, 15.239, 11.491999999999999, 14.312000000000001, 13.209000000000001, 11.017999999999999, 16.538, 12.559, 14.993, 13.443999999999999, 13.276, 16.474, 13.841000000000001, 15.482000000000001, 13.249, 12.306000000000001, 16.204, 13.364, 13.628, 14.014, 17.697000000000003, 14.651000000000002, 11.946, 16.707, 16.449, 15.324000000000003, 11.440999999999999, 14.137999999999998, 14.597999999999999, 15.470000000000002, 12.813, 14.091000000000001, 14.041, 11.39, 12.116999999999999, 13.225, 12.873999999999999, 13.181000000000001, 15.048000000000002, 13.006, 9.972999999999999, 12.778, 16.03, 13.315, 14.666000000000002, 12.461, 12.719000000000001, 13.148, 12.562000000000001, 14.723000000000003], "episode_lengths": [42, 51, 74, 51, 63, 40, 65, 58, 60, 43, 41, 52, 44, 54, 39, 48, 67, 58, 69, 83, 60, 44, 54, 66, 47, 43, 47, 46, 50, 78, 67, 59, 51, 51, 51, 61, 57, 51, 56, 62, 52, 35, 62, 73, 51, 61, 72, 86, 61, 47, 38, 55, 39, 58, 44, 38, 61, 48, 51, 50, 51, 63, 54, 52, 59, 45, 51, 45, 51, 43, 67, 53, 39, 68, 65, 67, 34, 59, 54, 55, 47, 52, 50, 36, 40, 40, 46, 43, 56, 51, 28, 44, 65, 45, 54, 48, 40, 51, 56, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5338271750222795, "mean_inference_ms": 1.3608324609945885, "mean_action_processing_ms": 0.09152353231842168, "mean_env_wait_ms": 5.451848919514772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032837390899658203, "ViewRequirementAgentConnector_ms": 0.23212504386901855}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23550, "num_agent_steps_trained": 0, "num_env_steps_sampled": 23552, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.725961613042763, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 23552, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 23550, "timers": {"training_iteration_time_ms": 152356.638, "sample_time_ms": 6864.777, "synch_weights_time_ms": 52.283}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 0, "num_agent_steps_sampled": 23550, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 303, "training_iteration": 23, "trial_id": "default", "date": "2025-12-19_23-36-44", "timestamp": 1766158604, "time_this_iter_s": 152.24886322021484, "time_total_s": 4206.9579491615295, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4206.9579491615295, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 94.83564814814815, "ram_util_percent": 14.786111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6475677051465027}, "default_policy": {"total_loss": 0.6475677051465027, "policy_loss": -0.03391494584502652, "vf_loss": 2.7275424979627134, "vf_loss_unclipped": 7.537554757297039, "vf_explained_var": 0.23767256028950215, "entropy": 1.2251359321177007, "mean_kl_loss": 0.008221663427249837, "gradients_default_optimizer_global_norm": 1.4308255933225156, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24574, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.418000000000006, "episode_reward_min": 9.972999999999999, "episode_reward_mean": 14.20081, "episode_len_mean": 52.36, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.014999999999999, 11.981, 14.777000000000001, 15.024000000000001, 13.799, 12.978, 14.22, 13.301000000000002, 13.591, 18.866999999999997, 17.283, 14.59, 14.027, 13.791, 14.860000000000001, 16.113000000000003, 16.477, 13.206, 13.668, 15.950000000000001, 13.608, 11.656, 15.015, 19.511000000000003, 14.387, 16.416000000000004, 19.066, 20.418000000000006, 16.081000000000003, 13.479, 11.386, 15.239, 11.491999999999999, 14.312000000000001, 13.209000000000001, 11.017999999999999, 16.538, 12.559, 14.993, 13.443999999999999, 13.276, 16.474, 13.841000000000001, 15.482000000000001, 13.249, 12.306000000000001, 16.204, 13.364, 13.628, 14.014, 17.697000000000003, 14.651000000000002, 11.946, 16.707, 16.449, 15.324000000000003, 11.440999999999999, 14.137999999999998, 14.597999999999999, 15.470000000000002, 12.813, 14.091000000000001, 14.041, 11.39, 12.116999999999999, 13.225, 12.873999999999999, 13.181000000000001, 15.048000000000002, 13.006, 9.972999999999999, 12.778, 16.03, 13.315, 14.666000000000002, 12.461, 12.719000000000001, 13.148, 12.562000000000001, 14.723000000000003, 18.306, 15.745000000000001, 11.7, 13.288, 12.026, 12.211, 17.619000000000003, 13.657000000000002, 13.831999999999999, 16.963, 16.035, 13.961, 11.887, 13.144, 12.875, 12.020000000000001, 13.629000000000001, 15.949, 13.103, 12.366], "episode_lengths": [60, 44, 54, 66, 47, 43, 47, 46, 50, 78, 67, 59, 51, 51, 51, 61, 57, 51, 56, 62, 52, 35, 62, 73, 51, 61, 72, 86, 61, 47, 38, 55, 39, 58, 44, 38, 61, 48, 51, 50, 51, 63, 54, 52, 59, 45, 51, 45, 51, 43, 67, 53, 39, 68, 65, 67, 34, 59, 54, 55, 47, 52, 50, 36, 40, 40, 46, 43, 56, 51, 28, 44, 65, 45, 54, 48, 40, 51, 56, 51, 75, 62, 41, 51, 40, 40, 72, 53, 54, 67, 58, 42, 35, 50, 45, 45, 52, 56, 46, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5330744822231173, "mean_inference_ms": 1.3507756727161935, "mean_action_processing_ms": 0.09096795657450159, "mean_env_wait_ms": 5.424584478344968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032587051391601562, "ViewRequirementAgentConnector_ms": 0.23180675506591797}}, "episode_reward_max": 20.418000000000006, "episode_reward_min": 9.972999999999999, "episode_reward_mean": 14.20081, "episode_len_mean": 52.36, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.014999999999999, 11.981, 14.777000000000001, 15.024000000000001, 13.799, 12.978, 14.22, 13.301000000000002, 13.591, 18.866999999999997, 17.283, 14.59, 14.027, 13.791, 14.860000000000001, 16.113000000000003, 16.477, 13.206, 13.668, 15.950000000000001, 13.608, 11.656, 15.015, 19.511000000000003, 14.387, 16.416000000000004, 19.066, 20.418000000000006, 16.081000000000003, 13.479, 11.386, 15.239, 11.491999999999999, 14.312000000000001, 13.209000000000001, 11.017999999999999, 16.538, 12.559, 14.993, 13.443999999999999, 13.276, 16.474, 13.841000000000001, 15.482000000000001, 13.249, 12.306000000000001, 16.204, 13.364, 13.628, 14.014, 17.697000000000003, 14.651000000000002, 11.946, 16.707, 16.449, 15.324000000000003, 11.440999999999999, 14.137999999999998, 14.597999999999999, 15.470000000000002, 12.813, 14.091000000000001, 14.041, 11.39, 12.116999999999999, 13.225, 12.873999999999999, 13.181000000000001, 15.048000000000002, 13.006, 9.972999999999999, 12.778, 16.03, 13.315, 14.666000000000002, 12.461, 12.719000000000001, 13.148, 12.562000000000001, 14.723000000000003, 18.306, 15.745000000000001, 11.7, 13.288, 12.026, 12.211, 17.619000000000003, 13.657000000000002, 13.831999999999999, 16.963, 16.035, 13.961, 11.887, 13.144, 12.875, 12.020000000000001, 13.629000000000001, 15.949, 13.103, 12.366], "episode_lengths": [60, 44, 54, 66, 47, 43, 47, 46, 50, 78, 67, 59, 51, 51, 51, 61, 57, 51, 56, 62, 52, 35, 62, 73, 51, 61, 72, 86, 61, 47, 38, 55, 39, 58, 44, 38, 61, 48, 51, 50, 51, 63, 54, 52, 59, 45, 51, 45, 51, 43, 67, 53, 39, 68, 65, 67, 34, 59, 54, 55, 47, 52, 50, 36, 40, 40, 46, 43, 56, 51, 28, 44, 65, 45, 54, 48, 40, 51, 56, 51, 75, 62, 41, 51, 40, 40, 72, 53, 54, 67, 58, 42, 35, 50, 45, 45, 52, 56, 46, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5330744822231173, "mean_inference_ms": 1.3507756727161935, "mean_action_processing_ms": 0.09096795657450159, "mean_env_wait_ms": 5.424584478344968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032587051391601562, "ViewRequirementAgentConnector_ms": 0.23180675506591797}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24574, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24576, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.766854034692839, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24576, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 24574, "timers": {"training_iteration_time_ms": 152343.248, "sample_time_ms": 6866.245, "synch_weights_time_ms": 53.435}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24574, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 323, "training_iteration": 24, "trial_id": "default", "date": "2025-12-19_23-39-15", "timestamp": 1766158755, "time_this_iter_s": 151.33168172836304, "time_total_s": 4358.289630889893, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4358.289630889893, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 94.98372093023254, "ram_util_percent": 14.367906976744187}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7829971316852606}, "default_policy": {"total_loss": 0.7829971316852606, "policy_loss": -0.03755456572398543, "vf_loss": 3.2829820536077023, "vf_loss_unclipped": 8.470589314401149, "vf_explained_var": 0.13944654390215874, "entropy": 1.1849909886717795, "mean_kl_loss": 0.009911802958067994, "gradients_default_optimizer_global_norm": 1.4536773208528757, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 0, "num_agent_steps_sampled": 25598, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.418000000000006, "episode_reward_min": 9.972999999999999, "episode_reward_mean": 13.9932, "episode_len_mean": 51.12, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.656, 15.015, 19.511000000000003, 14.387, 16.416000000000004, 19.066, 20.418000000000006, 16.081000000000003, 13.479, 11.386, 15.239, 11.491999999999999, 14.312000000000001, 13.209000000000001, 11.017999999999999, 16.538, 12.559, 14.993, 13.443999999999999, 13.276, 16.474, 13.841000000000001, 15.482000000000001, 13.249, 12.306000000000001, 16.204, 13.364, 13.628, 14.014, 17.697000000000003, 14.651000000000002, 11.946, 16.707, 16.449, 15.324000000000003, 11.440999999999999, 14.137999999999998, 14.597999999999999, 15.470000000000002, 12.813, 14.091000000000001, 14.041, 11.39, 12.116999999999999, 13.225, 12.873999999999999, 13.181000000000001, 15.048000000000002, 13.006, 9.972999999999999, 12.778, 16.03, 13.315, 14.666000000000002, 12.461, 12.719000000000001, 13.148, 12.562000000000001, 14.723000000000003, 18.306, 15.745000000000001, 11.7, 13.288, 12.026, 12.211, 17.619000000000003, 13.657000000000002, 13.831999999999999, 16.963, 16.035, 13.961, 11.887, 13.144, 12.875, 12.020000000000001, 13.629000000000001, 15.949, 13.103, 12.366, 14.417000000000002, 10.945, 13.158000000000001, 13.385, 15.227, 14.235000000000003, 12.125, 13.088000000000001, 14.386000000000001, 13.453, 13.39, 12.736, 14.305000000000003, 12.854, 13.942000000000002, 14.427000000000003, 11.792, 13.708, 14.775000000000002, 15.687, 12.33], "episode_lengths": [35, 62, 73, 51, 61, 72, 86, 61, 47, 38, 55, 39, 58, 44, 38, 61, 48, 51, 50, 51, 63, 54, 52, 59, 45, 51, 45, 51, 43, 67, 53, 39, 68, 65, 67, 34, 59, 54, 55, 47, 52, 50, 36, 40, 40, 46, 43, 56, 51, 28, 44, 65, 45, 54, 48, 40, 51, 56, 51, 75, 62, 41, 51, 40, 40, 72, 53, 54, 67, 58, 42, 35, 50, 45, 45, 52, 56, 46, 51, 58, 37, 44, 44, 67, 50, 40, 48, 53, 50, 43, 42, 53, 44, 52, 49, 38, 57, 48, 62, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5331555886955459, "mean_inference_ms": 1.3427421494638139, "mean_action_processing_ms": 0.0905241148973674, "mean_env_wait_ms": 5.400687135154333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032660961151123047, "ViewRequirementAgentConnector_ms": 0.23233318328857422}}, "episode_reward_max": 20.418000000000006, "episode_reward_min": 9.972999999999999, "episode_reward_mean": 13.9932, "episode_len_mean": 51.12, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.656, 15.015, 19.511000000000003, 14.387, 16.416000000000004, 19.066, 20.418000000000006, 16.081000000000003, 13.479, 11.386, 15.239, 11.491999999999999, 14.312000000000001, 13.209000000000001, 11.017999999999999, 16.538, 12.559, 14.993, 13.443999999999999, 13.276, 16.474, 13.841000000000001, 15.482000000000001, 13.249, 12.306000000000001, 16.204, 13.364, 13.628, 14.014, 17.697000000000003, 14.651000000000002, 11.946, 16.707, 16.449, 15.324000000000003, 11.440999999999999, 14.137999999999998, 14.597999999999999, 15.470000000000002, 12.813, 14.091000000000001, 14.041, 11.39, 12.116999999999999, 13.225, 12.873999999999999, 13.181000000000001, 15.048000000000002, 13.006, 9.972999999999999, 12.778, 16.03, 13.315, 14.666000000000002, 12.461, 12.719000000000001, 13.148, 12.562000000000001, 14.723000000000003, 18.306, 15.745000000000001, 11.7, 13.288, 12.026, 12.211, 17.619000000000003, 13.657000000000002, 13.831999999999999, 16.963, 16.035, 13.961, 11.887, 13.144, 12.875, 12.020000000000001, 13.629000000000001, 15.949, 13.103, 12.366, 14.417000000000002, 10.945, 13.158000000000001, 13.385, 15.227, 14.235000000000003, 12.125, 13.088000000000001, 14.386000000000001, 13.453, 13.39, 12.736, 14.305000000000003, 12.854, 13.942000000000002, 14.427000000000003, 11.792, 13.708, 14.775000000000002, 15.687, 12.33], "episode_lengths": [35, 62, 73, 51, 61, 72, 86, 61, 47, 38, 55, 39, 58, 44, 38, 61, 48, 51, 50, 51, 63, 54, 52, 59, 45, 51, 45, 51, 43, 67, 53, 39, 68, 65, 67, 34, 59, 54, 55, 47, 52, 50, 36, 40, 40, 46, 43, 56, 51, 28, 44, 65, 45, 54, 48, 40, 51, 56, 51, 75, 62, 41, 51, 40, 40, 72, 53, 54, 67, 58, 42, 35, 50, 45, 45, 52, 56, 46, 51, 58, 37, 44, 44, 67, 50, 40, 48, 53, 50, 43, 42, 53, 44, 52, 49, 38, 57, 48, 62, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5331555886955459, "mean_inference_ms": 1.3427421494638139, "mean_action_processing_ms": 0.0905241148973674, "mean_env_wait_ms": 5.400687135154333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032660961151123047, "ViewRequirementAgentConnector_ms": 0.23233318328857422}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25598, "num_agent_steps_trained": 0, "num_env_steps_sampled": 25600, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.76327840031863, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 25600, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 25598, "timers": {"training_iteration_time_ms": 152323.793, "sample_time_ms": 6867.668, "synch_weights_time_ms": 51.867}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 0, "num_agent_steps_sampled": 25598, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 344, "training_iteration": 25, "trial_id": "default", "date": "2025-12-19_23-41-47", "timestamp": 1766158907, "time_this_iter_s": 151.4110813140869, "time_total_s": 4509.7007122039795, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4509.7007122039795, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 94.96666666666667, "ram_util_percent": 14.69351851851852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7460595121607184}, "default_policy": {"total_loss": 0.7460595121607184, "policy_loss": -0.03631638484657742, "vf_loss": 3.130476900190115, "vf_loss_unclipped": 7.113975593447686, "vf_explained_var": 0.3708060495555401, "entropy": 1.2256707914173604, "mean_kl_loss": 0.00982338202393862, "gradients_default_optimizer_global_norm": 1.824547440558672, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 0, "num_agent_steps_sampled": 26622, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19.528000000000002, "episode_reward_min": 9.972999999999999, "episode_reward_mean": 13.656629999999998, "episode_len_mean": 49.9, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.841000000000001, 15.482000000000001, 13.249, 12.306000000000001, 16.204, 13.364, 13.628, 14.014, 17.697000000000003, 14.651000000000002, 11.946, 16.707, 16.449, 15.324000000000003, 11.440999999999999, 14.137999999999998, 14.597999999999999, 15.470000000000002, 12.813, 14.091000000000001, 14.041, 11.39, 12.116999999999999, 13.225, 12.873999999999999, 13.181000000000001, 15.048000000000002, 13.006, 9.972999999999999, 12.778, 16.03, 13.315, 14.666000000000002, 12.461, 12.719000000000001, 13.148, 12.562000000000001, 14.723000000000003, 18.306, 15.745000000000001, 11.7, 13.288, 12.026, 12.211, 17.619000000000003, 13.657000000000002, 13.831999999999999, 16.963, 16.035, 13.961, 11.887, 13.144, 12.875, 12.020000000000001, 13.629000000000001, 15.949, 13.103, 12.366, 14.417000000000002, 10.945, 13.158000000000001, 13.385, 15.227, 14.235000000000003, 12.125, 13.088000000000001, 14.386000000000001, 13.453, 13.39, 12.736, 14.305000000000003, 12.854, 13.942000000000002, 14.427000000000003, 11.792, 13.708, 14.775000000000002, 15.687, 12.33, 13.891000000000002, 16.345999999999997, 11.325, 10.953999999999999, 13.312000000000001, 13.996, 12.801, 11.362, 13.518, 11.503, 12.097000000000001, 11.842, 12.806000000000001, 15.014000000000003, 11.48, 19.528000000000002, 13.622, 13.57, 12.672999999999998, 13.062000000000003, 11.61], "episode_lengths": [54, 52, 59, 45, 51, 45, 51, 43, 67, 53, 39, 68, 65, 67, 34, 59, 54, 55, 47, 52, 50, 36, 40, 40, 46, 43, 56, 51, 28, 44, 65, 45, 54, 48, 40, 51, 56, 51, 75, 62, 41, 51, 40, 40, 72, 53, 54, 67, 58, 42, 35, 50, 45, 45, 52, 56, 46, 51, 58, 37, 44, 44, 67, 50, 40, 48, 53, 50, 43, 42, 53, 44, 52, 49, 38, 57, 48, 62, 50, 55, 54, 40, 37, 60, 47, 47, 46, 49, 40, 40, 49, 51, 54, 42, 73, 50, 43, 44, 63, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5332295204644073, "mean_inference_ms": 1.3353996165820905, "mean_action_processing_ms": 0.09011361228022156, "mean_env_wait_ms": 5.379376119752975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003258943557739258, "ViewRequirementAgentConnector_ms": 0.23203444480895996}}, "episode_reward_max": 19.528000000000002, "episode_reward_min": 9.972999999999999, "episode_reward_mean": 13.656629999999998, "episode_len_mean": 49.9, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.841000000000001, 15.482000000000001, 13.249, 12.306000000000001, 16.204, 13.364, 13.628, 14.014, 17.697000000000003, 14.651000000000002, 11.946, 16.707, 16.449, 15.324000000000003, 11.440999999999999, 14.137999999999998, 14.597999999999999, 15.470000000000002, 12.813, 14.091000000000001, 14.041, 11.39, 12.116999999999999, 13.225, 12.873999999999999, 13.181000000000001, 15.048000000000002, 13.006, 9.972999999999999, 12.778, 16.03, 13.315, 14.666000000000002, 12.461, 12.719000000000001, 13.148, 12.562000000000001, 14.723000000000003, 18.306, 15.745000000000001, 11.7, 13.288, 12.026, 12.211, 17.619000000000003, 13.657000000000002, 13.831999999999999, 16.963, 16.035, 13.961, 11.887, 13.144, 12.875, 12.020000000000001, 13.629000000000001, 15.949, 13.103, 12.366, 14.417000000000002, 10.945, 13.158000000000001, 13.385, 15.227, 14.235000000000003, 12.125, 13.088000000000001, 14.386000000000001, 13.453, 13.39, 12.736, 14.305000000000003, 12.854, 13.942000000000002, 14.427000000000003, 11.792, 13.708, 14.775000000000002, 15.687, 12.33, 13.891000000000002, 16.345999999999997, 11.325, 10.953999999999999, 13.312000000000001, 13.996, 12.801, 11.362, 13.518, 11.503, 12.097000000000001, 11.842, 12.806000000000001, 15.014000000000003, 11.48, 19.528000000000002, 13.622, 13.57, 12.672999999999998, 13.062000000000003, 11.61], "episode_lengths": [54, 52, 59, 45, 51, 45, 51, 43, 67, 53, 39, 68, 65, 67, 34, 59, 54, 55, 47, 52, 50, 36, 40, 40, 46, 43, 56, 51, 28, 44, 65, 45, 54, 48, 40, 51, 56, 51, 75, 62, 41, 51, 40, 40, 72, 53, 54, 67, 58, 42, 35, 50, 45, 45, 52, 56, 46, 51, 58, 37, 44, 44, 67, 50, 40, 48, 53, 50, 43, 42, 53, 44, 52, 49, 38, 57, 48, 62, 50, 55, 54, 40, 37, 60, 47, 47, 46, 49, 40, 40, 49, 51, 54, 42, 73, 50, 43, 44, 63, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5332295204644073, "mean_inference_ms": 1.3353996165820905, "mean_action_processing_ms": 0.09011361228022156, "mean_env_wait_ms": 5.379376119752975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003258943557739258, "ViewRequirementAgentConnector_ms": 0.23203444480895996}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26622, "num_agent_steps_trained": 0, "num_env_steps_sampled": 26624, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.7409388324373385, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 26624, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 26622, "timers": {"training_iteration_time_ms": 152249.852, "sample_time_ms": 6866.992, "synch_weights_time_ms": 52.837}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 0, "num_agent_steps_sampled": 26622, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 365, "training_iteration": 26, "trial_id": "default", "date": "2025-12-19_23-44-19", "timestamp": 1766159059, "time_this_iter_s": 151.91107296943665, "time_total_s": 4661.611785173416, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4661.611785173416, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 94.97870370370369, "ram_util_percent": 14.487962962962966}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7411202372983098}, "default_policy": {"total_loss": 0.7411202372983098, "policy_loss": -0.03996687582693994, "vf_loss": 3.124776045978069, "vf_loss_unclipped": 7.5250959940254685, "vf_explained_var": 0.3752086512744427, "entropy": 1.1369092166423798, "mean_kl_loss": 0.01030010933081229, "gradients_default_optimizer_global_norm": 1.5124681197106837, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 0, "num_agent_steps_sampled": 27646, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19.528000000000002, "episode_reward_min": 9.972999999999999, "episode_reward_mean": 13.48754, "episode_len_mean": 48.95, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.116999999999999, 13.225, 12.873999999999999, 13.181000000000001, 15.048000000000002, 13.006, 9.972999999999999, 12.778, 16.03, 13.315, 14.666000000000002, 12.461, 12.719000000000001, 13.148, 12.562000000000001, 14.723000000000003, 18.306, 15.745000000000001, 11.7, 13.288, 12.026, 12.211, 17.619000000000003, 13.657000000000002, 13.831999999999999, 16.963, 16.035, 13.961, 11.887, 13.144, 12.875, 12.020000000000001, 13.629000000000001, 15.949, 13.103, 12.366, 14.417000000000002, 10.945, 13.158000000000001, 13.385, 15.227, 14.235000000000003, 12.125, 13.088000000000001, 14.386000000000001, 13.453, 13.39, 12.736, 14.305000000000003, 12.854, 13.942000000000002, 14.427000000000003, 11.792, 13.708, 14.775000000000002, 15.687, 12.33, 13.891000000000002, 16.345999999999997, 11.325, 10.953999999999999, 13.312000000000001, 13.996, 12.801, 11.362, 13.518, 11.503, 12.097000000000001, 11.842, 12.806000000000001, 15.014000000000003, 11.48, 19.528000000000002, 13.622, 13.57, 12.672999999999998, 13.062000000000003, 11.61, 16.598, 18.691, 13.702, 14.006000000000004, 12.501999999999999, 13.373999999999999, 14.624000000000006, 15.235, 12.5, 12.968, 13.808, 11.984000000000002, 11.959, 13.383000000000001, 11.174999999999999, 10.697000000000001, 15.256000000000002, 12.169, 12.841000000000001, 13.394000000000002, 11.899000000000001, 13.17], "episode_lengths": [40, 40, 46, 43, 56, 51, 28, 44, 65, 45, 54, 48, 40, 51, 56, 51, 75, 62, 41, 51, 40, 40, 72, 53, 54, 67, 58, 42, 35, 50, 45, 45, 52, 56, 46, 51, 58, 37, 44, 44, 67, 50, 40, 48, 53, 50, 43, 42, 53, 44, 52, 49, 38, 57, 48, 62, 50, 55, 54, 40, 37, 60, 47, 47, 46, 49, 40, 40, 49, 51, 54, 42, 73, 50, 43, 44, 63, 38, 61, 82, 49, 49, 39, 46, 51, 56, 46, 48, 45, 39, 44, 46, 43, 35, 60, 35, 46, 44, 43, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5327845069436088, "mean_inference_ms": 1.3268591777360033, "mean_action_processing_ms": 0.08962866862782339, "mean_env_wait_ms": 5.357130950035228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003258228302001953, "ViewRequirementAgentConnector_ms": 0.232147216796875}}, "episode_reward_max": 19.528000000000002, "episode_reward_min": 9.972999999999999, "episode_reward_mean": 13.48754, "episode_len_mean": 48.95, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.116999999999999, 13.225, 12.873999999999999, 13.181000000000001, 15.048000000000002, 13.006, 9.972999999999999, 12.778, 16.03, 13.315, 14.666000000000002, 12.461, 12.719000000000001, 13.148, 12.562000000000001, 14.723000000000003, 18.306, 15.745000000000001, 11.7, 13.288, 12.026, 12.211, 17.619000000000003, 13.657000000000002, 13.831999999999999, 16.963, 16.035, 13.961, 11.887, 13.144, 12.875, 12.020000000000001, 13.629000000000001, 15.949, 13.103, 12.366, 14.417000000000002, 10.945, 13.158000000000001, 13.385, 15.227, 14.235000000000003, 12.125, 13.088000000000001, 14.386000000000001, 13.453, 13.39, 12.736, 14.305000000000003, 12.854, 13.942000000000002, 14.427000000000003, 11.792, 13.708, 14.775000000000002, 15.687, 12.33, 13.891000000000002, 16.345999999999997, 11.325, 10.953999999999999, 13.312000000000001, 13.996, 12.801, 11.362, 13.518, 11.503, 12.097000000000001, 11.842, 12.806000000000001, 15.014000000000003, 11.48, 19.528000000000002, 13.622, 13.57, 12.672999999999998, 13.062000000000003, 11.61, 16.598, 18.691, 13.702, 14.006000000000004, 12.501999999999999, 13.373999999999999, 14.624000000000006, 15.235, 12.5, 12.968, 13.808, 11.984000000000002, 11.959, 13.383000000000001, 11.174999999999999, 10.697000000000001, 15.256000000000002, 12.169, 12.841000000000001, 13.394000000000002, 11.899000000000001, 13.17], "episode_lengths": [40, 40, 46, 43, 56, 51, 28, 44, 65, 45, 54, 48, 40, 51, 56, 51, 75, 62, 41, 51, 40, 40, 72, 53, 54, 67, 58, 42, 35, 50, 45, 45, 52, 56, 46, 51, 58, 37, 44, 44, 67, 50, 40, 48, 53, 50, 43, 42, 53, 44, 52, 49, 38, 57, 48, 62, 50, 55, 54, 40, 37, 60, 47, 47, 46, 49, 40, 40, 49, 51, 54, 42, 73, 50, 43, 44, 63, 38, 61, 82, 49, 49, 39, 46, 51, 56, 46, 48, 45, 39, 44, 46, 43, 35, 60, 35, 46, 44, 43, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5327845069436088, "mean_inference_ms": 1.3268591777360033, "mean_action_processing_ms": 0.08962866862782339, "mean_env_wait_ms": 5.357130950035228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003258228302001953, "ViewRequirementAgentConnector_ms": 0.232147216796875}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27646, "num_agent_steps_trained": 0, "num_env_steps_sampled": 27648, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.727345765914876, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 27648, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 27646, "timers": {"training_iteration_time_ms": 152205.326, "sample_time_ms": 6853.982, "synch_weights_time_ms": 52.582}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 0, "num_agent_steps_sampled": 27646, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 387, "training_iteration": 27, "trial_id": "default", "date": "2025-12-19_23-46-59", "timestamp": 1766159219, "time_this_iter_s": 152.21740746498108, "time_total_s": 4813.829192638397, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4813.829192638397, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 90.60000000000001, "ram_util_percent": 14.644493392070485}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8239997303113341}, "default_policy": {"total_loss": 0.8239997303113341, "policy_loss": -0.036186421324964614, "vf_loss": 3.4415749698877334, "vf_loss_unclipped": 7.9415426582098005, "vf_explained_var": 0.3265295814722776, "entropy": 1.1505285955965519, "mean_kl_loss": 0.009429336249738185, "gradients_default_optimizer_global_norm": 1.5409491561353206, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28670, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19.528000000000002, "episode_reward_min": 10.697000000000001, "episode_reward_mean": 13.41333, "episode_len_mean": 49.01, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.026, 12.211, 17.619000000000003, 13.657000000000002, 13.831999999999999, 16.963, 16.035, 13.961, 11.887, 13.144, 12.875, 12.020000000000001, 13.629000000000001, 15.949, 13.103, 12.366, 14.417000000000002, 10.945, 13.158000000000001, 13.385, 15.227, 14.235000000000003, 12.125, 13.088000000000001, 14.386000000000001, 13.453, 13.39, 12.736, 14.305000000000003, 12.854, 13.942000000000002, 14.427000000000003, 11.792, 13.708, 14.775000000000002, 15.687, 12.33, 13.891000000000002, 16.345999999999997, 11.325, 10.953999999999999, 13.312000000000001, 13.996, 12.801, 11.362, 13.518, 11.503, 12.097000000000001, 11.842, 12.806000000000001, 15.014000000000003, 11.48, 19.528000000000002, 13.622, 13.57, 12.672999999999998, 13.062000000000003, 11.61, 16.598, 18.691, 13.702, 14.006000000000004, 12.501999999999999, 13.373999999999999, 14.624000000000006, 15.235, 12.5, 12.968, 13.808, 11.984000000000002, 11.959, 13.383000000000001, 11.174999999999999, 10.697000000000001, 15.256000000000002, 12.169, 12.841000000000001, 13.394000000000002, 11.899000000000001, 13.17, 16.220999999999997, 13.912, 13.293, 11.924, 15.827, 13.522000000000002, 12.365, 11.927000000000001, 13.735, 12.512, 12.586, 14.139000000000003, 11.426, 13.553999999999998, 15.077, 12.591000000000001, 10.997, 12.829, 11.672, 13.334999999999999], "episode_lengths": [40, 40, 72, 53, 54, 67, 58, 42, 35, 50, 45, 45, 52, 56, 46, 51, 58, 37, 44, 44, 67, 50, 40, 48, 53, 50, 43, 42, 53, 44, 52, 49, 38, 57, 48, 62, 50, 55, 54, 40, 37, 60, 47, 47, 46, 49, 40, 40, 49, 51, 54, 42, 73, 50, 43, 44, 63, 38, 61, 82, 49, 49, 39, 46, 51, 56, 46, 48, 45, 39, 44, 46, 43, 35, 60, 35, 46, 44, 43, 44, 69, 53, 47, 37, 58, 46, 45, 41, 46, 42, 52, 58, 40, 54, 64, 45, 39, 53, 39, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.532844238294978, "mean_inference_ms": 1.320771603267421, "mean_action_processing_ms": 0.08928429963888135, "mean_env_wait_ms": 5.3398388697994585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032684803009033203, "ViewRequirementAgentConnector_ms": 0.2322523593902588}}, "episode_reward_max": 19.528000000000002, "episode_reward_min": 10.697000000000001, "episode_reward_mean": 13.41333, "episode_len_mean": 49.01, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.026, 12.211, 17.619000000000003, 13.657000000000002, 13.831999999999999, 16.963, 16.035, 13.961, 11.887, 13.144, 12.875, 12.020000000000001, 13.629000000000001, 15.949, 13.103, 12.366, 14.417000000000002, 10.945, 13.158000000000001, 13.385, 15.227, 14.235000000000003, 12.125, 13.088000000000001, 14.386000000000001, 13.453, 13.39, 12.736, 14.305000000000003, 12.854, 13.942000000000002, 14.427000000000003, 11.792, 13.708, 14.775000000000002, 15.687, 12.33, 13.891000000000002, 16.345999999999997, 11.325, 10.953999999999999, 13.312000000000001, 13.996, 12.801, 11.362, 13.518, 11.503, 12.097000000000001, 11.842, 12.806000000000001, 15.014000000000003, 11.48, 19.528000000000002, 13.622, 13.57, 12.672999999999998, 13.062000000000003, 11.61, 16.598, 18.691, 13.702, 14.006000000000004, 12.501999999999999, 13.373999999999999, 14.624000000000006, 15.235, 12.5, 12.968, 13.808, 11.984000000000002, 11.959, 13.383000000000001, 11.174999999999999, 10.697000000000001, 15.256000000000002, 12.169, 12.841000000000001, 13.394000000000002, 11.899000000000001, 13.17, 16.220999999999997, 13.912, 13.293, 11.924, 15.827, 13.522000000000002, 12.365, 11.927000000000001, 13.735, 12.512, 12.586, 14.139000000000003, 11.426, 13.553999999999998, 15.077, 12.591000000000001, 10.997, 12.829, 11.672, 13.334999999999999], "episode_lengths": [40, 40, 72, 53, 54, 67, 58, 42, 35, 50, 45, 45, 52, 56, 46, 51, 58, 37, 44, 44, 67, 50, 40, 48, 53, 50, 43, 42, 53, 44, 52, 49, 38, 57, 48, 62, 50, 55, 54, 40, 37, 60, 47, 47, 46, 49, 40, 40, 49, 51, 54, 42, 73, 50, 43, 44, 63, 38, 61, 82, 49, 49, 39, 46, 51, 56, 46, 48, 45, 39, 44, 46, 43, 35, 60, 35, 46, 44, 43, 44, 69, 53, 47, 37, 58, 46, 45, 41, 46, 42, 52, 58, 40, 54, 64, 45, 39, 53, 39, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.532844238294978, "mean_inference_ms": 1.320771603267421, "mean_action_processing_ms": 0.08928429963888135, "mean_env_wait_ms": 5.3398388697994585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032684803009033203, "ViewRequirementAgentConnector_ms": 0.2322523593902588}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28670, "num_agent_steps_trained": 0, "num_env_steps_sampled": 28672, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.772614634163941, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 28672, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 28670, "timers": {"training_iteration_time_ms": 152001.765, "sample_time_ms": 6850.516, "synch_weights_time_ms": 53.365}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28670, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 407, "training_iteration": 28, "trial_id": "default", "date": "2025-12-19_23-49-30", "timestamp": 1766159370, "time_this_iter_s": 151.201354265213, "time_total_s": 4965.03054690361, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4965.03054690361, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 95.02558139534881, "ram_util_percent": 14.666046511627908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7843328330665826}, "default_policy": {"total_loss": 0.7843328330665826, "policy_loss": -0.03731024144217372, "vf_loss": 3.286878389120102, "vf_loss_unclipped": 8.142235051095486, "vf_explained_var": 0.191656044498086, "entropy": 1.0437375988811255, "mean_kl_loss": 0.00967228016274646, "gradients_default_optimizer_global_norm": 1.4701407719403505, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 0, "num_agent_steps_sampled": 29694, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19.528000000000002, "episode_reward_min": 10.413999999999998, "episode_reward_mean": 13.335659999999997, "episode_len_mean": 48.35, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.125, 13.088000000000001, 14.386000000000001, 13.453, 13.39, 12.736, 14.305000000000003, 12.854, 13.942000000000002, 14.427000000000003, 11.792, 13.708, 14.775000000000002, 15.687, 12.33, 13.891000000000002, 16.345999999999997, 11.325, 10.953999999999999, 13.312000000000001, 13.996, 12.801, 11.362, 13.518, 11.503, 12.097000000000001, 11.842, 12.806000000000001, 15.014000000000003, 11.48, 19.528000000000002, 13.622, 13.57, 12.672999999999998, 13.062000000000003, 11.61, 16.598, 18.691, 13.702, 14.006000000000004, 12.501999999999999, 13.373999999999999, 14.624000000000006, 15.235, 12.5, 12.968, 13.808, 11.984000000000002, 11.959, 13.383000000000001, 11.174999999999999, 10.697000000000001, 15.256000000000002, 12.169, 12.841000000000001, 13.394000000000002, 11.899000000000001, 13.17, 16.220999999999997, 13.912, 13.293, 11.924, 15.827, 13.522000000000002, 12.365, 11.927000000000001, 13.735, 12.512, 12.586, 14.139000000000003, 11.426, 13.553999999999998, 15.077, 12.591000000000001, 10.997, 12.829, 11.672, 13.334999999999999, 13.421, 14.101, 13.150000000000002, 12.685, 10.706, 14.542, 10.413999999999998, 16.195, 11.49, 12.356, 10.806000000000001, 15.587000000000003, 11.354, 12.748000000000001, 17.303, 18.756999999999998, 12.110999999999999, 13.15, 10.471, 13.474, 16.013, 14.043], "episode_lengths": [40, 48, 53, 50, 43, 42, 53, 44, 52, 49, 38, 57, 48, 62, 50, 55, 54, 40, 37, 60, 47, 47, 46, 49, 40, 40, 49, 51, 54, 42, 73, 50, 43, 44, 63, 38, 61, 82, 49, 49, 39, 46, 51, 56, 46, 48, 45, 39, 44, 46, 43, 35, 60, 35, 46, 44, 43, 44, 69, 53, 47, 37, 58, 46, 45, 41, 46, 42, 52, 58, 40, 54, 64, 45, 39, 53, 39, 65, 45, 48, 42, 48, 31, 61, 36, 60, 40, 46, 30, 57, 43, 43, 68, 78, 37, 43, 38, 45, 52, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5331139610370635, "mean_inference_ms": 1.3151656093902901, "mean_action_processing_ms": 0.08896343544834501, "mean_env_wait_ms": 5.323045750289148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033147335052490234, "ViewRequirementAgentConnector_ms": 0.23253297805786133}}, "episode_reward_max": 19.528000000000002, "episode_reward_min": 10.413999999999998, "episode_reward_mean": 13.335659999999997, "episode_len_mean": 48.35, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.125, 13.088000000000001, 14.386000000000001, 13.453, 13.39, 12.736, 14.305000000000003, 12.854, 13.942000000000002, 14.427000000000003, 11.792, 13.708, 14.775000000000002, 15.687, 12.33, 13.891000000000002, 16.345999999999997, 11.325, 10.953999999999999, 13.312000000000001, 13.996, 12.801, 11.362, 13.518, 11.503, 12.097000000000001, 11.842, 12.806000000000001, 15.014000000000003, 11.48, 19.528000000000002, 13.622, 13.57, 12.672999999999998, 13.062000000000003, 11.61, 16.598, 18.691, 13.702, 14.006000000000004, 12.501999999999999, 13.373999999999999, 14.624000000000006, 15.235, 12.5, 12.968, 13.808, 11.984000000000002, 11.959, 13.383000000000001, 11.174999999999999, 10.697000000000001, 15.256000000000002, 12.169, 12.841000000000001, 13.394000000000002, 11.899000000000001, 13.17, 16.220999999999997, 13.912, 13.293, 11.924, 15.827, 13.522000000000002, 12.365, 11.927000000000001, 13.735, 12.512, 12.586, 14.139000000000003, 11.426, 13.553999999999998, 15.077, 12.591000000000001, 10.997, 12.829, 11.672, 13.334999999999999, 13.421, 14.101, 13.150000000000002, 12.685, 10.706, 14.542, 10.413999999999998, 16.195, 11.49, 12.356, 10.806000000000001, 15.587000000000003, 11.354, 12.748000000000001, 17.303, 18.756999999999998, 12.110999999999999, 13.15, 10.471, 13.474, 16.013, 14.043], "episode_lengths": [40, 48, 53, 50, 43, 42, 53, 44, 52, 49, 38, 57, 48, 62, 50, 55, 54, 40, 37, 60, 47, 47, 46, 49, 40, 40, 49, 51, 54, 42, 73, 50, 43, 44, 63, 38, 61, 82, 49, 49, 39, 46, 51, 56, 46, 48, 45, 39, 44, 46, 43, 35, 60, 35, 46, 44, 43, 44, 69, 53, 47, 37, 58, 46, 45, 41, 46, 42, 52, 58, 40, 54, 64, 45, 39, 53, 39, 65, 45, 48, 42, 48, 31, 61, 36, 60, 40, 46, 30, 57, 43, 43, 68, 78, 37, 43, 38, 45, 52, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5331139610370635, "mean_inference_ms": 1.3151656093902901, "mean_action_processing_ms": 0.08896343544834501, "mean_env_wait_ms": 5.323045750289148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033147335052490234, "ViewRequirementAgentConnector_ms": 0.23253297805786133}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29694, "num_agent_steps_trained": 0, "num_env_steps_sampled": 29696, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.696457991883161, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 29696, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 29694, "timers": {"training_iteration_time_ms": 152125.96, "sample_time_ms": 6851.821, "synch_weights_time_ms": 52.665}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 0, "num_agent_steps_sampled": 29694, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 429, "training_iteration": 29, "trial_id": "default", "date": "2025-12-19_23-52-03", "timestamp": 1766159523, "time_this_iter_s": 152.9198865890503, "time_total_s": 5117.9504334926605, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5117.9504334926605, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 94.99357798165138, "ram_util_percent": 14.944036697247707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7583976068999618}, "default_policy": {"total_loss": 0.7583976068999618, "policy_loss": -0.03430818021297455, "vf_loss": 3.172021558880806, "vf_loss_unclipped": 7.922576901316643, "vf_explained_var": 0.27035318575799466, "entropy": 1.0533889692276717, "mean_kl_loss": 0.007537780066584787, "gradients_default_optimizer_global_norm": 1.5241678565740586, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 0, "num_agent_steps_sampled": 30718, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19.528000000000002, "episode_reward_min": 10.067, "episode_reward_mean": 13.18905, "episode_len_mean": 47.77, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.801, 11.362, 13.518, 11.503, 12.097000000000001, 11.842, 12.806000000000001, 15.014000000000003, 11.48, 19.528000000000002, 13.622, 13.57, 12.672999999999998, 13.062000000000003, 11.61, 16.598, 18.691, 13.702, 14.006000000000004, 12.501999999999999, 13.373999999999999, 14.624000000000006, 15.235, 12.5, 12.968, 13.808, 11.984000000000002, 11.959, 13.383000000000001, 11.174999999999999, 10.697000000000001, 15.256000000000002, 12.169, 12.841000000000001, 13.394000000000002, 11.899000000000001, 13.17, 16.220999999999997, 13.912, 13.293, 11.924, 15.827, 13.522000000000002, 12.365, 11.927000000000001, 13.735, 12.512, 12.586, 14.139000000000003, 11.426, 13.553999999999998, 15.077, 12.591000000000001, 10.997, 12.829, 11.672, 13.334999999999999, 13.421, 14.101, 13.150000000000002, 12.685, 10.706, 14.542, 10.413999999999998, 16.195, 11.49, 12.356, 10.806000000000001, 15.587000000000003, 11.354, 12.748000000000001, 17.303, 18.756999999999998, 12.110999999999999, 13.15, 10.471, 13.474, 16.013, 14.043, 12.413, 12.3, 10.067, 13.703000000000003, 15.274000000000001, 11.046999999999999, 11.851, 12.784, 13.092, 12.879000000000001, 14.308000000000002, 14.935000000000002, 12.426000000000002, 12.528, 12.695, 11.395, 13.578000000000003, 13.038, 12.626999999999999, 13.306000000000001, 11.915], "episode_lengths": [47, 46, 49, 40, 40, 49, 51, 54, 42, 73, 50, 43, 44, 63, 38, 61, 82, 49, 49, 39, 46, 51, 56, 46, 48, 45, 39, 44, 46, 43, 35, 60, 35, 46, 44, 43, 44, 69, 53, 47, 37, 58, 46, 45, 41, 46, 42, 52, 58, 40, 54, 64, 45, 39, 53, 39, 65, 45, 48, 42, 48, 31, 61, 36, 60, 40, 46, 30, 57, 43, 43, 68, 78, 37, 43, 38, 45, 52, 49, 48, 41, 38, 52, 57, 51, 40, 45, 46, 45, 57, 57, 41, 42, 48, 38, 45, 45, 40, 45, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5330552183525205, "mean_inference_ms": 1.3096009979166217, "mean_action_processing_ms": 0.08864189848233268, "mean_env_wait_ms": 5.307330058425621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033376216888427734, "ViewRequirementAgentConnector_ms": 0.2324657440185547}}, "episode_reward_max": 19.528000000000002, "episode_reward_min": 10.067, "episode_reward_mean": 13.18905, "episode_len_mean": 47.77, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.801, 11.362, 13.518, 11.503, 12.097000000000001, 11.842, 12.806000000000001, 15.014000000000003, 11.48, 19.528000000000002, 13.622, 13.57, 12.672999999999998, 13.062000000000003, 11.61, 16.598, 18.691, 13.702, 14.006000000000004, 12.501999999999999, 13.373999999999999, 14.624000000000006, 15.235, 12.5, 12.968, 13.808, 11.984000000000002, 11.959, 13.383000000000001, 11.174999999999999, 10.697000000000001, 15.256000000000002, 12.169, 12.841000000000001, 13.394000000000002, 11.899000000000001, 13.17, 16.220999999999997, 13.912, 13.293, 11.924, 15.827, 13.522000000000002, 12.365, 11.927000000000001, 13.735, 12.512, 12.586, 14.139000000000003, 11.426, 13.553999999999998, 15.077, 12.591000000000001, 10.997, 12.829, 11.672, 13.334999999999999, 13.421, 14.101, 13.150000000000002, 12.685, 10.706, 14.542, 10.413999999999998, 16.195, 11.49, 12.356, 10.806000000000001, 15.587000000000003, 11.354, 12.748000000000001, 17.303, 18.756999999999998, 12.110999999999999, 13.15, 10.471, 13.474, 16.013, 14.043, 12.413, 12.3, 10.067, 13.703000000000003, 15.274000000000001, 11.046999999999999, 11.851, 12.784, 13.092, 12.879000000000001, 14.308000000000002, 14.935000000000002, 12.426000000000002, 12.528, 12.695, 11.395, 13.578000000000003, 13.038, 12.626999999999999, 13.306000000000001, 11.915], "episode_lengths": [47, 46, 49, 40, 40, 49, 51, 54, 42, 73, 50, 43, 44, 63, 38, 61, 82, 49, 49, 39, 46, 51, 56, 46, 48, 45, 39, 44, 46, 43, 35, 60, 35, 46, 44, 43, 44, 69, 53, 47, 37, 58, 46, 45, 41, 46, 42, 52, 58, 40, 54, 64, 45, 39, 53, 39, 65, 45, 48, 42, 48, 31, 61, 36, 60, 40, 46, 30, 57, 43, 43, 68, 78, 37, 43, 38, 45, 52, 49, 48, 41, 38, 52, 57, 51, 40, 45, 46, 45, 57, 57, 41, 42, 48, 38, 45, 45, 40, 45, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5330552183525205, "mean_inference_ms": 1.3096009979166217, "mean_action_processing_ms": 0.08864189848233268, "mean_env_wait_ms": 5.307330058425621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033376216888427734, "ViewRequirementAgentConnector_ms": 0.2324657440185547}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30718, "num_agent_steps_trained": 0, "num_env_steps_sampled": 30720, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.541342518656428, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 30720, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 30718, "timers": {"training_iteration_time_ms": 152618.679, "sample_time_ms": 6858.743, "synch_weights_time_ms": 51.908}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 0, "num_agent_steps_sampled": 30718, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 450, "training_iteration": 30, "trial_id": "default", "date": "2025-12-19_23-54-40", "timestamp": 1766159680, "time_this_iter_s": 156.54569149017334, "time_total_s": 5274.496124982834, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5274.496124982834, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 95.07702702702701, "ram_util_percent": 17.168018018018017}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8272887581959367}, "default_policy": {"total_loss": 0.8272887581959367, "policy_loss": -0.03263430740917102, "vf_loss": 3.4396445572376253, "vf_loss_unclipped": 8.140618187189101, "vf_explained_var": 0.32103724032640457, "entropy": 0.9664786241948604, "mean_kl_loss": 0.009783972806400244, "gradients_default_optimizer_global_norm": 1.7159518655389547, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 0, "num_agent_steps_sampled": 31742, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 18.756999999999998, "episode_reward_min": 10.067, "episode_reward_mean": 12.874630000000002, "episode_len_mean": 46.39, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.808, 11.984000000000002, 11.959, 13.383000000000001, 11.174999999999999, 10.697000000000001, 15.256000000000002, 12.169, 12.841000000000001, 13.394000000000002, 11.899000000000001, 13.17, 16.220999999999997, 13.912, 13.293, 11.924, 15.827, 13.522000000000002, 12.365, 11.927000000000001, 13.735, 12.512, 12.586, 14.139000000000003, 11.426, 13.553999999999998, 15.077, 12.591000000000001, 10.997, 12.829, 11.672, 13.334999999999999, 13.421, 14.101, 13.150000000000002, 12.685, 10.706, 14.542, 10.413999999999998, 16.195, 11.49, 12.356, 10.806000000000001, 15.587000000000003, 11.354, 12.748000000000001, 17.303, 18.756999999999998, 12.110999999999999, 13.15, 10.471, 13.474, 16.013, 14.043, 12.413, 12.3, 10.067, 13.703000000000003, 15.274000000000001, 11.046999999999999, 11.851, 12.784, 13.092, 12.879000000000001, 14.308000000000002, 14.935000000000002, 12.426000000000002, 12.528, 12.695, 11.395, 13.578000000000003, 13.038, 12.626999999999999, 13.306000000000001, 11.915, 16.044000000000004, 11.462000000000002, 10.855999999999998, 12.286, 12.599000000000002, 11.544, 10.661999999999999, 12.123000000000001, 10.394, 11.677, 11.251, 11.364, 12.739, 14.510000000000003, 12.158, 12.506, 12.135, 12.22, 11.777999999999999, 14.792000000000002, 14.429000000000002, 13.497000000000002, 13.186000000000002, 11.979, 11.055], "episode_lengths": [45, 39, 44, 46, 43, 35, 60, 35, 46, 44, 43, 44, 69, 53, 47, 37, 58, 46, 45, 41, 46, 42, 52, 58, 40, 54, 64, 45, 39, 53, 39, 65, 45, 48, 42, 48, 31, 61, 36, 60, 40, 46, 30, 57, 43, 43, 68, 78, 37, 43, 38, 45, 52, 49, 48, 41, 38, 52, 57, 51, 40, 45, 46, 45, 57, 57, 41, 42, 48, 38, 45, 45, 40, 45, 43, 65, 46, 39, 40, 40, 43, 39, 42, 40, 39, 44, 42, 48, 59, 46, 48, 43, 42, 38, 57, 50, 46, 45, 38, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5330859353450208, "mean_inference_ms": 1.3032649893725547, "mean_action_processing_ms": 0.08827179853853197, "mean_env_wait_ms": 5.289968665349769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003391742706298828, "ViewRequirementAgentConnector_ms": 0.2339491844177246}}, "episode_reward_max": 18.756999999999998, "episode_reward_min": 10.067, "episode_reward_mean": 12.874630000000002, "episode_len_mean": 46.39, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.808, 11.984000000000002, 11.959, 13.383000000000001, 11.174999999999999, 10.697000000000001, 15.256000000000002, 12.169, 12.841000000000001, 13.394000000000002, 11.899000000000001, 13.17, 16.220999999999997, 13.912, 13.293, 11.924, 15.827, 13.522000000000002, 12.365, 11.927000000000001, 13.735, 12.512, 12.586, 14.139000000000003, 11.426, 13.553999999999998, 15.077, 12.591000000000001, 10.997, 12.829, 11.672, 13.334999999999999, 13.421, 14.101, 13.150000000000002, 12.685, 10.706, 14.542, 10.413999999999998, 16.195, 11.49, 12.356, 10.806000000000001, 15.587000000000003, 11.354, 12.748000000000001, 17.303, 18.756999999999998, 12.110999999999999, 13.15, 10.471, 13.474, 16.013, 14.043, 12.413, 12.3, 10.067, 13.703000000000003, 15.274000000000001, 11.046999999999999, 11.851, 12.784, 13.092, 12.879000000000001, 14.308000000000002, 14.935000000000002, 12.426000000000002, 12.528, 12.695, 11.395, 13.578000000000003, 13.038, 12.626999999999999, 13.306000000000001, 11.915, 16.044000000000004, 11.462000000000002, 10.855999999999998, 12.286, 12.599000000000002, 11.544, 10.661999999999999, 12.123000000000001, 10.394, 11.677, 11.251, 11.364, 12.739, 14.510000000000003, 12.158, 12.506, 12.135, 12.22, 11.777999999999999, 14.792000000000002, 14.429000000000002, 13.497000000000002, 13.186000000000002, 11.979, 11.055], "episode_lengths": [45, 39, 44, 46, 43, 35, 60, 35, 46, 44, 43, 44, 69, 53, 47, 37, 58, 46, 45, 41, 46, 42, 52, 58, 40, 54, 64, 45, 39, 53, 39, 65, 45, 48, 42, 48, 31, 61, 36, 60, 40, 46, 30, 57, 43, 43, 68, 78, 37, 43, 38, 45, 52, 49, 48, 41, 38, 52, 57, 51, 40, 45, 46, 45, 57, 57, 41, 42, 48, 38, 45, 45, 40, 45, 43, 65, 46, 39, 40, 40, 43, 39, 42, 40, 39, 44, 42, 48, 59, 46, 48, 43, 42, 38, 57, 50, 46, 45, 38, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5330859353450208, "mean_inference_ms": 1.3032649893725547, "mean_action_processing_ms": 0.08827179853853197, "mean_env_wait_ms": 5.289968665349769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003391742706298828, "ViewRequirementAgentConnector_ms": 0.2339491844177246}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31742, "num_agent_steps_trained": 0, "num_env_steps_sampled": 31744, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.660580430566956, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 31744, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 31742, "timers": {"training_iteration_time_ms": 152736.706, "sample_time_ms": 6860.374, "synch_weights_time_ms": 51.419}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 0, "num_agent_steps_sampled": 31742, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 475, "training_iteration": 31, "trial_id": "default", "date": "2025-12-19_23-57-13", "timestamp": 1766159833, "time_this_iter_s": 153.74737787246704, "time_total_s": 5428.243502855301, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5428.243502855301, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 94.88584474885845, "ram_util_percent": 17.005936073059356}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7832927366980584}, "default_policy": {"total_loss": 0.7832927366980584, "policy_loss": -0.033869282621890304, "vf_loss": 3.2692562524229287, "vf_loss_unclipped": 8.104231928288936, "vf_explained_var": 0.35154083780944345, "entropy": 0.9266801193356514, "mean_kl_loss": 0.00774635048271648, "gradients_default_optimizer_global_norm": 1.7150627829134464, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32766, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 18.756999999999998, "episode_reward_min": 10.067, "episode_reward_mean": 12.697289999999995, "episode_len_mean": 45.85, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.139000000000003, 11.426, 13.553999999999998, 15.077, 12.591000000000001, 10.997, 12.829, 11.672, 13.334999999999999, 13.421, 14.101, 13.150000000000002, 12.685, 10.706, 14.542, 10.413999999999998, 16.195, 11.49, 12.356, 10.806000000000001, 15.587000000000003, 11.354, 12.748000000000001, 17.303, 18.756999999999998, 12.110999999999999, 13.15, 10.471, 13.474, 16.013, 14.043, 12.413, 12.3, 10.067, 13.703000000000003, 15.274000000000001, 11.046999999999999, 11.851, 12.784, 13.092, 12.879000000000001, 14.308000000000002, 14.935000000000002, 12.426000000000002, 12.528, 12.695, 11.395, 13.578000000000003, 13.038, 12.626999999999999, 13.306000000000001, 11.915, 16.044000000000004, 11.462000000000002, 10.855999999999998, 12.286, 12.599000000000002, 11.544, 10.661999999999999, 12.123000000000001, 10.394, 11.677, 11.251, 11.364, 12.739, 14.510000000000003, 12.158, 12.506, 12.135, 12.22, 11.777999999999999, 14.792000000000002, 14.429000000000002, 13.497000000000002, 13.186000000000002, 11.979, 11.055, 10.957999999999998, 13.082, 14.176000000000004, 11.493, 12.557000000000002, 11.278, 11.159, 10.57, 14.024000000000001, 11.885, 10.988000000000001, 12.381999999999998, 12.676, 14.321000000000002, 12.792, 12.32, 13.706000000000003, 10.953999999999999, 11.780999999999999, 11.495, 13.128, 11.147, 12.953000000000001], "episode_lengths": [58, 40, 54, 64, 45, 39, 53, 39, 65, 45, 48, 42, 48, 31, 61, 36, 60, 40, 46, 30, 57, 43, 43, 68, 78, 37, 43, 38, 45, 52, 49, 48, 41, 38, 52, 57, 51, 40, 45, 46, 45, 57, 57, 41, 42, 48, 38, 45, 45, 40, 45, 43, 65, 46, 39, 40, 40, 43, 39, 42, 40, 39, 44, 42, 48, 59, 46, 48, 43, 42, 38, 57, 50, 46, 45, 38, 39, 37, 47, 55, 39, 46, 40, 40, 38, 61, 40, 43, 40, 47, 48, 40, 45, 51, 37, 36, 40, 42, 44, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.533603939056658, "mean_inference_ms": 1.2990051258842918, "mean_action_processing_ms": 0.08802425379536734, "mean_env_wait_ms": 5.276819765471523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003376483917236328, "ViewRequirementAgentConnector_ms": 0.23371386528015137}}, "episode_reward_max": 18.756999999999998, "episode_reward_min": 10.067, "episode_reward_mean": 12.697289999999995, "episode_len_mean": 45.85, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.139000000000003, 11.426, 13.553999999999998, 15.077, 12.591000000000001, 10.997, 12.829, 11.672, 13.334999999999999, 13.421, 14.101, 13.150000000000002, 12.685, 10.706, 14.542, 10.413999999999998, 16.195, 11.49, 12.356, 10.806000000000001, 15.587000000000003, 11.354, 12.748000000000001, 17.303, 18.756999999999998, 12.110999999999999, 13.15, 10.471, 13.474, 16.013, 14.043, 12.413, 12.3, 10.067, 13.703000000000003, 15.274000000000001, 11.046999999999999, 11.851, 12.784, 13.092, 12.879000000000001, 14.308000000000002, 14.935000000000002, 12.426000000000002, 12.528, 12.695, 11.395, 13.578000000000003, 13.038, 12.626999999999999, 13.306000000000001, 11.915, 16.044000000000004, 11.462000000000002, 10.855999999999998, 12.286, 12.599000000000002, 11.544, 10.661999999999999, 12.123000000000001, 10.394, 11.677, 11.251, 11.364, 12.739, 14.510000000000003, 12.158, 12.506, 12.135, 12.22, 11.777999999999999, 14.792000000000002, 14.429000000000002, 13.497000000000002, 13.186000000000002, 11.979, 11.055, 10.957999999999998, 13.082, 14.176000000000004, 11.493, 12.557000000000002, 11.278, 11.159, 10.57, 14.024000000000001, 11.885, 10.988000000000001, 12.381999999999998, 12.676, 14.321000000000002, 12.792, 12.32, 13.706000000000003, 10.953999999999999, 11.780999999999999, 11.495, 13.128, 11.147, 12.953000000000001], "episode_lengths": [58, 40, 54, 64, 45, 39, 53, 39, 65, 45, 48, 42, 48, 31, 61, 36, 60, 40, 46, 30, 57, 43, 43, 68, 78, 37, 43, 38, 45, 52, 49, 48, 41, 38, 52, 57, 51, 40, 45, 46, 45, 57, 57, 41, 42, 48, 38, 45, 45, 40, 45, 43, 65, 46, 39, 40, 40, 43, 39, 42, 40, 39, 44, 42, 48, 59, 46, 48, 43, 42, 38, 57, 50, 46, 45, 38, 39, 37, 47, 55, 39, 46, 40, 40, 38, 61, 40, 43, 40, 47, 48, 40, 45, 51, 37, 36, 40, 42, 44, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.533603939056658, "mean_inference_ms": 1.2990051258842918, "mean_action_processing_ms": 0.08802425379536734, "mean_env_wait_ms": 5.276819765471523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003376483917236328, "ViewRequirementAgentConnector_ms": 0.23371386528015137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32766, "num_agent_steps_trained": 0, "num_env_steps_sampled": 32768, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.679325314641929, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 32768, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 32766, "timers": {"training_iteration_time_ms": 152680.51, "sample_time_ms": 6862.412, "synch_weights_time_ms": 51.333}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32766, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 498, "training_iteration": 32, "trial_id": "default", "date": "2025-12-19_23-59-55", "timestamp": 1766159995, "time_this_iter_s": 153.3120219707489, "time_total_s": 5581.55552482605, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5581.55552482605, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 90.67248908296942, "ram_util_percent": 16.695633187772923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8232684560120106}, "default_policy": {"total_loss": 0.8232684560120106, "policy_loss": -0.035618793225148694, "vf_loss": 3.4355655282735826, "vf_loss_unclipped": 8.732692210376262, "vf_explained_var": 0.2434120312333107, "entropy": 0.8925558712333441, "mean_kl_loss": 0.008884232173500095, "gradients_default_optimizer_global_norm": 1.4746422529220582, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 0, "num_agent_steps_sampled": 33790, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 18.756999999999998, "episode_reward_min": 10.067, "episode_reward_mean": 12.555300000000003, "episode_len_mean": 45.07, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.303, 18.756999999999998, 12.110999999999999, 13.15, 10.471, 13.474, 16.013, 14.043, 12.413, 12.3, 10.067, 13.703000000000003, 15.274000000000001, 11.046999999999999, 11.851, 12.784, 13.092, 12.879000000000001, 14.308000000000002, 14.935000000000002, 12.426000000000002, 12.528, 12.695, 11.395, 13.578000000000003, 13.038, 12.626999999999999, 13.306000000000001, 11.915, 16.044000000000004, 11.462000000000002, 10.855999999999998, 12.286, 12.599000000000002, 11.544, 10.661999999999999, 12.123000000000001, 10.394, 11.677, 11.251, 11.364, 12.739, 14.510000000000003, 12.158, 12.506, 12.135, 12.22, 11.777999999999999, 14.792000000000002, 14.429000000000002, 13.497000000000002, 13.186000000000002, 11.979, 11.055, 10.957999999999998, 13.082, 14.176000000000004, 11.493, 12.557000000000002, 11.278, 11.159, 10.57, 14.024000000000001, 11.885, 10.988000000000001, 12.381999999999998, 12.676, 14.321000000000002, 12.792, 12.32, 13.706000000000003, 10.953999999999999, 11.780999999999999, 11.495, 13.128, 11.147, 12.953000000000001, 10.700999999999999, 12.215, 14.569000000000003, 11.756, 12.612, 12.004, 12.781, 10.412999999999998, 12.581, 11.873999999999999, 14.079000000000002, 11.139, 11.908000000000001, 11.671, 11.532, 15.665, 11.376, 11.274999999999999, 11.57, 13.066, 11.484, 12.889999999999999, 11.815000000000001], "episode_lengths": [68, 78, 37, 43, 38, 45, 52, 49, 48, 41, 38, 52, 57, 51, 40, 45, 46, 45, 57, 57, 41, 42, 48, 38, 45, 45, 40, 45, 43, 65, 46, 39, 40, 40, 43, 39, 42, 40, 39, 44, 42, 48, 59, 46, 48, 43, 42, 38, 57, 50, 46, 45, 38, 39, 37, 47, 55, 39, 46, 40, 40, 38, 61, 40, 43, 40, 47, 48, 40, 45, 51, 37, 36, 40, 42, 44, 50, 33, 43, 63, 46, 55, 39, 46, 33, 38, 37, 57, 35, 40, 39, 48, 65, 41, 38, 38, 47, 40, 46, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5339965808072662, "mean_inference_ms": 1.2947048038315663, "mean_action_processing_ms": 0.08777571383171306, "mean_env_wait_ms": 5.264398561924301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003353595733642578, "ViewRequirementAgentConnector_ms": 0.23349475860595703}}, "episode_reward_max": 18.756999999999998, "episode_reward_min": 10.067, "episode_reward_mean": 12.555300000000003, "episode_len_mean": 45.07, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.303, 18.756999999999998, 12.110999999999999, 13.15, 10.471, 13.474, 16.013, 14.043, 12.413, 12.3, 10.067, 13.703000000000003, 15.274000000000001, 11.046999999999999, 11.851, 12.784, 13.092, 12.879000000000001, 14.308000000000002, 14.935000000000002, 12.426000000000002, 12.528, 12.695, 11.395, 13.578000000000003, 13.038, 12.626999999999999, 13.306000000000001, 11.915, 16.044000000000004, 11.462000000000002, 10.855999999999998, 12.286, 12.599000000000002, 11.544, 10.661999999999999, 12.123000000000001, 10.394, 11.677, 11.251, 11.364, 12.739, 14.510000000000003, 12.158, 12.506, 12.135, 12.22, 11.777999999999999, 14.792000000000002, 14.429000000000002, 13.497000000000002, 13.186000000000002, 11.979, 11.055, 10.957999999999998, 13.082, 14.176000000000004, 11.493, 12.557000000000002, 11.278, 11.159, 10.57, 14.024000000000001, 11.885, 10.988000000000001, 12.381999999999998, 12.676, 14.321000000000002, 12.792, 12.32, 13.706000000000003, 10.953999999999999, 11.780999999999999, 11.495, 13.128, 11.147, 12.953000000000001, 10.700999999999999, 12.215, 14.569000000000003, 11.756, 12.612, 12.004, 12.781, 10.412999999999998, 12.581, 11.873999999999999, 14.079000000000002, 11.139, 11.908000000000001, 11.671, 11.532, 15.665, 11.376, 11.274999999999999, 11.57, 13.066, 11.484, 12.889999999999999, 11.815000000000001], "episode_lengths": [68, 78, 37, 43, 38, 45, 52, 49, 48, 41, 38, 52, 57, 51, 40, 45, 46, 45, 57, 57, 41, 42, 48, 38, 45, 45, 40, 45, 43, 65, 46, 39, 40, 40, 43, 39, 42, 40, 39, 44, 42, 48, 59, 46, 48, 43, 42, 38, 57, 50, 46, 45, 38, 39, 37, 47, 55, 39, 46, 40, 40, 38, 61, 40, 43, 40, 47, 48, 40, 45, 51, 37, 36, 40, 42, 44, 50, 33, 43, 63, 46, 55, 39, 46, 33, 38, 37, 57, 35, 40, 39, 48, 65, 41, 38, 38, 47, 40, 46, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5339965808072662, "mean_inference_ms": 1.2947048038315663, "mean_action_processing_ms": 0.08777571383171306, "mean_env_wait_ms": 5.264398561924301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003353595733642578, "ViewRequirementAgentConnector_ms": 0.23349475860595703}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33790, "num_agent_steps_trained": 0, "num_env_steps_sampled": 33792, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.637203659870668, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 33792, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 33790, "timers": {"training_iteration_time_ms": 152884.105, "sample_time_ms": 6863.367, "synch_weights_time_ms": 52.567}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 0, "num_agent_steps_sampled": 33790, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 521, "training_iteration": 33, "trial_id": "default", "date": "2025-12-20_00-02-29", "timestamp": 1766160149, "time_this_iter_s": 154.28478264808655, "time_total_s": 5735.840307474136, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5735.840307474136, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 95.04772727272727, "ram_util_percent": 16.35090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8123200659028953}, "default_policy": {"total_loss": 0.8123200659028953, "policy_loss": -0.03569129318930209, "vf_loss": 3.3915775768458842, "vf_loss_unclipped": 8.877875430881977, "vf_explained_var": 0.3027324728667736, "entropy": 0.9163545705378056, "mean_kl_loss": 0.010333092377555886, "gradients_default_optimizer_global_norm": 1.521865712478757, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 0, "num_agent_steps_sampled": 34814, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.044000000000004, "episode_reward_min": 10.394, "episode_reward_mean": 12.289820000000002, "episode_len_mean": 44.33, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.395, 13.578000000000003, 13.038, 12.626999999999999, 13.306000000000001, 11.915, 16.044000000000004, 11.462000000000002, 10.855999999999998, 12.286, 12.599000000000002, 11.544, 10.661999999999999, 12.123000000000001, 10.394, 11.677, 11.251, 11.364, 12.739, 14.510000000000003, 12.158, 12.506, 12.135, 12.22, 11.777999999999999, 14.792000000000002, 14.429000000000002, 13.497000000000002, 13.186000000000002, 11.979, 11.055, 10.957999999999998, 13.082, 14.176000000000004, 11.493, 12.557000000000002, 11.278, 11.159, 10.57, 14.024000000000001, 11.885, 10.988000000000001, 12.381999999999998, 12.676, 14.321000000000002, 12.792, 12.32, 13.706000000000003, 10.953999999999999, 11.780999999999999, 11.495, 13.128, 11.147, 12.953000000000001, 10.700999999999999, 12.215, 14.569000000000003, 11.756, 12.612, 12.004, 12.781, 10.412999999999998, 12.581, 11.873999999999999, 14.079000000000002, 11.139, 11.908000000000001, 11.671, 11.532, 15.665, 11.376, 11.274999999999999, 11.57, 13.066, 11.484, 12.889999999999999, 11.815000000000001, 11.078000000000001, 12.999000000000002, 13.537, 13.982000000000001, 12.366000000000001, 11.744, 14.081000000000001, 10.681999999999999, 11.607999999999999, 11.424000000000001, 12.199, 11.237, 12.137000000000002, 12.983000000000002, 12.408, 13.780000000000001, 10.986, 11.976, 12.394, 12.028, 11.575999999999999, 12.778, 11.093], "episode_lengths": [38, 45, 45, 40, 45, 43, 65, 46, 39, 40, 40, 43, 39, 42, 40, 39, 44, 42, 48, 59, 46, 48, 43, 42, 38, 57, 50, 46, 45, 38, 39, 37, 47, 55, 39, 46, 40, 40, 38, 61, 40, 43, 40, 47, 48, 40, 45, 51, 37, 36, 40, 42, 44, 50, 33, 43, 63, 46, 55, 39, 46, 33, 38, 37, 57, 35, 40, 39, 48, 65, 41, 38, 38, 47, 40, 46, 42, 40, 48, 53, 45, 47, 45, 55, 39, 41, 42, 55, 36, 46, 50, 46, 53, 40, 47, 40, 43, 42, 51, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347145918695788, "mean_inference_ms": 1.291097288741603, "mean_action_processing_ms": 0.08757184830725634, "mean_env_wait_ms": 5.25353735220095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003338336944580078, "ViewRequirementAgentConnector_ms": 0.23413705825805664}}, "episode_reward_max": 16.044000000000004, "episode_reward_min": 10.394, "episode_reward_mean": 12.289820000000002, "episode_len_mean": 44.33, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.395, 13.578000000000003, 13.038, 12.626999999999999, 13.306000000000001, 11.915, 16.044000000000004, 11.462000000000002, 10.855999999999998, 12.286, 12.599000000000002, 11.544, 10.661999999999999, 12.123000000000001, 10.394, 11.677, 11.251, 11.364, 12.739, 14.510000000000003, 12.158, 12.506, 12.135, 12.22, 11.777999999999999, 14.792000000000002, 14.429000000000002, 13.497000000000002, 13.186000000000002, 11.979, 11.055, 10.957999999999998, 13.082, 14.176000000000004, 11.493, 12.557000000000002, 11.278, 11.159, 10.57, 14.024000000000001, 11.885, 10.988000000000001, 12.381999999999998, 12.676, 14.321000000000002, 12.792, 12.32, 13.706000000000003, 10.953999999999999, 11.780999999999999, 11.495, 13.128, 11.147, 12.953000000000001, 10.700999999999999, 12.215, 14.569000000000003, 11.756, 12.612, 12.004, 12.781, 10.412999999999998, 12.581, 11.873999999999999, 14.079000000000002, 11.139, 11.908000000000001, 11.671, 11.532, 15.665, 11.376, 11.274999999999999, 11.57, 13.066, 11.484, 12.889999999999999, 11.815000000000001, 11.078000000000001, 12.999000000000002, 13.537, 13.982000000000001, 12.366000000000001, 11.744, 14.081000000000001, 10.681999999999999, 11.607999999999999, 11.424000000000001, 12.199, 11.237, 12.137000000000002, 12.983000000000002, 12.408, 13.780000000000001, 10.986, 11.976, 12.394, 12.028, 11.575999999999999, 12.778, 11.093], "episode_lengths": [38, 45, 45, 40, 45, 43, 65, 46, 39, 40, 40, 43, 39, 42, 40, 39, 44, 42, 48, 59, 46, 48, 43, 42, 38, 57, 50, 46, 45, 38, 39, 37, 47, 55, 39, 46, 40, 40, 38, 61, 40, 43, 40, 47, 48, 40, 45, 51, 37, 36, 40, 42, 44, 50, 33, 43, 63, 46, 55, 39, 46, 33, 38, 37, 57, 35, 40, 39, 48, 65, 41, 38, 38, 47, 40, 46, 42, 40, 48, 53, 45, 47, 45, 55, 39, 41, 42, 55, 36, 46, 50, 46, 53, 40, 47, 40, 43, 42, 51, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347145918695788, "mean_inference_ms": 1.291097288741603, "mean_action_processing_ms": 0.08757184830725634, "mean_env_wait_ms": 5.25353735220095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003338336944580078, "ViewRequirementAgentConnector_ms": 0.23413705825805664}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34814, "num_agent_steps_trained": 0, "num_env_steps_sampled": 34816, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.6932028952020985, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 34816, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 34814, "timers": {"training_iteration_time_ms": 153050.623, "sample_time_ms": 6872.8, "synch_weights_time_ms": 52.681}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 0, "num_agent_steps_sampled": 34814, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 544, "training_iteration": 34, "trial_id": "default", "date": "2025-12-20_00-05-02", "timestamp": 1766160302, "time_this_iter_s": 152.99395537376404, "time_total_s": 5888.8342628479, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5888.8342628479, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 95.01009174311928, "ram_util_percent": 16.3454128440367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8505422580637969}, "default_policy": {"total_loss": 0.8505422580637969, "policy_loss": -0.04096666688565165, "vf_loss": 3.564929365366697, "vf_loss_unclipped": 8.642007826268673, "vf_explained_var": 0.3293244481086731, "entropy": 0.8993080731481313, "mean_kl_loss": 0.011758900849685006, "gradients_default_optimizer_global_norm": 1.4214228391647339, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 0, "num_agent_steps_sampled": 35838, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 15.665, "episode_reward_min": 10.373000000000001, "episode_reward_mean": 12.254650000000002, "episode_len_mean": 44.4, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.22, 11.777999999999999, 14.792000000000002, 14.429000000000002, 13.497000000000002, 13.186000000000002, 11.979, 11.055, 10.957999999999998, 13.082, 14.176000000000004, 11.493, 12.557000000000002, 11.278, 11.159, 10.57, 14.024000000000001, 11.885, 10.988000000000001, 12.381999999999998, 12.676, 14.321000000000002, 12.792, 12.32, 13.706000000000003, 10.953999999999999, 11.780999999999999, 11.495, 13.128, 11.147, 12.953000000000001, 10.700999999999999, 12.215, 14.569000000000003, 11.756, 12.612, 12.004, 12.781, 10.412999999999998, 12.581, 11.873999999999999, 14.079000000000002, 11.139, 11.908000000000001, 11.671, 11.532, 15.665, 11.376, 11.274999999999999, 11.57, 13.066, 11.484, 12.889999999999999, 11.815000000000001, 11.078000000000001, 12.999000000000002, 13.537, 13.982000000000001, 12.366000000000001, 11.744, 14.081000000000001, 10.681999999999999, 11.607999999999999, 11.424000000000001, 12.199, 11.237, 12.137000000000002, 12.983000000000002, 12.408, 13.780000000000001, 10.986, 11.976, 12.394, 12.028, 11.575999999999999, 12.778, 11.093, 11.343, 11.319999999999999, 14.194, 10.373000000000001, 12.383999999999999, 11.972, 12.395, 12.062000000000001, 11.629, 11.305, 11.116, 10.972000000000001, 11.708, 14.164000000000001, 14.604, 12.158000000000001, 13.167, 12.138, 11.690000000000001, 13.815000000000003, 11.924, 11.126, 11.093], "episode_lengths": [42, 38, 57, 50, 46, 45, 38, 39, 37, 47, 55, 39, 46, 40, 40, 38, 61, 40, 43, 40, 47, 48, 40, 45, 51, 37, 36, 40, 42, 44, 50, 33, 43, 63, 46, 55, 39, 46, 33, 38, 37, 57, 35, 40, 39, 48, 65, 41, 38, 38, 47, 40, 46, 42, 40, 48, 53, 45, 47, 45, 55, 39, 41, 42, 55, 36, 46, 50, 46, 53, 40, 47, 40, 43, 42, 51, 40, 36, 33, 56, 39, 42, 48, 54, 47, 42, 40, 43, 38, 42, 55, 57, 47, 47, 43, 40, 60, 43, 35, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5350072178073881, "mean_inference_ms": 1.2870272592438912, "mean_action_processing_ms": 0.08733723010378805, "mean_env_wait_ms": 5.242560165915855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032982826232910156, "ViewRequirementAgentConnector_ms": 0.2337193489074707}}, "episode_reward_max": 15.665, "episode_reward_min": 10.373000000000001, "episode_reward_mean": 12.254650000000002, "episode_len_mean": 44.4, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.22, 11.777999999999999, 14.792000000000002, 14.429000000000002, 13.497000000000002, 13.186000000000002, 11.979, 11.055, 10.957999999999998, 13.082, 14.176000000000004, 11.493, 12.557000000000002, 11.278, 11.159, 10.57, 14.024000000000001, 11.885, 10.988000000000001, 12.381999999999998, 12.676, 14.321000000000002, 12.792, 12.32, 13.706000000000003, 10.953999999999999, 11.780999999999999, 11.495, 13.128, 11.147, 12.953000000000001, 10.700999999999999, 12.215, 14.569000000000003, 11.756, 12.612, 12.004, 12.781, 10.412999999999998, 12.581, 11.873999999999999, 14.079000000000002, 11.139, 11.908000000000001, 11.671, 11.532, 15.665, 11.376, 11.274999999999999, 11.57, 13.066, 11.484, 12.889999999999999, 11.815000000000001, 11.078000000000001, 12.999000000000002, 13.537, 13.982000000000001, 12.366000000000001, 11.744, 14.081000000000001, 10.681999999999999, 11.607999999999999, 11.424000000000001, 12.199, 11.237, 12.137000000000002, 12.983000000000002, 12.408, 13.780000000000001, 10.986, 11.976, 12.394, 12.028, 11.575999999999999, 12.778, 11.093, 11.343, 11.319999999999999, 14.194, 10.373000000000001, 12.383999999999999, 11.972, 12.395, 12.062000000000001, 11.629, 11.305, 11.116, 10.972000000000001, 11.708, 14.164000000000001, 14.604, 12.158000000000001, 13.167, 12.138, 11.690000000000001, 13.815000000000003, 11.924, 11.126, 11.093], "episode_lengths": [42, 38, 57, 50, 46, 45, 38, 39, 37, 47, 55, 39, 46, 40, 40, 38, 61, 40, 43, 40, 47, 48, 40, 45, 51, 37, 36, 40, 42, 44, 50, 33, 43, 63, 46, 55, 39, 46, 33, 38, 37, 57, 35, 40, 39, 48, 65, 41, 38, 38, 47, 40, 46, 42, 40, 48, 53, 45, 47, 45, 55, 39, 41, 42, 55, 36, 46, 50, 46, 53, 40, 47, 40, 43, 42, 51, 40, 36, 33, 56, 39, 42, 48, 54, 47, 42, 40, 43, 38, 42, 55, 57, 47, 47, 43, 40, 60, 43, 35, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5350072178073881, "mean_inference_ms": 1.2870272592438912, "mean_action_processing_ms": 0.08733723010378805, "mean_env_wait_ms": 5.242560165915855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032982826232910156, "ViewRequirementAgentConnector_ms": 0.2337193489074707}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35838, "num_agent_steps_trained": 0, "num_env_steps_sampled": 35840, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.707805096362367, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 35840, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 35838, "timers": {"training_iteration_time_ms": 153175.841, "sample_time_ms": 6874.328, "synch_weights_time_ms": 52.207}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 0, "num_agent_steps_sampled": 35838, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 567, "training_iteration": 35, "trial_id": "default", "date": "2025-12-20_00-07-35", "timestamp": 1766160455, "time_this_iter_s": 152.66386723518372, "time_total_s": 6041.498130083084, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6041.498130083084, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 94.88248847926268, "ram_util_percent": 16.024423963133643}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8810178205749253}, "default_policy": {"total_loss": 0.8810178205749253, "policy_loss": -0.03746749128913507, "vf_loss": 3.673209198564291, "vf_loss_unclipped": 10.444522233307362, "vf_explained_var": 0.3254761669784784, "entropy": 0.8275124512612819, "mean_kl_loss": 0.010105229252789626, "gradients_default_optimizer_global_norm": 1.6467970937490464, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 36864, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36862, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 21.156000000000006, "episode_reward_min": 10.069, "episode_reward_mean": 12.243540000000001, "episode_len_mean": 45.19, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.321000000000002, 12.792, 12.32, 13.706000000000003, 10.953999999999999, 11.780999999999999, 11.495, 13.128, 11.147, 12.953000000000001, 10.700999999999999, 12.215, 14.569000000000003, 11.756, 12.612, 12.004, 12.781, 10.412999999999998, 12.581, 11.873999999999999, 14.079000000000002, 11.139, 11.908000000000001, 11.671, 11.532, 15.665, 11.376, 11.274999999999999, 11.57, 13.066, 11.484, 12.889999999999999, 11.815000000000001, 11.078000000000001, 12.999000000000002, 13.537, 13.982000000000001, 12.366000000000001, 11.744, 14.081000000000001, 10.681999999999999, 11.607999999999999, 11.424000000000001, 12.199, 11.237, 12.137000000000002, 12.983000000000002, 12.408, 13.780000000000001, 10.986, 11.976, 12.394, 12.028, 11.575999999999999, 12.778, 11.093, 11.343, 11.319999999999999, 14.194, 10.373000000000001, 12.383999999999999, 11.972, 12.395, 12.062000000000001, 11.629, 11.305, 11.116, 10.972000000000001, 11.708, 14.164000000000001, 14.604, 12.158000000000001, 13.167, 12.138, 11.690000000000001, 13.815000000000003, 11.924, 11.126, 11.093, 13.323, 10.261, 11.579999999999998, 10.984, 15.620000000000003, 11.811, 12.215, 11.32, 12.408000000000001, 12.236, 11.222999999999999, 10.959000000000001, 11.967, 12.076, 10.069, 11.997, 11.963999999999999, 21.156000000000006, 13.107, 11.184000000000001, 11.593], "episode_lengths": [48, 40, 45, 51, 37, 36, 40, 42, 44, 50, 33, 43, 63, 46, 55, 39, 46, 33, 38, 37, 57, 35, 40, 39, 48, 65, 41, 38, 38, 47, 40, 46, 42, 40, 48, 53, 45, 47, 45, 55, 39, 41, 42, 55, 36, 46, 50, 46, 53, 40, 47, 40, 43, 42, 51, 40, 36, 33, 56, 39, 42, 48, 54, 47, 42, 40, 43, 38, 42, 55, 57, 47, 47, 43, 40, 60, 43, 35, 39, 48, 39, 41, 39, 63, 44, 43, 42, 47, 44, 36, 36, 46, 45, 41, 41, 39, 141, 54, 39, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5353294539985134, "mean_inference_ms": 1.2837721633167118, "mean_action_processing_ms": 0.08715426604850121, "mean_env_wait_ms": 5.2332542048187545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033118724822998047, "ViewRequirementAgentConnector_ms": 0.23285436630249023}}, "episode_reward_max": 21.156000000000006, "episode_reward_min": 10.069, "episode_reward_mean": 12.243540000000001, "episode_len_mean": 45.19, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.321000000000002, 12.792, 12.32, 13.706000000000003, 10.953999999999999, 11.780999999999999, 11.495, 13.128, 11.147, 12.953000000000001, 10.700999999999999, 12.215, 14.569000000000003, 11.756, 12.612, 12.004, 12.781, 10.412999999999998, 12.581, 11.873999999999999, 14.079000000000002, 11.139, 11.908000000000001, 11.671, 11.532, 15.665, 11.376, 11.274999999999999, 11.57, 13.066, 11.484, 12.889999999999999, 11.815000000000001, 11.078000000000001, 12.999000000000002, 13.537, 13.982000000000001, 12.366000000000001, 11.744, 14.081000000000001, 10.681999999999999, 11.607999999999999, 11.424000000000001, 12.199, 11.237, 12.137000000000002, 12.983000000000002, 12.408, 13.780000000000001, 10.986, 11.976, 12.394, 12.028, 11.575999999999999, 12.778, 11.093, 11.343, 11.319999999999999, 14.194, 10.373000000000001, 12.383999999999999, 11.972, 12.395, 12.062000000000001, 11.629, 11.305, 11.116, 10.972000000000001, 11.708, 14.164000000000001, 14.604, 12.158000000000001, 13.167, 12.138, 11.690000000000001, 13.815000000000003, 11.924, 11.126, 11.093, 13.323, 10.261, 11.579999999999998, 10.984, 15.620000000000003, 11.811, 12.215, 11.32, 12.408000000000001, 12.236, 11.222999999999999, 10.959000000000001, 11.967, 12.076, 10.069, 11.997, 11.963999999999999, 21.156000000000006, 13.107, 11.184000000000001, 11.593], "episode_lengths": [48, 40, 45, 51, 37, 36, 40, 42, 44, 50, 33, 43, 63, 46, 55, 39, 46, 33, 38, 37, 57, 35, 40, 39, 48, 65, 41, 38, 38, 47, 40, 46, 42, 40, 48, 53, 45, 47, 45, 55, 39, 41, 42, 55, 36, 46, 50, 46, 53, 40, 47, 40, 43, 42, 51, 40, 36, 33, 56, 39, 42, 48, 54, 47, 42, 40, 43, 38, 42, 55, 57, 47, 47, 43, 40, 60, 43, 35, 39, 48, 39, 41, 39, 63, 44, 43, 42, 47, 44, 36, 36, 46, 45, 41, 41, 39, 141, 54, 39, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5353294539985134, "mean_inference_ms": 1.2837721633167118, "mean_action_processing_ms": 0.08715426604850121, "mean_env_wait_ms": 5.2332542048187545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033118724822998047, "ViewRequirementAgentConnector_ms": 0.23285436630249023}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36862, "num_agent_steps_trained": 0, "num_env_steps_sampled": 36864, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.755224941651831, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 36864, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 36862, "timers": {"training_iteration_time_ms": 153143.717, "sample_time_ms": 6870.348, "synch_weights_time_ms": 51.647}, "counters": {"num_env_steps_sampled": 36864, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36862, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 588, "training_iteration": 36, "trial_id": "default", "date": "2025-12-20_00-10-06", "timestamp": 1766160606, "time_this_iter_s": 151.58956670761108, "time_total_s": 6193.087696790695, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6193.087696790695, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 94.96046511627907, "ram_util_percent": 16.393953488372095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8308990459889174}, "default_policy": {"total_loss": 0.8308990459889174, "policy_loss": -0.031775006605312225, "vf_loss": 3.4504581525921822, "vf_loss_unclipped": 11.704722675681115, "vf_explained_var": 0.03679749481379986, "entropy": 0.792374585941434, "mean_kl_loss": 0.00851879471854602, "gradients_default_optimizer_global_norm": 1.2921110654249788, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 37888, "num_env_steps_trained": 0, "num_agent_steps_sampled": 37886, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 21.156000000000006, "episode_reward_min": 10.069, "episode_reward_mean": 12.14528, "episode_len_mean": 44.98, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.665, 11.376, 11.274999999999999, 11.57, 13.066, 11.484, 12.889999999999999, 11.815000000000001, 11.078000000000001, 12.999000000000002, 13.537, 13.982000000000001, 12.366000000000001, 11.744, 14.081000000000001, 10.681999999999999, 11.607999999999999, 11.424000000000001, 12.199, 11.237, 12.137000000000002, 12.983000000000002, 12.408, 13.780000000000001, 10.986, 11.976, 12.394, 12.028, 11.575999999999999, 12.778, 11.093, 11.343, 11.319999999999999, 14.194, 10.373000000000001, 12.383999999999999, 11.972, 12.395, 12.062000000000001, 11.629, 11.305, 11.116, 10.972000000000001, 11.708, 14.164000000000001, 14.604, 12.158000000000001, 13.167, 12.138, 11.690000000000001, 13.815000000000003, 11.924, 11.126, 11.093, 13.323, 10.261, 11.579999999999998, 10.984, 15.620000000000003, 11.811, 12.215, 11.32, 12.408000000000001, 12.236, 11.222999999999999, 10.959000000000001, 11.967, 12.076, 10.069, 11.997, 11.963999999999999, 21.156000000000006, 13.107, 11.184000000000001, 11.593, 12.350000000000001, 13.1, 11.827000000000002, 11.057, 13.658000000000001, 11.952, 10.441, 11.215, 13.854, 13.044, 10.847, 12.013, 10.739999999999998, 11.522, 10.079, 14.882000000000003, 10.885, 11.892, 11.005, 11.587, 11.173, 11.077, 12.533000000000001, 12.112, 11.761], "episode_lengths": [65, 41, 38, 38, 47, 40, 46, 42, 40, 48, 53, 45, 47, 45, 55, 39, 41, 42, 55, 36, 46, 50, 46, 53, 40, 47, 40, 43, 42, 51, 40, 36, 33, 56, 39, 42, 48, 54, 47, 42, 40, 43, 38, 42, 55, 57, 47, 47, 43, 40, 60, 43, 35, 39, 48, 39, 41, 39, 63, 44, 43, 42, 47, 44, 36, 36, 46, 45, 41, 41, 39, 141, 54, 39, 39, 45, 45, 43, 38, 46, 43, 37, 42, 46, 50, 36, 41, 35, 42, 38, 63, 40, 40, 40, 38, 40, 39, 44, 54, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5358961990750234, "mean_inference_ms": 1.2804831203494589, "mean_action_processing_ms": 0.08697108574771445, "mean_env_wait_ms": 5.223091153059231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032927989959716797, "ViewRequirementAgentConnector_ms": 0.23288393020629883}}, "episode_reward_max": 21.156000000000006, "episode_reward_min": 10.069, "episode_reward_mean": 12.14528, "episode_len_mean": 44.98, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.665, 11.376, 11.274999999999999, 11.57, 13.066, 11.484, 12.889999999999999, 11.815000000000001, 11.078000000000001, 12.999000000000002, 13.537, 13.982000000000001, 12.366000000000001, 11.744, 14.081000000000001, 10.681999999999999, 11.607999999999999, 11.424000000000001, 12.199, 11.237, 12.137000000000002, 12.983000000000002, 12.408, 13.780000000000001, 10.986, 11.976, 12.394, 12.028, 11.575999999999999, 12.778, 11.093, 11.343, 11.319999999999999, 14.194, 10.373000000000001, 12.383999999999999, 11.972, 12.395, 12.062000000000001, 11.629, 11.305, 11.116, 10.972000000000001, 11.708, 14.164000000000001, 14.604, 12.158000000000001, 13.167, 12.138, 11.690000000000001, 13.815000000000003, 11.924, 11.126, 11.093, 13.323, 10.261, 11.579999999999998, 10.984, 15.620000000000003, 11.811, 12.215, 11.32, 12.408000000000001, 12.236, 11.222999999999999, 10.959000000000001, 11.967, 12.076, 10.069, 11.997, 11.963999999999999, 21.156000000000006, 13.107, 11.184000000000001, 11.593, 12.350000000000001, 13.1, 11.827000000000002, 11.057, 13.658000000000001, 11.952, 10.441, 11.215, 13.854, 13.044, 10.847, 12.013, 10.739999999999998, 11.522, 10.079, 14.882000000000003, 10.885, 11.892, 11.005, 11.587, 11.173, 11.077, 12.533000000000001, 12.112, 11.761], "episode_lengths": [65, 41, 38, 38, 47, 40, 46, 42, 40, 48, 53, 45, 47, 45, 55, 39, 41, 42, 55, 36, 46, 50, 46, 53, 40, 47, 40, 43, 42, 51, 40, 36, 33, 56, 39, 42, 48, 54, 47, 42, 40, 43, 38, 42, 55, 57, 47, 47, 43, 40, 60, 43, 35, 39, 48, 39, 41, 39, 63, 44, 43, 42, 47, 44, 36, 36, 46, 45, 41, 41, 39, 141, 54, 39, 39, 45, 45, 43, 38, 46, 43, 37, 42, 46, 50, 36, 41, 35, 42, 38, 63, 40, 40, 40, 38, 40, 39, 44, 54, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5358961990750234, "mean_inference_ms": 1.2804831203494589, "mean_action_processing_ms": 0.08697108574771445, "mean_env_wait_ms": 5.223091153059231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032927989959716797, "ViewRequirementAgentConnector_ms": 0.23288393020629883}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37886, "num_agent_steps_trained": 0, "num_env_steps_sampled": 37888, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.759369115625361, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37888, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 37886, "timers": {"training_iteration_time_ms": 153071.605, "sample_time_ms": 6872.196, "synch_weights_time_ms": 50.7}, "counters": {"num_env_steps_sampled": 37888, "num_env_steps_trained": 0, "num_agent_steps_sampled": 37886, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 613, "training_iteration": 37, "trial_id": "default", "date": "2025-12-20_00-12-46", "timestamp": 1766160766, "time_this_iter_s": 151.4962456226349, "time_total_s": 6344.58394241333, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6344.58394241333, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 90.62466960352424, "ram_util_percent": 16.952863436123348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8019984812475741}, "default_policy": {"total_loss": 0.8019984812475741, "policy_loss": -0.03304481166414917, "vf_loss": 3.339671029150486, "vf_loss_unclipped": 10.629531937837601, "vf_explained_var": 0.06134909875690937, "entropy": 0.7799208838492632, "mean_kl_loss": 0.009054535257193663, "gradients_default_optimizer_global_norm": 1.394549398124218, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 38912, "num_env_steps_trained": 0, "num_agent_steps_sampled": 38910, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 21.156000000000006, "episode_reward_min": 10.069, "episode_reward_mean": 11.975060000000003, "episode_len_mean": 43.91, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.986, 11.976, 12.394, 12.028, 11.575999999999999, 12.778, 11.093, 11.343, 11.319999999999999, 14.194, 10.373000000000001, 12.383999999999999, 11.972, 12.395, 12.062000000000001, 11.629, 11.305, 11.116, 10.972000000000001, 11.708, 14.164000000000001, 14.604, 12.158000000000001, 13.167, 12.138, 11.690000000000001, 13.815000000000003, 11.924, 11.126, 11.093, 13.323, 10.261, 11.579999999999998, 10.984, 15.620000000000003, 11.811, 12.215, 11.32, 12.408000000000001, 12.236, 11.222999999999999, 10.959000000000001, 11.967, 12.076, 10.069, 11.997, 11.963999999999999, 21.156000000000006, 13.107, 11.184000000000001, 11.593, 12.350000000000001, 13.1, 11.827000000000002, 11.057, 13.658000000000001, 11.952, 10.441, 11.215, 13.854, 13.044, 10.847, 12.013, 10.739999999999998, 11.522, 10.079, 14.882000000000003, 10.885, 11.892, 11.005, 11.587, 11.173, 11.077, 12.533000000000001, 12.112, 11.761, 10.847, 12.036, 12.579, 10.842, 12.301000000000002, 10.974, 10.472999999999999, 11.115, 15.673000000000002, 12.111999999999998, 12.445, 11.568000000000001, 11.597, 11.159999999999998, 12.429999999999998, 10.908999999999999, 12.235, 11.717000000000002, 10.610000000000001, 11.582999999999998, 10.546999999999999, 12.747000000000002, 10.655999999999999, 11.208], "episode_lengths": [40, 47, 40, 43, 42, 51, 40, 36, 33, 56, 39, 42, 48, 54, 47, 42, 40, 43, 38, 42, 55, 57, 47, 47, 43, 40, 60, 43, 35, 39, 48, 39, 41, 39, 63, 44, 43, 42, 47, 44, 36, 36, 46, 45, 41, 41, 39, 141, 54, 39, 39, 45, 45, 43, 38, 46, 43, 37, 42, 46, 50, 36, 41, 35, 42, 38, 63, 40, 40, 40, 38, 40, 39, 44, 54, 39, 36, 44, 46, 36, 42, 38, 39, 41, 61, 40, 43, 39, 40, 37, 41, 33, 43, 41, 41, 41, 37, 45, 38, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5369244120885693, "mean_inference_ms": 1.2785107787487848, "mean_action_processing_ms": 0.08686843156503883, "mean_env_wait_ms": 5.217596653833043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034143924713134766, "ViewRequirementAgentConnector_ms": 0.23910140991210938}}, "episode_reward_max": 21.156000000000006, "episode_reward_min": 10.069, "episode_reward_mean": 11.975060000000003, "episode_len_mean": 43.91, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.986, 11.976, 12.394, 12.028, 11.575999999999999, 12.778, 11.093, 11.343, 11.319999999999999, 14.194, 10.373000000000001, 12.383999999999999, 11.972, 12.395, 12.062000000000001, 11.629, 11.305, 11.116, 10.972000000000001, 11.708, 14.164000000000001, 14.604, 12.158000000000001, 13.167, 12.138, 11.690000000000001, 13.815000000000003, 11.924, 11.126, 11.093, 13.323, 10.261, 11.579999999999998, 10.984, 15.620000000000003, 11.811, 12.215, 11.32, 12.408000000000001, 12.236, 11.222999999999999, 10.959000000000001, 11.967, 12.076, 10.069, 11.997, 11.963999999999999, 21.156000000000006, 13.107, 11.184000000000001, 11.593, 12.350000000000001, 13.1, 11.827000000000002, 11.057, 13.658000000000001, 11.952, 10.441, 11.215, 13.854, 13.044, 10.847, 12.013, 10.739999999999998, 11.522, 10.079, 14.882000000000003, 10.885, 11.892, 11.005, 11.587, 11.173, 11.077, 12.533000000000001, 12.112, 11.761, 10.847, 12.036, 12.579, 10.842, 12.301000000000002, 10.974, 10.472999999999999, 11.115, 15.673000000000002, 12.111999999999998, 12.445, 11.568000000000001, 11.597, 11.159999999999998, 12.429999999999998, 10.908999999999999, 12.235, 11.717000000000002, 10.610000000000001, 11.582999999999998, 10.546999999999999, 12.747000000000002, 10.655999999999999, 11.208], "episode_lengths": [40, 47, 40, 43, 42, 51, 40, 36, 33, 56, 39, 42, 48, 54, 47, 42, 40, 43, 38, 42, 55, 57, 47, 47, 43, 40, 60, 43, 35, 39, 48, 39, 41, 39, 63, 44, 43, 42, 47, 44, 36, 36, 46, 45, 41, 41, 39, 141, 54, 39, 39, 45, 45, 43, 38, 46, 43, 37, 42, 46, 50, 36, 41, 35, 42, 38, 63, 40, 40, 40, 38, 40, 39, 44, 54, 39, 36, 44, 46, 36, 42, 38, 39, 41, 61, 40, 43, 39, 40, 37, 41, 33, 43, 41, 41, 41, 37, 45, 38, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5369244120885693, "mean_inference_ms": 1.2785107787487848, "mean_action_processing_ms": 0.08686843156503883, "mean_env_wait_ms": 5.217596653833043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034143924713134766, "ViewRequirementAgentConnector_ms": 0.23910140991210938}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38910, "num_agent_steps_trained": 0, "num_env_steps_sampled": 38912, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.77440943391599, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 38912, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 38910, "timers": {"training_iteration_time_ms": 153067.596, "sample_time_ms": 6961.461, "synch_weights_time_ms": 50.58}, "counters": {"num_env_steps_sampled": 38912, "num_env_steps_trained": 0, "num_agent_steps_sampled": 38910, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 637, "training_iteration": 38, "trial_id": "default", "date": "2025-12-20_00-15-17", "timestamp": 1766160917, "time_this_iter_s": 151.16003108024597, "time_total_s": 6495.743973493576, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6495.743973493576, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 94.37767441860467, "ram_util_percent": 16.58279069767442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.83294034358114}, "default_policy": {"total_loss": 0.83294034358114, "policy_loss": -0.036159219953697176, "vf_loss": 3.475114946812391, "vf_loss_unclipped": 9.554739064723254, "vf_explained_var": 0.20737698301672935, "entropy": 0.7867983803153038, "mean_kl_loss": 0.011076245151481418, "gradients_default_optimizer_global_norm": 1.5552886631339788, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 39936, "num_env_steps_trained": 0, "num_agent_steps_sampled": 39934, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 21.156000000000006, "episode_reward_min": 10.069, "episode_reward_mean": 11.809219999999998, "episode_len_mean": 42.92, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.690000000000001, 13.815000000000003, 11.924, 11.126, 11.093, 13.323, 10.261, 11.579999999999998, 10.984, 15.620000000000003, 11.811, 12.215, 11.32, 12.408000000000001, 12.236, 11.222999999999999, 10.959000000000001, 11.967, 12.076, 10.069, 11.997, 11.963999999999999, 21.156000000000006, 13.107, 11.184000000000001, 11.593, 12.350000000000001, 13.1, 11.827000000000002, 11.057, 13.658000000000001, 11.952, 10.441, 11.215, 13.854, 13.044, 10.847, 12.013, 10.739999999999998, 11.522, 10.079, 14.882000000000003, 10.885, 11.892, 11.005, 11.587, 11.173, 11.077, 12.533000000000001, 12.112, 11.761, 10.847, 12.036, 12.579, 10.842, 12.301000000000002, 10.974, 10.472999999999999, 11.115, 15.673000000000002, 12.111999999999998, 12.445, 11.568000000000001, 11.597, 11.159999999999998, 12.429999999999998, 10.908999999999999, 12.235, 11.717000000000002, 10.610000000000001, 11.582999999999998, 10.546999999999999, 12.747000000000002, 10.655999999999999, 11.208, 10.817999999999998, 10.364, 10.667, 11.375, 10.742, 10.841000000000001, 11.814, 12.035, 11.156, 11.231, 11.469000000000001, 12.276, 11.053, 13.067, 10.936, 12.534, 11.152000000000001, 12.63, 11.784, 12.318999999999999, 11.518, 11.106000000000002, 10.165000000000001, 11.302, 10.897], "episode_lengths": [40, 60, 43, 35, 39, 48, 39, 41, 39, 63, 44, 43, 42, 47, 44, 36, 36, 46, 45, 41, 41, 39, 141, 54, 39, 39, 45, 45, 43, 38, 46, 43, 37, 42, 46, 50, 36, 41, 35, 42, 38, 63, 40, 40, 40, 38, 40, 39, 44, 54, 39, 36, 44, 46, 36, 42, 38, 39, 41, 61, 40, 43, 39, 40, 37, 41, 33, 43, 41, 41, 41, 37, 45, 38, 49, 35, 42, 41, 38, 35, 36, 41, 43, 36, 45, 39, 48, 39, 45, 38, 43, 36, 44, 48, 41, 42, 41, 37, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5379484984631411, "mean_inference_ms": 1.2765824818683686, "mean_action_processing_ms": 0.08676585860980715, "mean_env_wait_ms": 5.212096042802684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003404855728149414, "ViewRequirementAgentConnector_ms": 0.23865723609924316}}, "episode_reward_max": 21.156000000000006, "episode_reward_min": 10.069, "episode_reward_mean": 11.809219999999998, "episode_len_mean": 42.92, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.690000000000001, 13.815000000000003, 11.924, 11.126, 11.093, 13.323, 10.261, 11.579999999999998, 10.984, 15.620000000000003, 11.811, 12.215, 11.32, 12.408000000000001, 12.236, 11.222999999999999, 10.959000000000001, 11.967, 12.076, 10.069, 11.997, 11.963999999999999, 21.156000000000006, 13.107, 11.184000000000001, 11.593, 12.350000000000001, 13.1, 11.827000000000002, 11.057, 13.658000000000001, 11.952, 10.441, 11.215, 13.854, 13.044, 10.847, 12.013, 10.739999999999998, 11.522, 10.079, 14.882000000000003, 10.885, 11.892, 11.005, 11.587, 11.173, 11.077, 12.533000000000001, 12.112, 11.761, 10.847, 12.036, 12.579, 10.842, 12.301000000000002, 10.974, 10.472999999999999, 11.115, 15.673000000000002, 12.111999999999998, 12.445, 11.568000000000001, 11.597, 11.159999999999998, 12.429999999999998, 10.908999999999999, 12.235, 11.717000000000002, 10.610000000000001, 11.582999999999998, 10.546999999999999, 12.747000000000002, 10.655999999999999, 11.208, 10.817999999999998, 10.364, 10.667, 11.375, 10.742, 10.841000000000001, 11.814, 12.035, 11.156, 11.231, 11.469000000000001, 12.276, 11.053, 13.067, 10.936, 12.534, 11.152000000000001, 12.63, 11.784, 12.318999999999999, 11.518, 11.106000000000002, 10.165000000000001, 11.302, 10.897], "episode_lengths": [40, 60, 43, 35, 39, 48, 39, 41, 39, 63, 44, 43, 42, 47, 44, 36, 36, 46, 45, 41, 41, 39, 141, 54, 39, 39, 45, 45, 43, 38, 46, 43, 37, 42, 46, 50, 36, 41, 35, 42, 38, 63, 40, 40, 40, 38, 40, 39, 44, 54, 39, 36, 44, 46, 36, 42, 38, 39, 41, 61, 40, 43, 39, 40, 37, 41, 33, 43, 41, 41, 41, 37, 45, 38, 49, 35, 42, 41, 38, 35, 36, 41, 43, 36, 45, 39, 48, 39, 45, 38, 43, 36, 44, 48, 41, 42, 41, 37, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5379484984631411, "mean_inference_ms": 1.2765824818683686, "mean_action_processing_ms": 0.08676585860980715, "mean_env_wait_ms": 5.212096042802684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003404855728149414, "ViewRequirementAgentConnector_ms": 0.23865723609924316}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39934, "num_agent_steps_trained": 0, "num_env_steps_sampled": 39936, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.783619413404038, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 39936, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 39934, "timers": {"training_iteration_time_ms": 152871.116, "sample_time_ms": 6958.479, "synch_weights_time_ms": 50.767}, "counters": {"num_env_steps_sampled": 39936, "num_env_steps_trained": 0, "num_agent_steps_sampled": 39934, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 662, "training_iteration": 39, "trial_id": "default", "date": "2025-12-20_00-17-48", "timestamp": 1766161068, "time_this_iter_s": 150.9549264907837, "time_total_s": 6646.69889998436, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6646.69889998436, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 94.83860465116281, "ram_util_percent": 17.408837209302327}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7631849721074104}, "default_policy": {"total_loss": 0.7631849721074104, "policy_loss": -0.03400897019309923, "vf_loss": 3.1881202049553394, "vf_loss_unclipped": 10.360416200384497, "vf_explained_var": 0.001867324858903885, "entropy": 0.8175705887377263, "mean_kl_loss": 0.009814716642640064, "gradients_default_optimizer_global_norm": 1.7139122303575278, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40958, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 23.81500000000001, "episode_reward_min": 10.079, "episode_reward_mean": 11.9586, "episode_len_mean": 44.06, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.963999999999999, 21.156000000000006, 13.107, 11.184000000000001, 11.593, 12.350000000000001, 13.1, 11.827000000000002, 11.057, 13.658000000000001, 11.952, 10.441, 11.215, 13.854, 13.044, 10.847, 12.013, 10.739999999999998, 11.522, 10.079, 14.882000000000003, 10.885, 11.892, 11.005, 11.587, 11.173, 11.077, 12.533000000000001, 12.112, 11.761, 10.847, 12.036, 12.579, 10.842, 12.301000000000002, 10.974, 10.472999999999999, 11.115, 15.673000000000002, 12.111999999999998, 12.445, 11.568000000000001, 11.597, 11.159999999999998, 12.429999999999998, 10.908999999999999, 12.235, 11.717000000000002, 10.610000000000001, 11.582999999999998, 10.546999999999999, 12.747000000000002, 10.655999999999999, 11.208, 10.817999999999998, 10.364, 10.667, 11.375, 10.742, 10.841000000000001, 11.814, 12.035, 11.156, 11.231, 11.469000000000001, 12.276, 11.053, 13.067, 10.936, 12.534, 11.152000000000001, 12.63, 11.784, 12.318999999999999, 11.518, 11.106000000000002, 10.165000000000001, 11.302, 10.897, 10.771, 15.081000000000001, 11.685, 10.501, 11.147000000000002, 11.007, 10.722000000000001, 15.638000000000005, 11.406, 12.797, 14.350000000000001, 14.368, 10.715, 10.883, 12.953000000000001, 10.852, 23.81500000000001, 11.177000000000001, 12.22, 11.271999999999998, 11.274999999999999], "episode_lengths": [39, 141, 54, 39, 39, 45, 45, 43, 38, 46, 43, 37, 42, 46, 50, 36, 41, 35, 42, 38, 63, 40, 40, 40, 38, 40, 39, 44, 54, 39, 36, 44, 46, 36, 42, 38, 39, 41, 61, 40, 43, 39, 40, 37, 41, 33, 43, 41, 41, 41, 37, 45, 38, 49, 35, 42, 41, 38, 35, 36, 41, 43, 36, 45, 39, 48, 39, 45, 38, 43, 36, 44, 48, 41, 42, 41, 37, 40, 40, 39, 55, 48, 32, 37, 42, 34, 61, 41, 49, 54, 57, 42, 39, 44, 36, 159, 38, 43, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5386351005527362, "mean_inference_ms": 1.274792272376607, "mean_action_processing_ms": 0.0866678457657677, "mean_env_wait_ms": 5.207350029966384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003413677215576172, "ViewRequirementAgentConnector_ms": 0.23897886276245117}}, "episode_reward_max": 23.81500000000001, "episode_reward_min": 10.079, "episode_reward_mean": 11.9586, "episode_len_mean": 44.06, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.963999999999999, 21.156000000000006, 13.107, 11.184000000000001, 11.593, 12.350000000000001, 13.1, 11.827000000000002, 11.057, 13.658000000000001, 11.952, 10.441, 11.215, 13.854, 13.044, 10.847, 12.013, 10.739999999999998, 11.522, 10.079, 14.882000000000003, 10.885, 11.892, 11.005, 11.587, 11.173, 11.077, 12.533000000000001, 12.112, 11.761, 10.847, 12.036, 12.579, 10.842, 12.301000000000002, 10.974, 10.472999999999999, 11.115, 15.673000000000002, 12.111999999999998, 12.445, 11.568000000000001, 11.597, 11.159999999999998, 12.429999999999998, 10.908999999999999, 12.235, 11.717000000000002, 10.610000000000001, 11.582999999999998, 10.546999999999999, 12.747000000000002, 10.655999999999999, 11.208, 10.817999999999998, 10.364, 10.667, 11.375, 10.742, 10.841000000000001, 11.814, 12.035, 11.156, 11.231, 11.469000000000001, 12.276, 11.053, 13.067, 10.936, 12.534, 11.152000000000001, 12.63, 11.784, 12.318999999999999, 11.518, 11.106000000000002, 10.165000000000001, 11.302, 10.897, 10.771, 15.081000000000001, 11.685, 10.501, 11.147000000000002, 11.007, 10.722000000000001, 15.638000000000005, 11.406, 12.797, 14.350000000000001, 14.368, 10.715, 10.883, 12.953000000000001, 10.852, 23.81500000000001, 11.177000000000001, 12.22, 11.271999999999998, 11.274999999999999], "episode_lengths": [39, 141, 54, 39, 39, 45, 45, 43, 38, 46, 43, 37, 42, 46, 50, 36, 41, 35, 42, 38, 63, 40, 40, 40, 38, 40, 39, 44, 54, 39, 36, 44, 46, 36, 42, 38, 39, 41, 61, 40, 43, 39, 40, 37, 41, 33, 43, 41, 41, 41, 37, 45, 38, 49, 35, 42, 41, 38, 35, 36, 41, 43, 36, 45, 39, 48, 39, 45, 38, 43, 36, 44, 48, 41, 42, 41, 37, 40, 40, 39, 55, 48, 32, 37, 42, 34, 61, 41, 49, 54, 57, 42, 39, 44, 36, 159, 38, 43, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5386351005527362, "mean_inference_ms": 1.274792272376607, "mean_action_processing_ms": 0.0866678457657677, "mean_env_wait_ms": 5.207350029966384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003413677215576172, "ViewRequirementAgentConnector_ms": 0.23897886276245117}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40958, "num_agent_steps_trained": 0, "num_env_steps_sampled": 40960, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.775398772286185, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 40960, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 40958, "timers": {"training_iteration_time_ms": 152330.34, "sample_time_ms": 6949.046, "synch_weights_time_ms": 50.719}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40958, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 683, "training_iteration": 40, "trial_id": "default", "date": "2025-12-20_00-20-19", "timestamp": 1766161219, "time_this_iter_s": 151.14074778556824, "time_total_s": 6797.839647769928, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6797.839647769928, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 94.94790697674416, "ram_util_percent": 16.334883720930232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8619366455823183}, "default_policy": {"total_loss": 0.8619366455823183, "policy_loss": -0.03460007127723656, "vf_loss": 3.5849261090159414, "vf_loss_unclipped": 11.907509082555771, "vf_explained_var": 0.19193919375538826, "entropy": 0.7210356425493956, "mean_kl_loss": 0.010262261376778525, "gradients_default_optimizer_global_norm": 1.2982071749866009, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 41984, "num_env_steps_trained": 0, "num_agent_steps_sampled": 41982, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 23.81500000000001, "episode_reward_min": 10.165000000000001, "episode_reward_mean": 11.78829, "episode_len_mean": 43.06, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.587, 11.173, 11.077, 12.533000000000001, 12.112, 11.761, 10.847, 12.036, 12.579, 10.842, 12.301000000000002, 10.974, 10.472999999999999, 11.115, 15.673000000000002, 12.111999999999998, 12.445, 11.568000000000001, 11.597, 11.159999999999998, 12.429999999999998, 10.908999999999999, 12.235, 11.717000000000002, 10.610000000000001, 11.582999999999998, 10.546999999999999, 12.747000000000002, 10.655999999999999, 11.208, 10.817999999999998, 10.364, 10.667, 11.375, 10.742, 10.841000000000001, 11.814, 12.035, 11.156, 11.231, 11.469000000000001, 12.276, 11.053, 13.067, 10.936, 12.534, 11.152000000000001, 12.63, 11.784, 12.318999999999999, 11.518, 11.106000000000002, 10.165000000000001, 11.302, 10.897, 10.771, 15.081000000000001, 11.685, 10.501, 11.147000000000002, 11.007, 10.722000000000001, 15.638000000000005, 11.406, 12.797, 14.350000000000001, 14.368, 10.715, 10.883, 12.953000000000001, 10.852, 23.81500000000001, 11.177000000000001, 12.22, 11.271999999999998, 11.274999999999999, 10.443, 11.095, 10.761, 10.691, 12.086, 11.509, 10.448, 10.985, 11.908999999999999, 11.659, 10.352, 15.208000000000004, 10.732999999999999, 12.673000000000002, 14.974000000000004, 10.45, 11.488999999999999, 10.49, 11.779, 11.059999999999999, 10.781999999999998, 12.974, 11.966999999999999, 11.819], "episode_lengths": [38, 40, 39, 44, 54, 39, 36, 44, 46, 36, 42, 38, 39, 41, 61, 40, 43, 39, 40, 37, 41, 33, 43, 41, 41, 41, 37, 45, 38, 49, 35, 42, 41, 38, 35, 36, 41, 43, 36, 45, 39, 48, 39, 45, 38, 43, 36, 44, 48, 41, 42, 41, 37, 40, 40, 39, 55, 48, 32, 37, 42, 34, 61, 41, 49, 54, 57, 42, 39, 44, 36, 159, 38, 43, 38, 38, 36, 40, 39, 42, 42, 42, 36, 39, 40, 47, 37, 77, 36, 48, 57, 39, 39, 33, 40, 39, 42, 46, 45, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392178687003885, "mean_inference_ms": 1.2725785640485794, "mean_action_processing_ms": 0.08654446780170975, "mean_env_wait_ms": 5.2020169309757645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003417491912841797, "ViewRequirementAgentConnector_ms": 0.23900890350341797}}, "episode_reward_max": 23.81500000000001, "episode_reward_min": 10.165000000000001, "episode_reward_mean": 11.78829, "episode_len_mean": 43.06, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.587, 11.173, 11.077, 12.533000000000001, 12.112, 11.761, 10.847, 12.036, 12.579, 10.842, 12.301000000000002, 10.974, 10.472999999999999, 11.115, 15.673000000000002, 12.111999999999998, 12.445, 11.568000000000001, 11.597, 11.159999999999998, 12.429999999999998, 10.908999999999999, 12.235, 11.717000000000002, 10.610000000000001, 11.582999999999998, 10.546999999999999, 12.747000000000002, 10.655999999999999, 11.208, 10.817999999999998, 10.364, 10.667, 11.375, 10.742, 10.841000000000001, 11.814, 12.035, 11.156, 11.231, 11.469000000000001, 12.276, 11.053, 13.067, 10.936, 12.534, 11.152000000000001, 12.63, 11.784, 12.318999999999999, 11.518, 11.106000000000002, 10.165000000000001, 11.302, 10.897, 10.771, 15.081000000000001, 11.685, 10.501, 11.147000000000002, 11.007, 10.722000000000001, 15.638000000000005, 11.406, 12.797, 14.350000000000001, 14.368, 10.715, 10.883, 12.953000000000001, 10.852, 23.81500000000001, 11.177000000000001, 12.22, 11.271999999999998, 11.274999999999999, 10.443, 11.095, 10.761, 10.691, 12.086, 11.509, 10.448, 10.985, 11.908999999999999, 11.659, 10.352, 15.208000000000004, 10.732999999999999, 12.673000000000002, 14.974000000000004, 10.45, 11.488999999999999, 10.49, 11.779, 11.059999999999999, 10.781999999999998, 12.974, 11.966999999999999, 11.819], "episode_lengths": [38, 40, 39, 44, 54, 39, 36, 44, 46, 36, 42, 38, 39, 41, 61, 40, 43, 39, 40, 37, 41, 33, 43, 41, 41, 41, 37, 45, 38, 49, 35, 42, 41, 38, 35, 36, 41, 43, 36, 45, 39, 48, 39, 45, 38, 43, 36, 44, 48, 41, 42, 41, 37, 40, 40, 39, 55, 48, 32, 37, 42, 34, 61, 41, 49, 54, 57, 42, 39, 44, 36, 159, 38, 43, 38, 38, 36, 40, 39, 42, 42, 42, 36, 39, 40, 47, 37, 77, 36, 48, 57, 39, 39, 33, 40, 39, 42, 46, 45, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392178687003885, "mean_inference_ms": 1.2725785640485794, "mean_action_processing_ms": 0.08654446780170975, "mean_env_wait_ms": 5.2020169309757645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003417491912841797, "ViewRequirementAgentConnector_ms": 0.23900890350341797}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41982, "num_agent_steps_trained": 0, "num_env_steps_sampled": 41984, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.815202119885158, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 41984, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 41982, "timers": {"training_iteration_time_ms": 151981.537, "sample_time_ms": 6945.278, "synch_weights_time_ms": 50.339}, "counters": {"num_env_steps_sampled": 41984, "num_env_steps_trained": 0, "num_agent_steps_sampled": 41982, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 707, "training_iteration": 41, "trial_id": "default", "date": "2025-12-20_00-22-49", "timestamp": 1766161369, "time_this_iter_s": 150.25548458099365, "time_total_s": 6948.095132350922, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6948.095132350922, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 94.91355140186914, "ram_util_percent": 16.28271028037383}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7739764543544879}, "default_policy": {"total_loss": 0.7739764543544879, "policy_loss": -0.037140580726554615, "vf_loss": 3.2435237027704718, "vf_loss_unclipped": 10.705581896007061, "vf_explained_var": 0.15528465509414674, "entropy": 0.7459595486521721, "mean_kl_loss": 0.009820637454865278, "gradients_default_optimizer_global_norm": 1.5901490461081267, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 0, "num_agent_steps_sampled": 43006, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 23.81500000000001, "episode_reward_min": 10.165000000000001, "episode_reward_mean": 11.881350000000005, "episode_len_mean": 44.53, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.908999999999999, 12.235, 11.717000000000002, 10.610000000000001, 11.582999999999998, 10.546999999999999, 12.747000000000002, 10.655999999999999, 11.208, 10.817999999999998, 10.364, 10.667, 11.375, 10.742, 10.841000000000001, 11.814, 12.035, 11.156, 11.231, 11.469000000000001, 12.276, 11.053, 13.067, 10.936, 12.534, 11.152000000000001, 12.63, 11.784, 12.318999999999999, 11.518, 11.106000000000002, 10.165000000000001, 11.302, 10.897, 10.771, 15.081000000000001, 11.685, 10.501, 11.147000000000002, 11.007, 10.722000000000001, 15.638000000000005, 11.406, 12.797, 14.350000000000001, 14.368, 10.715, 10.883, 12.953000000000001, 10.852, 23.81500000000001, 11.177000000000001, 12.22, 11.271999999999998, 11.274999999999999, 10.443, 11.095, 10.761, 10.691, 12.086, 11.509, 10.448, 10.985, 11.908999999999999, 11.659, 10.352, 15.208000000000004, 10.732999999999999, 12.673000000000002, 14.974000000000004, 10.45, 11.488999999999999, 10.49, 11.779, 11.059999999999999, 10.781999999999998, 12.974, 11.966999999999999, 11.819, 11.844000000000001, 11.358, 11.485, 12.434, 14.469, 12.688, 10.763, 12.54, 11.102, 10.737, 13.212, 19.329000000000004, 11.838000000000001, 12.847999999999999, 11.782, 13.098000000000003, 11.163, 11.296, 10.614, 11.528, 11.573], "episode_lengths": [33, 43, 41, 41, 41, 37, 45, 38, 49, 35, 42, 41, 38, 35, 36, 41, 43, 36, 45, 39, 48, 39, 45, 38, 43, 36, 44, 48, 41, 42, 41, 37, 40, 40, 39, 55, 48, 32, 37, 42, 34, 61, 41, 49, 54, 57, 42, 39, 44, 36, 159, 38, 43, 38, 38, 36, 40, 39, 42, 42, 42, 36, 39, 40, 47, 37, 77, 36, 48, 57, 39, 39, 33, 40, 39, 42, 46, 45, 41, 43, 47, 41, 44, 82, 51, 37, 45, 43, 36, 52, 117, 45, 46, 39, 48, 38, 41, 46, 43, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392432289076692, "mean_inference_ms": 1.2699438286429112, "mean_action_processing_ms": 0.0863929021249733, "mean_env_wait_ms": 5.194894649909013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033180713653564453, "ViewRequirementAgentConnector_ms": 0.23386478424072266}}, "episode_reward_max": 23.81500000000001, "episode_reward_min": 10.165000000000001, "episode_reward_mean": 11.881350000000005, "episode_len_mean": 44.53, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.908999999999999, 12.235, 11.717000000000002, 10.610000000000001, 11.582999999999998, 10.546999999999999, 12.747000000000002, 10.655999999999999, 11.208, 10.817999999999998, 10.364, 10.667, 11.375, 10.742, 10.841000000000001, 11.814, 12.035, 11.156, 11.231, 11.469000000000001, 12.276, 11.053, 13.067, 10.936, 12.534, 11.152000000000001, 12.63, 11.784, 12.318999999999999, 11.518, 11.106000000000002, 10.165000000000001, 11.302, 10.897, 10.771, 15.081000000000001, 11.685, 10.501, 11.147000000000002, 11.007, 10.722000000000001, 15.638000000000005, 11.406, 12.797, 14.350000000000001, 14.368, 10.715, 10.883, 12.953000000000001, 10.852, 23.81500000000001, 11.177000000000001, 12.22, 11.271999999999998, 11.274999999999999, 10.443, 11.095, 10.761, 10.691, 12.086, 11.509, 10.448, 10.985, 11.908999999999999, 11.659, 10.352, 15.208000000000004, 10.732999999999999, 12.673000000000002, 14.974000000000004, 10.45, 11.488999999999999, 10.49, 11.779, 11.059999999999999, 10.781999999999998, 12.974, 11.966999999999999, 11.819, 11.844000000000001, 11.358, 11.485, 12.434, 14.469, 12.688, 10.763, 12.54, 11.102, 10.737, 13.212, 19.329000000000004, 11.838000000000001, 12.847999999999999, 11.782, 13.098000000000003, 11.163, 11.296, 10.614, 11.528, 11.573], "episode_lengths": [33, 43, 41, 41, 41, 37, 45, 38, 49, 35, 42, 41, 38, 35, 36, 41, 43, 36, 45, 39, 48, 39, 45, 38, 43, 36, 44, 48, 41, 42, 41, 37, 40, 40, 39, 55, 48, 32, 37, 42, 34, 61, 41, 49, 54, 57, 42, 39, 44, 36, 159, 38, 43, 38, 38, 36, 40, 39, 42, 42, 42, 36, 39, 40, 47, 37, 77, 36, 48, 57, 39, 39, 33, 40, 39, 42, 46, 45, 41, 43, 47, 41, 44, 82, 51, 37, 45, 43, 36, 52, 117, 45, 46, 39, 48, 38, 41, 46, 43, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392432289076692, "mean_inference_ms": 1.2699438286429112, "mean_action_processing_ms": 0.0863929021249733, "mean_env_wait_ms": 5.194894649909013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033180713653564453, "ViewRequirementAgentConnector_ms": 0.23386478424072266}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43006, "num_agent_steps_trained": 0, "num_env_steps_sampled": 43008, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.775789773966783, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 43008, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 43006, "timers": {"training_iteration_time_ms": 151763.278, "sample_time_ms": 6938.747, "synch_weights_time_ms": 51.139}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 0, "num_agent_steps_sampled": 43006, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 728, "training_iteration": 42, "trial_id": "default", "date": "2025-12-20_00-25-28", "timestamp": 1766161528, "time_this_iter_s": 151.1321201324463, "time_total_s": 7099.227252483368, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7099.227252483368, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 90.69422222222222, "ram_util_percent": 16.11111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7863940894603729}, "default_policy": {"total_loss": 0.7863940894603729, "policy_loss": -0.034165108716115354, "vf_loss": 3.2803928211331366, "vf_loss_unclipped": 11.184924933314324, "vf_explained_var": 0.004337690398097038, "entropy": 0.700742319598794, "mean_kl_loss": 0.01161733076872552, "gradients_default_optimizer_global_norm": 1.337585774809122, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 44032, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44030, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 23.81500000000001, "episode_reward_min": 10.033, "episode_reward_mean": 11.94916, "episode_len_mean": 44.96, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.534, 11.152000000000001, 12.63, 11.784, 12.318999999999999, 11.518, 11.106000000000002, 10.165000000000001, 11.302, 10.897, 10.771, 15.081000000000001, 11.685, 10.501, 11.147000000000002, 11.007, 10.722000000000001, 15.638000000000005, 11.406, 12.797, 14.350000000000001, 14.368, 10.715, 10.883, 12.953000000000001, 10.852, 23.81500000000001, 11.177000000000001, 12.22, 11.271999999999998, 11.274999999999999, 10.443, 11.095, 10.761, 10.691, 12.086, 11.509, 10.448, 10.985, 11.908999999999999, 11.659, 10.352, 15.208000000000004, 10.732999999999999, 12.673000000000002, 14.974000000000004, 10.45, 11.488999999999999, 10.49, 11.779, 11.059999999999999, 10.781999999999998, 12.974, 11.966999999999999, 11.819, 11.844000000000001, 11.358, 11.485, 12.434, 14.469, 12.688, 10.763, 12.54, 11.102, 10.737, 13.212, 19.329000000000004, 11.838000000000001, 12.847999999999999, 11.782, 13.098000000000003, 11.163, 11.296, 10.614, 11.528, 11.573, 11.065, 10.043, 12.433000000000002, 11.219000000000001, 12.125, 11.009999999999998, 11.421, 11.304, 12.469000000000001, 10.288, 11.703000000000001, 10.868, 12.401, 12.454, 12.843, 12.368, 13.532, 10.824, 13.476999999999999, 10.341999999999999, 13.158000000000001, 10.033, 11.065, 10.392000000000001], "episode_lengths": [43, 36, 44, 48, 41, 42, 41, 37, 40, 40, 39, 55, 48, 32, 37, 42, 34, 61, 41, 49, 54, 57, 42, 39, 44, 36, 159, 38, 43, 38, 38, 36, 40, 39, 42, 42, 42, 36, 39, 40, 47, 37, 77, 36, 48, 57, 39, 39, 33, 40, 39, 42, 46, 45, 41, 43, 47, 41, 44, 82, 51, 37, 45, 43, 36, 52, 117, 45, 46, 39, 48, 38, 41, 46, 43, 40, 38, 36, 42, 42, 43, 44, 43, 40, 46, 41, 41, 38, 41, 45, 44, 45, 52, 35, 47, 36, 58, 36, 38, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5391557705317597, "mean_inference_ms": 1.266863900086593, "mean_action_processing_ms": 0.08621149885424441, "mean_env_wait_ms": 5.18612037164834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003287792205810547, "ViewRequirementAgentConnector_ms": 0.2319633960723877}}, "episode_reward_max": 23.81500000000001, "episode_reward_min": 10.033, "episode_reward_mean": 11.94916, "episode_len_mean": 44.96, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.534, 11.152000000000001, 12.63, 11.784, 12.318999999999999, 11.518, 11.106000000000002, 10.165000000000001, 11.302, 10.897, 10.771, 15.081000000000001, 11.685, 10.501, 11.147000000000002, 11.007, 10.722000000000001, 15.638000000000005, 11.406, 12.797, 14.350000000000001, 14.368, 10.715, 10.883, 12.953000000000001, 10.852, 23.81500000000001, 11.177000000000001, 12.22, 11.271999999999998, 11.274999999999999, 10.443, 11.095, 10.761, 10.691, 12.086, 11.509, 10.448, 10.985, 11.908999999999999, 11.659, 10.352, 15.208000000000004, 10.732999999999999, 12.673000000000002, 14.974000000000004, 10.45, 11.488999999999999, 10.49, 11.779, 11.059999999999999, 10.781999999999998, 12.974, 11.966999999999999, 11.819, 11.844000000000001, 11.358, 11.485, 12.434, 14.469, 12.688, 10.763, 12.54, 11.102, 10.737, 13.212, 19.329000000000004, 11.838000000000001, 12.847999999999999, 11.782, 13.098000000000003, 11.163, 11.296, 10.614, 11.528, 11.573, 11.065, 10.043, 12.433000000000002, 11.219000000000001, 12.125, 11.009999999999998, 11.421, 11.304, 12.469000000000001, 10.288, 11.703000000000001, 10.868, 12.401, 12.454, 12.843, 12.368, 13.532, 10.824, 13.476999999999999, 10.341999999999999, 13.158000000000001, 10.033, 11.065, 10.392000000000001], "episode_lengths": [43, 36, 44, 48, 41, 42, 41, 37, 40, 40, 39, 55, 48, 32, 37, 42, 34, 61, 41, 49, 54, 57, 42, 39, 44, 36, 159, 38, 43, 38, 38, 36, 40, 39, 42, 42, 42, 36, 39, 40, 47, 37, 77, 36, 48, 57, 39, 39, 33, 40, 39, 42, 46, 45, 41, 43, 47, 41, 44, 82, 51, 37, 45, 43, 36, 52, 117, 45, 46, 39, 48, 38, 41, 46, 43, 40, 38, 36, 42, 42, 43, 44, 43, 40, 46, 41, 41, 38, 41, 45, 44, 45, 52, 35, 47, 36, 58, 36, 38, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5391557705317597, "mean_inference_ms": 1.266863900086593, "mean_action_processing_ms": 0.08621149885424441, "mean_env_wait_ms": 5.18612037164834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003287792205810547, "ViewRequirementAgentConnector_ms": 0.2319633960723877}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44030, "num_agent_steps_trained": 0, "num_env_steps_sampled": 44032, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.829447671075179, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 44032, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 44030, "timers": {"training_iteration_time_ms": 151328.986, "sample_time_ms": 6942.324, "synch_weights_time_ms": 49.958}, "counters": {"num_env_steps_sampled": 44032, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44030, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 752, "training_iteration": 43, "trial_id": "default", "date": "2025-12-20_00-27-58", "timestamp": 1766161678, "time_this_iter_s": 149.94178414344788, "time_total_s": 7249.169036626816, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7249.169036626816, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 94.76666666666668, "ram_util_percent": 16.285915492957745}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8165497239679098}, "default_policy": {"total_loss": 0.8165497239679098, "policy_loss": -0.03517926223576069, "vf_loss": 3.4064153864979745, "vf_loss_unclipped": 11.408068105578423, "vf_explained_var": 0.06756401658058167, "entropy": 0.6536874650046229, "mean_kl_loss": 0.007788170469027023, "gradients_default_optimizer_global_norm": 1.2834358936175705, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 45056, "num_env_steps_trained": 0, "num_agent_steps_sampled": 45054, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 23.81500000000001, "episode_reward_min": 9.793999999999999, "episode_reward_mean": 11.806980000000001, "episode_len_mean": 44.2, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.81500000000001, 11.177000000000001, 12.22, 11.271999999999998, 11.274999999999999, 10.443, 11.095, 10.761, 10.691, 12.086, 11.509, 10.448, 10.985, 11.908999999999999, 11.659, 10.352, 15.208000000000004, 10.732999999999999, 12.673000000000002, 14.974000000000004, 10.45, 11.488999999999999, 10.49, 11.779, 11.059999999999999, 10.781999999999998, 12.974, 11.966999999999999, 11.819, 11.844000000000001, 11.358, 11.485, 12.434, 14.469, 12.688, 10.763, 12.54, 11.102, 10.737, 13.212, 19.329000000000004, 11.838000000000001, 12.847999999999999, 11.782, 13.098000000000003, 11.163, 11.296, 10.614, 11.528, 11.573, 11.065, 10.043, 12.433000000000002, 11.219000000000001, 12.125, 11.009999999999998, 11.421, 11.304, 12.469000000000001, 10.288, 11.703000000000001, 10.868, 12.401, 12.454, 12.843, 12.368, 13.532, 10.824, 13.476999999999999, 10.341999999999999, 13.158000000000001, 10.033, 11.065, 10.392000000000001, 9.811, 9.793999999999999, 11.389, 11.483999999999998, 11.693, 11.715000000000002, 10.744, 10.86, 12.215, 11.92, 11.414000000000001, 11.383000000000001, 12.983, 11.937, 12.094, 11.370999999999999, 11.155, 11.296, 13.592, 10.545, 10.786, 10.987, 12.093, 11.267999999999999, 10.356, 11.18], "episode_lengths": [159, 38, 43, 38, 38, 36, 40, 39, 42, 42, 42, 36, 39, 40, 47, 37, 77, 36, 48, 57, 39, 39, 33, 40, 39, 42, 46, 45, 41, 43, 47, 41, 44, 82, 51, 37, 45, 43, 36, 52, 117, 45, 46, 39, 48, 38, 41, 46, 43, 40, 38, 36, 42, 42, 43, 44, 43, 40, 46, 41, 41, 38, 41, 45, 44, 45, 52, 35, 47, 36, 58, 36, 38, 41, 35, 32, 42, 39, 41, 41, 36, 37, 41, 40, 41, 39, 51, 43, 39, 40, 37, 42, 53, 36, 39, 40, 45, 39, 39, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5396297577400526, "mean_inference_ms": 1.2646576073165188, "mean_action_processing_ms": 0.08608471400571371, "mean_env_wait_ms": 5.1782786861774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032951831817626953, "ViewRequirementAgentConnector_ms": 0.2324388027191162}}, "episode_reward_max": 23.81500000000001, "episode_reward_min": 9.793999999999999, "episode_reward_mean": 11.806980000000001, "episode_len_mean": 44.2, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.81500000000001, 11.177000000000001, 12.22, 11.271999999999998, 11.274999999999999, 10.443, 11.095, 10.761, 10.691, 12.086, 11.509, 10.448, 10.985, 11.908999999999999, 11.659, 10.352, 15.208000000000004, 10.732999999999999, 12.673000000000002, 14.974000000000004, 10.45, 11.488999999999999, 10.49, 11.779, 11.059999999999999, 10.781999999999998, 12.974, 11.966999999999999, 11.819, 11.844000000000001, 11.358, 11.485, 12.434, 14.469, 12.688, 10.763, 12.54, 11.102, 10.737, 13.212, 19.329000000000004, 11.838000000000001, 12.847999999999999, 11.782, 13.098000000000003, 11.163, 11.296, 10.614, 11.528, 11.573, 11.065, 10.043, 12.433000000000002, 11.219000000000001, 12.125, 11.009999999999998, 11.421, 11.304, 12.469000000000001, 10.288, 11.703000000000001, 10.868, 12.401, 12.454, 12.843, 12.368, 13.532, 10.824, 13.476999999999999, 10.341999999999999, 13.158000000000001, 10.033, 11.065, 10.392000000000001, 9.811, 9.793999999999999, 11.389, 11.483999999999998, 11.693, 11.715000000000002, 10.744, 10.86, 12.215, 11.92, 11.414000000000001, 11.383000000000001, 12.983, 11.937, 12.094, 11.370999999999999, 11.155, 11.296, 13.592, 10.545, 10.786, 10.987, 12.093, 11.267999999999999, 10.356, 11.18], "episode_lengths": [159, 38, 43, 38, 38, 36, 40, 39, 42, 42, 42, 36, 39, 40, 47, 37, 77, 36, 48, 57, 39, 39, 33, 40, 39, 42, 46, 45, 41, 43, 47, 41, 44, 82, 51, 37, 45, 43, 36, 52, 117, 45, 46, 39, 48, 38, 41, 46, 43, 40, 38, 36, 42, 42, 43, 44, 43, 40, 46, 41, 41, 38, 41, 45, 44, 45, 52, 35, 47, 36, 58, 36, 38, 41, 35, 32, 42, 39, 41, 41, 36, 37, 41, 40, 41, 39, 51, 43, 39, 40, 37, 42, 53, 36, 39, 40, 45, 39, 39, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5396297577400526, "mean_inference_ms": 1.2646576073165188, "mean_action_processing_ms": 0.08608471400571371, "mean_env_wait_ms": 5.1782786861774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032951831817626953, "ViewRequirementAgentConnector_ms": 0.2324388027191162}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45054, "num_agent_steps_trained": 0, "num_env_steps_sampled": 45056, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.894994706393727, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 45056, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 45054, "timers": {"training_iteration_time_ms": 150881.236, "sample_time_ms": 6931.285, "synch_weights_time_ms": 50.011}, "counters": {"num_env_steps_sampled": 45056, "num_env_steps_trained": 0, "num_agent_steps_sampled": 45054, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 778, "training_iteration": 44, "trial_id": "default", "date": "2025-12-20_00-30-27", "timestamp": 1766161827, "time_this_iter_s": 148.51652836799622, "time_total_s": 7397.685564994812, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7397.685564994812, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 94.84056603773587, "ram_util_percent": 16.164622641509432}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6771938674617559}, "default_policy": {"total_loss": 0.6771938674617559, "policy_loss": -0.031819380732486024, "vf_loss": 2.8340729935094715, "vf_loss_unclipped": 8.168948475830257, "vf_explained_var": 0.2875296246260405, "entropy": 0.7164904799312353, "mean_kl_loss": 0.012114977407067328, "gradients_default_optimizer_global_norm": 1.630841065943241, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 46080, "num_env_steps_trained": 0, "num_agent_steps_sampled": 46078, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 25.695000000000014, "episode_reward_min": 9.793999999999999, "episode_reward_mean": 12.04035, "episode_len_mean": 45.74, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.673000000000002, 14.974000000000004, 10.45, 11.488999999999999, 10.49, 11.779, 11.059999999999999, 10.781999999999998, 12.974, 11.966999999999999, 11.819, 11.844000000000001, 11.358, 11.485, 12.434, 14.469, 12.688, 10.763, 12.54, 11.102, 10.737, 13.212, 19.329000000000004, 11.838000000000001, 12.847999999999999, 11.782, 13.098000000000003, 11.163, 11.296, 10.614, 11.528, 11.573, 11.065, 10.043, 12.433000000000002, 11.219000000000001, 12.125, 11.009999999999998, 11.421, 11.304, 12.469000000000001, 10.288, 11.703000000000001, 10.868, 12.401, 12.454, 12.843, 12.368, 13.532, 10.824, 13.476999999999999, 10.341999999999999, 13.158000000000001, 10.033, 11.065, 10.392000000000001, 9.811, 9.793999999999999, 11.389, 11.483999999999998, 11.693, 11.715000000000002, 10.744, 10.86, 12.215, 11.92, 11.414000000000001, 11.383000000000001, 12.983, 11.937, 12.094, 11.370999999999999, 11.155, 11.296, 13.592, 10.545, 10.786, 10.987, 12.093, 11.267999999999999, 10.356, 11.18, 11.254, 12.474, 19.764999999999993, 25.695000000000014, 13.322000000000001, 15.683000000000002, 11.694, 11.082, 12.767000000000001, 10.668, 13.381, 11.808, 11.065, 12.527000000000001, 12.746, 10.739999999999998, 10.738999999999999, 13.565000000000001], "episode_lengths": [48, 57, 39, 39, 33, 40, 39, 42, 46, 45, 41, 43, 47, 41, 44, 82, 51, 37, 45, 43, 36, 52, 117, 45, 46, 39, 48, 38, 41, 46, 43, 40, 38, 36, 42, 42, 43, 44, 43, 40, 46, 41, 41, 38, 41, 45, 44, 45, 52, 35, 47, 36, 58, 36, 38, 41, 35, 32, 42, 39, 41, 41, 36, 37, 41, 40, 41, 39, 51, 43, 39, 40, 37, 42, 53, 36, 39, 40, 45, 39, 39, 39, 37, 46, 126, 181, 52, 68, 40, 41, 45, 40, 48, 41, 38, 46, 46, 36, 36, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5388130129494654, "mean_inference_ms": 1.2609040212908893, "mean_action_processing_ms": 0.08585074296660773, "mean_env_wait_ms": 5.170134789256204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003282308578491211, "ViewRequirementAgentConnector_ms": 0.2327265739440918}}, "episode_reward_max": 25.695000000000014, "episode_reward_min": 9.793999999999999, "episode_reward_mean": 12.04035, "episode_len_mean": 45.74, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.673000000000002, 14.974000000000004, 10.45, 11.488999999999999, 10.49, 11.779, 11.059999999999999, 10.781999999999998, 12.974, 11.966999999999999, 11.819, 11.844000000000001, 11.358, 11.485, 12.434, 14.469, 12.688, 10.763, 12.54, 11.102, 10.737, 13.212, 19.329000000000004, 11.838000000000001, 12.847999999999999, 11.782, 13.098000000000003, 11.163, 11.296, 10.614, 11.528, 11.573, 11.065, 10.043, 12.433000000000002, 11.219000000000001, 12.125, 11.009999999999998, 11.421, 11.304, 12.469000000000001, 10.288, 11.703000000000001, 10.868, 12.401, 12.454, 12.843, 12.368, 13.532, 10.824, 13.476999999999999, 10.341999999999999, 13.158000000000001, 10.033, 11.065, 10.392000000000001, 9.811, 9.793999999999999, 11.389, 11.483999999999998, 11.693, 11.715000000000002, 10.744, 10.86, 12.215, 11.92, 11.414000000000001, 11.383000000000001, 12.983, 11.937, 12.094, 11.370999999999999, 11.155, 11.296, 13.592, 10.545, 10.786, 10.987, 12.093, 11.267999999999999, 10.356, 11.18, 11.254, 12.474, 19.764999999999993, 25.695000000000014, 13.322000000000001, 15.683000000000002, 11.694, 11.082, 12.767000000000001, 10.668, 13.381, 11.808, 11.065, 12.527000000000001, 12.746, 10.739999999999998, 10.738999999999999, 13.565000000000001], "episode_lengths": [48, 57, 39, 39, 33, 40, 39, 42, 46, 45, 41, 43, 47, 41, 44, 82, 51, 37, 45, 43, 36, 52, 117, 45, 46, 39, 48, 38, 41, 46, 43, 40, 38, 36, 42, 42, 43, 44, 43, 40, 46, 41, 41, 38, 41, 45, 44, 45, 52, 35, 47, 36, 58, 36, 38, 41, 35, 32, 42, 39, 41, 41, 36, 37, 41, 40, 41, 39, 51, 43, 39, 40, 37, 42, 53, 36, 39, 40, 45, 39, 39, 39, 37, 46, 126, 181, 52, 68, 40, 41, 45, 40, 48, 41, 38, 46, 46, 36, 36, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5388130129494654, "mean_inference_ms": 1.2609040212908893, "mean_action_processing_ms": 0.08585074296660773, "mean_env_wait_ms": 5.170134789256204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003282308578491211, "ViewRequirementAgentConnector_ms": 0.2327265739440918}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46078, "num_agent_steps_trained": 0, "num_env_steps_sampled": 46080, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.83074458944887, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 46080, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 46078, "timers": {"training_iteration_time_ms": 150606.482, "sample_time_ms": 6924.053, "synch_weights_time_ms": 51.321}, "counters": {"num_env_steps_sampled": 46080, "num_env_steps_trained": 0, "num_agent_steps_sampled": 46078, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 796, "training_iteration": 45, "trial_id": "default", "date": "2025-12-20_00-32-57", "timestamp": 1766161977, "time_this_iter_s": 149.91625666618347, "time_total_s": 7547.6018216609955, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7547.6018216609955, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 94.90093896713616, "ram_util_percent": 16.253051643192485}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8463410254567861}, "default_policy": {"total_loss": 0.8463410254567861, "policy_loss": -0.03397101947339252, "vf_loss": 3.5206305146217347, "vf_loss_unclipped": 10.788988587260246, "vf_explained_var": 0.29659567289054395, "entropy": 0.7037220615893602, "mean_kl_loss": 0.00858130390200813, "gradients_default_optimizer_global_norm": 1.4016582384705543, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 47104, "num_env_steps_trained": 0, "num_agent_steps_sampled": 47102, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 25.695000000000014, "episode_reward_min": 9.793999999999999, "episode_reward_mean": 11.866199999999997, "episode_len_mean": 44.3, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.847999999999999, 11.782, 13.098000000000003, 11.163, 11.296, 10.614, 11.528, 11.573, 11.065, 10.043, 12.433000000000002, 11.219000000000001, 12.125, 11.009999999999998, 11.421, 11.304, 12.469000000000001, 10.288, 11.703000000000001, 10.868, 12.401, 12.454, 12.843, 12.368, 13.532, 10.824, 13.476999999999999, 10.341999999999999, 13.158000000000001, 10.033, 11.065, 10.392000000000001, 9.811, 9.793999999999999, 11.389, 11.483999999999998, 11.693, 11.715000000000002, 10.744, 10.86, 12.215, 11.92, 11.414000000000001, 11.383000000000001, 12.983, 11.937, 12.094, 11.370999999999999, 11.155, 11.296, 13.592, 10.545, 10.786, 10.987, 12.093, 11.267999999999999, 10.356, 11.18, 11.254, 12.474, 19.764999999999993, 25.695000000000014, 13.322000000000001, 15.683000000000002, 11.694, 11.082, 12.767000000000001, 10.668, 13.381, 11.808, 11.065, 12.527000000000001, 12.746, 10.739999999999998, 10.738999999999999, 13.565000000000001, 10.653, 11.693999999999999, 11.873000000000001, 12.24, 11.9, 12.776, 12.254000000000001, 12.099, 12.036000000000001, 10.334, 10.448, 11.451, 11.308, 12.354999999999999, 10.549000000000001, 11.179, 12.0, 11.751, 12.658, 11.62, 11.493, 9.812000000000001, 10.466, 11.892], "episode_lengths": [46, 39, 48, 38, 41, 46, 43, 40, 38, 36, 42, 42, 43, 44, 43, 40, 46, 41, 41, 38, 41, 45, 44, 45, 52, 35, 47, 36, 58, 36, 38, 41, 35, 32, 42, 39, 41, 41, 36, 37, 41, 40, 41, 39, 51, 43, 39, 40, 37, 42, 53, 36, 39, 40, 45, 39, 39, 39, 37, 46, 126, 181, 52, 68, 40, 41, 45, 40, 48, 41, 38, 46, 46, 36, 36, 56, 38, 40, 49, 45, 41, 48, 45, 43, 43, 37, 36, 47, 42, 45, 36, 38, 42, 48, 45, 47, 41, 33, 38, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5390723869082009, "mean_inference_ms": 1.2588694887686214, "mean_action_processing_ms": 0.08572416037065818, "mean_env_wait_ms": 5.1630826646096954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032930374145507812, "ViewRequirementAgentConnector_ms": 0.23308944702148438}}, "episode_reward_max": 25.695000000000014, "episode_reward_min": 9.793999999999999, "episode_reward_mean": 11.866199999999997, "episode_len_mean": 44.3, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.847999999999999, 11.782, 13.098000000000003, 11.163, 11.296, 10.614, 11.528, 11.573, 11.065, 10.043, 12.433000000000002, 11.219000000000001, 12.125, 11.009999999999998, 11.421, 11.304, 12.469000000000001, 10.288, 11.703000000000001, 10.868, 12.401, 12.454, 12.843, 12.368, 13.532, 10.824, 13.476999999999999, 10.341999999999999, 13.158000000000001, 10.033, 11.065, 10.392000000000001, 9.811, 9.793999999999999, 11.389, 11.483999999999998, 11.693, 11.715000000000002, 10.744, 10.86, 12.215, 11.92, 11.414000000000001, 11.383000000000001, 12.983, 11.937, 12.094, 11.370999999999999, 11.155, 11.296, 13.592, 10.545, 10.786, 10.987, 12.093, 11.267999999999999, 10.356, 11.18, 11.254, 12.474, 19.764999999999993, 25.695000000000014, 13.322000000000001, 15.683000000000002, 11.694, 11.082, 12.767000000000001, 10.668, 13.381, 11.808, 11.065, 12.527000000000001, 12.746, 10.739999999999998, 10.738999999999999, 13.565000000000001, 10.653, 11.693999999999999, 11.873000000000001, 12.24, 11.9, 12.776, 12.254000000000001, 12.099, 12.036000000000001, 10.334, 10.448, 11.451, 11.308, 12.354999999999999, 10.549000000000001, 11.179, 12.0, 11.751, 12.658, 11.62, 11.493, 9.812000000000001, 10.466, 11.892], "episode_lengths": [46, 39, 48, 38, 41, 46, 43, 40, 38, 36, 42, 42, 43, 44, 43, 40, 46, 41, 41, 38, 41, 45, 44, 45, 52, 35, 47, 36, 58, 36, 38, 41, 35, 32, 42, 39, 41, 41, 36, 37, 41, 40, 41, 39, 51, 43, 39, 40, 37, 42, 53, 36, 39, 40, 45, 39, 39, 39, 37, 46, 126, 181, 52, 68, 40, 41, 45, 40, 48, 41, 38, 46, 46, 36, 36, 56, 38, 40, 49, 45, 41, 48, 45, 43, 43, 37, 36, 47, 42, 45, 36, 38, 42, 48, 45, 47, 41, 33, 38, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5390723869082009, "mean_inference_ms": 1.2588694887686214, "mean_action_processing_ms": 0.08572416037065818, "mean_env_wait_ms": 5.1630826646096954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032930374145507812, "ViewRequirementAgentConnector_ms": 0.23308944702148438}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47102, "num_agent_steps_trained": 0, "num_env_steps_sampled": 47104, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.880283913657421, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 47104, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 47102, "timers": {"training_iteration_time_ms": 150330.948, "sample_time_ms": 6925.1, "synch_weights_time_ms": 50.84}, "counters": {"num_env_steps_sampled": 47104, "num_env_steps_trained": 0, "num_agent_steps_sampled": 47102, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 820, "training_iteration": 46, "trial_id": "default", "date": "2025-12-20_00-35-26", "timestamp": 1766162126, "time_this_iter_s": 148.834321975708, "time_total_s": 7696.4361436367035, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7696.4361436367035, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 94.82783018867924, "ram_util_percent": 16.26981132075472}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8383626498281955}, "default_policy": {"total_loss": 0.8383626498281955, "policy_loss": -0.031609506893437354, "vf_loss": 3.4789675772190094, "vf_loss_unclipped": 10.969634910672903, "vf_explained_var": 0.1936493419110775, "entropy": 0.6865357104688883, "mean_kl_loss": 0.00916797949941497, "gradients_default_optimizer_global_norm": 1.4445810429751873, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 48128, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48126, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 25.695000000000014, "episode_reward_min": 9.793999999999999, "episode_reward_mean": 11.88358, "episode_len_mean": 44.39, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.532, 10.824, 13.476999999999999, 10.341999999999999, 13.158000000000001, 10.033, 11.065, 10.392000000000001, 9.811, 9.793999999999999, 11.389, 11.483999999999998, 11.693, 11.715000000000002, 10.744, 10.86, 12.215, 11.92, 11.414000000000001, 11.383000000000001, 12.983, 11.937, 12.094, 11.370999999999999, 11.155, 11.296, 13.592, 10.545, 10.786, 10.987, 12.093, 11.267999999999999, 10.356, 11.18, 11.254, 12.474, 19.764999999999993, 25.695000000000014, 13.322000000000001, 15.683000000000002, 11.694, 11.082, 12.767000000000001, 10.668, 13.381, 11.808, 11.065, 12.527000000000001, 12.746, 10.739999999999998, 10.738999999999999, 13.565000000000001, 10.653, 11.693999999999999, 11.873000000000001, 12.24, 11.9, 12.776, 12.254000000000001, 12.099, 12.036000000000001, 10.334, 10.448, 11.451, 11.308, 12.354999999999999, 10.549000000000001, 11.179, 12.0, 11.751, 12.658, 11.62, 11.493, 9.812000000000001, 10.466, 11.892, 11.701, 12.695000000000002, 12.027000000000001, 10.030999999999999, 10.443999999999999, 12.252, 11.413, 11.448, 12.276, 13.172, 12.084, 11.817, 11.270999999999999, 10.578, 11.402, 12.416, 11.998000000000001, 11.622, 10.731, 12.244000000000002, 11.97, 13.624000000000002, 11.280000000000001, 11.158], "episode_lengths": [52, 35, 47, 36, 58, 36, 38, 41, 35, 32, 42, 39, 41, 41, 36, 37, 41, 40, 41, 39, 51, 43, 39, 40, 37, 42, 53, 36, 39, 40, 45, 39, 39, 39, 37, 46, 126, 181, 52, 68, 40, 41, 45, 40, 48, 41, 38, 46, 46, 36, 36, 56, 38, 40, 49, 45, 41, 48, 45, 43, 43, 37, 36, 47, 42, 45, 36, 38, 42, 48, 45, 47, 41, 33, 38, 41, 39, 50, 42, 36, 39, 48, 43, 47, 48, 47, 39, 42, 38, 38, 48, 42, 42, 44, 36, 47, 37, 51, 39, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392039789414531, "mean_inference_ms": 1.2565410105530805, "mean_action_processing_ms": 0.08558224365705858, "mean_env_wait_ms": 5.155950770746045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032558441162109375, "ViewRequirementAgentConnector_ms": 0.23230814933776855}}, "episode_reward_max": 25.695000000000014, "episode_reward_min": 9.793999999999999, "episode_reward_mean": 11.88358, "episode_len_mean": 44.39, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.532, 10.824, 13.476999999999999, 10.341999999999999, 13.158000000000001, 10.033, 11.065, 10.392000000000001, 9.811, 9.793999999999999, 11.389, 11.483999999999998, 11.693, 11.715000000000002, 10.744, 10.86, 12.215, 11.92, 11.414000000000001, 11.383000000000001, 12.983, 11.937, 12.094, 11.370999999999999, 11.155, 11.296, 13.592, 10.545, 10.786, 10.987, 12.093, 11.267999999999999, 10.356, 11.18, 11.254, 12.474, 19.764999999999993, 25.695000000000014, 13.322000000000001, 15.683000000000002, 11.694, 11.082, 12.767000000000001, 10.668, 13.381, 11.808, 11.065, 12.527000000000001, 12.746, 10.739999999999998, 10.738999999999999, 13.565000000000001, 10.653, 11.693999999999999, 11.873000000000001, 12.24, 11.9, 12.776, 12.254000000000001, 12.099, 12.036000000000001, 10.334, 10.448, 11.451, 11.308, 12.354999999999999, 10.549000000000001, 11.179, 12.0, 11.751, 12.658, 11.62, 11.493, 9.812000000000001, 10.466, 11.892, 11.701, 12.695000000000002, 12.027000000000001, 10.030999999999999, 10.443999999999999, 12.252, 11.413, 11.448, 12.276, 13.172, 12.084, 11.817, 11.270999999999999, 10.578, 11.402, 12.416, 11.998000000000001, 11.622, 10.731, 12.244000000000002, 11.97, 13.624000000000002, 11.280000000000001, 11.158], "episode_lengths": [52, 35, 47, 36, 58, 36, 38, 41, 35, 32, 42, 39, 41, 41, 36, 37, 41, 40, 41, 39, 51, 43, 39, 40, 37, 42, 53, 36, 39, 40, 45, 39, 39, 39, 37, 46, 126, 181, 52, 68, 40, 41, 45, 40, 48, 41, 38, 46, 46, 36, 36, 56, 38, 40, 49, 45, 41, 48, 45, 43, 43, 37, 36, 47, 42, 45, 36, 38, 42, 48, 45, 47, 41, 33, 38, 41, 39, 50, 42, 36, 39, 48, 43, 47, 48, 47, 39, 42, 38, 38, 48, 42, 42, 44, 36, 47, 37, 51, 39, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392039789414531, "mean_inference_ms": 1.2565410105530805, "mean_action_processing_ms": 0.08558224365705858, "mean_env_wait_ms": 5.155950770746045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032558441162109375, "ViewRequirementAgentConnector_ms": 0.23230814933776855}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48126, "num_agent_steps_trained": 0, "num_env_steps_sampled": 48128, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.862999595899672, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 48128, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 48126, "timers": {"training_iteration_time_ms": 150102.194, "sample_time_ms": 6919.312, "synch_weights_time_ms": 51.467}, "counters": {"num_env_steps_sampled": 48128, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48126, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 844, "training_iteration": 47, "trial_id": "default", "date": "2025-12-20_00-38-03", "timestamp": 1766162283, "time_this_iter_s": 149.2101538181305, "time_total_s": 7845.646297454834, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7845.646297454834, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 90.38206278026904, "ram_util_percent": 16.162780269058295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8178367959335446}, "default_policy": {"total_loss": 0.8178367959335446, "policy_loss": -0.0382342972618062, "vf_loss": 3.4224065750837327, "vf_loss_unclipped": 12.343373936414718, "vf_explained_var": 0.17066012211143972, "entropy": 0.6427217995747924, "mean_kl_loss": 0.011121640785607668, "gradients_default_optimizer_global_norm": 1.185470498353243, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 0, "num_agent_steps_sampled": 49150, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 25.695000000000014, "episode_reward_min": 9.812000000000001, "episode_reward_mean": 11.901180000000004, "episode_len_mean": 44.65, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.296, 13.592, 10.545, 10.786, 10.987, 12.093, 11.267999999999999, 10.356, 11.18, 11.254, 12.474, 19.764999999999993, 25.695000000000014, 13.322000000000001, 15.683000000000002, 11.694, 11.082, 12.767000000000001, 10.668, 13.381, 11.808, 11.065, 12.527000000000001, 12.746, 10.739999999999998, 10.738999999999999, 13.565000000000001, 10.653, 11.693999999999999, 11.873000000000001, 12.24, 11.9, 12.776, 12.254000000000001, 12.099, 12.036000000000001, 10.334, 10.448, 11.451, 11.308, 12.354999999999999, 10.549000000000001, 11.179, 12.0, 11.751, 12.658, 11.62, 11.493, 9.812000000000001, 10.466, 11.892, 11.701, 12.695000000000002, 12.027000000000001, 10.030999999999999, 10.443999999999999, 12.252, 11.413, 11.448, 12.276, 13.172, 12.084, 11.817, 11.270999999999999, 10.578, 11.402, 12.416, 11.998000000000001, 11.622, 10.731, 12.244000000000002, 11.97, 13.624000000000002, 11.280000000000001, 11.158, 10.851999999999999, 11.183, 10.98, 12.429, 10.393, 11.922, 10.51, 12.452000000000002, 11.205000000000002, 12.836, 11.36, 11.166, 10.336, 13.0, 11.699, 10.923, 16.032000000000004, 10.846, 11.795, 10.652000000000001, 11.918, 10.165000000000001, 11.477, 11.803, 10.611], "episode_lengths": [42, 53, 36, 39, 40, 45, 39, 39, 39, 37, 46, 126, 181, 52, 68, 40, 41, 45, 40, 48, 41, 38, 46, 46, 36, 36, 56, 38, 40, 49, 45, 41, 48, 45, 43, 43, 37, 36, 47, 42, 45, 36, 38, 42, 48, 45, 47, 41, 33, 38, 41, 39, 50, 42, 36, 39, 48, 43, 47, 48, 47, 39, 42, 38, 38, 48, 42, 42, 44, 36, 47, 37, 51, 39, 37, 37, 39, 39, 43, 34, 44, 34, 46, 46, 42, 38, 39, 37, 50, 41, 35, 79, 37, 49, 36, 48, 37, 38, 42, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5393039543019361, "mean_inference_ms": 1.2542153114204633, "mean_action_processing_ms": 0.08544442276016287, "mean_env_wait_ms": 5.148871884921142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003262042999267578, "ViewRequirementAgentConnector_ms": 0.2331554889678955}}, "episode_reward_max": 25.695000000000014, "episode_reward_min": 9.812000000000001, "episode_reward_mean": 11.901180000000004, "episode_len_mean": 44.65, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.296, 13.592, 10.545, 10.786, 10.987, 12.093, 11.267999999999999, 10.356, 11.18, 11.254, 12.474, 19.764999999999993, 25.695000000000014, 13.322000000000001, 15.683000000000002, 11.694, 11.082, 12.767000000000001, 10.668, 13.381, 11.808, 11.065, 12.527000000000001, 12.746, 10.739999999999998, 10.738999999999999, 13.565000000000001, 10.653, 11.693999999999999, 11.873000000000001, 12.24, 11.9, 12.776, 12.254000000000001, 12.099, 12.036000000000001, 10.334, 10.448, 11.451, 11.308, 12.354999999999999, 10.549000000000001, 11.179, 12.0, 11.751, 12.658, 11.62, 11.493, 9.812000000000001, 10.466, 11.892, 11.701, 12.695000000000002, 12.027000000000001, 10.030999999999999, 10.443999999999999, 12.252, 11.413, 11.448, 12.276, 13.172, 12.084, 11.817, 11.270999999999999, 10.578, 11.402, 12.416, 11.998000000000001, 11.622, 10.731, 12.244000000000002, 11.97, 13.624000000000002, 11.280000000000001, 11.158, 10.851999999999999, 11.183, 10.98, 12.429, 10.393, 11.922, 10.51, 12.452000000000002, 11.205000000000002, 12.836, 11.36, 11.166, 10.336, 13.0, 11.699, 10.923, 16.032000000000004, 10.846, 11.795, 10.652000000000001, 11.918, 10.165000000000001, 11.477, 11.803, 10.611], "episode_lengths": [42, 53, 36, 39, 40, 45, 39, 39, 39, 37, 46, 126, 181, 52, 68, 40, 41, 45, 40, 48, 41, 38, 46, 46, 36, 36, 56, 38, 40, 49, 45, 41, 48, 45, 43, 43, 37, 36, 47, 42, 45, 36, 38, 42, 48, 45, 47, 41, 33, 38, 41, 39, 50, 42, 36, 39, 48, 43, 47, 48, 47, 39, 42, 38, 38, 48, 42, 42, 44, 36, 47, 37, 51, 39, 37, 37, 39, 39, 43, 34, 44, 34, 46, 46, 42, 38, 39, 37, 50, 41, 35, 79, 37, 49, 36, 48, 37, 38, 42, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5393039543019361, "mean_inference_ms": 1.2542153114204633, "mean_action_processing_ms": 0.08544442276016287, "mean_env_wait_ms": 5.148871884921142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003262042999267578, "ViewRequirementAgentConnector_ms": 0.2331554889678955}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49150, "num_agent_steps_trained": 0, "num_env_steps_sampled": 49152, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.9414534016547575, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 49152, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 49150, "timers": {"training_iteration_time_ms": 149738.441, "sample_time_ms": 6829.904, "synch_weights_time_ms": 51.421}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 0, "num_agent_steps_sampled": 49150, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 869, "training_iteration": 48, "trial_id": "default", "date": "2025-12-20_00-40-30", "timestamp": 1766162430, "time_this_iter_s": 147.52231001853943, "time_total_s": 7993.168607473373, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7993.168607473373, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 94.8452380952381, "ram_util_percent": 16.30714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7978384642861783}, "default_policy": {"total_loss": 0.7978384642861783, "policy_loss": -0.03030832263175398, "vf_loss": 3.3113927356898785, "vf_loss_unclipped": 10.680932524055242, "vf_explained_var": 0.13505536764860154, "entropy": 0.6521306527778507, "mean_kl_loss": 0.009507307783522378, "gradients_default_optimizer_global_norm": 1.0916996520012616, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 0, "num_agent_steps_sampled": 50174, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 16.032000000000004, "episode_reward_min": 9.802, "episode_reward_mean": 11.62288, "episode_len_mean": 41.98, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.738999999999999, 13.565000000000001, 10.653, 11.693999999999999, 11.873000000000001, 12.24, 11.9, 12.776, 12.254000000000001, 12.099, 12.036000000000001, 10.334, 10.448, 11.451, 11.308, 12.354999999999999, 10.549000000000001, 11.179, 12.0, 11.751, 12.658, 11.62, 11.493, 9.812000000000001, 10.466, 11.892, 11.701, 12.695000000000002, 12.027000000000001, 10.030999999999999, 10.443999999999999, 12.252, 11.413, 11.448, 12.276, 13.172, 12.084, 11.817, 11.270999999999999, 10.578, 11.402, 12.416, 11.998000000000001, 11.622, 10.731, 12.244000000000002, 11.97, 13.624000000000002, 11.280000000000001, 11.158, 10.851999999999999, 11.183, 10.98, 12.429, 10.393, 11.922, 10.51, 12.452000000000002, 11.205000000000002, 12.836, 11.36, 11.166, 10.336, 13.0, 11.699, 10.923, 16.032000000000004, 10.846, 11.795, 10.652000000000001, 11.918, 10.165000000000001, 11.477, 11.803, 10.611, 10.633999999999999, 10.441999999999998, 10.623999999999999, 11.512, 11.809000000000001, 12.165000000000001, 10.643999999999998, 13.224, 10.895, 14.099000000000002, 13.19, 12.956, 10.751999999999999, 10.553, 11.883000000000001, 9.802, 11.604, 10.773, 10.651, 11.154000000000002, 12.802, 10.821, 10.545, 15.601999999999999, 11.808], "episode_lengths": [36, 56, 38, 40, 49, 45, 41, 48, 45, 43, 43, 37, 36, 47, 42, 45, 36, 38, 42, 48, 45, 47, 41, 33, 38, 41, 39, 50, 42, 36, 39, 48, 43, 47, 48, 47, 39, 42, 38, 38, 48, 42, 42, 44, 36, 47, 37, 51, 39, 37, 37, 39, 39, 43, 34, 44, 34, 46, 46, 42, 38, 39, 37, 50, 41, 35, 79, 37, 49, 36, 48, 37, 38, 42, 33, 33, 36, 34, 40, 41, 46, 35, 51, 40, 54, 50, 45, 37, 36, 38, 33, 42, 37, 38, 36, 49, 43, 36, 64, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.540439779273579, "mean_inference_ms": 1.2539562676516893, "mean_action_processing_ms": 0.08544040164174412, "mean_env_wait_ms": 5.144644849061727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032775402069091797, "ViewRequirementAgentConnector_ms": 0.23392844200134277}}, "episode_reward_max": 16.032000000000004, "episode_reward_min": 9.802, "episode_reward_mean": 11.62288, "episode_len_mean": 41.98, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.738999999999999, 13.565000000000001, 10.653, 11.693999999999999, 11.873000000000001, 12.24, 11.9, 12.776, 12.254000000000001, 12.099, 12.036000000000001, 10.334, 10.448, 11.451, 11.308, 12.354999999999999, 10.549000000000001, 11.179, 12.0, 11.751, 12.658, 11.62, 11.493, 9.812000000000001, 10.466, 11.892, 11.701, 12.695000000000002, 12.027000000000001, 10.030999999999999, 10.443999999999999, 12.252, 11.413, 11.448, 12.276, 13.172, 12.084, 11.817, 11.270999999999999, 10.578, 11.402, 12.416, 11.998000000000001, 11.622, 10.731, 12.244000000000002, 11.97, 13.624000000000002, 11.280000000000001, 11.158, 10.851999999999999, 11.183, 10.98, 12.429, 10.393, 11.922, 10.51, 12.452000000000002, 11.205000000000002, 12.836, 11.36, 11.166, 10.336, 13.0, 11.699, 10.923, 16.032000000000004, 10.846, 11.795, 10.652000000000001, 11.918, 10.165000000000001, 11.477, 11.803, 10.611, 10.633999999999999, 10.441999999999998, 10.623999999999999, 11.512, 11.809000000000001, 12.165000000000001, 10.643999999999998, 13.224, 10.895, 14.099000000000002, 13.19, 12.956, 10.751999999999999, 10.553, 11.883000000000001, 9.802, 11.604, 10.773, 10.651, 11.154000000000002, 12.802, 10.821, 10.545, 15.601999999999999, 11.808], "episode_lengths": [36, 56, 38, 40, 49, 45, 41, 48, 45, 43, 43, 37, 36, 47, 42, 45, 36, 38, 42, 48, 45, 47, 41, 33, 38, 41, 39, 50, 42, 36, 39, 48, 43, 47, 48, 47, 39, 42, 38, 38, 48, 42, 42, 44, 36, 47, 37, 51, 39, 37, 37, 39, 39, 43, 34, 44, 34, 46, 46, 42, 38, 39, 37, 50, 41, 35, 79, 37, 49, 36, 48, 37, 38, 42, 33, 33, 36, 34, 40, 41, 46, 35, 51, 40, 54, 50, 45, 37, 36, 38, 33, 42, 37, 38, 36, 49, 43, 36, 64, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.540439779273579, "mean_inference_ms": 1.2539562676516893, "mean_action_processing_ms": 0.08544040164174412, "mean_env_wait_ms": 5.144644849061727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032775402069091797, "ViewRequirementAgentConnector_ms": 0.23392844200134277}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50174, "num_agent_steps_trained": 0, "num_env_steps_sampled": 50176, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.927019272298166, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 50176, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 50174, "timers": {"training_iteration_time_ms": 149425.946, "sample_time_ms": 6833.517, "synch_weights_time_ms": 49.693}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 0, "num_agent_steps_sampled": 50174, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 894, "training_iteration": 49, "trial_id": "default", "date": "2025-12-20_00-42-58", "timestamp": 1766162578, "time_this_iter_s": 147.83062505722046, "time_total_s": 8140.999232530594, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8140.999232530594, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 94.82523809523809, "ram_util_percent": 16.178095238095235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7253594354726374}, "default_policy": {"total_loss": 0.7253594354726374, "policy_loss": -0.03720178259536624, "vf_loss": 3.0486197270452977, "vf_loss_unclipped": 9.01747103407979, "vf_explained_var": 0.34876245968043806, "entropy": 0.6992537459358573, "mean_kl_loss": 0.011055401172060896, "gradients_default_optimizer_global_norm": 1.5253578677773476, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 51200, "num_env_steps_trained": 0, "num_agent_steps_sampled": 51198, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 27.289999999999985, "episode_reward_min": 9.748000000000001, "episode_reward_mean": 11.740119999999997, "episode_len_mean": 43.64, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.658, 11.62, 11.493, 9.812000000000001, 10.466, 11.892, 11.701, 12.695000000000002, 12.027000000000001, 10.030999999999999, 10.443999999999999, 12.252, 11.413, 11.448, 12.276, 13.172, 12.084, 11.817, 11.270999999999999, 10.578, 11.402, 12.416, 11.998000000000001, 11.622, 10.731, 12.244000000000002, 11.97, 13.624000000000002, 11.280000000000001, 11.158, 10.851999999999999, 11.183, 10.98, 12.429, 10.393, 11.922, 10.51, 12.452000000000002, 11.205000000000002, 12.836, 11.36, 11.166, 10.336, 13.0, 11.699, 10.923, 16.032000000000004, 10.846, 11.795, 10.652000000000001, 11.918, 10.165000000000001, 11.477, 11.803, 10.611, 10.633999999999999, 10.441999999999998, 10.623999999999999, 11.512, 11.809000000000001, 12.165000000000001, 10.643999999999998, 13.224, 10.895, 14.099000000000002, 13.19, 12.956, 10.751999999999999, 10.553, 11.883000000000001, 9.802, 11.604, 10.773, 10.651, 11.154000000000002, 12.802, 10.821, 10.545, 15.601999999999999, 11.808, 14.616000000000001, 11.837, 10.591000000000001, 10.818, 10.031999999999998, 11.578000000000001, 27.289999999999985, 10.932000000000002, 11.433, 11.827, 9.748000000000001, 10.950000000000001, 11.263, 10.546, 13.186, 11.143, 11.407000000000002, 13.187000000000001, 11.399000000000001, 11.145], "episode_lengths": [45, 47, 41, 33, 38, 41, 39, 50, 42, 36, 39, 48, 43, 47, 48, 47, 39, 42, 38, 38, 48, 42, 42, 44, 36, 47, 37, 51, 39, 37, 37, 39, 39, 43, 34, 44, 34, 46, 46, 42, 38, 39, 37, 50, 41, 35, 79, 37, 49, 36, 48, 37, 38, 42, 33, 33, 36, 34, 40, 41, 46, 35, 51, 40, 54, 50, 45, 37, 36, 38, 33, 42, 37, 38, 36, 49, 43, 36, 64, 42, 52, 44, 40, 42, 37, 50, 196, 43, 44, 41, 37, 50, 38, 36, 56, 36, 42, 62, 39, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5401296424585739, "mean_inference_ms": 1.251298798433616, "mean_action_processing_ms": 0.08528350768086718, "mean_env_wait_ms": 5.138217244538734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033011436462402344, "ViewRequirementAgentConnector_ms": 0.23409724235534668}}, "episode_reward_max": 27.289999999999985, "episode_reward_min": 9.748000000000001, "episode_reward_mean": 11.740119999999997, "episode_len_mean": 43.64, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.658, 11.62, 11.493, 9.812000000000001, 10.466, 11.892, 11.701, 12.695000000000002, 12.027000000000001, 10.030999999999999, 10.443999999999999, 12.252, 11.413, 11.448, 12.276, 13.172, 12.084, 11.817, 11.270999999999999, 10.578, 11.402, 12.416, 11.998000000000001, 11.622, 10.731, 12.244000000000002, 11.97, 13.624000000000002, 11.280000000000001, 11.158, 10.851999999999999, 11.183, 10.98, 12.429, 10.393, 11.922, 10.51, 12.452000000000002, 11.205000000000002, 12.836, 11.36, 11.166, 10.336, 13.0, 11.699, 10.923, 16.032000000000004, 10.846, 11.795, 10.652000000000001, 11.918, 10.165000000000001, 11.477, 11.803, 10.611, 10.633999999999999, 10.441999999999998, 10.623999999999999, 11.512, 11.809000000000001, 12.165000000000001, 10.643999999999998, 13.224, 10.895, 14.099000000000002, 13.19, 12.956, 10.751999999999999, 10.553, 11.883000000000001, 9.802, 11.604, 10.773, 10.651, 11.154000000000002, 12.802, 10.821, 10.545, 15.601999999999999, 11.808, 14.616000000000001, 11.837, 10.591000000000001, 10.818, 10.031999999999998, 11.578000000000001, 27.289999999999985, 10.932000000000002, 11.433, 11.827, 9.748000000000001, 10.950000000000001, 11.263, 10.546, 13.186, 11.143, 11.407000000000002, 13.187000000000001, 11.399000000000001, 11.145], "episode_lengths": [45, 47, 41, 33, 38, 41, 39, 50, 42, 36, 39, 48, 43, 47, 48, 47, 39, 42, 38, 38, 48, 42, 42, 44, 36, 47, 37, 51, 39, 37, 37, 39, 39, 43, 34, 44, 34, 46, 46, 42, 38, 39, 37, 50, 41, 35, 79, 37, 49, 36, 48, 37, 38, 42, 33, 33, 36, 34, 40, 41, 46, 35, 51, 40, 54, 50, 45, 37, 36, 38, 33, 42, 37, 38, 36, 49, 43, 36, 64, 42, 52, 44, 40, 42, 37, 50, 196, 43, 44, 41, 37, 50, 38, 36, 56, 36, 42, 62, 39, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5401296424585739, "mean_inference_ms": 1.251298798433616, "mean_action_processing_ms": 0.08528350768086718, "mean_env_wait_ms": 5.138217244538734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033011436462402344, "ViewRequirementAgentConnector_ms": 0.23409724235534668}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51198, "num_agent_steps_trained": 0, "num_env_steps_sampled": 51200, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.877066323579518, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 51200, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 51198, "timers": {"training_iteration_time_ms": 149202.514, "sample_time_ms": 6843.424, "synch_weights_time_ms": 50.076}, "counters": {"num_env_steps_sampled": 51200, "num_env_steps_trained": 0, "num_agent_steps_sampled": 51198, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 914, "training_iteration": 50, "trial_id": "default", "date": "2025-12-20_00-45-27", "timestamp": 1766162727, "time_this_iter_s": 148.90336894989014, "time_total_s": 8289.902601480484, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8289.902601480484, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 94.88962264150943, "ram_util_percent": 16.319811320754717}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8118423979496583}, "default_policy": {"total_loss": 0.8118423979496583, "policy_loss": -0.03402145978761837, "vf_loss": 3.3825877040624617, "vf_loss_unclipped": 11.050534170866012, "vf_explained_var": 0.26474472135305405, "entropy": 0.6535302789881825, "mean_kl_loss": 0.008704692873268981, "gradients_default_optimizer_global_norm": 1.4684649050235747, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 52224, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52222, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 27.289999999999985, "episode_reward_min": 9.748000000000001, "episode_reward_mean": 11.680860000000003, "episode_len_mean": 43.65, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.622, 10.731, 12.244000000000002, 11.97, 13.624000000000002, 11.280000000000001, 11.158, 10.851999999999999, 11.183, 10.98, 12.429, 10.393, 11.922, 10.51, 12.452000000000002, 11.205000000000002, 12.836, 11.36, 11.166, 10.336, 13.0, 11.699, 10.923, 16.032000000000004, 10.846, 11.795, 10.652000000000001, 11.918, 10.165000000000001, 11.477, 11.803, 10.611, 10.633999999999999, 10.441999999999998, 10.623999999999999, 11.512, 11.809000000000001, 12.165000000000001, 10.643999999999998, 13.224, 10.895, 14.099000000000002, 13.19, 12.956, 10.751999999999999, 10.553, 11.883000000000001, 9.802, 11.604, 10.773, 10.651, 11.154000000000002, 12.802, 10.821, 10.545, 15.601999999999999, 11.808, 14.616000000000001, 11.837, 10.591000000000001, 10.818, 10.031999999999998, 11.578000000000001, 27.289999999999985, 10.932000000000002, 11.433, 11.827, 9.748000000000001, 10.950000000000001, 11.263, 10.546, 13.186, 11.143, 11.407000000000002, 13.187000000000001, 11.399000000000001, 11.145, 11.905999999999999, 11.731000000000002, 10.579, 11.004, 10.567, 11.178999999999998, 11.184, 10.973, 11.312, 10.027, 12.634, 11.157, 12.899000000000001, 10.138, 10.878000000000002, 11.059000000000001, 12.158999999999999, 11.637, 10.460999999999999, 14.155000000000003, 10.991, 10.360999999999999, 12.049], "episode_lengths": [44, 36, 47, 37, 51, 39, 37, 37, 39, 39, 43, 34, 44, 34, 46, 46, 42, 38, 39, 37, 50, 41, 35, 79, 37, 49, 36, 48, 37, 38, 42, 33, 33, 36, 34, 40, 41, 46, 35, 51, 40, 54, 50, 45, 37, 36, 38, 33, 42, 37, 38, 36, 49, 43, 36, 64, 42, 52, 44, 40, 42, 37, 50, 196, 43, 44, 41, 37, 50, 38, 36, 56, 36, 42, 62, 39, 36, 41, 46, 39, 33, 38, 39, 40, 38, 40, 36, 55, 37, 49, 36, 39, 37, 45, 46, 38, 76, 42, 37, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5403014486142047, "mean_inference_ms": 1.2496963655995033, "mean_action_processing_ms": 0.0851994694998157, "mean_env_wait_ms": 5.132889872478863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033054351806640625, "ViewRequirementAgentConnector_ms": 0.23393750190734863}}, "episode_reward_max": 27.289999999999985, "episode_reward_min": 9.748000000000001, "episode_reward_mean": 11.680860000000003, "episode_len_mean": 43.65, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.622, 10.731, 12.244000000000002, 11.97, 13.624000000000002, 11.280000000000001, 11.158, 10.851999999999999, 11.183, 10.98, 12.429, 10.393, 11.922, 10.51, 12.452000000000002, 11.205000000000002, 12.836, 11.36, 11.166, 10.336, 13.0, 11.699, 10.923, 16.032000000000004, 10.846, 11.795, 10.652000000000001, 11.918, 10.165000000000001, 11.477, 11.803, 10.611, 10.633999999999999, 10.441999999999998, 10.623999999999999, 11.512, 11.809000000000001, 12.165000000000001, 10.643999999999998, 13.224, 10.895, 14.099000000000002, 13.19, 12.956, 10.751999999999999, 10.553, 11.883000000000001, 9.802, 11.604, 10.773, 10.651, 11.154000000000002, 12.802, 10.821, 10.545, 15.601999999999999, 11.808, 14.616000000000001, 11.837, 10.591000000000001, 10.818, 10.031999999999998, 11.578000000000001, 27.289999999999985, 10.932000000000002, 11.433, 11.827, 9.748000000000001, 10.950000000000001, 11.263, 10.546, 13.186, 11.143, 11.407000000000002, 13.187000000000001, 11.399000000000001, 11.145, 11.905999999999999, 11.731000000000002, 10.579, 11.004, 10.567, 11.178999999999998, 11.184, 10.973, 11.312, 10.027, 12.634, 11.157, 12.899000000000001, 10.138, 10.878000000000002, 11.059000000000001, 12.158999999999999, 11.637, 10.460999999999999, 14.155000000000003, 10.991, 10.360999999999999, 12.049], "episode_lengths": [44, 36, 47, 37, 51, 39, 37, 37, 39, 39, 43, 34, 44, 34, 46, 46, 42, 38, 39, 37, 50, 41, 35, 79, 37, 49, 36, 48, 37, 38, 42, 33, 33, 36, 34, 40, 41, 46, 35, 51, 40, 54, 50, 45, 37, 36, 38, 33, 42, 37, 38, 36, 49, 43, 36, 64, 42, 52, 44, 40, 42, 37, 50, 196, 43, 44, 41, 37, 50, 38, 36, 56, 36, 42, 62, 39, 36, 41, 46, 39, 33, 38, 39, 40, 38, 40, 36, 55, 37, 49, 36, 39, 37, 45, 46, 38, 76, 42, 37, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5403014486142047, "mean_inference_ms": 1.2496963655995033, "mean_action_processing_ms": 0.0851994694998157, "mean_env_wait_ms": 5.132889872478863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033054351806640625, "ViewRequirementAgentConnector_ms": 0.23393750190734863}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52222, "num_agent_steps_trained": 0, "num_env_steps_sampled": 52224, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.832092351325134, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 52224, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 52222, "timers": {"training_iteration_time_ms": 149165.37, "sample_time_ms": 6840.033, "synch_weights_time_ms": 49.918}, "counters": {"num_env_steps_sampled": 52224, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52222, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 937, "training_iteration": 51, "trial_id": "default", "date": "2025-12-20_00-47-57", "timestamp": 1766162877, "time_this_iter_s": 149.8843080997467, "time_total_s": 8439.78690958023, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8439.78690958023, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 94.8338028169014, "ram_util_percent": 16.146478873239435}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7855031896837318}, "default_policy": {"total_loss": 0.7855031896837318, "policy_loss": -0.033685827255249025, "vf_loss": 3.2747148029506206, "vf_loss_unclipped": 10.219354248046875, "vf_explained_var": 0.35890046656131747, "entropy": 0.6368990190327167, "mean_kl_loss": 0.01147219419999317, "gradients_default_optimizer_global_norm": 1.176393781416118, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 53248, "num_env_steps_trained": 0, "num_agent_steps_sampled": 53246, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 27.289999999999985, "episode_reward_min": 9.748000000000001, "episode_reward_mean": 11.620800000000004, "episode_len_mean": 44.01, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.846, 11.795, 10.652000000000001, 11.918, 10.165000000000001, 11.477, 11.803, 10.611, 10.633999999999999, 10.441999999999998, 10.623999999999999, 11.512, 11.809000000000001, 12.165000000000001, 10.643999999999998, 13.224, 10.895, 14.099000000000002, 13.19, 12.956, 10.751999999999999, 10.553, 11.883000000000001, 9.802, 11.604, 10.773, 10.651, 11.154000000000002, 12.802, 10.821, 10.545, 15.601999999999999, 11.808, 14.616000000000001, 11.837, 10.591000000000001, 10.818, 10.031999999999998, 11.578000000000001, 27.289999999999985, 10.932000000000002, 11.433, 11.827, 9.748000000000001, 10.950000000000001, 11.263, 10.546, 13.186, 11.143, 11.407000000000002, 13.187000000000001, 11.399000000000001, 11.145, 11.905999999999999, 11.731000000000002, 10.579, 11.004, 10.567, 11.178999999999998, 11.184, 10.973, 11.312, 10.027, 12.634, 11.157, 12.899000000000001, 10.138, 10.878000000000002, 11.059000000000001, 12.158999999999999, 11.637, 10.460999999999999, 14.155000000000003, 10.991, 10.360999999999999, 12.049, 15.874000000000008, 12.979, 10.763000000000002, 11.277000000000001, 10.873999999999999, 10.049000000000001, 10.788000000000002, 10.254000000000001, 12.616000000000001, 10.011, 11.521, 10.652000000000001, 14.665, 12.487, 11.588000000000001, 10.374, 10.437, 11.813, 10.694, 10.448, 11.535, 11.737, 10.428, 12.036999999999999], "episode_lengths": [37, 49, 36, 48, 37, 38, 42, 33, 33, 36, 34, 40, 41, 46, 35, 51, 40, 54, 50, 45, 37, 36, 38, 33, 42, 37, 38, 36, 49, 43, 36, 64, 42, 52, 44, 40, 42, 37, 50, 196, 43, 44, 41, 37, 50, 38, 36, 56, 36, 42, 62, 39, 36, 41, 46, 39, 33, 38, 39, 40, 38, 40, 36, 55, 37, 49, 36, 39, 37, 45, 46, 38, 76, 42, 37, 47, 85, 48, 38, 39, 40, 37, 42, 38, 52, 35, 42, 41, 55, 48, 40, 39, 36, 44, 40, 37, 45, 44, 38, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5403374183453995, "mean_inference_ms": 1.2477776517277355, "mean_action_processing_ms": 0.08508733539430108, "mean_env_wait_ms": 5.127097296577777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003327608108520508, "ViewRequirementAgentConnector_ms": 0.23321223258972168}}, "episode_reward_max": 27.289999999999985, "episode_reward_min": 9.748000000000001, "episode_reward_mean": 11.620800000000004, "episode_len_mean": 44.01, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.846, 11.795, 10.652000000000001, 11.918, 10.165000000000001, 11.477, 11.803, 10.611, 10.633999999999999, 10.441999999999998, 10.623999999999999, 11.512, 11.809000000000001, 12.165000000000001, 10.643999999999998, 13.224, 10.895, 14.099000000000002, 13.19, 12.956, 10.751999999999999, 10.553, 11.883000000000001, 9.802, 11.604, 10.773, 10.651, 11.154000000000002, 12.802, 10.821, 10.545, 15.601999999999999, 11.808, 14.616000000000001, 11.837, 10.591000000000001, 10.818, 10.031999999999998, 11.578000000000001, 27.289999999999985, 10.932000000000002, 11.433, 11.827, 9.748000000000001, 10.950000000000001, 11.263, 10.546, 13.186, 11.143, 11.407000000000002, 13.187000000000001, 11.399000000000001, 11.145, 11.905999999999999, 11.731000000000002, 10.579, 11.004, 10.567, 11.178999999999998, 11.184, 10.973, 11.312, 10.027, 12.634, 11.157, 12.899000000000001, 10.138, 10.878000000000002, 11.059000000000001, 12.158999999999999, 11.637, 10.460999999999999, 14.155000000000003, 10.991, 10.360999999999999, 12.049, 15.874000000000008, 12.979, 10.763000000000002, 11.277000000000001, 10.873999999999999, 10.049000000000001, 10.788000000000002, 10.254000000000001, 12.616000000000001, 10.011, 11.521, 10.652000000000001, 14.665, 12.487, 11.588000000000001, 10.374, 10.437, 11.813, 10.694, 10.448, 11.535, 11.737, 10.428, 12.036999999999999], "episode_lengths": [37, 49, 36, 48, 37, 38, 42, 33, 33, 36, 34, 40, 41, 46, 35, 51, 40, 54, 50, 45, 37, 36, 38, 33, 42, 37, 38, 36, 49, 43, 36, 64, 42, 52, 44, 40, 42, 37, 50, 196, 43, 44, 41, 37, 50, 38, 36, 56, 36, 42, 62, 39, 36, 41, 46, 39, 33, 38, 39, 40, 38, 40, 36, 55, 37, 49, 36, 39, 37, 45, 46, 38, 76, 42, 37, 47, 85, 48, 38, 39, 40, 37, 42, 38, 52, 35, 42, 41, 55, 48, 40, 39, 36, 44, 40, 37, 45, 44, 38, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5403374183453995, "mean_inference_ms": 1.2477776517277355, "mean_action_processing_ms": 0.08508733539430108, "mean_env_wait_ms": 5.127097296577777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003327608108520508, "ViewRequirementAgentConnector_ms": 0.23321223258972168}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53246, "num_agent_steps_trained": 0, "num_env_steps_sampled": 53248, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.896793000716978, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 53248, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 53246, "timers": {"training_iteration_time_ms": 148900.217, "sample_time_ms": 6847.307, "synch_weights_time_ms": 49.516}, "counters": {"num_env_steps_sampled": 53248, "num_env_steps_trained": 0, "num_agent_steps_sampled": 53246, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 961, "training_iteration": 52, "trial_id": "default", "date": "2025-12-20_00-50-33", "timestamp": 1766163033, "time_this_iter_s": 148.47841715812683, "time_total_s": 8588.265326738358, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8588.265326738358, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 90.45470852017937, "ram_util_percent": 16.408071748878925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.656438838597387}, "default_policy": {"total_loss": 0.656438838597387, "policy_loss": -0.030214005726156755, "vf_loss": 2.7441378839313986, "vf_loss_unclipped": 8.514231299608946, "vf_explained_var": 0.42383776009082796, "entropy": 0.6470422856509686, "mean_kl_loss": 0.012654151368521127, "gradients_default_optimizer_global_norm": 1.3895555142313243, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 54272, "num_env_steps_trained": 0, "num_agent_steps_sampled": 54270, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.75500000000001, "episode_reward_min": 9.748000000000001, "episode_reward_mean": 11.784710000000002, "episode_len_mean": 46.01, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.553, 11.883000000000001, 9.802, 11.604, 10.773, 10.651, 11.154000000000002, 12.802, 10.821, 10.545, 15.601999999999999, 11.808, 14.616000000000001, 11.837, 10.591000000000001, 10.818, 10.031999999999998, 11.578000000000001, 27.289999999999985, 10.932000000000002, 11.433, 11.827, 9.748000000000001, 10.950000000000001, 11.263, 10.546, 13.186, 11.143, 11.407000000000002, 13.187000000000001, 11.399000000000001, 11.145, 11.905999999999999, 11.731000000000002, 10.579, 11.004, 10.567, 11.178999999999998, 11.184, 10.973, 11.312, 10.027, 12.634, 11.157, 12.899000000000001, 10.138, 10.878000000000002, 11.059000000000001, 12.158999999999999, 11.637, 10.460999999999999, 14.155000000000003, 10.991, 10.360999999999999, 12.049, 15.874000000000008, 12.979, 10.763000000000002, 11.277000000000001, 10.873999999999999, 10.049000000000001, 10.788000000000002, 10.254000000000001, 12.616000000000001, 10.011, 11.521, 10.652000000000001, 14.665, 12.487, 11.588000000000001, 10.374, 10.437, 11.813, 10.694, 10.448, 11.535, 11.737, 10.428, 12.036999999999999, 11.645, 10.026, 12.603, 10.765, 10.351999999999999, 11.005, 10.872, 10.036999999999999, 10.439, 11.74, 11.366, 14.251000000000001, 10.348999999999998, 12.881, 11.491000000000001, 11.171000000000001, 31.75500000000001, 10.279, 11.413, 12.687999999999999, 11.476], "episode_lengths": [36, 38, 33, 42, 37, 38, 36, 49, 43, 36, 64, 42, 52, 44, 40, 42, 37, 50, 196, 43, 44, 41, 37, 50, 38, 36, 56, 36, 42, 62, 39, 36, 41, 46, 39, 33, 38, 39, 40, 38, 40, 36, 55, 37, 49, 36, 39, 37, 45, 46, 38, 76, 42, 37, 47, 85, 48, 38, 39, 40, 37, 42, 38, 52, 35, 42, 41, 55, 48, 40, 39, 36, 44, 40, 37, 45, 44, 38, 47, 44, 35, 51, 41, 36, 42, 39, 37, 38, 48, 40, 53, 37, 47, 40, 39, 214, 40, 42, 51, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5407495434895805, "mean_inference_ms": 1.24720871734482, "mean_action_processing_ms": 0.08506472211229252, "mean_env_wait_ms": 5.124601055922683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036144256591796875, "ViewRequirementAgentConnector_ms": 0.23878026008605957}}, "episode_reward_max": 31.75500000000001, "episode_reward_min": 9.748000000000001, "episode_reward_mean": 11.784710000000002, "episode_len_mean": 46.01, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.553, 11.883000000000001, 9.802, 11.604, 10.773, 10.651, 11.154000000000002, 12.802, 10.821, 10.545, 15.601999999999999, 11.808, 14.616000000000001, 11.837, 10.591000000000001, 10.818, 10.031999999999998, 11.578000000000001, 27.289999999999985, 10.932000000000002, 11.433, 11.827, 9.748000000000001, 10.950000000000001, 11.263, 10.546, 13.186, 11.143, 11.407000000000002, 13.187000000000001, 11.399000000000001, 11.145, 11.905999999999999, 11.731000000000002, 10.579, 11.004, 10.567, 11.178999999999998, 11.184, 10.973, 11.312, 10.027, 12.634, 11.157, 12.899000000000001, 10.138, 10.878000000000002, 11.059000000000001, 12.158999999999999, 11.637, 10.460999999999999, 14.155000000000003, 10.991, 10.360999999999999, 12.049, 15.874000000000008, 12.979, 10.763000000000002, 11.277000000000001, 10.873999999999999, 10.049000000000001, 10.788000000000002, 10.254000000000001, 12.616000000000001, 10.011, 11.521, 10.652000000000001, 14.665, 12.487, 11.588000000000001, 10.374, 10.437, 11.813, 10.694, 10.448, 11.535, 11.737, 10.428, 12.036999999999999, 11.645, 10.026, 12.603, 10.765, 10.351999999999999, 11.005, 10.872, 10.036999999999999, 10.439, 11.74, 11.366, 14.251000000000001, 10.348999999999998, 12.881, 11.491000000000001, 11.171000000000001, 31.75500000000001, 10.279, 11.413, 12.687999999999999, 11.476], "episode_lengths": [36, 38, 33, 42, 37, 38, 36, 49, 43, 36, 64, 42, 52, 44, 40, 42, 37, 50, 196, 43, 44, 41, 37, 50, 38, 36, 56, 36, 42, 62, 39, 36, 41, 46, 39, 33, 38, 39, 40, 38, 40, 36, 55, 37, 49, 36, 39, 37, 45, 46, 38, 76, 42, 37, 47, 85, 48, 38, 39, 40, 37, 42, 38, 52, 35, 42, 41, 55, 48, 40, 39, 36, 44, 40, 37, 45, 44, 38, 47, 44, 35, 51, 41, 36, 42, 39, 37, 38, 48, 40, 53, 37, 47, 40, 39, 214, 40, 42, 51, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5407495434895805, "mean_inference_ms": 1.24720871734482, "mean_action_processing_ms": 0.08506472211229252, "mean_env_wait_ms": 5.124601055922683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036144256591796875, "ViewRequirementAgentConnector_ms": 0.23878026008605957}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54270, "num_agent_steps_trained": 0, "num_env_steps_sampled": 54272, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.849710215420306, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 54272, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 54270, "timers": {"training_iteration_time_ms": 148855.861, "sample_time_ms": 6904.399, "synch_weights_time_ms": 50.509}, "counters": {"num_env_steps_sampled": 54272, "num_env_steps_trained": 0, "num_agent_steps_sampled": 54270, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 982, "training_iteration": 53, "trial_id": "default", "date": "2025-12-20_00-53-03", "timestamp": 1766163183, "time_this_iter_s": 149.4988579750061, "time_total_s": 8737.764184713364, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8737.764184713364, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 94.50801886792455, "ram_util_percent": 16.013207547169813}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6082123721949756}, "default_policy": {"total_loss": 0.6082123721949756, "policy_loss": -0.02675221792887896, "vf_loss": 2.5383069310337305, "vf_loss_unclipped": 9.570555688068271, "vf_explained_var": 0.37512751035392283, "entropy": 0.6350006759166718, "mean_kl_loss": 0.010228643596792607, "gradients_default_optimizer_global_norm": 1.279191562719643, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 55296, "num_env_steps_trained": 0, "num_agent_steps_sampled": 55294, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.75500000000001, "episode_reward_min": 9.748000000000001, "episode_reward_mean": 11.848599999999998, "episode_len_mean": 48.08, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.289999999999985, 10.932000000000002, 11.433, 11.827, 9.748000000000001, 10.950000000000001, 11.263, 10.546, 13.186, 11.143, 11.407000000000002, 13.187000000000001, 11.399000000000001, 11.145, 11.905999999999999, 11.731000000000002, 10.579, 11.004, 10.567, 11.178999999999998, 11.184, 10.973, 11.312, 10.027, 12.634, 11.157, 12.899000000000001, 10.138, 10.878000000000002, 11.059000000000001, 12.158999999999999, 11.637, 10.460999999999999, 14.155000000000003, 10.991, 10.360999999999999, 12.049, 15.874000000000008, 12.979, 10.763000000000002, 11.277000000000001, 10.873999999999999, 10.049000000000001, 10.788000000000002, 10.254000000000001, 12.616000000000001, 10.011, 11.521, 10.652000000000001, 14.665, 12.487, 11.588000000000001, 10.374, 10.437, 11.813, 10.694, 10.448, 11.535, 11.737, 10.428, 12.036999999999999, 11.645, 10.026, 12.603, 10.765, 10.351999999999999, 11.005, 10.872, 10.036999999999999, 10.439, 11.74, 11.366, 14.251000000000001, 10.348999999999998, 12.881, 11.491000000000001, 11.171000000000001, 31.75500000000001, 10.279, 11.413, 12.687999999999999, 11.476, 10.658999999999999, 10.633, 10.274000000000001, 25.327000000000037, 10.936, 11.903, 12.321000000000002, 10.641, 10.373000000000001, 12.437000000000001, 11.514000000000001, 11.662, 10.571, 10.321, 10.244, 11.012, 13.098, 9.933], "episode_lengths": [196, 43, 44, 41, 37, 50, 38, 36, 56, 36, 42, 62, 39, 36, 41, 46, 39, 33, 38, 39, 40, 38, 40, 36, 55, 37, 49, 36, 39, 37, 45, 46, 38, 76, 42, 37, 47, 85, 48, 38, 39, 40, 37, 42, 38, 52, 35, 42, 41, 55, 48, 40, 39, 36, 44, 40, 37, 45, 44, 38, 47, 44, 35, 51, 41, 36, 42, 39, 37, 38, 48, 40, 53, 37, 47, 40, 39, 214, 40, 42, 51, 48, 39, 37, 38, 257, 44, 40, 42, 36, 39, 46, 43, 49, 40, 34, 36, 45, 64, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5409692163697685, "mean_inference_ms": 1.246488829098911, "mean_action_processing_ms": 0.08501629212459733, "mean_env_wait_ms": 5.122207356788785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036046504974365234, "ViewRequirementAgentConnector_ms": 0.2388455867767334}}, "episode_reward_max": 31.75500000000001, "episode_reward_min": 9.748000000000001, "episode_reward_mean": 11.848599999999998, "episode_len_mean": 48.08, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.289999999999985, 10.932000000000002, 11.433, 11.827, 9.748000000000001, 10.950000000000001, 11.263, 10.546, 13.186, 11.143, 11.407000000000002, 13.187000000000001, 11.399000000000001, 11.145, 11.905999999999999, 11.731000000000002, 10.579, 11.004, 10.567, 11.178999999999998, 11.184, 10.973, 11.312, 10.027, 12.634, 11.157, 12.899000000000001, 10.138, 10.878000000000002, 11.059000000000001, 12.158999999999999, 11.637, 10.460999999999999, 14.155000000000003, 10.991, 10.360999999999999, 12.049, 15.874000000000008, 12.979, 10.763000000000002, 11.277000000000001, 10.873999999999999, 10.049000000000001, 10.788000000000002, 10.254000000000001, 12.616000000000001, 10.011, 11.521, 10.652000000000001, 14.665, 12.487, 11.588000000000001, 10.374, 10.437, 11.813, 10.694, 10.448, 11.535, 11.737, 10.428, 12.036999999999999, 11.645, 10.026, 12.603, 10.765, 10.351999999999999, 11.005, 10.872, 10.036999999999999, 10.439, 11.74, 11.366, 14.251000000000001, 10.348999999999998, 12.881, 11.491000000000001, 11.171000000000001, 31.75500000000001, 10.279, 11.413, 12.687999999999999, 11.476, 10.658999999999999, 10.633, 10.274000000000001, 25.327000000000037, 10.936, 11.903, 12.321000000000002, 10.641, 10.373000000000001, 12.437000000000001, 11.514000000000001, 11.662, 10.571, 10.321, 10.244, 11.012, 13.098, 9.933], "episode_lengths": [196, 43, 44, 41, 37, 50, 38, 36, 56, 36, 42, 62, 39, 36, 41, 46, 39, 33, 38, 39, 40, 38, 40, 36, 55, 37, 49, 36, 39, 37, 45, 46, 38, 76, 42, 37, 47, 85, 48, 38, 39, 40, 37, 42, 38, 52, 35, 42, 41, 55, 48, 40, 39, 36, 44, 40, 37, 45, 44, 38, 47, 44, 35, 51, 41, 36, 42, 39, 37, 38, 48, 40, 53, 37, 47, 40, 39, 214, 40, 42, 51, 48, 39, 37, 38, 257, 44, 40, 42, 36, 39, 46, 43, 49, 40, 34, 36, 45, 64, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5409692163697685, "mean_inference_ms": 1.246488829098911, "mean_action_processing_ms": 0.08501629212459733, "mean_env_wait_ms": 5.122207356788785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036046504974365234, "ViewRequirementAgentConnector_ms": 0.2388455867767334}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55294, "num_agent_steps_trained": 0, "num_env_steps_sampled": 55296, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.850818685526775, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 55296, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 55294, "timers": {"training_iteration_time_ms": 148951.626, "sample_time_ms": 6913.962, "synch_weights_time_ms": 50.485}, "counters": {"num_env_steps_sampled": 55296, "num_env_steps_trained": 0, "num_agent_steps_sampled": 55294, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1000, "training_iteration": 54, "trial_id": "default", "date": "2025-12-20_00-55-32", "timestamp": 1766163332, "time_this_iter_s": 149.47404193878174, "time_total_s": 8887.238226652145, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8887.238226652145, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 94.87042253521126, "ram_util_percent": 16.33051643192488}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5794328914023936}, "default_policy": {"total_loss": 0.5794328914023936, "policy_loss": -0.032677852746564894, "vf_loss": 2.445900827087462, "vf_loss_unclipped": 8.205105740763248, "vf_explained_var": 0.44234843738377094, "entropy": 0.6544654965400696, "mean_kl_loss": 0.012900090691952925, "gradients_default_optimizer_global_norm": 1.4298454011790453, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 56320, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56318, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.75500000000001, "episode_reward_min": 9.822000000000001, "episode_reward_mean": 12.05191, "episode_len_mean": 49.74, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.579, 11.004, 10.567, 11.178999999999998, 11.184, 10.973, 11.312, 10.027, 12.634, 11.157, 12.899000000000001, 10.138, 10.878000000000002, 11.059000000000001, 12.158999999999999, 11.637, 10.460999999999999, 14.155000000000003, 10.991, 10.360999999999999, 12.049, 15.874000000000008, 12.979, 10.763000000000002, 11.277000000000001, 10.873999999999999, 10.049000000000001, 10.788000000000002, 10.254000000000001, 12.616000000000001, 10.011, 11.521, 10.652000000000001, 14.665, 12.487, 11.588000000000001, 10.374, 10.437, 11.813, 10.694, 10.448, 11.535, 11.737, 10.428, 12.036999999999999, 11.645, 10.026, 12.603, 10.765, 10.351999999999999, 11.005, 10.872, 10.036999999999999, 10.439, 11.74, 11.366, 14.251000000000001, 10.348999999999998, 12.881, 11.491000000000001, 11.171000000000001, 31.75500000000001, 10.279, 11.413, 12.687999999999999, 11.476, 10.658999999999999, 10.633, 10.274000000000001, 25.327000000000037, 10.936, 11.903, 12.321000000000002, 10.641, 10.373000000000001, 12.437000000000001, 11.514000000000001, 11.662, 10.571, 10.321, 10.244, 11.012, 13.098, 9.933, 23.579, 13.523000000000001, 12.885000000000002, 24.862999999999985, 11.431999999999999, 11.716000000000001, 10.978000000000002, 11.484, 10.675999999999998, 13.183, 12.765, 12.309000000000001, 15.332999999999997, 12.244, 9.822000000000001, 12.632000000000001], "episode_lengths": [39, 33, 38, 39, 40, 38, 40, 36, 55, 37, 49, 36, 39, 37, 45, 46, 38, 76, 42, 37, 47, 85, 48, 38, 39, 40, 37, 42, 38, 52, 35, 42, 41, 55, 48, 40, 39, 36, 44, 40, 37, 45, 44, 38, 47, 44, 35, 51, 41, 36, 42, 39, 37, 38, 48, 40, 53, 37, 47, 40, 39, 214, 40, 42, 51, 48, 39, 37, 38, 257, 44, 40, 42, 36, 39, 46, 43, 49, 40, 34, 36, 45, 64, 37, 155, 71, 47, 172, 42, 49, 39, 38, 44, 52, 46, 41, 88, 44, 36, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.541234520535726, "mean_inference_ms": 1.2463265304627396, "mean_action_processing_ms": 0.08501014149193771, "mean_env_wait_ms": 5.1208108723547845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003603696823120117, "ViewRequirementAgentConnector_ms": 0.2382035255432129}}, "episode_reward_max": 31.75500000000001, "episode_reward_min": 9.822000000000001, "episode_reward_mean": 12.05191, "episode_len_mean": 49.74, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.579, 11.004, 10.567, 11.178999999999998, 11.184, 10.973, 11.312, 10.027, 12.634, 11.157, 12.899000000000001, 10.138, 10.878000000000002, 11.059000000000001, 12.158999999999999, 11.637, 10.460999999999999, 14.155000000000003, 10.991, 10.360999999999999, 12.049, 15.874000000000008, 12.979, 10.763000000000002, 11.277000000000001, 10.873999999999999, 10.049000000000001, 10.788000000000002, 10.254000000000001, 12.616000000000001, 10.011, 11.521, 10.652000000000001, 14.665, 12.487, 11.588000000000001, 10.374, 10.437, 11.813, 10.694, 10.448, 11.535, 11.737, 10.428, 12.036999999999999, 11.645, 10.026, 12.603, 10.765, 10.351999999999999, 11.005, 10.872, 10.036999999999999, 10.439, 11.74, 11.366, 14.251000000000001, 10.348999999999998, 12.881, 11.491000000000001, 11.171000000000001, 31.75500000000001, 10.279, 11.413, 12.687999999999999, 11.476, 10.658999999999999, 10.633, 10.274000000000001, 25.327000000000037, 10.936, 11.903, 12.321000000000002, 10.641, 10.373000000000001, 12.437000000000001, 11.514000000000001, 11.662, 10.571, 10.321, 10.244, 11.012, 13.098, 9.933, 23.579, 13.523000000000001, 12.885000000000002, 24.862999999999985, 11.431999999999999, 11.716000000000001, 10.978000000000002, 11.484, 10.675999999999998, 13.183, 12.765, 12.309000000000001, 15.332999999999997, 12.244, 9.822000000000001, 12.632000000000001], "episode_lengths": [39, 33, 38, 39, 40, 38, 40, 36, 55, 37, 49, 36, 39, 37, 45, 46, 38, 76, 42, 37, 47, 85, 48, 38, 39, 40, 37, 42, 38, 52, 35, 42, 41, 55, 48, 40, 39, 36, 44, 40, 37, 45, 44, 38, 47, 44, 35, 51, 41, 36, 42, 39, 37, 38, 48, 40, 53, 37, 47, 40, 39, 214, 40, 42, 51, 48, 39, 37, 38, 257, 44, 40, 42, 36, 39, 46, 43, 49, 40, 34, 36, 45, 64, 37, 155, 71, 47, 172, 42, 49, 39, 38, 44, 52, 46, 41, 88, 44, 36, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.541234520535726, "mean_inference_ms": 1.2463265304627396, "mean_action_processing_ms": 0.08501014149193771, "mean_env_wait_ms": 5.1208108723547845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003603696823120117, "ViewRequirementAgentConnector_ms": 0.2382035255432129}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56318, "num_agent_steps_trained": 0, "num_env_steps_sampled": 56320, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.840094960160865, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 56320, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 56318, "timers": {"training_iteration_time_ms": 148931.135, "sample_time_ms": 6914.174, "synch_weights_time_ms": 50.473}, "counters": {"num_env_steps_sampled": 56320, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56318, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1016, "training_iteration": 55, "trial_id": "default", "date": "2025-12-20_00-58-02", "timestamp": 1766163482, "time_this_iter_s": 149.70814156532288, "time_total_s": 9036.946368217468, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9036.946368217468, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 94.83802816901408, "ram_util_percent": 16.079812206572768}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5717877428047359}, "default_policy": {"total_loss": 0.5717877428047359, "policy_loss": -0.0261878008604981, "vf_loss": 2.390911413403228, "vf_loss_unclipped": 8.29548275587149, "vf_explained_var": 0.306345022469759, "entropy": 0.6113187048584223, "mean_kl_loss": 0.008590084503144624, "gradients_default_optimizer_global_norm": 1.6718598566018046, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 0, "num_agent_steps_sampled": 57342, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.75500000000001, "episode_reward_min": 9.822000000000001, "episode_reward_mean": 12.17418, "episode_len_mean": 50.76, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.991, 10.360999999999999, 12.049, 15.874000000000008, 12.979, 10.763000000000002, 11.277000000000001, 10.873999999999999, 10.049000000000001, 10.788000000000002, 10.254000000000001, 12.616000000000001, 10.011, 11.521, 10.652000000000001, 14.665, 12.487, 11.588000000000001, 10.374, 10.437, 11.813, 10.694, 10.448, 11.535, 11.737, 10.428, 12.036999999999999, 11.645, 10.026, 12.603, 10.765, 10.351999999999999, 11.005, 10.872, 10.036999999999999, 10.439, 11.74, 11.366, 14.251000000000001, 10.348999999999998, 12.881, 11.491000000000001, 11.171000000000001, 31.75500000000001, 10.279, 11.413, 12.687999999999999, 11.476, 10.658999999999999, 10.633, 10.274000000000001, 25.327000000000037, 10.936, 11.903, 12.321000000000002, 10.641, 10.373000000000001, 12.437000000000001, 11.514000000000001, 11.662, 10.571, 10.321, 10.244, 11.012, 13.098, 9.933, 23.579, 13.523000000000001, 12.885000000000002, 24.862999999999985, 11.431999999999999, 11.716000000000001, 10.978000000000002, 11.484, 10.675999999999998, 13.183, 12.765, 12.309000000000001, 15.332999999999997, 12.244, 9.822000000000001, 12.632000000000001, 10.346, 10.658999999999999, 10.632, 11.062999999999999, 11.85, 11.944999999999999, 10.650000000000002, 12.411000000000001, 11.478000000000002, 10.401, 11.525999999999998, 11.359, 11.062000000000001, 13.853000000000002, 10.649000000000001, 22.871999999999996, 12.584, 10.889], "episode_lengths": [42, 37, 47, 85, 48, 38, 39, 40, 37, 42, 38, 52, 35, 42, 41, 55, 48, 40, 39, 36, 44, 40, 37, 45, 44, 38, 47, 44, 35, 51, 41, 36, 42, 39, 37, 38, 48, 40, 53, 37, 47, 40, 39, 214, 40, 42, 51, 48, 39, 37, 38, 257, 44, 40, 42, 36, 39, 46, 43, 49, 40, 34, 36, 45, 64, 37, 155, 71, 47, 172, 42, 49, 39, 38, 44, 52, 46, 41, 88, 44, 36, 45, 38, 39, 39, 38, 45, 45, 37, 41, 39, 35, 43, 43, 38, 73, 40, 150, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5415081725210009, "mean_inference_ms": 1.2463360511192534, "mean_action_processing_ms": 0.08501324030237281, "mean_env_wait_ms": 5.1194273880416645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003615856170654297, "ViewRequirementAgentConnector_ms": 0.2386622428894043}}, "episode_reward_max": 31.75500000000001, "episode_reward_min": 9.822000000000001, "episode_reward_mean": 12.17418, "episode_len_mean": 50.76, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.991, 10.360999999999999, 12.049, 15.874000000000008, 12.979, 10.763000000000002, 11.277000000000001, 10.873999999999999, 10.049000000000001, 10.788000000000002, 10.254000000000001, 12.616000000000001, 10.011, 11.521, 10.652000000000001, 14.665, 12.487, 11.588000000000001, 10.374, 10.437, 11.813, 10.694, 10.448, 11.535, 11.737, 10.428, 12.036999999999999, 11.645, 10.026, 12.603, 10.765, 10.351999999999999, 11.005, 10.872, 10.036999999999999, 10.439, 11.74, 11.366, 14.251000000000001, 10.348999999999998, 12.881, 11.491000000000001, 11.171000000000001, 31.75500000000001, 10.279, 11.413, 12.687999999999999, 11.476, 10.658999999999999, 10.633, 10.274000000000001, 25.327000000000037, 10.936, 11.903, 12.321000000000002, 10.641, 10.373000000000001, 12.437000000000001, 11.514000000000001, 11.662, 10.571, 10.321, 10.244, 11.012, 13.098, 9.933, 23.579, 13.523000000000001, 12.885000000000002, 24.862999999999985, 11.431999999999999, 11.716000000000001, 10.978000000000002, 11.484, 10.675999999999998, 13.183, 12.765, 12.309000000000001, 15.332999999999997, 12.244, 9.822000000000001, 12.632000000000001, 10.346, 10.658999999999999, 10.632, 11.062999999999999, 11.85, 11.944999999999999, 10.650000000000002, 12.411000000000001, 11.478000000000002, 10.401, 11.525999999999998, 11.359, 11.062000000000001, 13.853000000000002, 10.649000000000001, 22.871999999999996, 12.584, 10.889], "episode_lengths": [42, 37, 47, 85, 48, 38, 39, 40, 37, 42, 38, 52, 35, 42, 41, 55, 48, 40, 39, 36, 44, 40, 37, 45, 44, 38, 47, 44, 35, 51, 41, 36, 42, 39, 37, 38, 48, 40, 53, 37, 47, 40, 39, 214, 40, 42, 51, 48, 39, 37, 38, 257, 44, 40, 42, 36, 39, 46, 43, 49, 40, 34, 36, 45, 64, 37, 155, 71, 47, 172, 42, 49, 39, 38, 44, 52, 46, 41, 88, 44, 36, 45, 38, 39, 39, 38, 45, 45, 37, 41, 39, 35, 43, 43, 38, 73, 40, 150, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5415081725210009, "mean_inference_ms": 1.2463360511192534, "mean_action_processing_ms": 0.08501324030237281, "mean_env_wait_ms": 5.1194273880416645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003615856170654297, "ViewRequirementAgentConnector_ms": 0.2386622428894043}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57342, "num_agent_steps_trained": 0, "num_env_steps_sampled": 57344, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.89706077678264, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 57344, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 57342, "timers": {"training_iteration_time_ms": 148894.934, "sample_time_ms": 6906.372, "synch_weights_time_ms": 50.866}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 0, "num_agent_steps_sampled": 57342, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1034, "training_iteration": 56, "trial_id": "default", "date": "2025-12-20_01-00-31", "timestamp": 1766163631, "time_this_iter_s": 148.4720823764801, "time_total_s": 9185.418450593948, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9185.418450593948, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 94.90426540284358, "ram_util_percent": 16.40947867298578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5421254434622824}, "default_policy": {"total_loss": 0.5421254434622824, "policy_loss": -0.02690201885998249, "vf_loss": 2.273901289177593, "vf_loss_unclipped": 8.362973308784422, "vf_explained_var": 0.43147675655782225, "entropy": 0.6104477411136031, "mean_kl_loss": 0.01162585982179749, "gradients_default_optimizer_global_norm": 1.4650365751236678, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 58368, "num_env_steps_trained": 0, "num_agent_steps_sampled": 58366, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.75500000000001, "episode_reward_min": 9.822000000000001, "episode_reward_mean": 12.51478, "episode_len_mean": 55.04, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.374, 10.437, 11.813, 10.694, 10.448, 11.535, 11.737, 10.428, 12.036999999999999, 11.645, 10.026, 12.603, 10.765, 10.351999999999999, 11.005, 10.872, 10.036999999999999, 10.439, 11.74, 11.366, 14.251000000000001, 10.348999999999998, 12.881, 11.491000000000001, 11.171000000000001, 31.75500000000001, 10.279, 11.413, 12.687999999999999, 11.476, 10.658999999999999, 10.633, 10.274000000000001, 25.327000000000037, 10.936, 11.903, 12.321000000000002, 10.641, 10.373000000000001, 12.437000000000001, 11.514000000000001, 11.662, 10.571, 10.321, 10.244, 11.012, 13.098, 9.933, 23.579, 13.523000000000001, 12.885000000000002, 24.862999999999985, 11.431999999999999, 11.716000000000001, 10.978000000000002, 11.484, 10.675999999999998, 13.183, 12.765, 12.309000000000001, 15.332999999999997, 12.244, 9.822000000000001, 12.632000000000001, 10.346, 10.658999999999999, 10.632, 11.062999999999999, 11.85, 11.944999999999999, 10.650000000000002, 12.411000000000001, 11.478000000000002, 10.401, 11.525999999999998, 11.359, 11.062000000000001, 13.853000000000002, 10.649000000000001, 22.871999999999996, 12.584, 10.889, 12.411000000000001, 12.039, 10.232, 10.442, 10.75, 12.337, 13.739, 10.625, 11.244, 11.809999999999999, 11.172, 10.781, 23.613999999999976, 14.195000000000002, 13.28, 12.431000000000001, 31.23400000000002, 11.523000000000001], "episode_lengths": [39, 36, 44, 40, 37, 45, 44, 38, 47, 44, 35, 51, 41, 36, 42, 39, 37, 38, 48, 40, 53, 37, 47, 40, 39, 214, 40, 42, 51, 48, 39, 37, 38, 257, 44, 40, 42, 36, 39, 46, 43, 49, 40, 34, 36, 45, 64, 37, 155, 71, 47, 172, 42, 49, 39, 38, 44, 52, 46, 41, 88, 44, 36, 45, 38, 39, 39, 38, 45, 45, 37, 41, 39, 35, 43, 43, 38, 73, 40, 150, 40, 40, 43, 44, 36, 39, 42, 48, 56, 38, 45, 42, 42, 41, 239, 85, 67, 57, 225, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5413080208903409, "mean_inference_ms": 1.2454195354211448, "mean_action_processing_ms": 0.08495310466938572, "mean_env_wait_ms": 5.116779877935178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.23834443092346191}}, "episode_reward_max": 31.75500000000001, "episode_reward_min": 9.822000000000001, "episode_reward_mean": 12.51478, "episode_len_mean": 55.04, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.374, 10.437, 11.813, 10.694, 10.448, 11.535, 11.737, 10.428, 12.036999999999999, 11.645, 10.026, 12.603, 10.765, 10.351999999999999, 11.005, 10.872, 10.036999999999999, 10.439, 11.74, 11.366, 14.251000000000001, 10.348999999999998, 12.881, 11.491000000000001, 11.171000000000001, 31.75500000000001, 10.279, 11.413, 12.687999999999999, 11.476, 10.658999999999999, 10.633, 10.274000000000001, 25.327000000000037, 10.936, 11.903, 12.321000000000002, 10.641, 10.373000000000001, 12.437000000000001, 11.514000000000001, 11.662, 10.571, 10.321, 10.244, 11.012, 13.098, 9.933, 23.579, 13.523000000000001, 12.885000000000002, 24.862999999999985, 11.431999999999999, 11.716000000000001, 10.978000000000002, 11.484, 10.675999999999998, 13.183, 12.765, 12.309000000000001, 15.332999999999997, 12.244, 9.822000000000001, 12.632000000000001, 10.346, 10.658999999999999, 10.632, 11.062999999999999, 11.85, 11.944999999999999, 10.650000000000002, 12.411000000000001, 11.478000000000002, 10.401, 11.525999999999998, 11.359, 11.062000000000001, 13.853000000000002, 10.649000000000001, 22.871999999999996, 12.584, 10.889, 12.411000000000001, 12.039, 10.232, 10.442, 10.75, 12.337, 13.739, 10.625, 11.244, 11.809999999999999, 11.172, 10.781, 23.613999999999976, 14.195000000000002, 13.28, 12.431000000000001, 31.23400000000002, 11.523000000000001], "episode_lengths": [39, 36, 44, 40, 37, 45, 44, 38, 47, 44, 35, 51, 41, 36, 42, 39, 37, 38, 48, 40, 53, 37, 47, 40, 39, 214, 40, 42, 51, 48, 39, 37, 38, 257, 44, 40, 42, 36, 39, 46, 43, 49, 40, 34, 36, 45, 64, 37, 155, 71, 47, 172, 42, 49, 39, 38, 44, 52, 46, 41, 88, 44, 36, 45, 38, 39, 39, 38, 45, 45, 37, 41, 39, 35, 43, 43, 38, 73, 40, 150, 40, 40, 43, 44, 36, 39, 42, 48, 56, 38, 45, 42, 42, 41, 239, 85, 67, 57, 225, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5413080208903409, "mean_inference_ms": 1.2454195354211448, "mean_action_processing_ms": 0.08495310466938572, "mean_env_wait_ms": 5.116779877935178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036001205444335938, "ViewRequirementAgentConnector_ms": 0.23834443092346191}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58366, "num_agent_steps_trained": 0, "num_env_steps_sampled": 58368, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.807749074888013, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 58368, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 58366, "timers": {"training_iteration_time_ms": 149016.028, "sample_time_ms": 6903.78, "synch_weights_time_ms": 51.432}, "counters": {"num_env_steps_sampled": 58368, "num_env_steps_trained": 0, "num_agent_steps_sampled": 58366, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1052, "training_iteration": 57, "trial_id": "default", "date": "2025-12-20_01-03-09", "timestamp": 1766163789, "time_this_iter_s": 150.4227647781372, "time_total_s": 9335.841215372086, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9335.841215372086, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 90.56888888888889, "ram_util_percent": 16.092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6123739833012223}, "default_policy": {"total_loss": 0.6123739833012223, "policy_loss": -0.030276366916950792, "vf_loss": 2.566998938843608, "vf_loss_unclipped": 9.776755911111831, "vf_explained_var": 0.5804611060768365, "entropy": 0.6302115982398391, "mean_kl_loss": 0.015308295548393858, "gradients_default_optimizer_global_norm": 1.27597781047225, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 59392, "num_env_steps_trained": 0, "num_agent_steps_sampled": 59390, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.75500000000001, "episode_reward_min": 9.822000000000001, "episode_reward_mean": 12.675810000000002, "episode_len_mean": 56.61, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.251000000000001, 10.348999999999998, 12.881, 11.491000000000001, 11.171000000000001, 31.75500000000001, 10.279, 11.413, 12.687999999999999, 11.476, 10.658999999999999, 10.633, 10.274000000000001, 25.327000000000037, 10.936, 11.903, 12.321000000000002, 10.641, 10.373000000000001, 12.437000000000001, 11.514000000000001, 11.662, 10.571, 10.321, 10.244, 11.012, 13.098, 9.933, 23.579, 13.523000000000001, 12.885000000000002, 24.862999999999985, 11.431999999999999, 11.716000000000001, 10.978000000000002, 11.484, 10.675999999999998, 13.183, 12.765, 12.309000000000001, 15.332999999999997, 12.244, 9.822000000000001, 12.632000000000001, 10.346, 10.658999999999999, 10.632, 11.062999999999999, 11.85, 11.944999999999999, 10.650000000000002, 12.411000000000001, 11.478000000000002, 10.401, 11.525999999999998, 11.359, 11.062000000000001, 13.853000000000002, 10.649000000000001, 22.871999999999996, 12.584, 10.889, 12.411000000000001, 12.039, 10.232, 10.442, 10.75, 12.337, 13.739, 10.625, 11.244, 11.809999999999999, 11.172, 10.781, 23.613999999999976, 14.195000000000002, 13.28, 12.431000000000001, 31.23400000000002, 11.523000000000001, 10.44, 10.719, 12.073, 11.554, 11.584, 10.433, 12.259, 10.659999999999998, 10.075, 13.386, 11.545, 11.001000000000001, 10.669, 20.991999999999994, 11.603, 10.535, 10.043, 13.120000000000003, 11.813, 11.952], "episode_lengths": [53, 37, 47, 40, 39, 214, 40, 42, 51, 48, 39, 37, 38, 257, 44, 40, 42, 36, 39, 46, 43, 49, 40, 34, 36, 45, 64, 37, 155, 71, 47, 172, 42, 49, 39, 38, 44, 52, 46, 41, 88, 44, 36, 45, 38, 39, 39, 38, 45, 45, 37, 41, 39, 35, 43, 43, 38, 73, 40, 150, 40, 40, 43, 44, 36, 39, 42, 48, 56, 38, 45, 42, 42, 41, 239, 85, 67, 57, 225, 45, 36, 37, 55, 38, 41, 39, 49, 39, 41, 66, 50, 44, 38, 127, 41, 39, 37, 62, 45, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5407784050993985, "mean_inference_ms": 1.2440144185421431, "mean_action_processing_ms": 0.08486270403852174, "mean_env_wait_ms": 5.1127310581546785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003519296646118164, "ViewRequirementAgentConnector_ms": 0.23503804206848145}}, "episode_reward_max": 31.75500000000001, "episode_reward_min": 9.822000000000001, "episode_reward_mean": 12.675810000000002, "episode_len_mean": 56.61, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.251000000000001, 10.348999999999998, 12.881, 11.491000000000001, 11.171000000000001, 31.75500000000001, 10.279, 11.413, 12.687999999999999, 11.476, 10.658999999999999, 10.633, 10.274000000000001, 25.327000000000037, 10.936, 11.903, 12.321000000000002, 10.641, 10.373000000000001, 12.437000000000001, 11.514000000000001, 11.662, 10.571, 10.321, 10.244, 11.012, 13.098, 9.933, 23.579, 13.523000000000001, 12.885000000000002, 24.862999999999985, 11.431999999999999, 11.716000000000001, 10.978000000000002, 11.484, 10.675999999999998, 13.183, 12.765, 12.309000000000001, 15.332999999999997, 12.244, 9.822000000000001, 12.632000000000001, 10.346, 10.658999999999999, 10.632, 11.062999999999999, 11.85, 11.944999999999999, 10.650000000000002, 12.411000000000001, 11.478000000000002, 10.401, 11.525999999999998, 11.359, 11.062000000000001, 13.853000000000002, 10.649000000000001, 22.871999999999996, 12.584, 10.889, 12.411000000000001, 12.039, 10.232, 10.442, 10.75, 12.337, 13.739, 10.625, 11.244, 11.809999999999999, 11.172, 10.781, 23.613999999999976, 14.195000000000002, 13.28, 12.431000000000001, 31.23400000000002, 11.523000000000001, 10.44, 10.719, 12.073, 11.554, 11.584, 10.433, 12.259, 10.659999999999998, 10.075, 13.386, 11.545, 11.001000000000001, 10.669, 20.991999999999994, 11.603, 10.535, 10.043, 13.120000000000003, 11.813, 11.952], "episode_lengths": [53, 37, 47, 40, 39, 214, 40, 42, 51, 48, 39, 37, 38, 257, 44, 40, 42, 36, 39, 46, 43, 49, 40, 34, 36, 45, 64, 37, 155, 71, 47, 172, 42, 49, 39, 38, 44, 52, 46, 41, 88, 44, 36, 45, 38, 39, 39, 38, 45, 45, 37, 41, 39, 35, 43, 43, 38, 73, 40, 150, 40, 40, 43, 44, 36, 39, 42, 48, 56, 38, 45, 42, 42, 41, 239, 85, 67, 57, 225, 45, 36, 37, 55, 38, 41, 39, 49, 39, 41, 66, 50, 44, 38, 127, 41, 39, 37, 62, 45, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5407784050993985, "mean_inference_ms": 1.2440144185421431, "mean_action_processing_ms": 0.08486270403852174, "mean_env_wait_ms": 5.1127310581546785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003519296646118164, "ViewRequirementAgentConnector_ms": 0.23503804206848145}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59390, "num_agent_steps_trained": 0, "num_env_steps_sampled": 59392, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.887408241103446, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 59392, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 59390, "timers": {"training_iteration_time_ms": 149131.787, "sample_time_ms": 6895.84, "synch_weights_time_ms": 51.535}, "counters": {"num_env_steps_sampled": 59392, "num_env_steps_trained": 0, "num_agent_steps_sampled": 59390, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1072, "training_iteration": 58, "trial_id": "default", "date": "2025-12-20_01-05-38", "timestamp": 1766163938, "time_this_iter_s": 148.67964029312134, "time_total_s": 9484.520855665207, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9484.520855665207, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 95.00990566037736, "ram_util_percent": 16.439150943396225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.47253455920144916}, "default_policy": {"total_loss": 0.47253455920144916, "policy_loss": -0.023336657835170627, "vf_loss": 1.9830150608206167, "vf_loss_unclipped": 8.773620992922224, "vf_explained_var": 0.484797802567482, "entropy": 0.5546389501541853, "mean_kl_loss": 0.006720922640494109, "gradients_default_optimizer_global_norm": 1.256058923061937, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 60416, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60414, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.23400000000002, "episode_reward_min": 9.822000000000001, "episode_reward_mean": 12.476389999999999, "episode_len_mean": 55.6, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.641, 10.373000000000001, 12.437000000000001, 11.514000000000001, 11.662, 10.571, 10.321, 10.244, 11.012, 13.098, 9.933, 23.579, 13.523000000000001, 12.885000000000002, 24.862999999999985, 11.431999999999999, 11.716000000000001, 10.978000000000002, 11.484, 10.675999999999998, 13.183, 12.765, 12.309000000000001, 15.332999999999997, 12.244, 9.822000000000001, 12.632000000000001, 10.346, 10.658999999999999, 10.632, 11.062999999999999, 11.85, 11.944999999999999, 10.650000000000002, 12.411000000000001, 11.478000000000002, 10.401, 11.525999999999998, 11.359, 11.062000000000001, 13.853000000000002, 10.649000000000001, 22.871999999999996, 12.584, 10.889, 12.411000000000001, 12.039, 10.232, 10.442, 10.75, 12.337, 13.739, 10.625, 11.244, 11.809999999999999, 11.172, 10.781, 23.613999999999976, 14.195000000000002, 13.28, 12.431000000000001, 31.23400000000002, 11.523000000000001, 10.44, 10.719, 12.073, 11.554, 11.584, 10.433, 12.259, 10.659999999999998, 10.075, 13.386, 11.545, 11.001000000000001, 10.669, 20.991999999999994, 11.603, 10.535, 10.043, 13.120000000000003, 11.813, 11.952, 13.363999999999999, 10.135, 10.46, 12.024000000000001, 11.55, 9.999, 21.262000000000008, 10.721, 10.408, 10.97, 10.865, 25.238999999999987, 10.754, 10.119, 10.446, 10.857, 10.692], "episode_lengths": [36, 39, 46, 43, 49, 40, 34, 36, 45, 64, 37, 155, 71, 47, 172, 42, 49, 39, 38, 44, 52, 46, 41, 88, 44, 36, 45, 38, 39, 39, 38, 45, 45, 37, 41, 39, 35, 43, 43, 38, 73, 40, 150, 40, 40, 43, 44, 36, 39, 42, 48, 56, 38, 45, 42, 42, 41, 239, 85, 67, 57, 225, 45, 36, 37, 55, 38, 41, 39, 49, 39, 41, 66, 50, 44, 38, 127, 41, 39, 37, 62, 45, 54, 70, 36, 39, 61, 50, 32, 129, 36, 34, 46, 40, 239, 41, 37, 36, 38, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5404122173820466, "mean_inference_ms": 1.2429684865932464, "mean_action_processing_ms": 0.08479626907206697, "mean_env_wait_ms": 5.1089796218084444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032873153686523438, "ViewRequirementAgentConnector_ms": 0.2328321933746338}}, "episode_reward_max": 31.23400000000002, "episode_reward_min": 9.822000000000001, "episode_reward_mean": 12.476389999999999, "episode_len_mean": 55.6, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.641, 10.373000000000001, 12.437000000000001, 11.514000000000001, 11.662, 10.571, 10.321, 10.244, 11.012, 13.098, 9.933, 23.579, 13.523000000000001, 12.885000000000002, 24.862999999999985, 11.431999999999999, 11.716000000000001, 10.978000000000002, 11.484, 10.675999999999998, 13.183, 12.765, 12.309000000000001, 15.332999999999997, 12.244, 9.822000000000001, 12.632000000000001, 10.346, 10.658999999999999, 10.632, 11.062999999999999, 11.85, 11.944999999999999, 10.650000000000002, 12.411000000000001, 11.478000000000002, 10.401, 11.525999999999998, 11.359, 11.062000000000001, 13.853000000000002, 10.649000000000001, 22.871999999999996, 12.584, 10.889, 12.411000000000001, 12.039, 10.232, 10.442, 10.75, 12.337, 13.739, 10.625, 11.244, 11.809999999999999, 11.172, 10.781, 23.613999999999976, 14.195000000000002, 13.28, 12.431000000000001, 31.23400000000002, 11.523000000000001, 10.44, 10.719, 12.073, 11.554, 11.584, 10.433, 12.259, 10.659999999999998, 10.075, 13.386, 11.545, 11.001000000000001, 10.669, 20.991999999999994, 11.603, 10.535, 10.043, 13.120000000000003, 11.813, 11.952, 13.363999999999999, 10.135, 10.46, 12.024000000000001, 11.55, 9.999, 21.262000000000008, 10.721, 10.408, 10.97, 10.865, 25.238999999999987, 10.754, 10.119, 10.446, 10.857, 10.692], "episode_lengths": [36, 39, 46, 43, 49, 40, 34, 36, 45, 64, 37, 155, 71, 47, 172, 42, 49, 39, 38, 44, 52, 46, 41, 88, 44, 36, 45, 38, 39, 39, 38, 45, 45, 37, 41, 39, 35, 43, 43, 38, 73, 40, 150, 40, 40, 43, 44, 36, 39, 42, 48, 56, 38, 45, 42, 42, 41, 239, 85, 67, 57, 225, 45, 36, 37, 55, 38, 41, 39, 49, 39, 41, 66, 50, 44, 38, 127, 41, 39, 37, 62, 45, 54, 70, 36, 39, 61, 50, 32, 129, 36, 34, 46, 40, 239, 41, 37, 36, 38, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5404122173820466, "mean_inference_ms": 1.2429684865932464, "mean_action_processing_ms": 0.08479626907206697, "mean_env_wait_ms": 5.1089796218084444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032873153686523438, "ViewRequirementAgentConnector_ms": 0.2328321933746338}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60414, "num_agent_steps_trained": 0, "num_env_steps_sampled": 60416, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.902544643985789, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 60416, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 60414, "timers": {"training_iteration_time_ms": 149184.204, "sample_time_ms": 6889.341, "synch_weights_time_ms": 52.829}, "counters": {"num_env_steps_sampled": 60416, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60414, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1089, "training_iteration": 59, "trial_id": "default", "date": "2025-12-20_01-08-06", "timestamp": 1766164086, "time_this_iter_s": 148.35793447494507, "time_total_s": 9632.878790140152, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9632.878790140152, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 94.75924170616113, "ram_util_percent": 15.928909952606634}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.603546050330624}, "default_policy": {"total_loss": 0.603546050330624, "policy_loss": -0.025786027777940035, "vf_loss": 2.5146552694030104, "vf_loss_unclipped": 11.112775116879494, "vf_explained_var": 0.4669648826122284, "entropy": 0.5463550886139273, "mean_kl_loss": 0.012146170647898202, "gradients_default_optimizer_global_norm": 1.2976287882775068, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 61440, "num_env_steps_trained": 0, "num_agent_steps_sampled": 61438, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.23400000000002, "episode_reward_min": 9.822000000000001, "episode_reward_mean": 12.199269999999999, "episode_len_mean": 53.45, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.765, 12.309000000000001, 15.332999999999997, 12.244, 9.822000000000001, 12.632000000000001, 10.346, 10.658999999999999, 10.632, 11.062999999999999, 11.85, 11.944999999999999, 10.650000000000002, 12.411000000000001, 11.478000000000002, 10.401, 11.525999999999998, 11.359, 11.062000000000001, 13.853000000000002, 10.649000000000001, 22.871999999999996, 12.584, 10.889, 12.411000000000001, 12.039, 10.232, 10.442, 10.75, 12.337, 13.739, 10.625, 11.244, 11.809999999999999, 11.172, 10.781, 23.613999999999976, 14.195000000000002, 13.28, 12.431000000000001, 31.23400000000002, 11.523000000000001, 10.44, 10.719, 12.073, 11.554, 11.584, 10.433, 12.259, 10.659999999999998, 10.075, 13.386, 11.545, 11.001000000000001, 10.669, 20.991999999999994, 11.603, 10.535, 10.043, 13.120000000000003, 11.813, 11.952, 13.363999999999999, 10.135, 10.46, 12.024000000000001, 11.55, 9.999, 21.262000000000008, 10.721, 10.408, 10.97, 10.865, 25.238999999999987, 10.754, 10.119, 10.446, 10.857, 10.692, 14.437999999999999, 9.829, 10.713000000000001, 10.535, 14.225999999999999, 10.065, 11.068, 11.059, 10.85, 10.545, 10.651, 15.128, 10.046, 10.915, 10.820999999999998, 12.144999999999998, 11.748, 11.302999999999999, 11.078000000000001, 10.677, 10.572999999999999], "episode_lengths": [46, 41, 88, 44, 36, 45, 38, 39, 39, 38, 45, 45, 37, 41, 39, 35, 43, 43, 38, 73, 40, 150, 40, 40, 43, 44, 36, 39, 42, 48, 56, 38, 45, 42, 42, 41, 239, 85, 67, 57, 225, 45, 36, 37, 55, 38, 41, 39, 49, 39, 41, 66, 50, 44, 38, 127, 41, 39, 37, 62, 45, 54, 70, 36, 39, 61, 50, 32, 129, 36, 34, 46, 40, 239, 41, 37, 36, 38, 43, 76, 39, 36, 52, 70, 41, 43, 42, 37, 41, 39, 82, 37, 36, 36, 52, 49, 43, 40, 40, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5401647091848997, "mean_inference_ms": 1.242193398961811, "mean_action_processing_ms": 0.08475150954140556, "mean_env_wait_ms": 5.105208004610838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032706260681152344, "ViewRequirementAgentConnector_ms": 0.23237895965576172}}, "episode_reward_max": 31.23400000000002, "episode_reward_min": 9.822000000000001, "episode_reward_mean": 12.199269999999999, "episode_len_mean": 53.45, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.765, 12.309000000000001, 15.332999999999997, 12.244, 9.822000000000001, 12.632000000000001, 10.346, 10.658999999999999, 10.632, 11.062999999999999, 11.85, 11.944999999999999, 10.650000000000002, 12.411000000000001, 11.478000000000002, 10.401, 11.525999999999998, 11.359, 11.062000000000001, 13.853000000000002, 10.649000000000001, 22.871999999999996, 12.584, 10.889, 12.411000000000001, 12.039, 10.232, 10.442, 10.75, 12.337, 13.739, 10.625, 11.244, 11.809999999999999, 11.172, 10.781, 23.613999999999976, 14.195000000000002, 13.28, 12.431000000000001, 31.23400000000002, 11.523000000000001, 10.44, 10.719, 12.073, 11.554, 11.584, 10.433, 12.259, 10.659999999999998, 10.075, 13.386, 11.545, 11.001000000000001, 10.669, 20.991999999999994, 11.603, 10.535, 10.043, 13.120000000000003, 11.813, 11.952, 13.363999999999999, 10.135, 10.46, 12.024000000000001, 11.55, 9.999, 21.262000000000008, 10.721, 10.408, 10.97, 10.865, 25.238999999999987, 10.754, 10.119, 10.446, 10.857, 10.692, 14.437999999999999, 9.829, 10.713000000000001, 10.535, 14.225999999999999, 10.065, 11.068, 11.059, 10.85, 10.545, 10.651, 15.128, 10.046, 10.915, 10.820999999999998, 12.144999999999998, 11.748, 11.302999999999999, 11.078000000000001, 10.677, 10.572999999999999], "episode_lengths": [46, 41, 88, 44, 36, 45, 38, 39, 39, 38, 45, 45, 37, 41, 39, 35, 43, 43, 38, 73, 40, 150, 40, 40, 43, 44, 36, 39, 42, 48, 56, 38, 45, 42, 42, 41, 239, 85, 67, 57, 225, 45, 36, 37, 55, 38, 41, 39, 49, 39, 41, 66, 50, 44, 38, 127, 41, 39, 37, 62, 45, 54, 70, 36, 39, 61, 50, 32, 129, 36, 34, 46, 40, 239, 41, 37, 36, 38, 43, 76, 39, 36, 52, 70, 41, 43, 42, 37, 41, 39, 82, 37, 36, 36, 52, 49, 43, 40, 40, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5401647091848997, "mean_inference_ms": 1.242193398961811, "mean_action_processing_ms": 0.08475150954140556, "mean_env_wait_ms": 5.105208004610838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032706260681152344, "ViewRequirementAgentConnector_ms": 0.23237895965576172}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61438, "num_agent_steps_trained": 0, "num_env_steps_sampled": 61440, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.905525676187631, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 61440, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 61438, "timers": {"training_iteration_time_ms": 149122.838, "sample_time_ms": 6881.861, "synch_weights_time_ms": 52.64}, "counters": {"num_env_steps_sampled": 61440, "num_env_steps_trained": 0, "num_agent_steps_sampled": 61438, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1110, "training_iteration": 60, "trial_id": "default", "date": "2025-12-20_01-10-35", "timestamp": 1766164235, "time_this_iter_s": 148.28992867469788, "time_total_s": 9781.16871881485, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9781.16871881485, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 94.88199052132703, "ram_util_percent": 16.29383886255924}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.45005958452820777}, "default_policy": {"total_loss": 0.45005958452820777, "policy_loss": -0.023513793625170365, "vf_loss": 1.8924580588238313, "vf_loss_unclipped": 8.257507390459068, "vf_explained_var": 0.5282211106270551, "entropy": 0.5103357735089957, "mean_kl_loss": 0.009692051840352179, "gradients_default_optimizer_global_norm": 1.1133383226580917, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 62464, "num_env_steps_trained": 0, "num_agent_steps_sampled": 62462, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.23400000000002, "episode_reward_min": 9.829, "episode_reward_mean": 12.35366, "episode_len_mean": 57.1, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.525999999999998, 11.359, 11.062000000000001, 13.853000000000002, 10.649000000000001, 22.871999999999996, 12.584, 10.889, 12.411000000000001, 12.039, 10.232, 10.442, 10.75, 12.337, 13.739, 10.625, 11.244, 11.809999999999999, 11.172, 10.781, 23.613999999999976, 14.195000000000002, 13.28, 12.431000000000001, 31.23400000000002, 11.523000000000001, 10.44, 10.719, 12.073, 11.554, 11.584, 10.433, 12.259, 10.659999999999998, 10.075, 13.386, 11.545, 11.001000000000001, 10.669, 20.991999999999994, 11.603, 10.535, 10.043, 13.120000000000003, 11.813, 11.952, 13.363999999999999, 10.135, 10.46, 12.024000000000001, 11.55, 9.999, 21.262000000000008, 10.721, 10.408, 10.97, 10.865, 25.238999999999987, 10.754, 10.119, 10.446, 10.857, 10.692, 14.437999999999999, 9.829, 10.713000000000001, 10.535, 14.225999999999999, 10.065, 11.068, 11.059, 10.85, 10.545, 10.651, 15.128, 10.046, 10.915, 10.820999999999998, 12.144999999999998, 11.748, 11.302999999999999, 11.078000000000001, 10.677, 10.572999999999999, 25.493000000000038, 11.135, 11.039, 10.660000000000002, 11.058, 10.986999999999998, 10.274000000000001, 10.46, 13.256, 10.096, 12.155, 10.807, 21.68100000000002, 10.96, 11.611999999999998, 10.306], "episode_lengths": [43, 43, 38, 73, 40, 150, 40, 40, 43, 44, 36, 39, 42, 48, 56, 38, 45, 42, 42, 41, 239, 85, 67, 57, 225, 45, 36, 37, 55, 38, 41, 39, 49, 39, 41, 66, 50, 44, 38, 127, 41, 39, 37, 62, 45, 54, 70, 36, 39, 61, 50, 32, 129, 36, 34, 46, 40, 239, 41, 37, 36, 38, 43, 76, 39, 36, 52, 70, 41, 43, 42, 37, 41, 39, 82, 37, 36, 36, 52, 49, 43, 40, 40, 32, 237, 38, 44, 43, 40, 41, 31, 52, 50, 34, 50, 37, 235, 45, 47, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5397409585846079, "mean_inference_ms": 1.2409744773807956, "mean_action_processing_ms": 0.08467366846036954, "mean_env_wait_ms": 5.101601482808656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032341480255126953, "ViewRequirementAgentConnector_ms": 0.2321772575378418}}, "episode_reward_max": 31.23400000000002, "episode_reward_min": 9.829, "episode_reward_mean": 12.35366, "episode_len_mean": 57.1, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.525999999999998, 11.359, 11.062000000000001, 13.853000000000002, 10.649000000000001, 22.871999999999996, 12.584, 10.889, 12.411000000000001, 12.039, 10.232, 10.442, 10.75, 12.337, 13.739, 10.625, 11.244, 11.809999999999999, 11.172, 10.781, 23.613999999999976, 14.195000000000002, 13.28, 12.431000000000001, 31.23400000000002, 11.523000000000001, 10.44, 10.719, 12.073, 11.554, 11.584, 10.433, 12.259, 10.659999999999998, 10.075, 13.386, 11.545, 11.001000000000001, 10.669, 20.991999999999994, 11.603, 10.535, 10.043, 13.120000000000003, 11.813, 11.952, 13.363999999999999, 10.135, 10.46, 12.024000000000001, 11.55, 9.999, 21.262000000000008, 10.721, 10.408, 10.97, 10.865, 25.238999999999987, 10.754, 10.119, 10.446, 10.857, 10.692, 14.437999999999999, 9.829, 10.713000000000001, 10.535, 14.225999999999999, 10.065, 11.068, 11.059, 10.85, 10.545, 10.651, 15.128, 10.046, 10.915, 10.820999999999998, 12.144999999999998, 11.748, 11.302999999999999, 11.078000000000001, 10.677, 10.572999999999999, 25.493000000000038, 11.135, 11.039, 10.660000000000002, 11.058, 10.986999999999998, 10.274000000000001, 10.46, 13.256, 10.096, 12.155, 10.807, 21.68100000000002, 10.96, 11.611999999999998, 10.306], "episode_lengths": [43, 43, 38, 73, 40, 150, 40, 40, 43, 44, 36, 39, 42, 48, 56, 38, 45, 42, 42, 41, 239, 85, 67, 57, 225, 45, 36, 37, 55, 38, 41, 39, 49, 39, 41, 66, 50, 44, 38, 127, 41, 39, 37, 62, 45, 54, 70, 36, 39, 61, 50, 32, 129, 36, 34, 46, 40, 239, 41, 37, 36, 38, 43, 76, 39, 36, 52, 70, 41, 43, 42, 37, 41, 39, 82, 37, 36, 36, 52, 49, 43, 40, 40, 32, 237, 38, 44, 43, 40, 41, 31, 52, 50, 34, 50, 37, 235, 45, 47, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5397409585846079, "mean_inference_ms": 1.2409744773807956, "mean_action_processing_ms": 0.08467366846036954, "mean_env_wait_ms": 5.101601482808656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032341480255126953, "ViewRequirementAgentConnector_ms": 0.2321772575378418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62462, "num_agent_steps_trained": 0, "num_env_steps_sampled": 62464, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.850000065151254, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 62464, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 62462, "timers": {"training_iteration_time_ms": 149083.651, "sample_time_ms": 6877.256, "synch_weights_time_ms": 52.878}, "counters": {"num_env_steps_sampled": 62464, "num_env_steps_trained": 0, "num_agent_steps_sampled": 62462, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1126, "training_iteration": 61, "trial_id": "default", "date": "2025-12-20_01-13-04", "timestamp": 1766164384, "time_this_iter_s": 149.49434518814087, "time_total_s": 9930.66306400299, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9930.66306400299, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 94.92769953051642, "ram_util_percent": 16.62300469483568}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.4899207348003983}, "default_policy": {"total_loss": 0.4899207348003983, "policy_loss": -0.02188908914104104, "vf_loss": 2.04613209720992, "vf_loss_unclipped": 8.141238992477884, "vf_explained_var": 0.510733162984252, "entropy": 0.49624032229185105, "mean_kl_loss": 0.007730467886774761, "gradients_default_optimizer_global_norm": 1.322810291312635, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 63488, "num_env_steps_trained": 0, "num_agent_steps_sampled": 63486, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.23400000000002, "episode_reward_min": 9.829, "episode_reward_mean": 12.456470000000001, "episode_len_mean": 58.83, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.244, 11.809999999999999, 11.172, 10.781, 23.613999999999976, 14.195000000000002, 13.28, 12.431000000000001, 31.23400000000002, 11.523000000000001, 10.44, 10.719, 12.073, 11.554, 11.584, 10.433, 12.259, 10.659999999999998, 10.075, 13.386, 11.545, 11.001000000000001, 10.669, 20.991999999999994, 11.603, 10.535, 10.043, 13.120000000000003, 11.813, 11.952, 13.363999999999999, 10.135, 10.46, 12.024000000000001, 11.55, 9.999, 21.262000000000008, 10.721, 10.408, 10.97, 10.865, 25.238999999999987, 10.754, 10.119, 10.446, 10.857, 10.692, 14.437999999999999, 9.829, 10.713000000000001, 10.535, 14.225999999999999, 10.065, 11.068, 11.059, 10.85, 10.545, 10.651, 15.128, 10.046, 10.915, 10.820999999999998, 12.144999999999998, 11.748, 11.302999999999999, 11.078000000000001, 10.677, 10.572999999999999, 25.493000000000038, 11.135, 11.039, 10.660000000000002, 11.058, 10.986999999999998, 10.274000000000001, 10.46, 13.256, 10.096, 12.155, 10.807, 21.68100000000002, 10.96, 11.611999999999998, 10.306, 23.529000000000003, 11.904, 11.942, 16.033, 11.920000000000002, 16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675], "episode_lengths": [45, 42, 42, 41, 239, 85, 67, 57, 225, 45, 36, 37, 55, 38, 41, 39, 49, 39, 41, 66, 50, 44, 38, 127, 41, 39, 37, 62, 45, 54, 70, 36, 39, 61, 50, 32, 129, 36, 34, 46, 40, 239, 41, 37, 36, 38, 43, 76, 39, 36, 52, 70, 41, 43, 42, 37, 41, 39, 82, 37, 36, 36, 52, 49, 43, 40, 40, 32, 237, 38, 44, 43, 40, 41, 31, 52, 50, 34, 50, 37, 235, 45, 47, 37, 161, 46, 47, 93, 51, 90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5384835911611426, "mean_inference_ms": 1.2380154691198628, "mean_action_processing_ms": 0.08447845434618136, "mean_env_wait_ms": 5.095632147165374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032422542572021484, "ViewRequirementAgentConnector_ms": 0.23186445236206055}}, "episode_reward_max": 31.23400000000002, "episode_reward_min": 9.829, "episode_reward_mean": 12.456470000000001, "episode_len_mean": 58.83, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.244, 11.809999999999999, 11.172, 10.781, 23.613999999999976, 14.195000000000002, 13.28, 12.431000000000001, 31.23400000000002, 11.523000000000001, 10.44, 10.719, 12.073, 11.554, 11.584, 10.433, 12.259, 10.659999999999998, 10.075, 13.386, 11.545, 11.001000000000001, 10.669, 20.991999999999994, 11.603, 10.535, 10.043, 13.120000000000003, 11.813, 11.952, 13.363999999999999, 10.135, 10.46, 12.024000000000001, 11.55, 9.999, 21.262000000000008, 10.721, 10.408, 10.97, 10.865, 25.238999999999987, 10.754, 10.119, 10.446, 10.857, 10.692, 14.437999999999999, 9.829, 10.713000000000001, 10.535, 14.225999999999999, 10.065, 11.068, 11.059, 10.85, 10.545, 10.651, 15.128, 10.046, 10.915, 10.820999999999998, 12.144999999999998, 11.748, 11.302999999999999, 11.078000000000001, 10.677, 10.572999999999999, 25.493000000000038, 11.135, 11.039, 10.660000000000002, 11.058, 10.986999999999998, 10.274000000000001, 10.46, 13.256, 10.096, 12.155, 10.807, 21.68100000000002, 10.96, 11.611999999999998, 10.306, 23.529000000000003, 11.904, 11.942, 16.033, 11.920000000000002, 16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675], "episode_lengths": [45, 42, 42, 41, 239, 85, 67, 57, 225, 45, 36, 37, 55, 38, 41, 39, 49, 39, 41, 66, 50, 44, 38, 127, 41, 39, 37, 62, 45, 54, 70, 36, 39, 61, 50, 32, 129, 36, 34, 46, 40, 239, 41, 37, 36, 38, 43, 76, 39, 36, 52, 70, 41, 43, 42, 37, 41, 39, 82, 37, 36, 36, 52, 49, 43, 40, 40, 32, 237, 38, 44, 43, 40, 41, 31, 52, 50, 34, 50, 37, 235, 45, 47, 37, 161, 46, 47, 93, 51, 90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5384835911611426, "mean_inference_ms": 1.2380154691198628, "mean_action_processing_ms": 0.08447845434618136, "mean_env_wait_ms": 5.095632147165374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032422542572021484, "ViewRequirementAgentConnector_ms": 0.23186445236206055}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63486, "num_agent_steps_trained": 0, "num_env_steps_sampled": 63488, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.9244969050689145, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 63488, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 63486, "timers": {"training_iteration_time_ms": 149024.246, "sample_time_ms": 6865.069, "synch_weights_time_ms": 52.614}, "counters": {"num_env_steps_sampled": 63488, "num_env_steps_trained": 0, "num_agent_steps_sampled": 63486, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1142, "training_iteration": 62, "trial_id": "default", "date": "2025-12-20_01-15-40", "timestamp": 1766164540, "time_this_iter_s": 147.8865442276001, "time_total_s": 10078.54960823059, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10078.54960823059, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 90.65882352941176, "ram_util_percent": 16.38733031674208}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.47786832484416664}, "default_policy": {"total_loss": 0.47786832484416664, "policy_loss": -0.022962356940843164, "vf_loss": 2.00039129271172, "vf_loss_unclipped": 9.167284718109295, "vf_explained_var": 0.6290610078722239, "entropy": 0.49537341110408306, "mean_kl_loss": 0.012282296871534015, "gradients_default_optimizer_global_norm": 0.9981284966692329, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64510, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 25.493000000000038, "episode_reward_min": 9.829, "episode_reward_mean": 12.406880000000001, "episode_len_mean": 58.03, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.659999999999998, 10.075, 13.386, 11.545, 11.001000000000001, 10.669, 20.991999999999994, 11.603, 10.535, 10.043, 13.120000000000003, 11.813, 11.952, 13.363999999999999, 10.135, 10.46, 12.024000000000001, 11.55, 9.999, 21.262000000000008, 10.721, 10.408, 10.97, 10.865, 25.238999999999987, 10.754, 10.119, 10.446, 10.857, 10.692, 14.437999999999999, 9.829, 10.713000000000001, 10.535, 14.225999999999999, 10.065, 11.068, 11.059, 10.85, 10.545, 10.651, 15.128, 10.046, 10.915, 10.820999999999998, 12.144999999999998, 11.748, 11.302999999999999, 11.078000000000001, 10.677, 10.572999999999999, 25.493000000000038, 11.135, 11.039, 10.660000000000002, 11.058, 10.986999999999998, 10.274000000000001, 10.46, 13.256, 10.096, 12.155, 10.807, 21.68100000000002, 10.96, 11.611999999999998, 10.306, 23.529000000000003, 11.904, 11.942, 16.033, 11.920000000000002, 16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999], "episode_lengths": [39, 41, 66, 50, 44, 38, 127, 41, 39, 37, 62, 45, 54, 70, 36, 39, 61, 50, 32, 129, 36, 34, 46, 40, 239, 41, 37, 36, 38, 43, 76, 39, 36, 52, 70, 41, 43, 42, 37, 41, 39, 82, 37, 36, 36, 52, 49, 43, 40, 40, 32, 237, 38, 44, 43, 40, 41, 31, 52, 50, 34, 50, 37, 235, 45, 47, 37, 161, 46, 47, 93, 51, 90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5375821806505455, "mean_inference_ms": 1.2365374917917547, "mean_action_processing_ms": 0.08434141632432074, "mean_env_wait_ms": 5.090742248614374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032300949096679688, "ViewRequirementAgentConnector_ms": 0.23153400421142578}}, "episode_reward_max": 25.493000000000038, "episode_reward_min": 9.829, "episode_reward_mean": 12.406880000000001, "episode_len_mean": 58.03, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.659999999999998, 10.075, 13.386, 11.545, 11.001000000000001, 10.669, 20.991999999999994, 11.603, 10.535, 10.043, 13.120000000000003, 11.813, 11.952, 13.363999999999999, 10.135, 10.46, 12.024000000000001, 11.55, 9.999, 21.262000000000008, 10.721, 10.408, 10.97, 10.865, 25.238999999999987, 10.754, 10.119, 10.446, 10.857, 10.692, 14.437999999999999, 9.829, 10.713000000000001, 10.535, 14.225999999999999, 10.065, 11.068, 11.059, 10.85, 10.545, 10.651, 15.128, 10.046, 10.915, 10.820999999999998, 12.144999999999998, 11.748, 11.302999999999999, 11.078000000000001, 10.677, 10.572999999999999, 25.493000000000038, 11.135, 11.039, 10.660000000000002, 11.058, 10.986999999999998, 10.274000000000001, 10.46, 13.256, 10.096, 12.155, 10.807, 21.68100000000002, 10.96, 11.611999999999998, 10.306, 23.529000000000003, 11.904, 11.942, 16.033, 11.920000000000002, 16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999], "episode_lengths": [39, 41, 66, 50, 44, 38, 127, 41, 39, 37, 62, 45, 54, 70, 36, 39, 61, 50, 32, 129, 36, 34, 46, 40, 239, 41, 37, 36, 38, 43, 76, 39, 36, 52, 70, 41, 43, 42, 37, 41, 39, 82, 37, 36, 36, 52, 49, 43, 40, 40, 32, 237, 38, 44, 43, 40, 41, 31, 52, 50, 34, 50, 37, 235, 45, 47, 37, 161, 46, 47, 93, 51, 90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5375821806505455, "mean_inference_ms": 1.2365374917917547, "mean_action_processing_ms": 0.08434141632432074, "mean_env_wait_ms": 5.090742248614374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032300949096679688, "ViewRequirementAgentConnector_ms": 0.23153400421142578}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64510, "num_agent_steps_trained": 0, "num_env_steps_sampled": 64512, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.856337143251965, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 64512, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 64510, "timers": {"training_iteration_time_ms": 149009.799, "sample_time_ms": 6820.525, "synch_weights_time_ms": 51.934}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64510, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1159, "training_iteration": 63, "trial_id": "default", "date": "2025-12-20_01-18-09", "timestamp": 1766164689, "time_this_iter_s": 149.3542938232422, "time_total_s": 10227.903902053833, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10227.903902053833, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 94.88207547169812, "ram_util_percent": 16.147641509433964}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.4215508167631924}, "default_policy": {"total_loss": 0.4215508167631924, "policy_loss": -0.02536102943122387, "vf_loss": 1.7864603006571997, "vf_loss_unclipped": 7.376034874591278, "vf_explained_var": 0.387979868799448, "entropy": 0.49116101674735546, "mean_kl_loss": 0.007879311634195574, "gradients_default_optimizer_global_norm": 1.2296116901561618, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 65536, "num_env_steps_trained": 0, "num_agent_steps_sampled": 65534, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 25.493000000000038, "episode_reward_min": 9.829, "episode_reward_mean": 12.571530000000001, "episode_len_mean": 61.04, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.135, 10.46, 12.024000000000001, 11.55, 9.999, 21.262000000000008, 10.721, 10.408, 10.97, 10.865, 25.238999999999987, 10.754, 10.119, 10.446, 10.857, 10.692, 14.437999999999999, 9.829, 10.713000000000001, 10.535, 14.225999999999999, 10.065, 11.068, 11.059, 10.85, 10.545, 10.651, 15.128, 10.046, 10.915, 10.820999999999998, 12.144999999999998, 11.748, 11.302999999999999, 11.078000000000001, 10.677, 10.572999999999999, 25.493000000000038, 11.135, 11.039, 10.660000000000002, 11.058, 10.986999999999998, 10.274000000000001, 10.46, 13.256, 10.096, 12.155, 10.807, 21.68100000000002, 10.96, 11.611999999999998, 10.306, 23.529000000000003, 11.904, 11.942, 16.033, 11.920000000000002, 16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238], "episode_lengths": [36, 39, 61, 50, 32, 129, 36, 34, 46, 40, 239, 41, 37, 36, 38, 43, 76, 39, 36, 52, 70, 41, 43, 42, 37, 41, 39, 82, 37, 36, 36, 52, 49, 43, 40, 40, 32, 237, 38, 44, 43, 40, 41, 31, 52, 50, 34, 50, 37, 235, 45, 47, 37, 161, 46, 47, 93, 51, 90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.537279287719295, "mean_inference_ms": 1.2363903556987963, "mean_action_processing_ms": 0.08430144354940775, "mean_env_wait_ms": 5.088088799850947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032553672790527344, "ViewRequirementAgentConnector_ms": 0.23204302787780762}}, "episode_reward_max": 25.493000000000038, "episode_reward_min": 9.829, "episode_reward_mean": 12.571530000000001, "episode_len_mean": 61.04, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.135, 10.46, 12.024000000000001, 11.55, 9.999, 21.262000000000008, 10.721, 10.408, 10.97, 10.865, 25.238999999999987, 10.754, 10.119, 10.446, 10.857, 10.692, 14.437999999999999, 9.829, 10.713000000000001, 10.535, 14.225999999999999, 10.065, 11.068, 11.059, 10.85, 10.545, 10.651, 15.128, 10.046, 10.915, 10.820999999999998, 12.144999999999998, 11.748, 11.302999999999999, 11.078000000000001, 10.677, 10.572999999999999, 25.493000000000038, 11.135, 11.039, 10.660000000000002, 11.058, 10.986999999999998, 10.274000000000001, 10.46, 13.256, 10.096, 12.155, 10.807, 21.68100000000002, 10.96, 11.611999999999998, 10.306, 23.529000000000003, 11.904, 11.942, 16.033, 11.920000000000002, 16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238], "episode_lengths": [36, 39, 61, 50, 32, 129, 36, 34, 46, 40, 239, 41, 37, 36, 38, 43, 76, 39, 36, 52, 70, 41, 43, 42, 37, 41, 39, 82, 37, 36, 36, 52, 49, 43, 40, 40, 32, 237, 38, 44, 43, 40, 41, 31, 52, 50, 34, 50, 37, 235, 45, 47, 37, 161, 46, 47, 93, 51, 90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.537279287719295, "mean_inference_ms": 1.2363903556987963, "mean_action_processing_ms": 0.08430144354940775, "mean_env_wait_ms": 5.088088799850947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032553672790527344, "ViewRequirementAgentConnector_ms": 0.23204302787780762}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65534, "num_agent_steps_trained": 0, "num_env_steps_sampled": 65536, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.8672403286870765, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 65536, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 65534, "timers": {"training_iteration_time_ms": 148974.056, "sample_time_ms": 6812.528, "synch_weights_time_ms": 52.019}, "counters": {"num_env_steps_sampled": 65536, "num_env_steps_trained": 0, "num_agent_steps_sampled": 65534, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1173, "training_iteration": 64, "trial_id": "default", "date": "2025-12-20_01-20-38", "timestamp": 1766164838, "time_this_iter_s": 149.1203396320343, "time_total_s": 10377.024241685867, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10377.024241685867, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 94.89575471698114, "ram_util_percent": 16.29198113207547}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.4101864058058709}, "default_policy": {"total_loss": 0.4101864058058709, "policy_loss": -0.0167082694824785, "vf_loss": 1.7062671910971403, "vf_loss_unclipped": 7.345629611238837, "vf_explained_var": 0.4295156836509705, "entropy": 0.48209397252649067, "mean_kl_loss": 0.008099702928103625, "gradients_default_optimizer_global_norm": 1.589088791795075, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 66560, "num_env_steps_trained": 0, "num_agent_steps_sampled": 66558, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 25.549000000000003, "episode_reward_min": 9.829, "episode_reward_mean": 12.693580000000004, "episode_len_mean": 61.98, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.857, 10.692, 14.437999999999999, 9.829, 10.713000000000001, 10.535, 14.225999999999999, 10.065, 11.068, 11.059, 10.85, 10.545, 10.651, 15.128, 10.046, 10.915, 10.820999999999998, 12.144999999999998, 11.748, 11.302999999999999, 11.078000000000001, 10.677, 10.572999999999999, 25.493000000000038, 11.135, 11.039, 10.660000000000002, 11.058, 10.986999999999998, 10.274000000000001, 10.46, 13.256, 10.096, 12.155, 10.807, 21.68100000000002, 10.96, 11.611999999999998, 10.306, 23.529000000000003, 11.904, 11.942, 16.033, 11.920000000000002, 16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348], "episode_lengths": [38, 43, 76, 39, 36, 52, 70, 41, 43, 42, 37, 41, 39, 82, 37, 36, 36, 52, 49, 43, 40, 40, 32, 237, 38, 44, 43, 40, 41, 31, 52, 50, 34, 50, 37, 235, 45, 47, 37, 161, 46, 47, 93, 51, 90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5364207231400158, "mean_inference_ms": 1.2351471026316103, "mean_action_processing_ms": 0.08418144848331302, "mean_env_wait_ms": 5.0839432255068235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032274723052978516, "ViewRequirementAgentConnector_ms": 0.2309858798980713}}, "episode_reward_max": 25.549000000000003, "episode_reward_min": 9.829, "episode_reward_mean": 12.693580000000004, "episode_len_mean": 61.98, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.857, 10.692, 14.437999999999999, 9.829, 10.713000000000001, 10.535, 14.225999999999999, 10.065, 11.068, 11.059, 10.85, 10.545, 10.651, 15.128, 10.046, 10.915, 10.820999999999998, 12.144999999999998, 11.748, 11.302999999999999, 11.078000000000001, 10.677, 10.572999999999999, 25.493000000000038, 11.135, 11.039, 10.660000000000002, 11.058, 10.986999999999998, 10.274000000000001, 10.46, 13.256, 10.096, 12.155, 10.807, 21.68100000000002, 10.96, 11.611999999999998, 10.306, 23.529000000000003, 11.904, 11.942, 16.033, 11.920000000000002, 16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348], "episode_lengths": [38, 43, 76, 39, 36, 52, 70, 41, 43, 42, 37, 41, 39, 82, 37, 36, 36, 52, 49, 43, 40, 40, 32, 237, 38, 44, 43, 40, 41, 31, 52, 50, 34, 50, 37, 235, 45, 47, 37, 161, 46, 47, 93, 51, 90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5364207231400158, "mean_inference_ms": 1.2351471026316103, "mean_action_processing_ms": 0.08418144848331302, "mean_env_wait_ms": 5.0839432255068235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032274723052978516, "ViewRequirementAgentConnector_ms": 0.2309858798980713}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66558, "num_agent_steps_trained": 0, "num_env_steps_sampled": 66560, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.817622771888077, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 66560, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 66558, "timers": {"training_iteration_time_ms": 149023.402, "sample_time_ms": 6810.654, "synch_weights_time_ms": 51.292}, "counters": {"num_env_steps_sampled": 66560, "num_env_steps_trained": 0, "num_agent_steps_sampled": 66558, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1187, "training_iteration": 65, "trial_id": "default", "date": "2025-12-20_01-23-08", "timestamp": 1766164988, "time_this_iter_s": 150.20470428466797, "time_total_s": 10527.228945970535, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10527.228945970535, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 94.93364485981309, "ram_util_percent": 16.22616822429906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.31298650642856957}, "default_policy": {"total_loss": 0.31298650642856957, "policy_loss": -0.0256504314718768, "vf_loss": 1.3534993146313354, "vf_loss_unclipped": 6.34449147048872, "vf_explained_var": 0.38386262357234957, "entropy": 0.47863104213029145, "mean_kl_loss": 0.007407371273066588, "gradients_default_optimizer_global_norm": 1.0842458601109684, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 67584, "num_env_steps_trained": 0, "num_agent_steps_sampled": 67582, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 25.549000000000003, "episode_reward_min": 9.872, "episode_reward_mean": 13.006390000000001, "episode_len_mean": 66.05, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.128, 10.046, 10.915, 10.820999999999998, 12.144999999999998, 11.748, 11.302999999999999, 11.078000000000001, 10.677, 10.572999999999999, 25.493000000000038, 11.135, 11.039, 10.660000000000002, 11.058, 10.986999999999998, 10.274000000000001, 10.46, 13.256, 10.096, 12.155, 10.807, 21.68100000000002, 10.96, 11.611999999999998, 10.306, 23.529000000000003, 11.904, 11.942, 16.033, 11.920000000000002, 16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001], "episode_lengths": [82, 37, 36, 36, 52, 49, 43, 40, 40, 32, 237, 38, 44, 43, 40, 41, 31, 52, 50, 34, 50, 37, 235, 45, 47, 37, 161, 46, 47, 93, 51, 90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5353583639018753, "mean_inference_ms": 1.2336167192647807, "mean_action_processing_ms": 0.08404748104360764, "mean_env_wait_ms": 5.079699390906368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003221750259399414, "ViewRequirementAgentConnector_ms": 0.23035144805908203}}, "episode_reward_max": 25.549000000000003, "episode_reward_min": 9.872, "episode_reward_mean": 13.006390000000001, "episode_len_mean": 66.05, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.128, 10.046, 10.915, 10.820999999999998, 12.144999999999998, 11.748, 11.302999999999999, 11.078000000000001, 10.677, 10.572999999999999, 25.493000000000038, 11.135, 11.039, 10.660000000000002, 11.058, 10.986999999999998, 10.274000000000001, 10.46, 13.256, 10.096, 12.155, 10.807, 21.68100000000002, 10.96, 11.611999999999998, 10.306, 23.529000000000003, 11.904, 11.942, 16.033, 11.920000000000002, 16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001], "episode_lengths": [82, 37, 36, 36, 52, 49, 43, 40, 40, 32, 237, 38, 44, 43, 40, 41, 31, 52, 50, 34, 50, 37, 235, 45, 47, 37, 161, 46, 47, 93, 51, 90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5353583639018753, "mean_inference_ms": 1.2336167192647807, "mean_action_processing_ms": 0.08404748104360764, "mean_env_wait_ms": 5.079699390906368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003221750259399414, "ViewRequirementAgentConnector_ms": 0.23035144805908203}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67582, "num_agent_steps_trained": 0, "num_env_steps_sampled": 67584, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.771047527574158, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 67584, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 67582, "timers": {"training_iteration_time_ms": 149299.715, "sample_time_ms": 6815.769, "synch_weights_time_ms": 51.903}, "counters": {"num_env_steps_sampled": 67584, "num_env_steps_trained": 0, "num_agent_steps_sampled": 67582, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1200, "training_iteration": 66, "trial_id": "default", "date": "2025-12-20_01-25-40", "timestamp": 1766165140, "time_this_iter_s": 151.23467302322388, "time_total_s": 10678.46361899376, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10678.46361899376, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 95.00558139534884, "ram_util_percent": 16.479534883720927}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.26584889497607944}, "default_policy": {"total_loss": 0.26584889497607944, "policy_loss": -0.026623280320200136, "vf_loss": 1.1674290796785498, "vf_loss_unclipped": 5.613005736660853, "vf_explained_var": 0.5308145005255938, "entropy": 0.4074297138489783, "mean_kl_loss": 0.010223355338877128, "gradients_default_optimizer_global_norm": 1.0066052322741599, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 68608, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68606, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 13.4678, "episode_len_mean": 71.73, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.493000000000038, 11.135, 11.039, 10.660000000000002, 11.058, 10.986999999999998, 10.274000000000001, 10.46, 13.256, 10.096, 12.155, 10.807, 21.68100000000002, 10.96, 11.611999999999998, 10.306, 23.529000000000003, 11.904, 11.942, 16.033, 11.920000000000002, 16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997], "episode_lengths": [237, 38, 44, 43, 40, 41, 31, 52, 50, 34, 50, 37, 235, 45, 47, 37, 161, 46, 47, 93, 51, 90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.535493798079469, "mean_inference_ms": 1.2346062119984902, "mean_action_processing_ms": 0.08410026714989652, "mean_env_wait_ms": 5.079422543266885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003229856491088867, "ViewRequirementAgentConnector_ms": 0.23044610023498535}}, "episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 13.4678, "episode_len_mean": 71.73, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.493000000000038, 11.135, 11.039, 10.660000000000002, 11.058, 10.986999999999998, 10.274000000000001, 10.46, 13.256, 10.096, 12.155, 10.807, 21.68100000000002, 10.96, 11.611999999999998, 10.306, 23.529000000000003, 11.904, 11.942, 16.033, 11.920000000000002, 16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997], "episode_lengths": [237, 38, 44, 43, 40, 41, 31, 52, 50, 34, 50, 37, 235, 45, 47, 37, 161, 46, 47, 93, 51, 90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.535493798079469, "mean_inference_ms": 1.2346062119984902, "mean_action_processing_ms": 0.08410026714989652, "mean_env_wait_ms": 5.079422543266885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003229856491088867, "ViewRequirementAgentConnector_ms": 0.23044610023498535}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68606, "num_agent_steps_trained": 0, "num_env_steps_sampled": 68608, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.789519538797309, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 68608, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 68606, "timers": {"training_iteration_time_ms": 149340.1, "sample_time_ms": 6815.843, "synch_weights_time_ms": 51.859}, "counters": {"num_env_steps_sampled": 68608, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68606, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1210, "training_iteration": 67, "trial_id": "default", "date": "2025-12-20_01-28-20", "timestamp": 1766165300, "time_this_iter_s": 150.82351398468018, "time_total_s": 10829.28713297844, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10829.28713297844, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 90.0202643171806, "ram_util_percent": 16.04361233480176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.18547931700013578}, "default_policy": {"total_loss": 0.18547931700013578, "policy_loss": -0.021724947076290847, "vf_loss": 0.8280426874975092, "vf_loss_unclipped": 4.326471342727018, "vf_explained_var": 0.22176501639187335, "entropy": 0.3371986576821655, "mean_kl_loss": 0.005307937443097899, "gradients_default_optimizer_global_norm": 1.0476824633777142, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 69632, "num_env_steps_trained": 0, "num_agent_steps_sampled": 69630, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 13.877420000000003, "episode_len_mean": 76.97, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.256, 10.096, 12.155, 10.807, 21.68100000000002, 10.96, 11.611999999999998, 10.306, 23.529000000000003, 11.904, 11.942, 16.033, 11.920000000000002, 16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998], "episode_lengths": [50, 34, 50, 37, 235, 45, 47, 37, 161, 46, 47, 93, 51, 90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.534546944949911, "mean_inference_ms": 1.2333079474281587, "mean_action_processing_ms": 0.0840039146020157, "mean_env_wait_ms": 5.076580218952452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003245830535888672, "ViewRequirementAgentConnector_ms": 0.23051190376281738}}, "episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 13.877420000000003, "episode_len_mean": 76.97, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.256, 10.096, 12.155, 10.807, 21.68100000000002, 10.96, 11.611999999999998, 10.306, 23.529000000000003, 11.904, 11.942, 16.033, 11.920000000000002, 16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998], "episode_lengths": [50, 34, 50, 37, 235, 45, 47, 37, 161, 46, 47, 93, 51, 90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.534546944949911, "mean_inference_ms": 1.2333079474281587, "mean_action_processing_ms": 0.0840039146020157, "mean_env_wait_ms": 5.076580218952452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003245830535888672, "ViewRequirementAgentConnector_ms": 0.23051190376281738}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69630, "num_agent_steps_trained": 0, "num_env_steps_sampled": 69632, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.7287353377390575, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 69632, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 69630, "timers": {"training_iteration_time_ms": 149690.7, "sample_time_ms": 6821.967, "synch_weights_time_ms": 51.87}, "counters": {"num_env_steps_sampled": 69632, "num_env_steps_trained": 0, "num_agent_steps_sampled": 69630, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1218, "training_iteration": 68, "trial_id": "default", "date": "2025-12-20_01-30-52", "timestamp": 1766165452, "time_this_iter_s": 152.18549752235413, "time_total_s": 10981.472630500793, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10981.472630500793, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 94.99907834101384, "ram_util_percent": 16.48847926267281}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.18911659534205683}, "default_policy": {"total_loss": 0.18911659534205683, "policy_loss": -0.022995157015975563, "vf_loss": 0.8483119532735145, "vf_loss_unclipped": 3.8880705549650885, "vf_explained_var": 0.5499795857816935, "entropy": 0.3637101881206036, "mean_kl_loss": 0.003974712079176612, "gradients_default_optimizer_global_norm": 1.189391437242739, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 70656, "num_env_steps_trained": 0, "num_agent_steps_sampled": 70654, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 14.26258, "episode_len_mean": 82.42, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.529000000000003, 11.904, 11.942, 16.033, 11.920000000000002, 16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001], "episode_lengths": [161, 46, 47, 93, 51, 90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5342692407815788, "mean_inference_ms": 1.2334814413464998, "mean_action_processing_ms": 0.08400534247484817, "mean_env_wait_ms": 5.07554958827188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003255128860473633, "ViewRequirementAgentConnector_ms": 0.23066329956054688}}, "episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 14.26258, "episode_len_mean": 82.42, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.529000000000003, 11.904, 11.942, 16.033, 11.920000000000002, 16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001], "episode_lengths": [161, 46, 47, 93, 51, 90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5342692407815788, "mean_inference_ms": 1.2334814413464998, "mean_action_processing_ms": 0.08400534247484817, "mean_env_wait_ms": 5.07554958827188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003255128860473633, "ViewRequirementAgentConnector_ms": 0.23066329956054688}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70654, "num_agent_steps_trained": 0, "num_env_steps_sampled": 70656, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.735888692699213, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 70656, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 70654, "timers": {"training_iteration_time_ms": 150057.744, "sample_time_ms": 6822.77, "synch_weights_time_ms": 50.77}, "counters": {"num_env_steps_sampled": 70656, "num_env_steps_trained": 0, "num_agent_steps_sampled": 70654, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1226, "training_iteration": 69, "trial_id": "default", "date": "2025-12-20_01-33-24", "timestamp": 1766165604, "time_this_iter_s": 152.0239028930664, "time_total_s": 11133.49653339386, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11133.49653339386, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 95.01851851851852, "ram_util_percent": 16.00138888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.10005294331349432}, "default_policy": {"total_loss": 0.10005294331349432, "policy_loss": -0.024677383949165233, "vf_loss": 0.49895603458789994, "vf_loss_unclipped": 2.6205241563489836, "vf_explained_var": 0.2821588806807995, "entropy": 0.2819136611185968, "mean_kl_loss": 0.005464768556004173, "gradients_default_optimizer_global_norm": 0.8023050635354594, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 0, "num_agent_steps_sampled": 71678, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 14.565700000000007, "episode_len_mean": 86.76, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999], "episode_lengths": [90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5334985220198228, "mean_inference_ms": 1.232438193357106, "mean_action_processing_ms": 0.08392494448650402, "mean_env_wait_ms": 5.073358373221421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003259420394897461, "ViewRequirementAgentConnector_ms": 0.23102140426635742}}, "episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 14.565700000000007, "episode_len_mean": 86.76, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.096000000000007, 10.745, 10.634, 13.777000000000001, 11.698, 11.734, 10.341999999999999, 14.621, 10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999], "episode_lengths": [90, 39, 38, 67, 47, 56, 39, 78, 47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5334985220198228, "mean_inference_ms": 1.232438193357106, "mean_action_processing_ms": 0.08392494448650402, "mean_env_wait_ms": 5.073358373221421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003259420394897461, "ViewRequirementAgentConnector_ms": 0.23102140426635742}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71678, "num_agent_steps_trained": 0, "num_env_steps_sampled": 71680, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.81433921714939, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 71680, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 71678, "timers": {"training_iteration_time_ms": 150256.177, "sample_time_ms": 6818.523, "synch_weights_time_ms": 50.431}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 0, "num_agent_steps_sampled": 71678, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1231, "training_iteration": 70, "trial_id": "default", "date": "2025-12-20_01-35-54", "timestamp": 1766165754, "time_this_iter_s": 150.27362084388733, "time_total_s": 11283.770154237747, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11283.770154237747, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 94.87710280373832, "ram_util_percent": 16.546728971962615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.21884559671161696}, "default_policy": {"total_loss": 0.21884559671161696, "policy_loss": -0.026552898570662363, "vf_loss": 0.9810856641328428, "vf_loss_unclipped": 5.109499996626982, "vf_explained_var": 0.5160087272524834, "entropy": 0.41689724726602434, "mean_kl_loss": 0.010879536624014464, "gradients_default_optimizer_global_norm": 1.1693565281108023, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 72704, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72702, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 14.95316, "episode_len_mean": 92.8, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997], "episode_lengths": [47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5334120287734145, "mean_inference_ms": 1.2333484133466772, "mean_action_processing_ms": 0.08398139087720446, "mean_env_wait_ms": 5.073511834139989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003265380859375, "ViewRequirementAgentConnector_ms": 0.23122358322143555}}, "episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 14.95316, "episode_len_mean": 92.8, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.696, 11.304, 10.675, 24.259, 11.269, 20.398000000000003, 10.826, 10.626999999999999, 13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997], "episode_lengths": [47, 47, 40, 236, 42, 125, 41, 36, 68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5334120287734145, "mean_inference_ms": 1.2333484133466772, "mean_action_processing_ms": 0.08398139087720446, "mean_env_wait_ms": 5.073511834139989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003265380859375, "ViewRequirementAgentConnector_ms": 0.23122358322143555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72702, "num_agent_steps_trained": 0, "num_env_steps_sampled": 72704, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.775940671210231, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 72704, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 72702, "timers": {"training_iteration_time_ms": 150419.567, "sample_time_ms": 6820.69, "synch_weights_time_ms": 50.28}, "counters": {"num_env_steps_sampled": 72704, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72702, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1239, "training_iteration": 71, "trial_id": "default", "date": "2025-12-20_01-38-25", "timestamp": 1766165905, "time_this_iter_s": 151.12596726417542, "time_total_s": 11434.896121501923, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11434.896121501923, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 95.01488372093021, "ram_util_percent": 15.99860465116279}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.18960541705600917}, "default_policy": {"total_loss": 0.18960541705600917, "policy_loss": -0.021136491175275295, "vf_loss": 0.8416571722831577, "vf_loss_unclipped": 4.273668218916282, "vf_explained_var": 0.38760804645717145, "entropy": 0.3693699300289154, "mean_kl_loss": 0.013939545418895704, "gradients_default_optimizer_global_norm": 0.9970886030234396, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 73728, "num_env_steps_trained": 0, "num_agent_steps_sampled": 73726, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 15.155770000000004, "episode_len_mean": 97.03, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601], "episode_lengths": [68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5324129634670279, "mean_inference_ms": 1.232429139828065, "mean_action_processing_ms": 0.08390523724938997, "mean_env_wait_ms": 5.070981026613227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003270864486694336, "ViewRequirementAgentConnector_ms": 0.23111271858215332}}, "episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 15.155770000000004, "episode_len_mean": 97.03, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.832999999999997, 10.197000000000001, 10.802000000000001, 11.265, 10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601], "episode_lengths": [68, 35, 36, 40, 37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5324129634670279, "mean_inference_ms": 1.232429139828065, "mean_action_processing_ms": 0.08390523724938997, "mean_env_wait_ms": 5.070981026613227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003270864486694336, "ViewRequirementAgentConnector_ms": 0.23111271858215332}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73726, "num_agent_steps_trained": 0, "num_env_steps_sampled": 73728, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.775732093571373, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 73728, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 73726, "timers": {"training_iteration_time_ms": 150744.251, "sample_time_ms": 6829.315, "synch_weights_time_ms": 50.071}, "counters": {"num_env_steps_sampled": 73728, "num_env_steps_trained": 0, "num_agent_steps_sampled": 73726, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1247, "training_iteration": 72, "trial_id": "default", "date": "2025-12-20_01-41-39", "timestamp": 1766166099, "time_this_iter_s": 151.13050985336304, "time_total_s": 11586.026631355286, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11586.026631355286, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 75.63772893772894, "ram_util_percent": 16.416117216117218}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.0809814333745635}, "default_policy": {"total_loss": 0.0809814333745635, "policy_loss": -0.022614107608387713, "vf_loss": 0.4145389934964442, "vf_loss_unclipped": 2.7505264935977722, "vf_explained_var": 0.2703962467610836, "entropy": 0.2841239749453962, "mean_kl_loss": 0.004898367061811371, "gradients_default_optimizer_global_norm": 0.6090983843401773, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 74752, "num_env_steps_trained": 0, "num_agent_steps_sampled": 74750, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 15.493940000000007, "episode_len_mean": 103.84, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055], "episode_lengths": [37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5318513756431363, "mean_inference_ms": 1.2318383488889557, "mean_action_processing_ms": 0.08386534979805871, "mean_env_wait_ms": 5.069694312841647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003275632858276367, "ViewRequirementAgentConnector_ms": 0.23117375373840332}}, "episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 15.493940000000007, "episode_len_mean": 103.84, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.505999999999998, 11.772, 11.463999999999999, 10.731, 18.390000000000008, 13.989, 10.307, 14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055], "episode_lengths": [37, 39, 38, 37, 113, 71, 35, 74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5318513756431363, "mean_inference_ms": 1.2318383488889557, "mean_action_processing_ms": 0.08386534979805871, "mean_env_wait_ms": 5.069694312841647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003275632858276367, "ViewRequirementAgentConnector_ms": 0.23117375373840332}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74750, "num_agent_steps_trained": 0, "num_env_steps_sampled": 74752, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.750946007286286, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 74752, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 74750, "timers": {"training_iteration_time_ms": 150977.407, "sample_time_ms": 6808.524, "synch_weights_time_ms": 50.176}, "counters": {"num_env_steps_sampled": 74752, "num_env_steps_trained": 0, "num_agent_steps_sampled": 74750, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1251, "training_iteration": 73, "trial_id": "default", "date": "2025-12-20_01-44-10", "timestamp": 1766166250, "time_this_iter_s": 151.68516063690186, "time_total_s": 11737.711791992188, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11737.711791992188, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 95.03888888888889, "ram_util_percent": 16.19537037037037}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.13128441661247053}, "default_policy": {"total_loss": 0.13128441661247053, "policy_loss": -0.024031770223518833, "vf_loss": 0.6217262066646072, "vf_loss_unclipped": 3.032716589023039, "vf_explained_var": 0.43779351375997066, "entropy": 0.3049095016438514, "mean_kl_loss": 0.007581771126748826, "gradients_default_optimizer_global_norm": 0.9017420095624402, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 75776, "num_env_steps_trained": 0, "num_agent_steps_sampled": 75774, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 16.143560000000008, "episode_len_mean": 113.25, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994], "episode_lengths": [74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5314255016667535, "mean_inference_ms": 1.2317777143124626, "mean_action_processing_ms": 0.08388668096830579, "mean_env_wait_ms": 5.069194268644878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032939910888671875, "ViewRequirementAgentConnector_ms": 0.23139142990112305}}, "episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 16.143560000000008, "episode_len_mean": 113.25, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.751999999999999, 23.00699999999996, 11.173, 11.858, 10.589999999999998, 15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994], "episode_lengths": [74, 237, 44, 50, 35, 77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5314255016667535, "mean_inference_ms": 1.2317777143124626, "mean_action_processing_ms": 0.08388668096830579, "mean_env_wait_ms": 5.069194268644878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032939910888671875, "ViewRequirementAgentConnector_ms": 0.23139142990112305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75774, "num_agent_steps_trained": 0, "num_env_steps_sampled": 75776, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.81175240289528, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 75776, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 75774, "timers": {"training_iteration_time_ms": 151098.232, "sample_time_ms": 6808.81, "synch_weights_time_ms": 49.615}, "counters": {"num_env_steps_sampled": 75776, "num_env_steps_trained": 0, "num_agent_steps_sampled": 75774, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1258, "training_iteration": 74, "trial_id": "default", "date": "2025-12-20_01-46-41", "timestamp": 1766166401, "time_this_iter_s": 150.33200240135193, "time_total_s": 11888.04379439354, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11888.04379439354, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 94.82570093457943, "ram_util_percent": 16.358878504672894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.1494212300691288}, "default_policy": {"total_loss": 0.1494212300691288, "policy_loss": -0.019650306639960036, "vf_loss": 0.676824982764083, "vf_loss_unclipped": 3.383958020733553, "vf_explained_var": 0.3314535886049271, "entropy": 0.3236459662206471, "mean_kl_loss": 0.007557448439179737, "gradients_default_optimizer_global_norm": 0.7088229833636432, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 76800, "num_env_steps_trained": 0, "num_agent_steps_sampled": 76798, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 16.376850000000005, "episode_len_mean": 118.17, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479], "episode_lengths": [77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5305750871616196, "mean_inference_ms": 1.2308517123907905, "mean_action_processing_ms": 0.08382116421861605, "mean_env_wait_ms": 5.067260650873589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003293752670288086, "ViewRequirementAgentConnector_ms": 0.2318115234375}}, "episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 16.376850000000005, "episode_len_mean": 118.17, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.225000000000001, 13.899000000000001, 12.366999999999999, 11.775, 10.747, 20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479], "episode_lengths": [77, 70, 51, 52, 41, 218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5305750871616196, "mean_inference_ms": 1.2308517123907905, "mean_action_processing_ms": 0.08382116421861605, "mean_env_wait_ms": 5.067260650873589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003293752670288086, "ViewRequirementAgentConnector_ms": 0.2318115234375}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76798, "num_agent_steps_trained": 0, "num_env_steps_sampled": 76800, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.767461863041226, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 76800, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 76798, "timers": {"training_iteration_time_ms": 151209.555, "sample_time_ms": 6811.006, "synch_weights_time_ms": 50.281}, "counters": {"num_env_steps_sampled": 76800, "num_env_steps_trained": 0, "num_agent_steps_sampled": 76798, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1263, "training_iteration": 75, "trial_id": "default", "date": "2025-12-20_01-49-12", "timestamp": 1766166552, "time_this_iter_s": 151.31487321853638, "time_total_s": 12039.358667612076, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 12039.358667612076, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 95.01720930232557, "ram_util_percent": 16.13627906976744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.10425938342232258}, "default_policy": {"total_loss": 0.10425938342232258, "policy_loss": -0.017086174408905207, "vf_loss": 0.48614172313100423, "vf_loss_unclipped": 3.1606577866870795, "vf_explained_var": 0.1769862737506628, "entropy": 0.27877617315389214, "mean_kl_loss": 0.0035560586563022412, "gradients_default_optimizer_global_norm": 0.7615030100103468, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.012500000186264515}}, "num_env_steps_sampled": 77824, "num_env_steps_trained": 0, "num_agent_steps_sampled": 77822, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 16.771800000000006, "episode_len_mean": 124.73, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998], "episode_lengths": [218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5300152547496931, "mean_inference_ms": 1.2305204331489363, "mean_action_processing_ms": 0.0838101155757089, "mean_env_wait_ms": 5.066421170490992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003284454345703125, "ViewRequirementAgentConnector_ms": 0.2315208911895752}}, "episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 16.771800000000006, "episode_len_mean": 124.73, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.330999999999996, 11.247000000000002, 11.357999999999999, 11.408, 12.238, 25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998], "episode_lengths": [218, 46, 39, 45, 49, 231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5300152547496931, "mean_inference_ms": 1.2305204331489363, "mean_action_processing_ms": 0.0838101155757089, "mean_env_wait_ms": 5.066421170490992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003284454345703125, "ViewRequirementAgentConnector_ms": 0.2315208911895752}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77822, "num_agent_steps_trained": 0, "num_env_steps_sampled": 77824, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.780035751566498, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 77824, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 77822, "timers": {"training_iteration_time_ms": 151189.505, "sample_time_ms": 6811.491, "synch_weights_time_ms": 49.445}, "counters": {"num_env_steps_sampled": 77824, "num_env_steps_trained": 0, "num_agent_steps_sampled": 77822, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1268, "training_iteration": 76, "trial_id": "default", "date": "2025-12-20_01-51-43", "timestamp": 1766166703, "time_this_iter_s": 151.03418254852295, "time_total_s": 12190.392850160599, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 12190.392850160599, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 95.03162790697674, "ram_util_percent": 16.350232558139535}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.06461975852726028}, "default_policy": {"total_loss": 0.06461975852726028, "policy_loss": -0.016421136923599988, "vf_loss": 0.32481095906114205, "vf_loss_unclipped": 2.5649648927501403, "vf_explained_var": 0.32547220662236215, "entropy": 0.20844882372766732, "mean_kl_loss": 0.0037281202641938015, "gradients_default_optimizer_global_norm": 0.6313446847983869, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.0062500000931322575}}, "num_env_steps_sampled": 78848, "num_env_steps_trained": 0, "num_agent_steps_sampled": 78846, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 17.384460000000004, "episode_len_mean": 132.37, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002], "episode_lengths": [231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5296395799212803, "mean_inference_ms": 1.2305612453554204, "mean_action_processing_ms": 0.08383464450184369, "mean_env_wait_ms": 5.0662422830454235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032775402069091797, "ViewRequirementAgentConnector_ms": 0.23179388046264648}}, "episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 17.384460000000004, "episode_len_mean": 132.37, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.549000000000003, 17.022999999999996, 10.305, 11.068, 10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002], "episode_lengths": [231, 94, 33, 42, 38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5296395799212803, "mean_inference_ms": 1.2305612453554204, "mean_action_processing_ms": 0.08383464450184369, "mean_env_wait_ms": 5.0662422830454235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032775402069091797, "ViewRequirementAgentConnector_ms": 0.23179388046264648}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78846, "num_agent_steps_trained": 0, "num_env_steps_sampled": 78848, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.7633810903743985, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 78848, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 78846, "timers": {"training_iteration_time_ms": 151247.792, "sample_time_ms": 6805.336, "synch_weights_time_ms": 48.786}, "counters": {"num_env_steps_sampled": 78848, "num_env_steps_trained": 0, "num_agent_steps_sampled": 78846, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1273, "training_iteration": 77, "trial_id": "default", "date": "2025-12-20_01-54-46", "timestamp": 1766166886, "time_this_iter_s": 151.40635108947754, "time_total_s": 12341.799201250076, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 12341.799201250076, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 79.76563706563707, "ram_util_percent": 16.318146718146718}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.08627212493447586}, "default_policy": {"total_loss": 0.08627212493447586, "policy_loss": -0.013276079203933477, "vf_loss": 0.39922699707276477, "vf_loss_unclipped": 4.014324495687106, "vf_explained_var": 0.2287737801671028, "entropy": 0.2889660822227597, "mean_kl_loss": 0.004867760808041766, "gradients_default_optimizer_global_norm": 0.6166946754441597, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.0031250000465661287}}, "num_env_steps_sampled": 79872, "num_env_steps_trained": 0, "num_agent_steps_sampled": 79870, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 17.5871, "episode_len_mean": 136.91, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996], "episode_lengths": [38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5288117586468841, "mean_inference_ms": 1.229684941684515, "mean_action_processing_ms": 0.08377122614692895, "mean_env_wait_ms": 5.064451214342192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003278970718383789, "ViewRequirementAgentConnector_ms": 0.2318413257598877}}, "episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 17.5871, "episode_len_mean": 136.91, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.722, 24.71500000000002, 10.315999999999999, 11.206, 10.524999999999999, 14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996], "episode_lengths": [38, 165, 36, 44, 41, 80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5288117586468841, "mean_inference_ms": 1.229684941684515, "mean_action_processing_ms": 0.08377122614692895, "mean_env_wait_ms": 5.064451214342192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003278970718383789, "ViewRequirementAgentConnector_ms": 0.2318413257598877}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79870, "num_agent_steps_trained": 0, "num_env_steps_sampled": 79872, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.717002430123637, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 79872, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 79870, "timers": {"training_iteration_time_ms": 151274.374, "sample_time_ms": 6804.177, "synch_weights_time_ms": 48.766}, "counters": {"num_env_steps_sampled": 79872, "num_env_steps_trained": 0, "num_agent_steps_sampled": 79870, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1277, "training_iteration": 78, "trial_id": "default", "date": "2025-12-20_01-57-19", "timestamp": 1766167039, "time_this_iter_s": 152.45158195495605, "time_total_s": 12494.250783205032, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 12494.250783205032, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 94.91105990783409, "ram_util_percent": 16.2815668202765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.057095692539587614}, "default_policy": {"total_loss": 0.057095692539587614, "policy_loss": -0.020794720156118274, "vf_loss": 0.31253808004757955, "vf_loss_unclipped": 3.093693632576378, "vf_explained_var": 0.2792609579861164, "entropy": 0.2653171812649816, "mean_kl_loss": 0.00678720016620753, "gradients_default_optimizer_global_norm": 0.7474611762096174, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.0031250000465661287}}, "num_env_steps_sampled": 80896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80894, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 17.998000000000005, "episode_len_mean": 144.77, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016], "episode_lengths": [80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5281249579167412, "mean_inference_ms": 1.2292982443795442, "mean_action_processing_ms": 0.08375784616308417, "mean_env_wait_ms": 5.063542896637177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033087730407714844, "ViewRequirementAgentConnector_ms": 0.2320556640625}}, "episode_reward_max": 32.46600000000002, "episode_reward_min": 9.872, "episode_reward_mean": 17.998000000000005, "episode_len_mean": 144.77, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.853000000000005, 9.872, 10.014999999999999, 10.639999999999999, 10.348, 24.296999999999986, 10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016], "episode_lengths": [80, 31, 36, 41, 38, 161, 42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5281249579167412, "mean_inference_ms": 1.2292982443795442, "mean_action_processing_ms": 0.08375784616308417, "mean_env_wait_ms": 5.063542896637177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033087730407714844, "ViewRequirementAgentConnector_ms": 0.2320556640625}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80894, "num_agent_steps_trained": 0, "num_env_steps_sampled": 80896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.823009024571247, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 80896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 80894, "timers": {"training_iteration_time_ms": 151080.263, "sample_time_ms": 6799.789, "synch_weights_time_ms": 50.018}, "counters": {"num_env_steps_sampled": 80896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80894, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1282, "training_iteration": 79, "trial_id": "default", "date": "2025-12-20_01-59-49", "timestamp": 1766167189, "time_this_iter_s": 150.08886289596558, "time_total_s": 12644.339646100998, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 12644.339646100998, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 95.0448598130841, "ram_util_percent": 16.42803738317757}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.1561737261712551}, "default_policy": {"total_loss": 0.1561737261712551, "policy_loss": -0.022445319301914422, "vf_loss": 0.7155221860914025, "vf_loss_unclipped": 4.333766759565333, "vf_explained_var": 0.463123344630003, "entropy": 0.2843070504721254, "mean_kl_loss": 0.0072981051786857876, "gradients_default_optimizer_global_norm": 0.9223408224759624, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.0031250000465661287}}, "num_env_steps_sampled": 81920, "num_env_steps_trained": 0, "num_agent_steps_sampled": 81918, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32.46600000000002, "episode_reward_min": 10.029, "episode_reward_mean": 18.455400000000008, "episode_len_mean": 150.67, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005], "episode_lengths": [42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5273378900384068, "mean_inference_ms": 1.2289670430527673, "mean_action_processing_ms": 0.08375480939906517, "mean_env_wait_ms": 5.062685448730301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033173561096191406, "ViewRequirementAgentConnector_ms": 0.23255348205566406}}, "episode_reward_max": 32.46600000000002, "episode_reward_min": 10.029, "episode_reward_mean": 18.455400000000008, "episode_len_mean": 150.67, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.443999999999999, 11.997, 10.905, 20.216000000000008, 11.378, 10.815, 10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005], "episode_lengths": [42, 44, 35, 218, 39, 39, 36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5273378900384068, "mean_inference_ms": 1.2289670430527673, "mean_action_processing_ms": 0.08375480939906517, "mean_env_wait_ms": 5.062685448730301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033173561096191406, "ViewRequirementAgentConnector_ms": 0.23255348205566406}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81918, "num_agent_steps_trained": 0, "num_env_steps_sampled": 81920, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.765830983979747, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 81920, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 81918, "timers": {"training_iteration_time_ms": 151188.0, "sample_time_ms": 6803.077, "synch_weights_time_ms": 50.534}, "counters": {"num_env_steps_sampled": 81920, "num_env_steps_trained": 0, "num_agent_steps_sampled": 81918, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1288, "training_iteration": 80, "trial_id": "default", "date": "2025-12-20_02-02-20", "timestamp": 1766167340, "time_this_iter_s": 151.35123801231384, "time_total_s": 12795.690884113312, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 12795.690884113312, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 95.00837209302327, "ram_util_percent": 16.186046511627907}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.09933710486948258}, "default_policy": {"total_loss": 0.09933710486948258, "policy_loss": -0.020339021785184742, "vf_loss": 0.4796201968434616, "vf_loss_unclipped": 3.053257719507383, "vf_explained_var": 0.3884154725819826, "entropy": 0.25547159211710097, "mean_kl_loss": 0.00849576526167688, "gradients_default_optimizer_global_norm": 0.8502912517637015, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.0031250000465661287}}, "num_env_steps_sampled": 82944, "num_env_steps_trained": 0, "num_agent_steps_sampled": 82942, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32.46600000000002, "episode_reward_min": 10.029, "episode_reward_mean": 18.840970000000006, "episode_len_mean": 158.43, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035], "episode_lengths": [36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5262007119904692, "mean_inference_ms": 1.2280106970980043, "mean_action_processing_ms": 0.08369458974470545, "mean_env_wait_ms": 5.060675270068583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033109188079833984, "ViewRequirementAgentConnector_ms": 0.23264431953430176}}, "episode_reward_max": 32.46600000000002, "episode_reward_min": 10.029, "episode_reward_mean": 18.840970000000006, "episode_len_mean": 158.43, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.927999999999999, 11.084000000000001, 10.84, 12.779, 10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035], "episode_lengths": [36, 41, 40, 58, 37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5262007119904692, "mean_inference_ms": 1.2280106970980043, "mean_action_processing_ms": 0.08369458974470545, "mean_env_wait_ms": 5.060675270068583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033109188079833984, "ViewRequirementAgentConnector_ms": 0.23264431953430176}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82942, "num_agent_steps_trained": 0, "num_env_steps_sampled": 82944, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.745670513242194, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 82944, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 82942, "timers": {"training_iteration_time_ms": 151255.815, "sample_time_ms": 6803.111, "synch_weights_time_ms": 50.016}, "counters": {"num_env_steps_sampled": 82944, "num_env_steps_trained": 0, "num_agent_steps_sampled": 82942, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1294, "training_iteration": 81, "trial_id": "default", "date": "2025-12-20_02-04-52", "timestamp": 1766167492, "time_this_iter_s": 151.80323696136475, "time_total_s": 12947.494121074677, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 12947.494121074677, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 95.04768518518519, "ram_util_percent": 16.293518518518518}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.08928430628147907}, "default_policy": {"total_loss": 0.08928430628147907, "policy_loss": -0.01487670176429674, "vf_loss": 0.4173737107231773, "vf_loss_unclipped": 1.8405261530927874, "vf_explained_var": 0.2709057543426752, "entropy": 0.19515810522716492, "mean_kl_loss": 0.00407410831638586, "gradients_default_optimizer_global_norm": 0.8110577452956932, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.0015625000232830644}}, "num_env_steps_sampled": 83968, "num_env_steps_trained": 0, "num_agent_steps_sampled": 83966, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 32.46600000000002, "episode_reward_min": 10.029, "episode_reward_mean": 19.365220000000008, "episode_len_mean": 165.09, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337], "episode_lengths": [37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5256805872522122, "mean_inference_ms": 1.2279019999519298, "mean_action_processing_ms": 0.08370348934654626, "mean_env_wait_ms": 5.060332990551984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033142566680908203, "ViewRequirementAgentConnector_ms": 0.23273801803588867}}, "episode_reward_max": 32.46600000000002, "episode_reward_min": 10.029, "episode_reward_mean": 19.365220000000008, "episode_len_mean": 165.09, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.029, 21.09700000000001, 19.88200000000001, 32.46600000000002, 10.828000000000001, 11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337], "episode_lengths": [37, 214, 213, 220, 37, 45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5256805872522122, "mean_inference_ms": 1.2279019999519298, "mean_action_processing_ms": 0.08370348934654626, "mean_env_wait_ms": 5.060332990551984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033142566680908203, "ViewRequirementAgentConnector_ms": 0.23273801803588867}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83966, "num_agent_steps_trained": 0, "num_env_steps_sampled": 83968, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.748332390308895, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 83968, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 83966, "timers": {"training_iteration_time_ms": 151317.177, "sample_time_ms": 6798.356, "synch_weights_time_ms": 50.284}, "counters": {"num_env_steps_sampled": 83968, "num_env_steps_trained": 0, "num_agent_steps_sampled": 83966, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1298, "training_iteration": 82, "trial_id": "default", "date": "2025-12-20_02-08-03", "timestamp": 1766167683, "time_this_iter_s": 151.74389338493347, "time_total_s": 13099.23801445961, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 13099.23801445961, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 76.7708487084871, "ram_util_percent": 16.254612546125458}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.0783305314667814}, "default_policy": {"total_loss": 0.0783305314667814, "policy_loss": -0.02268455073935911, "vf_loss": 0.404959499693814, "vf_loss_unclipped": 2.986870350174013, "vf_explained_var": 0.31633262857794764, "entropy": 0.23214412180241198, "mean_kl_loss": 0.004706977986359107, "gradients_default_optimizer_global_norm": 1.0149142641108484, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.0007812500116415322}}, "num_env_steps_sampled": 84992, "num_env_steps_trained": 0, "num_agent_steps_sampled": 84990, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.25400000000001, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 19.442780000000006, "episode_len_mean": 169.26, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017], "episode_lengths": [45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5246576199834845, "mean_inference_ms": 1.2270615117478874, "mean_action_processing_ms": 0.08364991925641331, "mean_env_wait_ms": 5.058568186501031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033111572265625, "ViewRequirementAgentConnector_ms": 0.23286986351013184}}, "episode_reward_max": 28.25400000000001, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 19.442780000000006, "episode_len_mean": 169.26, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.069, 11.053999999999998, 14.041, 22.726000000000006, 11.293, 11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017], "episode_lengths": [45, 41, 65, 220, 45, 52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5246576199834845, "mean_inference_ms": 1.2270615117478874, "mean_action_processing_ms": 0.08364991925641331, "mean_env_wait_ms": 5.058568186501031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033111572265625, "ViewRequirementAgentConnector_ms": 0.23286986351013184}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84990, "num_agent_steps_trained": 0, "num_env_steps_sampled": 84992, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.78575934471823, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 84992, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 84990, "timers": {"training_iteration_time_ms": 151239.359, "sample_time_ms": 6802.085, "synch_weights_time_ms": 51.467}, "counters": {"num_env_steps_sampled": 84992, "num_env_steps_trained": 0, "num_agent_steps_sampled": 84990, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1303, "training_iteration": 83, "trial_id": "default", "date": "2025-12-20_02-10-34", "timestamp": 1766167834, "time_this_iter_s": 150.90679168701172, "time_total_s": 13250.144806146622, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 13250.144806146622, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 94.97897196261681, "ram_util_percent": 16.45981308411215}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1025.0, "total_loss": 0.036633162822875175}, "default_policy": {"total_loss": 0.036633162822875175, "policy_loss": -0.018476387213985, "vf_loss": 0.2212607554773408, "vf_loss_unclipped": 1.7278740726833801, "vf_explained_var": 0.41817721520891843, "entropy": 0.20975337603262492, "mean_kl_loss": 0.005264812643750414, "gradients_default_optimizer_global_norm": 0.6976844117461894, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.0007812500116415322}}, "num_env_steps_sampled": 86016, "num_env_steps_trained": 0, "num_agent_steps_sampled": 86015, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.25400000000001, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 19.704150000000006, "episode_len_mean": 175.94, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999], "episode_lengths": [52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5238094154897639, "mean_inference_ms": 1.22661213491856, "mean_action_processing_ms": 0.083631765847786, "mean_env_wait_ms": 5.057537842661094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003320932388305664, "ViewRequirementAgentConnector_ms": 0.2332315444946289}}, "episode_reward_max": 28.25400000000001, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 19.704150000000006, "episode_len_mean": 175.94, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.367, 15.848999999999997, 20.86699999999999, 17.598000000000003, 16.139999999999993, 12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999], "episode_lengths": [52, 77, 224, 103, 106, 61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5238094154897639, "mean_inference_ms": 1.22661213491856, "mean_action_processing_ms": 0.083631765847786, "mean_env_wait_ms": 5.057537842661094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003320932388305664, "ViewRequirementAgentConnector_ms": 0.2332315444946289}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86015, "num_agent_steps_trained": 0, "num_env_steps_sampled": 86016, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.74193650444827, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 86016, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 86015, "timers": {"training_iteration_time_ms": 151395.672, "sample_time_ms": 6800.342, "synch_weights_time_ms": 51.254}, "counters": {"num_env_steps_sampled": 86016, "num_env_steps_trained": 0, "num_agent_steps_sampled": 86015, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1308, "training_iteration": 84, "trial_id": "default", "date": "2025-12-20_02-13-06", "timestamp": 1766167986, "time_this_iter_s": 151.88771724700928, "time_total_s": 13402.032523393631, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 13402.032523393631, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 95.04055299539172, "ram_util_percent": 16.146543778801842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1023.0, "total_loss": 0.13584588608937337}, "default_policy": {"total_loss": 0.13584588608937337, "policy_loss": -0.022181871125940233, "vf_loss": 0.6331041531252936, "vf_loss_unclipped": 5.276358425858177, "vf_explained_var": 0.28711850978434084, "entropy": 0.2543772223638371, "mean_kl_loss": 0.007802688845261851, "gradients_default_optimizer_global_norm": 0.802704547502799, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.0007812500116415322}}, "num_env_steps_sampled": 87040, "num_env_steps_trained": 0, "num_agent_steps_sampled": 87038, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.25400000000001, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 19.807080000000006, "episode_len_mean": 179.66, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002], "episode_lengths": [61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5228403604801657, "mean_inference_ms": 1.2259559718828619, "mean_action_processing_ms": 0.08359496195558798, "mean_env_wait_ms": 5.056134846170946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003323078155517578, "ViewRequirementAgentConnector_ms": 0.23295903205871582}}, "episode_reward_max": 28.25400000000001, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 19.807080000000006, "episode_len_mean": 179.66, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.092, 10.713, 26.84500000000004, 27.005000000000024, 10.807999999999998, 20.951000000000008, 24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002], "episode_lengths": [61, 46, 235, 237, 38, 209, 227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5228403604801657, "mean_inference_ms": 1.2259559718828619, "mean_action_processing_ms": 0.08359496195558798, "mean_env_wait_ms": 5.056134846170946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003323078155517578, "ViewRequirementAgentConnector_ms": 0.23295903205871582}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87038, "num_agent_steps_trained": 0, "num_env_steps_sampled": 87040, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.777086291960337, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 87040, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 87038, "timers": {"training_iteration_time_ms": 151374.189, "sample_time_ms": 6801.717, "synch_weights_time_ms": 50.525}, "counters": {"num_env_steps_sampled": 87040, "num_env_steps_trained": 0, "num_agent_steps_sampled": 87038, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1313, "training_iteration": 85, "trial_id": "default", "date": "2025-12-20_02-15-37", "timestamp": 1766168137, "time_this_iter_s": 151.10313820838928, "time_total_s": 13553.13566160202, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 13553.13566160202, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 95.00651162790696, "ram_util_percent": 16.422325581395345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1025.0, "total_loss": 0.1139992093262465}, "default_policy": {"total_loss": 0.1139992093262465, "policy_loss": -0.019750997539817915, "vf_loss": 0.5358066843534814, "vf_loss_unclipped": 3.36502153334795, "vf_explained_var": 0.3696046638192597, "entropy": 0.20492030807441067, "mean_kl_loss": 0.004422701497633848, "gradients_default_optimizer_global_norm": 0.959800835953366, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.0003906250058207661}}, "num_env_steps_sampled": 88064, "num_env_steps_trained": 0, "num_agent_steps_sampled": 88063, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.25400000000001, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 20.066990000000004, "episode_len_mean": 182.56, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027], "episode_lengths": [227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5215847021569842, "mean_inference_ms": 1.2249849282253522, "mean_action_processing_ms": 0.08353419737828778, "mean_env_wait_ms": 5.054101786337716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033295154571533203, "ViewRequirementAgentConnector_ms": 0.23287081718444824}}, "episode_reward_max": 28.25400000000001, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 20.066990000000004, "episode_len_mean": 182.56, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.497000000000057, 10.6, 10.615, 26.69300000000004, 14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027], "episode_lengths": [227, 50, 38, 235, 74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5215847021569842, "mean_inference_ms": 1.2249849282253522, "mean_action_processing_ms": 0.08353419737828778, "mean_env_wait_ms": 5.054101786337716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033295154571533203, "ViewRequirementAgentConnector_ms": 0.23287081718444824}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88063, "num_agent_steps_trained": 0, "num_env_steps_sampled": 88064, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.776604299048653, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 88064, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 88063, "timers": {"training_iteration_time_ms": 151381.837, "sample_time_ms": 6801.182, "synch_weights_time_ms": 50.766}, "counters": {"num_env_steps_sampled": 88064, "num_env_steps_trained": 0, "num_agent_steps_sampled": 88063, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1319, "training_iteration": 86, "trial_id": "default", "date": "2025-12-20_02-18-09", "timestamp": 1766168289, "time_this_iter_s": 151.1105442047119, "time_total_s": 13704.246205806732, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 13704.246205806732, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 94.907476635514, "ram_util_percent": 15.03551401869159}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1023.0, "total_loss": 0.07626482602208853}, "default_policy": {"total_loss": 0.07626482602208853, "policy_loss": -0.01862195914145559, "vf_loss": 0.3802114781792625, "vf_loss_unclipped": 3.957433503201173, "vf_explained_var": 0.32071732021868227, "entropy": 0.16793717065593228, "mean_kl_loss": 0.004746123534388469, "gradients_default_optimizer_global_norm": 0.5614447039086372, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 0.00019531250291038305}}, "num_env_steps_sampled": 89088, "num_env_steps_trained": 0, "num_agent_steps_sampled": 89086, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.25400000000001, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 20.301360000000003, "episode_len_mean": 185.92, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003], "episode_lengths": [74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5207005671031886, "mean_inference_ms": 1.2242584827205294, "mean_action_processing_ms": 0.0834862920885502, "mean_env_wait_ms": 5.052592209533834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003334522247314453, "ViewRequirementAgentConnector_ms": 0.23276519775390625}}, "episode_reward_max": 28.25400000000001, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 20.301360000000003, "episode_len_mean": 185.92, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.216, 11.35, 20.46700000000001, 26.341000000000047, 25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003], "episode_lengths": [74, 39, 208, 239, 236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5207005671031886, "mean_inference_ms": 1.2242584827205294, "mean_action_processing_ms": 0.0834862920885502, "mean_env_wait_ms": 5.052592209533834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003334522247314453, "ViewRequirementAgentConnector_ms": 0.23276519775390625}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89086, "num_agent_steps_trained": 0, "num_env_steps_sampled": 89088, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 7.020637864019249, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 89088, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 89086, "timers": {"training_iteration_time_ms": 150827.05, "sample_time_ms": 6802.173, "synch_weights_time_ms": 51.126}, "counters": {"num_env_steps_sampled": 89088, "num_env_steps_trained": 0, "num_agent_steps_sampled": 89086, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1323, "training_iteration": 87, "trial_id": "default", "date": "2025-12-20_02-22-09", "timestamp": 1766168529, "time_this_iter_s": 145.85859727859497, "time_total_s": 13850.104803085327, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 13850.104803085327, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 59.76764705882353, "ram_util_percent": 13.392647058823533}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.03714376817952143}, "default_policy": {"total_loss": 0.03714376817952143, "policy_loss": -0.014199269225355238, "vf_loss": 0.20597398332620287, "vf_loss_unclipped": 2.154270457153416, "vf_explained_var": 0.11461299322545529, "entropy": 0.15099186534062028, "mean_kl_loss": 0.002721287461034194, "gradients_default_optimizer_global_norm": 0.6483472070074641, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 9.765625145519152e-05}}, "num_env_steps_sampled": 90112, "num_env_steps_trained": 0, "num_agent_steps_sampled": 90110, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 28.25400000000001, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 20.522950000000005, "episode_len_mean": 189.51, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002], "episode_lengths": [236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5200077180108243, "mean_inference_ms": 1.223928810804232, "mean_action_processing_ms": 0.0834746300075285, "mean_env_wait_ms": 5.051817667868894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033376216888427734, "ViewRequirementAgentConnector_ms": 0.2327427864074707}}, "episode_reward_max": 28.25400000000001, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 20.522950000000005, "episode_len_mean": 189.51, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.25200000000001, 14.939, 25.359000000000044, 13.748999999999999, 20.996999999999982, 10.565, 16.543000000000006, 14.747999999999998, 16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002], "episode_lengths": [236, 56, 232, 69, 212, 44, 93, 83, 99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5200077180108243, "mean_inference_ms": 1.223928810804232, "mean_action_processing_ms": 0.0834746300075285, "mean_env_wait_ms": 5.051817667868894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033376216888427734, "ViewRequirementAgentConnector_ms": 0.2327427864074707}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90110, "num_agent_steps_trained": 0, "num_env_steps_sampled": 90112, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.993430293876697, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 90112, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 90110, "timers": {"training_iteration_time_ms": 150224.468, "sample_time_ms": 6800.823, "synch_weights_time_ms": 50.94}, "counters": {"num_env_steps_sampled": 90112, "num_env_steps_trained": 0, "num_agent_steps_sampled": 90110, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1327, "training_iteration": 88, "trial_id": "default", "date": "2025-12-20_02-24-36", "timestamp": 1766168676, "time_this_iter_s": 146.4256420135498, "time_total_s": 13996.530445098877, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 13996.530445098877, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 94.95023923444975, "ram_util_percent": 13.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.2187280124082463}, "default_policy": {"total_loss": 0.2187280124082463, "policy_loss": -0.015686460153665392, "vf_loss": 0.9385292733632014, "vf_loss_unclipped": 6.238012494760005, "vf_explained_var": 0.49209925904870033, "entropy": 0.2183534087263979, "mean_kl_loss": 0.005208132071411376, "gradients_default_optimizer_global_norm": 1.099554629693739, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 9.765625145519152e-05}}, "num_env_steps_sampled": 91136, "num_env_steps_trained": 0, "num_agent_steps_sampled": 91134, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.059, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 20.840080000000004, "episode_len_mean": 192.26, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999], "episode_lengths": [99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5182852201345531, "mean_inference_ms": 1.2225191920001823, "mean_action_processing_ms": 0.08338204989582301, "mean_env_wait_ms": 5.04886833152791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003328084945678711, "ViewRequirementAgentConnector_ms": 0.23308229446411133}}, "episode_reward_max": 31.059, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 20.840080000000004, "episode_len_mean": 192.26, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.211000000000006, 20.752999999999993, 18.302000000000003, 20.273999999999997, 19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999], "episode_lengths": [99, 207, 108, 212, 215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5182852201345531, "mean_inference_ms": 1.2225191920001823, "mean_action_processing_ms": 0.08338204989582301, "mean_env_wait_ms": 5.04886833152791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003328084945678711, "ViewRequirementAgentConnector_ms": 0.23308229446411133}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91134, "num_agent_steps_trained": 0, "num_env_steps_sampled": 91136, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.961362070052611, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 91136, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 91134, "timers": {"training_iteration_time_ms": 149926.193, "sample_time_ms": 6801.767, "synch_weights_time_ms": 51.096}, "counters": {"num_env_steps_sampled": 91136, "num_env_steps_trained": 0, "num_agent_steps_sampled": 91134, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1335, "training_iteration": 89, "trial_id": "default", "date": "2025-12-20_02-27-03", "timestamp": 1766168823, "time_this_iter_s": 147.10036396980286, "time_total_s": 14143.63080906868, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 14143.63080906868, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 94.82631578947371, "ram_util_percent": 13.307177033492826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.04315145401051268}, "default_policy": {"total_loss": 0.04315145401051268, "policy_loss": -0.015119830123148858, "vf_loss": 0.23377951080674392, "vf_loss_unclipped": 1.5534196599828647, "vf_explained_var": 0.3132377818226814, "entropy": 0.1738757120561786, "mean_kl_loss": 0.0028781660646705733, "gradients_default_optimizer_global_norm": 0.7122112929951981, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 4.882812572759576e-05}}, "num_env_steps_sampled": 92160, "num_env_steps_trained": 0, "num_agent_steps_sampled": 92158, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.059, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 20.998700000000003, "episode_len_mean": 195.05, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034], "episode_lengths": [215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5176172773688754, "mean_inference_ms": 1.22220389965251, "mean_action_processing_ms": 0.08337073367561403, "mean_env_wait_ms": 5.048101275976564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033273696899414062, "ViewRequirementAgentConnector_ms": 0.23308038711547852}}, "episode_reward_max": 31.059, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 20.998700000000003, "episode_len_mean": 195.05, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.41599999999999, 10.736, 25.81700000000003, 22.603000000000037, 11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034], "episode_lengths": [215, 40, 231, 228, 43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5176172773688754, "mean_inference_ms": 1.22220389965251, "mean_action_processing_ms": 0.08337073367561403, "mean_env_wait_ms": 5.048101275976564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033273696899414062, "ViewRequirementAgentConnector_ms": 0.23308038711547852}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92158, "num_agent_steps_trained": 0, "num_env_steps_sampled": 92160, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.985843456976504, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 92160, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 92158, "timers": {"training_iteration_time_ms": 149449.535, "sample_time_ms": 6794.738, "synch_weights_time_ms": 50.628}, "counters": {"num_env_steps_sampled": 92160, "num_env_steps_trained": 0, "num_agent_steps_sampled": 92158, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1339, "training_iteration": 90, "trial_id": "default", "date": "2025-12-20_02-29-30", "timestamp": 1766168970, "time_this_iter_s": 146.5846071243286, "time_total_s": 14290.215416193008, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 14290.215416193008, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 94.96971153846154, "ram_util_percent": 13.300000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.048390990935149605}, "default_policy": {"total_loss": 0.048390990935149605, "policy_loss": -0.011849474650807679, "vf_loss": 0.24143568049657915, "vf_loss_unclipped": 2.77204114194501, "vf_explained_var": 0.12391509227454663, "entropy": 0.11853675054153427, "mean_kl_loss": 0.0016704243022839017, "gradients_default_optimizer_global_norm": 0.6763560232706368, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 2.441406286379788e-05}}, "num_env_steps_sampled": 93184, "num_env_steps_trained": 0, "num_agent_steps_sampled": 93182, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.059, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 21.240910000000003, "episode_len_mean": 197.07, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263], "episode_lengths": [43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5167492695464142, "mean_inference_ms": 1.2215109567256832, "mean_action_processing_ms": 0.08332449060466242, "mean_env_wait_ms": 5.046638135875457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003328561782836914, "ViewRequirementAgentConnector_ms": 0.23323965072631836}}, "episode_reward_max": 31.059, "episode_reward_min": 10.440000000000001, "episode_reward_mean": 21.240910000000003, "episode_len_mean": 197.07, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.052, 19.649999999999995, 10.440000000000001, 10.601, 20.334999999999976, 18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263], "episode_lengths": [43, 208, 37, 35, 218, 216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5167492695464142, "mean_inference_ms": 1.2215109567256832, "mean_action_processing_ms": 0.08332449060466242, "mean_env_wait_ms": 5.046638135875457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003328561782836914, "ViewRequirementAgentConnector_ms": 0.23323965072631836}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93182, "num_agent_steps_trained": 0, "num_env_steps_sampled": 93184, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.892406796181812, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 93184, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 93182, "timers": {"training_iteration_time_ms": 149126.357, "sample_time_ms": 6798.059, "synch_weights_time_ms": 51.612}, "counters": {"num_env_steps_sampled": 93184, "num_env_steps_trained": 0, "num_agent_steps_sampled": 93182, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1343, "training_iteration": 91, "trial_id": "default", "date": "2025-12-20_02-31-58", "timestamp": 1766169118, "time_this_iter_s": 148.57163500785828, "time_total_s": 14438.787051200867, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 14438.787051200867, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 94.9306603773585, "ram_util_percent": 13.376886792452831}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.1257937907692394}, "default_policy": {"total_loss": 0.1257937907692394, "policy_loss": -0.01925000299233943, "vf_loss": 0.5811369240253953, "vf_loss_unclipped": 3.7465157147466925, "vf_explained_var": 0.16676219291985034, "entropy": 0.24057854508282617, "mean_kl_loss": 0.005960348188134024, "gradients_default_optimizer_global_norm": 0.8158217073389096, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 2.441406286379788e-05}}, "num_env_steps_sampled": 94208, "num_env_steps_trained": 0, "num_agent_steps_sampled": 94206, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.059, "episode_reward_min": 10.66, "episode_reward_mean": 21.590050000000005, "episode_len_mean": 202.95, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025], "episode_lengths": [216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5159609066210141, "mean_inference_ms": 1.2212527185488733, "mean_action_processing_ms": 0.08332197999133775, "mean_env_wait_ms": 5.045946622775957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033240318298339844, "ViewRequirementAgentConnector_ms": 0.23309540748596191}}, "episode_reward_max": 31.059, "episode_reward_min": 10.66, "episode_reward_mean": 21.590050000000005, "episode_len_mean": 202.95, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.650000000000002, 20.87400000000001, 20.055, 23.532000000000007, 26.22900000000004, 22.247, 26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025], "episode_lengths": [216, 216, 210, 229, 231, 132, 233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5159609066210141, "mean_inference_ms": 1.2212527185488733, "mean_action_processing_ms": 0.08332197999133775, "mean_env_wait_ms": 5.045946622775957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033240318298339844, "ViewRequirementAgentConnector_ms": 0.23309540748596191}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94206, "num_agent_steps_trained": 0, "num_env_steps_sampled": 94208, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.594168028864037, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 94208, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 94206, "timers": {"training_iteration_time_ms": 149481.11, "sample_time_ms": 6798.153, "synch_weights_time_ms": 50.637}, "counters": {"num_env_steps_sampled": 94208, "num_env_steps_trained": 0, "num_agent_steps_sampled": 94206, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1348, "training_iteration": 92, "trial_id": "default", "date": "2025-12-20_02-35-51", "timestamp": 1766169351, "time_this_iter_s": 155.29190492630005, "time_total_s": 14594.078956127167, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 14594.078956127167, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 65.54589665653496, "ram_util_percent": 14.810942249240123}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.07664479597005994}, "default_policy": {"total_loss": 0.07664479597005994, "policy_loss": -0.016526756156235934, "vf_loss": 0.37346203027345837, "vf_loss_unclipped": 3.5967354081390113, "vf_explained_var": 0.4575069572776556, "entropy": 0.19411482490831986, "mean_kl_loss": 0.006522689538998705, "gradients_default_optimizer_global_norm": 0.5996120627532946, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 2.441406286379788e-05}}, "num_env_steps_sampled": 95232, "num_env_steps_trained": 0, "num_agent_steps_sampled": 95230, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.059, "episode_reward_min": 10.66, "episode_reward_mean": 21.469720000000006, "episode_len_mean": 202.13, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025, 13.648, 19.888999999999992, 19.849000000000004, 20.427999999999994, 19.996999999999993, 25.743000000000023], "episode_lengths": [233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226, 69, 206, 209, 218, 211, 239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5147327470864316, "mean_inference_ms": 1.2203141236764512, "mean_action_processing_ms": 0.08326074299075747, "mean_env_wait_ms": 5.043930553417409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003323793411254883, "ViewRequirementAgentConnector_ms": 0.23320484161376953}}, "episode_reward_max": 31.059, "episode_reward_min": 10.66, "episode_reward_mean": 21.469720000000006, "episode_len_mean": 202.13, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.65900000000002, 23.287000000000003, 10.66, 19.506999999999994, 21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025, 13.648, 19.888999999999992, 19.849000000000004, 20.427999999999994, 19.996999999999993, 25.743000000000023], "episode_lengths": [233, 225, 41, 220, 216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226, 69, 206, 209, 218, 211, 239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5147327470864316, "mean_inference_ms": 1.2203141236764512, "mean_action_processing_ms": 0.08326074299075747, "mean_env_wait_ms": 5.043930553417409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003323793411254883, "ViewRequirementAgentConnector_ms": 0.23320484161376953}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95230, "num_agent_steps_trained": 0, "num_env_steps_sampled": 95232, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.585955385061379, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 95232, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 95230, "timers": {"training_iteration_time_ms": 149938.922, "sample_time_ms": 6796.196, "synch_weights_time_ms": 49.387}, "counters": {"num_env_steps_sampled": 95232, "num_env_steps_trained": 0, "num_agent_steps_sampled": 95230, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1354, "training_iteration": 93, "trial_id": "default", "date": "2025-12-20_02-38-27", "timestamp": 1766169507, "time_this_iter_s": 155.48574233055115, "time_total_s": 14749.564698457718, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 14749.564698457718, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 95.02579185520362, "ram_util_percent": 14.878280542986422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.02332196544157341}, "default_policy": {"total_loss": 0.02332196544157341, "policy_loss": -0.008835930982604623, "vf_loss": 0.1291642442213515, "vf_loss_unclipped": 1.4909652875604251, "vf_explained_var": 0.4372487585991621, "entropy": 0.1332049603224732, "mean_kl_loss": 0.0016441019570226367, "gradients_default_optimizer_global_norm": 0.32329893128480763, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.220703143189894e-05}}, "num_env_steps_sampled": 96256, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96254, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.059, "episode_reward_min": 10.731, "episode_reward_mean": 21.659100000000013, "episode_len_mean": 204.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025, 13.648, 19.888999999999992, 19.849000000000004, 20.427999999999994, 19.996999999999993, 25.743000000000023, 27.159000000000013, 19.963000000000005, 26.934000000000047, 24.995000000000047], "episode_lengths": [216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226, 69, 206, 209, 218, 211, 239, 233, 207, 234, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5141672958438732, "mean_inference_ms": 1.2202159062781455, "mean_action_processing_ms": 0.08326759712202468, "mean_env_wait_ms": 5.043555137604027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033206939697265625, "ViewRequirementAgentConnector_ms": 0.23325657844543457}}, "episode_reward_max": 31.059, "episode_reward_min": 10.731, "episode_reward_mean": 21.659100000000013, "episode_len_mean": 204.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.121999999999996, 20.891999999999985, 19.854999999999986, 13.361, 19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025, 13.648, 19.888999999999992, 19.849000000000004, 20.427999999999994, 19.996999999999993, 25.743000000000023, 27.159000000000013, 19.963000000000005, 26.934000000000047, 24.995000000000047], "episode_lengths": [216, 224, 212, 65, 215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226, 69, 206, 209, 218, 211, 239, 233, 207, 234, 232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5141672958438732, "mean_inference_ms": 1.2202159062781455, "mean_action_processing_ms": 0.08326759712202468, "mean_env_wait_ms": 5.043555137604027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033206939697265625, "ViewRequirementAgentConnector_ms": 0.23325657844543457}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96254, "num_agent_steps_trained": 0, "num_env_steps_sampled": 96256, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.626270581245145, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 96256, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 96254, "timers": {"training_iteration_time_ms": 150204.047, "sample_time_ms": 6794.677, "synch_weights_time_ms": 49.104}, "counters": {"num_env_steps_sampled": 96256, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96254, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1358, "training_iteration": 94, "trial_id": "default", "date": "2025-12-20_02-41-02", "timestamp": 1766169662, "time_this_iter_s": 154.53909587860107, "time_total_s": 14904.103794336319, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 14904.103794336319, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 95.01454545454544, "ram_util_percent": 14.75681818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.030552610708400606}, "default_policy": {"total_loss": 0.030552610708400606, "policy_loss": -0.012256889278069139, "vf_loss": 0.17190773410038673, "vf_loss_unclipped": 1.7407345667226763, "vf_explained_var": 0.4050717752426863, "entropy": 0.16746910831425338, "mean_kl_loss": 0.0029118233280969246, "gradients_default_optimizer_global_norm": 0.438197058433434, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 6.10351571594947e-06}}, "num_env_steps_sampled": 97280, "num_env_steps_trained": 0, "num_agent_steps_sampled": 97278, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.059, "episode_reward_min": 10.731, "episode_reward_mean": 21.814790000000013, "episode_len_mean": 205.88, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025, 13.648, 19.888999999999992, 19.849000000000004, 20.427999999999994, 19.996999999999993, 25.743000000000023, 27.159000000000013, 19.963000000000005, 26.934000000000047, 24.995000000000047, 27.329000000000033, 27.448000000000043, 22.463000000000026, 13.559000000000003], "episode_lengths": [215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226, 69, 206, 209, 218, 211, 239, 233, 207, 234, 232, 231, 234, 215, 225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5134175001081637, "mean_inference_ms": 1.219738121165261, "mean_action_processing_ms": 0.08323955341287323, "mean_env_wait_ms": 5.042459125070199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033228397369384766, "ViewRequirementAgentConnector_ms": 0.23289704322814941}}, "episode_reward_max": 31.059, "episode_reward_min": 10.731, "episode_reward_mean": 21.814790000000013, "episode_len_mean": 205.88, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.479, 19.787999999999997, 27.167000000000016, 10.731, 25.14300000000002, 20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025, 13.648, 19.888999999999992, 19.849000000000004, 20.427999999999994, 19.996999999999993, 25.743000000000023, 27.159000000000013, 19.963000000000005, 26.934000000000047, 24.995000000000047, 27.329000000000033, 27.448000000000043, 22.463000000000026, 13.559000000000003], "episode_lengths": [215, 217, 238, 37, 236, 219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226, 69, 206, 209, 218, 211, 239, 233, 207, 234, 232, 231, 234, 215, 225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5134175001081637, "mean_inference_ms": 1.219738121165261, "mean_action_processing_ms": 0.08323955341287323, "mean_env_wait_ms": 5.042459125070199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033228397369384766, "ViewRequirementAgentConnector_ms": 0.23289704322814941}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97278, "num_agent_steps_trained": 0, "num_env_steps_sampled": 97280, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.710630557210006, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 97280, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 97278, "timers": {"training_iteration_time_ms": 150353.68, "sample_time_ms": 6791.33, "synch_weights_time_ms": 50.087}, "counters": {"num_env_steps_sampled": 97280, "num_env_steps_trained": 0, "num_agent_steps_sampled": 97278, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1362, "training_iteration": 95, "trial_id": "default", "date": "2025-12-20_02-43-34", "timestamp": 1766169814, "time_this_iter_s": 152.5961790084839, "time_total_s": 15056.699973344803, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 15056.699973344803, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 94.98986175115208, "ram_util_percent": 14.898156682027649}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.035522849147673695}, "default_policy": {"total_loss": 0.035522849147673695, "policy_loss": -0.013542333629447966, "vf_loss": 0.19686181882915435, "vf_loss_unclipped": 2.9007133922777824, "vf_explained_var": 0.0871750682592392, "entropy": 0.15029715936398133, "mean_kl_loss": 0.003906055708926637, "gradients_default_optimizer_global_norm": 0.534109161910601, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 3.051757857974735e-06}}, "num_env_steps_sampled": 98304, "num_env_steps_trained": 0, "num_agent_steps_sampled": 98302, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.059, "episode_reward_min": 10.8, "episode_reward_mean": 21.86332000000001, "episode_len_mean": 207.73, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025, 13.648, 19.888999999999992, 19.849000000000004, 20.427999999999994, 19.996999999999993, 25.743000000000023, 27.159000000000013, 19.963000000000005, 26.934000000000047, 24.995000000000047, 27.329000000000033, 27.448000000000043, 22.463000000000026, 13.559000000000003, 20.765999999999963, 26.545000000000012, 19.539999999999996, 26.892000000000007, 13.418000000000038], "episode_lengths": [219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226, 69, 206, 209, 218, 211, 239, 233, 207, 234, 232, 231, 234, 215, 225, 215, 231, 211, 242, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5124880234685468, "mean_inference_ms": 1.2191478348966818, "mean_action_processing_ms": 0.08320504885670968, "mean_env_wait_ms": 5.041108700099897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033216476440429688, "ViewRequirementAgentConnector_ms": 0.2330002784729004}}, "episode_reward_max": 31.059, "episode_reward_min": 10.8, "episode_reward_mean": 21.86332000000001, "episode_len_mean": 207.73, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.67899999999998, 26.056000000000008, 28.25400000000001, 22.415999999999986, 26.24700000000002, 24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025, 13.648, 19.888999999999992, 19.849000000000004, 20.427999999999994, 19.996999999999993, 25.743000000000023, 27.159000000000013, 19.963000000000005, 26.934000000000047, 24.995000000000047, 27.329000000000033, 27.448000000000043, 22.463000000000026, 13.559000000000003, 20.765999999999963, 26.545000000000012, 19.539999999999996, 26.892000000000007, 13.418000000000038], "episode_lengths": [219, 235, 237, 218, 230, 241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226, 69, 206, 209, 218, 211, 239, 233, 207, 234, 232, 231, 234, 215, 225, 215, 231, 211, 242, 229]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5124880234685468, "mean_inference_ms": 1.2191478348966818, "mean_action_processing_ms": 0.08320504885670968, "mean_env_wait_ms": 5.041108700099897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033216476440429688, "ViewRequirementAgentConnector_ms": 0.2330002784729004}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98302, "num_agent_steps_trained": 0, "num_env_steps_sampled": 98304, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.6338037665838385, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 98304, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 98302, "timers": {"training_iteration_time_ms": 150678.958, "sample_time_ms": 6791.721, "synch_weights_time_ms": 50.249}, "counters": {"num_env_steps_sampled": 98304, "num_env_steps_trained": 0, "num_agent_steps_sampled": 98302, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1367, "training_iteration": 96, "trial_id": "default", "date": "2025-12-20_02-46-09", "timestamp": 1766169969, "time_this_iter_s": 154.3640913963318, "time_total_s": 15211.064064741135, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 15211.064064741135, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 94.97625570776253, "ram_util_percent": 15.007305936073063}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.08253939523929148}, "default_policy": {"total_loss": 0.08253939523929148, "policy_loss": -0.015208411356434226, "vf_loss": 0.3915672250098396, "vf_loss_unclipped": 3.363817625865977, "vf_explained_var": 0.3801677517592907, "entropy": 0.14400814216351138, "mean_kl_loss": 0.003189290685279467, "gradients_default_optimizer_global_norm": 0.42587461731163784, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 1.5258789289873675e-06}}, "num_env_steps_sampled": 99328, "num_env_steps_trained": 0, "num_agent_steps_sampled": 99326, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.059, "episode_reward_min": 10.8, "episode_reward_mean": 21.850800000000007, "episode_len_mean": 206.84, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025, 13.648, 19.888999999999992, 19.849000000000004, 20.427999999999994, 19.996999999999993, 25.743000000000023, 27.159000000000013, 19.963000000000005, 26.934000000000047, 24.995000000000047, 27.329000000000033, 27.448000000000043, 22.463000000000026, 13.559000000000003, 20.765999999999963, 26.545000000000012, 19.539999999999996, 26.892000000000007, 13.418000000000038, 20.567999999999994, 25.312000000000005, 25.272000000000034, 23.205000000000013, 28.043000000000017], "episode_lengths": [241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226, 69, 206, 209, 218, 211, 239, 233, 207, 234, 232, 231, 234, 215, 225, 215, 231, 211, 242, 229, 208, 242, 234, 130, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5114837217562641, "mean_inference_ms": 1.2183799352559392, "mean_action_processing_ms": 0.08315491981225709, "mean_env_wait_ms": 5.03945042437309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003318309783935547, "ViewRequirementAgentConnector_ms": 0.23298215866088867}}, "episode_reward_max": 31.059, "episode_reward_min": 10.8, "episode_reward_mean": 21.850800000000007, "episode_len_mean": 206.84, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.87500000000002, 20.216999999999974, 21.091000000000005, 22.313999999999965, 20.586999999999996, 26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025, 13.648, 19.888999999999992, 19.849000000000004, 20.427999999999994, 19.996999999999993, 25.743000000000023, 27.159000000000013, 19.963000000000005, 26.934000000000047, 24.995000000000047, 27.329000000000033, 27.448000000000043, 22.463000000000026, 13.559000000000003, 20.765999999999963, 26.545000000000012, 19.539999999999996, 26.892000000000007, 13.418000000000038, 20.567999999999994, 25.312000000000005, 25.272000000000034, 23.205000000000013, 28.043000000000017], "episode_lengths": [241, 220, 208, 219, 207, 230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226, 69, 206, 209, 218, 211, 239, 233, 207, 234, 232, 231, 234, 215, 225, 215, 231, 211, 242, 229, 208, 242, 234, 130, 236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5114837217562641, "mean_inference_ms": 1.2183799352559392, "mean_action_processing_ms": 0.08315491981225709, "mean_env_wait_ms": 5.03945042437309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003318309783935547, "ViewRequirementAgentConnector_ms": 0.23298215866088867}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99326, "num_agent_steps_trained": 0, "num_env_steps_sampled": 99328, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.705913231879301, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 99328, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 99326, "timers": {"training_iteration_time_ms": 151363.493, "sample_time_ms": 6797.941, "synch_weights_time_ms": 49.443}, "counters": {"num_env_steps_sampled": 99328, "num_env_steps_trained": 0, "num_agent_steps_sampled": 99326, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1372, "training_iteration": 97, "trial_id": "default", "date": "2025-12-20_02-50-16", "timestamp": 1766170216, "time_this_iter_s": 152.7053201198578, "time_total_s": 15363.769384860992, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 15363.769384860992, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 61.19369627507163, "ram_util_percent": 14.77048710601719}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.0885561682516709}, "default_policy": {"total_loss": 0.0885561682516709, "policy_loss": -0.0192059388384223, "vf_loss": 0.431562172474446, "vf_loss_unclipped": 3.3576760931332728, "vf_explained_var": 0.3940604753792286, "entropy": 0.12843962998595088, "mean_kl_loss": 0.003553422955194385, "gradients_default_optimizer_global_norm": 0.6135604735754896, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 7.629394644936838e-07}}, "num_env_steps_sampled": 100352, "num_env_steps_trained": 0, "num_agent_steps_sampled": 100350, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.059, "episode_reward_min": 10.8, "episode_reward_mean": 21.88253000000001, "episode_len_mean": 205.87, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025, 13.648, 19.888999999999992, 19.849000000000004, 20.427999999999994, 19.996999999999993, 25.743000000000023, 27.159000000000013, 19.963000000000005, 26.934000000000047, 24.995000000000047, 27.329000000000033, 27.448000000000043, 22.463000000000026, 13.559000000000003, 20.765999999999963, 26.545000000000012, 19.539999999999996, 26.892000000000007, 13.418000000000038, 20.567999999999994, 25.312000000000005, 25.272000000000034, 23.205000000000013, 28.043000000000017, 27.565000000000015, 19.741000000000014, 20.123000000000008, 16.6, 28.228000000000023], "episode_lengths": [230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226, 69, 206, 209, 218, 211, 239, 233, 207, 234, 232, 231, 234, 215, 225, 215, 231, 211, 242, 229, 208, 242, 234, 130, 236, 233, 215, 216, 100, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5106066754665859, "mean_inference_ms": 1.2178217692631386, "mean_action_processing_ms": 0.08312326602067927, "mean_env_wait_ms": 5.038176571910114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033197402954101562, "ViewRequirementAgentConnector_ms": 0.23308587074279785}}, "episode_reward_max": 31.059, "episode_reward_min": 10.8, "episode_reward_mean": 21.88253000000001, "episode_len_mean": 205.87, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.94800000000001, 20.06699999999999, 21.517000000000003, 27.889000000000042, 12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025, 13.648, 19.888999999999992, 19.849000000000004, 20.427999999999994, 19.996999999999993, 25.743000000000023, 27.159000000000013, 19.963000000000005, 26.934000000000047, 24.995000000000047, 27.329000000000033, 27.448000000000043, 22.463000000000026, 13.559000000000003, 20.765999999999963, 26.545000000000012, 19.539999999999996, 26.892000000000007, 13.418000000000038, 20.567999999999994, 25.312000000000005, 25.272000000000034, 23.205000000000013, 28.043000000000017, 27.565000000000015, 19.741000000000014, 20.123000000000008, 16.6, 28.228000000000023], "episode_lengths": [230, 209, 219, 234, 218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226, 69, 206, 209, 218, 211, 239, 233, 207, 234, 232, 231, 234, 215, 225, 215, 231, 211, 242, 229, 208, 242, 234, 130, 236, 233, 215, 216, 100, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5106066754665859, "mean_inference_ms": 1.2178217692631386, "mean_action_processing_ms": 0.08312326602067927, "mean_env_wait_ms": 5.038176571910114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033197402954101562, "ViewRequirementAgentConnector_ms": 0.23308587074279785}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100350, "num_agent_steps_trained": 0, "num_env_steps_sampled": 100352, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.635595932167341, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 100352, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 100350, "timers": {"training_iteration_time_ms": 152153.102, "sample_time_ms": 6797.996, "synch_weights_time_ms": 51.448}, "counters": {"num_env_steps_sampled": 100352, "num_env_steps_trained": 0, "num_agent_steps_sampled": 100350, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1377, "training_iteration": 98, "trial_id": "default", "date": "2025-12-20_02-52-50", "timestamp": 1766170370, "time_this_iter_s": 154.32155656814575, "time_total_s": 15518.090941429138, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 15518.090941429138, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 95.07442922374429, "ram_util_percent": 15.03607305936073}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.01597432045455207}, "default_policy": {"total_loss": 0.01597432045455207, "policy_loss": -0.013854401785647497, "vf_loss": 0.11998534527565426, "vf_loss_unclipped": 1.1440407141945799, "vf_explained_var": 0.3453536681830883, "entropy": 0.16761775645718444, "mean_kl_loss": 0.0053052468949211, "gradients_default_optimizer_global_norm": 0.5460210395453032, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 7.629394644936838e-07}}, "num_env_steps_sampled": 101376, "num_env_steps_trained": 0, "num_agent_steps_sampled": 101374, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.059, "episode_reward_min": 10.8, "episode_reward_mean": 21.81278000000001, "episode_len_mean": 206.04, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025, 13.648, 19.888999999999992, 19.849000000000004, 20.427999999999994, 19.996999999999993, 25.743000000000023, 27.159000000000013, 19.963000000000005, 26.934000000000047, 24.995000000000047, 27.329000000000033, 27.448000000000043, 22.463000000000026, 13.559000000000003, 20.765999999999963, 26.545000000000012, 19.539999999999996, 26.892000000000007, 13.418000000000038, 20.567999999999994, 25.312000000000005, 25.272000000000034, 23.205000000000013, 28.043000000000017, 27.565000000000015, 19.741000000000014, 20.123000000000008, 16.6, 28.228000000000023, 27.677000000000042, 14.022999999999984, 28.375000000000032, 19.371000000000006], "episode_lengths": [218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226, 69, 206, 209, 218, 211, 239, 233, 207, 234, 232, 231, 234, 215, 225, 215, 231, 211, 242, 229, 208, 242, 234, 130, 236, 233, 215, 216, 100, 234, 233, 231, 234, 211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5099281896350876, "mean_inference_ms": 1.2173990820134377, "mean_action_processing_ms": 0.08309889348010625, "mean_env_wait_ms": 5.037189560032793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003290414810180664, "ViewRequirementAgentConnector_ms": 0.23305344581604004}}, "episode_reward_max": 31.059, "episode_reward_min": 10.8, "episode_reward_mean": 21.81278000000001, "episode_len_mean": 206.04, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.153000000000016, 24.541000000000036, 11.948, 26.203000000000007, 20.154000000000003, 15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025, 13.648, 19.888999999999992, 19.849000000000004, 20.427999999999994, 19.996999999999993, 25.743000000000023, 27.159000000000013, 19.963000000000005, 26.934000000000047, 24.995000000000047, 27.329000000000033, 27.448000000000043, 22.463000000000026, 13.559000000000003, 20.765999999999963, 26.545000000000012, 19.539999999999996, 26.892000000000007, 13.418000000000038, 20.567999999999994, 25.312000000000005, 25.272000000000034, 23.205000000000013, 28.043000000000017, 27.565000000000015, 19.741000000000014, 20.123000000000008, 16.6, 28.228000000000023, 27.677000000000042, 14.022999999999984, 28.375000000000032, 19.371000000000006], "episode_lengths": [218, 237, 46, 232, 214, 81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226, 69, 206, 209, 218, 211, 239, 233, 207, 234, 232, 231, 234, 215, 225, 215, 231, 211, 242, 229, 208, 242, 234, 130, 236, 233, 215, 216, 100, 234, 233, 231, 234, 211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5099281896350876, "mean_inference_ms": 1.2173990820134377, "mean_action_processing_ms": 0.08309889348010625, "mean_env_wait_ms": 5.037189560032793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003290414810180664, "ViewRequirementAgentConnector_ms": 0.23305344581604004}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101374, "num_agent_steps_trained": 0, "num_env_steps_sampled": 101376, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.662386082297007, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 101376, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 101374, "timers": {"training_iteration_time_ms": 152813.205, "sample_time_ms": 6797.714, "synch_weights_time_ms": 51.872}, "counters": {"num_env_steps_sampled": 101376, "num_env_steps_trained": 0, "num_agent_steps_sampled": 101374, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1381, "training_iteration": 99, "trial_id": "default", "date": "2025-12-20_02-55-24", "timestamp": 1766170524, "time_this_iter_s": 153.70143342018127, "time_total_s": 15671.79237484932, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 15671.79237484932, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 95.08493150684932, "ram_util_percent": 14.682191780821917}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 64.0, "num_env_steps_trained": 1024.0, "total_loss": 0.060419156984426084}, "default_policy": {"total_loss": 0.060419156984426084, "policy_loss": -0.01697088707005605, "vf_loss": 0.31005681499525506, "vf_loss_unclipped": 4.073088562187399, "vf_explained_var": 0.1874097190797329, "entropy": 0.12416365473181941, "mean_kl_loss": 0.0030980092891434107, "gradients_default_optimizer_global_norm": 0.6231260463071522, "default_optimizer_lr": 0.00020000000000000004, "curr_lr": 0.0002, "curr_entropy_coeff": 0.001, "curr_kl_coeff": 3.814697322468419e-07}}, "num_env_steps_sampled": 102400, "num_env_steps_trained": 0, "num_agent_steps_sampled": 102398, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 31.059, "episode_reward_min": 10.8, "episode_reward_mean": 22.01710000000001, "episode_len_mean": 208.19, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025, 13.648, 19.888999999999992, 19.849000000000004, 20.427999999999994, 19.996999999999993, 25.743000000000023, 27.159000000000013, 19.963000000000005, 26.934000000000047, 24.995000000000047, 27.329000000000033, 27.448000000000043, 22.463000000000026, 13.559000000000003, 20.765999999999963, 26.545000000000012, 19.539999999999996, 26.892000000000007, 13.418000000000038, 20.567999999999994, 25.312000000000005, 25.272000000000034, 23.205000000000013, 28.043000000000017, 27.565000000000015, 19.741000000000014, 20.123000000000008, 16.6, 28.228000000000023, 27.677000000000042, 14.022999999999984, 28.375000000000032, 19.371000000000006, 26.17600000000003, 27.951000000000032, 19.535999999999998, 13.828000000000024, 27.940000000000015], "episode_lengths": [81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226, 69, 206, 209, 218, 211, 239, 233, 207, 234, 232, 231, 234, 215, 225, 215, 231, 211, 242, 229, 208, 242, 234, 130, 236, 233, 215, 216, 100, 234, 233, 231, 234, 211, 239, 236, 216, 234, 237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5090861683841914, "mean_inference_ms": 1.216883273629788, "mean_action_processing_ms": 0.08306857515366893, "mean_env_wait_ms": 5.035989666045092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032987594604492188, "ViewRequirementAgentConnector_ms": 0.23302984237670898}}, "episode_reward_max": 31.059, "episode_reward_min": 10.8, "episode_reward_mean": 22.01710000000001, "episode_len_mean": 208.19, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.775, 27.144000000000005, 20.203, 21.282, 15.09000000000002, 16.59100000000001, 20.430999999999994, 20.715000000000035, 21.87799999999999, 27.776000000000014, 26.065, 22.337, 26.39700000000002, 19.191999999999997, 13.349000000000018, 20.01, 23.110000000000017, 12.898999999999988, 26.277000000000033, 17.016999999999964, 19.874999999999986, 20.25199999999999, 20.136, 19.979999999999997, 11.782, 27.816000000000013, 12.40000000000002, 27.15200000000001, 19.689000000000004, 26.230000000000047, 17.868, 17.432, 26.034000000000027, 27.747000000000007, 27.399000000000026, 21.097999999999995, 19.598000000000003, 26.290000000000035, 19.871999999999996, 27.397000000000002, 20.97400000000002, 26.923000000000002, 27.888000000000037, 19.958999999999993, 27.80600000000003, 31.059, 10.8, 17.344, 12.085999999999999, 21.02799999999999, 28.606000000000037, 14.243000000000029, 27.525000000000034, 20.57500000000001, 27.848000000000013, 27.107000000000042, 27.263, 25.874000000000017, 25.06400000000001, 21.339999999999982, 22.140000000000036, 12.574000000000025, 13.648, 19.888999999999992, 19.849000000000004, 20.427999999999994, 19.996999999999993, 25.743000000000023, 27.159000000000013, 19.963000000000005, 26.934000000000047, 24.995000000000047, 27.329000000000033, 27.448000000000043, 22.463000000000026, 13.559000000000003, 20.765999999999963, 26.545000000000012, 19.539999999999996, 26.892000000000007, 13.418000000000038, 20.567999999999994, 25.312000000000005, 25.272000000000034, 23.205000000000013, 28.043000000000017, 27.565000000000015, 19.741000000000014, 20.123000000000008, 16.6, 28.228000000000023, 27.677000000000042, 14.022999999999984, 28.375000000000032, 19.371000000000006, 26.17600000000003, 27.951000000000032, 19.535999999999998, 13.828000000000024, 27.940000000000015], "episode_lengths": [81, 167, 207, 212, 236, 215, 109, 214, 209, 238, 238, 156, 234, 218, 233, 220, 233, 220, 227, 214, 215, 208, 209, 214, 54, 233, 224, 235, 208, 230, 99, 111, 233, 232, 233, 209, 212, 236, 209, 243, 231, 234, 237, 205, 235, 202, 33, 99, 55, 214, 235, 221, 235, 207, 237, 234, 238, 240, 237, 208, 218, 226, 69, 206, 209, 218, 211, 239, 233, 207, 234, 232, 231, 234, 215, 225, 215, 231, 211, 242, 229, 208, 242, 234, 130, 236, 233, 215, 216, 100, 234, 233, 231, 234, 211, 239, 236, 216, 234, 237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5090861683841914, "mean_inference_ms": 1.216883273629788, "mean_action_processing_ms": 0.08306857515366893, "mean_env_wait_ms": 5.035989666045092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0032987594604492188, "ViewRequirementAgentConnector_ms": 0.23302984237670898}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102398, "num_agent_steps_trained": 0, "num_env_steps_sampled": 102400, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 6.627486329494042, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 102400, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 102398, "timers": {"training_iteration_time_ms": 153605.794, "sample_time_ms": 6810.219, "synch_weights_time_ms": 52.163}, "counters": {"num_env_steps_sampled": 102400, "num_env_steps_trained": 0, "num_agent_steps_sampled": 102398, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1386, "training_iteration": 100, "trial_id": "default", "date": "2025-12-20_02-57-59", "timestamp": 1766170679, "time_this_iter_s": 154.51131463050842, "time_total_s": 15826.303689479828, "pid": 1148676, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0002, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7b0f886f5990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x7b0f872b3880>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0002], [102400, 2e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 15826.303689479828, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 94.92909090909092, "ram_util_percent": 15.221818181818183}}
