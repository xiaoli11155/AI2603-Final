{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1022.0, "total_loss": -0.03938124524720479}, "default_policy": {"total_loss": -0.03938124524720479, "policy_loss": -0.0379043725784868, "vf_loss": 0.07873336435295641, "vf_loss_unclipped": 0.07873336435295641, "vf_explained_var": 0.16797640472650527, "entropy": 2.168619507551193, "mean_kl_loss": 0.0026299322793052497, "gradients_default_optimizer_global_norm": 0.13024099189788102, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.009880234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1022, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 9.414999999999994, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 6.5182499999999965, "episode_len_mean": 234.75, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681], "episode_lengths": [243, 227, 221, 248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44073881926359953, "mean_inference_ms": 1.4027968252379062, "mean_action_processing_ms": 0.08269546092369867, "mean_env_wait_ms": 5.0464777918586945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003707408905029297, "ViewRequirementAgentConnector_ms": 0.22948980331420898}}, "episode_reward_max": 9.414999999999994, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 6.5182499999999965, "episode_len_mean": 234.75, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681], "episode_lengths": [243, 227, 221, 248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44073881926359953, "mean_inference_ms": 1.4027968252379062, "mean_action_processing_ms": 0.08269546092369867, "mean_env_wait_ms": 5.0464777918586945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003707408905029297, "ViewRequirementAgentConnector_ms": 0.22948980331420898}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1022, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.531699713378156, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1024, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1022, "timers": {"training_iteration_time_ms": 49874.015, "sample_time_ms": 7187.597, "synch_weights_time_ms": 70.969}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1022, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 1, "trial_id": "default", "date": "2025-12-20_10-46-34", "timestamp": 1766198794, "time_this_iter_s": 49.879003286361694, "time_total_s": 49.879003286361694, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 49.879003286361694, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 84.41267605633803, "ram_util_percent": 14.036619718309858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.01868303567171097}, "default_policy": {"total_loss": 0.01868303567171097, "policy_loss": -0.029562947899103166, "vf_loss": 0.27599877417087554, "vf_loss_unclipped": 0.5856671124696732, "vf_explained_var": 0.4239757537841797, "entropy": 2.1566571414470674, "mean_kl_loss": 0.005545694406237089, "gradients_default_optimizer_global_norm": 0.20541698168963193, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.009760234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2046, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19.814999999999998, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 9.026374999999998, "episode_len_mean": 225.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43768939825469777, "mean_inference_ms": 1.3963922342050037, "mean_action_processing_ms": 0.08188813489791427, "mean_env_wait_ms": 5.034070193827059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00356137752532959, "ViewRequirementAgentConnector_ms": 0.2287149429321289}}, "episode_reward_max": 19.814999999999998, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 9.026374999999998, "episode_len_mean": 225.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43768939825469777, "mean_inference_ms": 1.3963922342050037, "mean_action_processing_ms": 0.08188813489791427, "mean_env_wait_ms": 5.034070193827059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00356137752532959, "ViewRequirementAgentConnector_ms": 0.2287149429321289}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2046, "num_agent_steps_trained": 0, "num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.668823366129224, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 2048, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2046, "timers": {"training_iteration_time_ms": 49708.578, "sample_time_ms": 7133.227, "synch_weights_time_ms": 72.68}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2046, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 2, "trial_id": "default", "date": "2025-12-20_10-47-32", "timestamp": 1766198852, "time_this_iter_s": 49.54501223564148, "time_total_s": 99.42401552200317, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 99.42401552200317, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 73.58915662650602, "ram_util_percent": 14.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.030188426654785872}, "default_policy": {"total_loss": 0.030188426654785872, "policy_loss": -0.0391139829531312, "vf_loss": 0.355296335555613, "vf_loss_unclipped": 0.5955634573474526, "vf_explained_var": 0.4443609371781349, "entropy": 2.0982232093811035, "mean_kl_loss": 0.00957479244998467, "gradients_default_optimizer_global_norm": 0.4145313072949648, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.009640234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3070, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19.814999999999998, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 10.767076923076921, "episode_len_mean": 219.15384615384616, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4364327828698221, "mean_inference_ms": 1.3937131806189114, "mean_action_processing_ms": 0.08142816067216582, "mean_env_wait_ms": 5.02471961229891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035524368286132812, "ViewRequirementAgentConnector_ms": 0.22848936227651742}}, "episode_reward_max": 19.814999999999998, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 10.767076923076921, "episode_len_mean": 219.15384615384616, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4364327828698221, "mean_inference_ms": 1.3937131806189114, "mean_action_processing_ms": 0.08142816067216582, "mean_env_wait_ms": 5.02471961229891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035524368286132812, "ViewRequirementAgentConnector_ms": 0.22848936227651742}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3070, "num_agent_steps_trained": 0, "num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.75736902118821, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 3072, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3070, "timers": {"training_iteration_time_ms": 49582.997, "sample_time_ms": 7116.878, "synch_weights_time_ms": 73.535}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3070, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 13, "training_iteration": 3, "trial_id": "default", "date": "2025-12-20_10-48-22", "timestamp": 1766198902, "time_this_iter_s": 49.337063789367676, "time_total_s": 148.76107931137085, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 148.76107931137085, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 85.70000000000002, "ram_util_percent": 14.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.1722603051457554}, "default_policy": {"total_loss": 0.1722603051457554, "policy_loss": -0.0359080633148551, "vf_loss": 0.909579448774457, "vf_loss_unclipped": 1.5020896870642901, "vf_explained_var": 0.5698178634047508, "entropy": 2.091386890411377, "mean_kl_loss": 0.009349651370985156, "gradients_default_optimizer_global_norm": 0.5554232023656368, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.009520234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4094, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 26.776999999999987, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 12.1122, "episode_len_mean": 201.3, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459, 5.553000000000003, 10.061000000000002, 15.630000000000006, 19.852, 26.776999999999987, 12.321, 12.078000000000001], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219, 243, 226, 222, 135, 186, 86, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43688354913115574, "mean_inference_ms": 1.3928581316091169, "mean_action_processing_ms": 0.08108944827460893, "mean_env_wait_ms": 5.015830310550115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035011768341064453, "ViewRequirementAgentConnector_ms": 0.22873163223266602}}, "episode_reward_max": 26.776999999999987, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 12.1122, "episode_len_mean": 201.3, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459, 5.553000000000003, 10.061000000000002, 15.630000000000006, 19.852, 26.776999999999987, 12.321, 12.078000000000001], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219, 243, 226, 222, 135, 186, 86, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43688354913115574, "mean_inference_ms": 1.3928581316091169, "mean_action_processing_ms": 0.08108944827460893, "mean_env_wait_ms": 5.015830310550115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035011768341064453, "ViewRequirementAgentConnector_ms": 0.22873163223266602}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4094, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.792961156763212, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4096, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4094, "timers": {"training_iteration_time_ms": 49499.093, "sample_time_ms": 7110.1, "synch_weights_time_ms": 74.263}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4094, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 4, "trial_id": "default", "date": "2025-12-20_10-49-11", "timestamp": 1766198951, "time_this_iter_s": 49.24958777427673, "time_total_s": 198.01066708564758, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 198.01066708564758, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 85.65142857142855, "ram_util_percent": 14.074285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.19924757555127143}, "default_policy": {"total_loss": 0.19924757555127143, "policy_loss": -0.0449244465213269, "vf_loss": 1.0480715572834014, "vf_loss_unclipped": 1.478094545006752, "vf_explained_var": 0.5617051303386689, "entropy": 2.0177338272333145, "mean_kl_loss": 0.013634322715552117, "gradients_default_optimizer_global_norm": 0.5937900312244893, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.009400234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5118, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 26.776999999999987, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 13.71152, "episode_len_mean": 196.92, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459, 5.553000000000003, 10.061000000000002, 15.630000000000006, 19.852, 26.776999999999987, 12.321, 12.078000000000001, 17.142999999999997, 22.002999999999993, 13.219, 22.654000000000003, 25.52499999999999], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219, 243, 226, 222, 135, 186, 86, 79, 175, 228, 92, 188, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4370130341290002, "mean_inference_ms": 1.3929973103676971, "mean_action_processing_ms": 0.08097914016680276, "mean_env_wait_ms": 5.011187782598949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034732818603515625, "ViewRequirementAgentConnector_ms": 0.2287616729736328}}, "episode_reward_max": 26.776999999999987, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 13.71152, "episode_len_mean": 196.92, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459, 5.553000000000003, 10.061000000000002, 15.630000000000006, 19.852, 26.776999999999987, 12.321, 12.078000000000001, 17.142999999999997, 22.002999999999993, 13.219, 22.654000000000003, 25.52499999999999], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219, 243, 226, 222, 135, 186, 86, 79, 175, 228, 92, 188, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4370130341290002, "mean_inference_ms": 1.3929973103676971, "mean_action_processing_ms": 0.08097914016680276, "mean_env_wait_ms": 5.011187782598949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034732818603515625, "ViewRequirementAgentConnector_ms": 0.2287616729736328}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5118, "num_agent_steps_trained": 0, "num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.505927313262866, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 5120, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 5118, "timers": {"training_iteration_time_ms": 49586.621, "sample_time_ms": 7105.483, "synch_weights_time_ms": 76.655}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 0, "num_agent_steps_sampled": 5118, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 25, "training_iteration": 5, "trial_id": "default", "date": "2025-12-20_10-50-01", "timestamp": 1766199001, "time_this_iter_s": 49.93894648551941, "time_total_s": 247.949613571167, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 247.949613571167, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 85.89999999999999, "ram_util_percent": 14.097183098591549}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.40376090481877325}, "default_policy": {"total_loss": 0.40376090481877325, "policy_loss": -0.04391630686586723, "vf_loss": 1.8576099395751953, "vf_loss_unclipped": 2.4365850001573564, "vf_explained_var": 0.5096539974212646, "entropy": 1.935482656955719, "mean_kl_loss": 0.014687179842212572, "gradients_default_optimizer_global_norm": 0.815320460498333, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.009280234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6142, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 26.776999999999987, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 14.805636363636362, "episode_len_mean": 183.33333333333334, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459, 5.553000000000003, 10.061000000000002, 15.630000000000006, 19.852, 26.776999999999987, 12.321, 12.078000000000001, 17.142999999999997, 22.002999999999993, 13.219, 22.654000000000003, 25.52499999999999, 19.303, 13.0, 22.502, 25.259000000000004, 14.471, 16.244999999999997, 15.316000000000003, 19.702000000000005], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219, 243, 226, 222, 135, 186, 86, 79, 175, 228, 92, 188, 214, 205, 75, 135, 204, 102, 129, 115, 162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4374908910066056, "mean_inference_ms": 1.3935518156461038, "mean_action_processing_ms": 0.08089305514720609, "mean_env_wait_ms": 5.006598150472636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034679066051136365, "ViewRequirementAgentConnector_ms": 0.22865208712491122}}, "episode_reward_max": 26.776999999999987, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 14.805636363636362, "episode_len_mean": 183.33333333333334, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459, 5.553000000000003, 10.061000000000002, 15.630000000000006, 19.852, 26.776999999999987, 12.321, 12.078000000000001, 17.142999999999997, 22.002999999999993, 13.219, 22.654000000000003, 25.52499999999999, 19.303, 13.0, 22.502, 25.259000000000004, 14.471, 16.244999999999997, 15.316000000000003, 19.702000000000005], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219, 243, 226, 222, 135, 186, 86, 79, 175, 228, 92, 188, 214, 205, 75, 135, 204, 102, 129, 115, 162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4374908910066056, "mean_inference_ms": 1.3935518156461038, "mean_action_processing_ms": 0.08089305514720609, "mean_env_wait_ms": 5.006598150472636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034679066051136365, "ViewRequirementAgentConnector_ms": 0.22865208712491122}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6142, "num_agent_steps_trained": 0, "num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.294641771187308, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 6144, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 6142, "timers": {"training_iteration_time_ms": 49731.622, "sample_time_ms": 7102.068, "synch_weights_time_ms": 76.896}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 0, "num_agent_steps_sampled": 6142, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 33, "training_iteration": 6, "trial_id": "default", "date": "2025-12-20_10-50-51", "timestamp": 1766199051, "time_this_iter_s": 50.459014654159546, "time_total_s": 298.40862822532654, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 298.40862822532654, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 86.03472222222223, "ram_util_percent": 14.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5056456297636032}, "default_policy": {"total_loss": 0.5056456297636032, "policy_loss": -0.03724358142353594, "vf_loss": 2.2365267634391786, "vf_loss_unclipped": 3.023427110910416, "vf_explained_var": 0.4992165893316269, "entropy": 1.891538456082344, "mean_kl_loss": 0.013114412492541305, "gradients_default_optimizer_global_norm": 1.1439188405871392, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.009160234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7166, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 26.776999999999987, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 15.264930232558141, "episode_len_mean": 164.88372093023256, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459, 5.553000000000003, 10.061000000000002, 15.630000000000006, 19.852, 26.776999999999987, 12.321, 12.078000000000001, 17.142999999999997, 22.002999999999993, 13.219, 22.654000000000003, 25.52499999999999, 19.303, 13.0, 22.502, 25.259000000000004, 14.471, 16.244999999999997, 15.316000000000003, 19.702000000000005, 17.322000000000003, 16.749, 19.555000000000003, 24.345000000000002, 19.962000000000003, 12.360000000000001, 15.368000000000002, 13.613, 17.608000000000004, 10.924000000000001], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219, 243, 226, 222, 135, 186, 86, 79, 175, 228, 92, 188, 214, 205, 75, 135, 204, 102, 129, 115, 162, 102, 106, 149, 140, 108, 56, 139, 74, 101, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43881117343312964, "mean_inference_ms": 1.3929710097506518, "mean_action_processing_ms": 0.08078624148599757, "mean_env_wait_ms": 5.00016920494947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003440435542616733, "ViewRequirementAgentConnector_ms": 0.22877094357512717}}, "episode_reward_max": 26.776999999999987, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 15.264930232558141, "episode_len_mean": 164.88372093023256, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459, 5.553000000000003, 10.061000000000002, 15.630000000000006, 19.852, 26.776999999999987, 12.321, 12.078000000000001, 17.142999999999997, 22.002999999999993, 13.219, 22.654000000000003, 25.52499999999999, 19.303, 13.0, 22.502, 25.259000000000004, 14.471, 16.244999999999997, 15.316000000000003, 19.702000000000005, 17.322000000000003, 16.749, 19.555000000000003, 24.345000000000002, 19.962000000000003, 12.360000000000001, 15.368000000000002, 13.613, 17.608000000000004, 10.924000000000001], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219, 243, 226, 222, 135, 186, 86, 79, 175, 228, 92, 188, 214, 205, 75, 135, 204, 102, 129, 115, 162, 102, 106, 149, 140, 108, 56, 139, 74, 101, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43881117343312964, "mean_inference_ms": 1.3929710097506518, "mean_action_processing_ms": 0.08078624148599757, "mean_env_wait_ms": 5.00016920494947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003440435542616733, "ViewRequirementAgentConnector_ms": 0.22877094357512717}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7166, "num_agent_steps_trained": 0, "num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.44423999096772, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 7168, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 7166, "timers": {"training_iteration_time_ms": 49782.44, "sample_time_ms": 7092.916, "synch_weights_time_ms": 78.816}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 0, "num_agent_steps_sampled": 7166, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 43, "training_iteration": 7, "trial_id": "default", "date": "2025-12-20_10-51-50", "timestamp": 1766199110, "time_this_iter_s": 50.09026885032654, "time_total_s": 348.4988970756531, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 348.4988970756531, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 74.93855421686746, "ram_util_percent": 14.099999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6019613191485405}, "default_policy": {"total_loss": 0.6019613191485405, "policy_loss": -0.03143772119656205, "vf_loss": 2.5935878574848177, "vf_loss_unclipped": 4.339999455213547, "vf_explained_var": 0.3461944878101349, "entropy": 1.7850693881511688, "mean_kl_loss": 0.013537251104753522, "gradients_default_optimizer_global_norm": 1.1880959160625935, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.009040234375000001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8190, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 26.776999999999987, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 15.441563636363638, "episode_len_mean": 147.8909090909091, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459, 5.553000000000003, 10.061000000000002, 15.630000000000006, 19.852, 26.776999999999987, 12.321, 12.078000000000001, 17.142999999999997, 22.002999999999993, 13.219, 22.654000000000003, 25.52499999999999, 19.303, 13.0, 22.502, 25.259000000000004, 14.471, 16.244999999999997, 15.316000000000003, 19.702000000000005, 17.322000000000003, 16.749, 19.555000000000003, 24.345000000000002, 19.962000000000003, 12.360000000000001, 15.368000000000002, 13.613, 17.608000000000004, 10.924000000000001, 15.198, 15.905000000000001, 14.027000000000001, 17.572000000000003, 25.483999999999998, 10.951, 12.928, 18.957000000000004, 12.344000000000001, 16.427, 15.501000000000001, 17.60000000000001], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219, 243, 226, 222, 135, 186, 86, 79, 175, 228, 92, 188, 214, 205, 75, 135, 204, 102, 129, 115, 162, 102, 106, 149, 140, 108, 56, 139, 74, 101, 65, 92, 93, 67, 104, 145, 59, 67, 84, 59, 104, 73, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44059191134971587, "mean_inference_ms": 1.3930533320912644, "mean_action_processing_ms": 0.08072658067731572, "mean_env_wait_ms": 4.9952360519135075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034293261441317472, "ViewRequirementAgentConnector_ms": 0.2286971699107777}}, "episode_reward_max": 26.776999999999987, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 15.441563636363638, "episode_len_mean": 147.8909090909091, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459, 5.553000000000003, 10.061000000000002, 15.630000000000006, 19.852, 26.776999999999987, 12.321, 12.078000000000001, 17.142999999999997, 22.002999999999993, 13.219, 22.654000000000003, 25.52499999999999, 19.303, 13.0, 22.502, 25.259000000000004, 14.471, 16.244999999999997, 15.316000000000003, 19.702000000000005, 17.322000000000003, 16.749, 19.555000000000003, 24.345000000000002, 19.962000000000003, 12.360000000000001, 15.368000000000002, 13.613, 17.608000000000004, 10.924000000000001, 15.198, 15.905000000000001, 14.027000000000001, 17.572000000000003, 25.483999999999998, 10.951, 12.928, 18.957000000000004, 12.344000000000001, 16.427, 15.501000000000001, 17.60000000000001], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219, 243, 226, 222, 135, 186, 86, 79, 175, 228, 92, 188, 214, 205, 75, 135, 204, 102, 129, 115, 162, 102, 106, 149, 140, 108, 56, 139, 74, 101, 65, 92, 93, 67, 104, 145, 59, 67, 84, 59, 104, 73, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44059191134971587, "mean_inference_ms": 1.3930533320912644, "mean_action_processing_ms": 0.08072658067731572, "mean_env_wait_ms": 4.9952360519135075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034293261441317472, "ViewRequirementAgentConnector_ms": 0.2286971699107777}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8190, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.409483290388824, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8192, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 8190, "timers": {"training_iteration_time_ms": 49831.221, "sample_time_ms": 7092.556, "synch_weights_time_ms": 79.816}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8190, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 55, "training_iteration": 8, "trial_id": "default", "date": "2025-12-20_10-52-40", "timestamp": 1766199160, "time_this_iter_s": 50.1767098903656, "time_total_s": 398.6756069660187, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 398.6756069660187, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 85.79154929577464, "ram_util_percent": 14.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6559688463807106}, "default_policy": {"total_loss": 0.6559688463807106, "policy_loss": -0.03855844701174647, "vf_loss": 2.835191160440445, "vf_loss_unclipped": 5.725997817516327, "vf_explained_var": 0.25790029019117355, "entropy": 1.7555956363677978, "mean_kl_loss": 0.01600489508082319, "gradients_default_optimizer_global_norm": 1.2173042714595794, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.008920234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9214, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 26.776999999999987, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 15.113463768115945, "episode_len_mean": 131.92753623188406, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459, 5.553000000000003, 10.061000000000002, 15.630000000000006, 19.852, 26.776999999999987, 12.321, 12.078000000000001, 17.142999999999997, 22.002999999999993, 13.219, 22.654000000000003, 25.52499999999999, 19.303, 13.0, 22.502, 25.259000000000004, 14.471, 16.244999999999997, 15.316000000000003, 19.702000000000005, 17.322000000000003, 16.749, 19.555000000000003, 24.345000000000002, 19.962000000000003, 12.360000000000001, 15.368000000000002, 13.613, 17.608000000000004, 10.924000000000001, 15.198, 15.905000000000001, 14.027000000000001, 17.572000000000003, 25.483999999999998, 10.951, 12.928, 18.957000000000004, 12.344000000000001, 16.427, 15.501000000000001, 17.60000000000001, 11.41, 12.658999999999999, 15.727, 16.155000000000005, 13.007000000000001, 13.503000000000002, 10.722000000000001, 13.729, 13.035, 15.621, 18.419000000000004, 11.156999999999998, 14.650000000000002, 13.749], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219, 243, 226, 222, 135, 186, 86, 79, 175, 228, 92, 188, 214, 205, 75, 135, 204, 102, 129, 115, 162, 102, 106, 149, 140, 108, 56, 139, 74, 101, 65, 92, 93, 67, 104, 145, 59, 67, 84, 59, 104, 73, 97, 46, 68, 75, 91, 66, 72, 57, 78, 69, 76, 83, 47, 67, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44289858456111836, "mean_inference_ms": 1.3934653925511529, "mean_action_processing_ms": 0.08068778639381809, "mean_env_wait_ms": 4.990721015804353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034487765768299932, "ViewRequirementAgentConnector_ms": 0.2292570860489555}}, "episode_reward_max": 26.776999999999987, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 15.113463768115945, "episode_len_mean": 131.92753623188406, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459, 5.553000000000003, 10.061000000000002, 15.630000000000006, 19.852, 26.776999999999987, 12.321, 12.078000000000001, 17.142999999999997, 22.002999999999993, 13.219, 22.654000000000003, 25.52499999999999, 19.303, 13.0, 22.502, 25.259000000000004, 14.471, 16.244999999999997, 15.316000000000003, 19.702000000000005, 17.322000000000003, 16.749, 19.555000000000003, 24.345000000000002, 19.962000000000003, 12.360000000000001, 15.368000000000002, 13.613, 17.608000000000004, 10.924000000000001, 15.198, 15.905000000000001, 14.027000000000001, 17.572000000000003, 25.483999999999998, 10.951, 12.928, 18.957000000000004, 12.344000000000001, 16.427, 15.501000000000001, 17.60000000000001, 11.41, 12.658999999999999, 15.727, 16.155000000000005, 13.007000000000001, 13.503000000000002, 10.722000000000001, 13.729, 13.035, 15.621, 18.419000000000004, 11.156999999999998, 14.650000000000002, 13.749], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219, 243, 226, 222, 135, 186, 86, 79, 175, 228, 92, 188, 214, 205, 75, 135, 204, 102, 129, 115, 162, 102, 106, 149, 140, 108, 56, 139, 74, 101, 65, 92, 93, 67, 104, 145, 59, 67, 84, 59, 104, 73, 97, 46, 68, 75, 91, 66, 72, 57, 78, 69, 76, 83, 47, 67, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44289858456111836, "mean_inference_ms": 1.3934653925511529, "mean_action_processing_ms": 0.08068778639381809, "mean_env_wait_ms": 4.990721015804353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034487765768299932, "ViewRequirementAgentConnector_ms": 0.2292570860489555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9214, "num_agent_steps_trained": 0, "num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.731179028054108, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 9216, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 9214, "timers": {"training_iteration_time_ms": 49782.659, "sample_time_ms": 7093.961, "synch_weights_time_ms": 80.56}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 0, "num_agent_steps_sampled": 9214, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 69, "training_iteration": 9, "trial_id": "default", "date": "2025-12-20_10-53-29", "timestamp": 1766199209, "time_this_iter_s": 49.39721059799194, "time_total_s": 448.0728175640106, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 448.0728175640106, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 85.67, "ram_util_percent": 14.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5519868288189173}, "default_policy": {"total_loss": 0.5519868288189173, "policy_loss": -0.03418013588525355, "vf_loss": 2.3957902252674104, "vf_loss_unclipped": 6.712386512756348, "vf_explained_var": 0.05722279548645019, "entropy": 1.606030198931694, "mean_kl_loss": 0.015455850772013946, "gradients_default_optimizer_global_norm": 1.3194427341222763, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.008800234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10238, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 26.776999999999987, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 15.091238095238097, "episode_len_mean": 120.61904761904762, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459, 5.553000000000003, 10.061000000000002, 15.630000000000006, 19.852, 26.776999999999987, 12.321, 12.078000000000001, 17.142999999999997, 22.002999999999993, 13.219, 22.654000000000003, 25.52499999999999, 19.303, 13.0, 22.502, 25.259000000000004, 14.471, 16.244999999999997, 15.316000000000003, 19.702000000000005, 17.322000000000003, 16.749, 19.555000000000003, 24.345000000000002, 19.962000000000003, 12.360000000000001, 15.368000000000002, 13.613, 17.608000000000004, 10.924000000000001, 15.198, 15.905000000000001, 14.027000000000001, 17.572000000000003, 25.483999999999998, 10.951, 12.928, 18.957000000000004, 12.344000000000001, 16.427, 15.501000000000001, 17.60000000000001, 11.41, 12.658999999999999, 15.727, 16.155000000000005, 13.007000000000001, 13.503000000000002, 10.722000000000001, 13.729, 13.035, 15.621, 18.419000000000004, 11.156999999999998, 14.650000000000002, 13.749, 16.271, 15.759000000000002, 11.887, 12.936, 13.383000000000001, 14.917000000000002, 15.071000000000002, 14.694000000000003, 14.072, 13.166, 15.423000000000002, 15.250000000000004, 15.908999999999999, 19.167, 16.930000000000003], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219, 243, 226, 222, 135, 186, 86, 79, 175, 228, 92, 188, 214, 205, 75, 135, 204, 102, 129, 115, 162, 102, 106, 149, 140, 108, 56, 139, 74, 101, 65, 92, 93, 67, 104, 145, 59, 67, 84, 59, 104, 73, 97, 46, 68, 75, 91, 66, 72, 57, 78, 69, 76, 83, 47, 67, 74, 82, 63, 43, 52, 53, 67, 67, 75, 78, 63, 75, 75, 67, 87, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44516001885939344, "mean_inference_ms": 1.393755764932297, "mean_action_processing_ms": 0.0806486913881811, "mean_env_wait_ms": 4.986840181502752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034374850136893137, "ViewRequirementAgentConnector_ms": 0.22919660522824242}}, "episode_reward_max": 26.776999999999987, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 15.091238095238097, "episode_len_mean": 120.61904761904762, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459, 5.553000000000003, 10.061000000000002, 15.630000000000006, 19.852, 26.776999999999987, 12.321, 12.078000000000001, 17.142999999999997, 22.002999999999993, 13.219, 22.654000000000003, 25.52499999999999, 19.303, 13.0, 22.502, 25.259000000000004, 14.471, 16.244999999999997, 15.316000000000003, 19.702000000000005, 17.322000000000003, 16.749, 19.555000000000003, 24.345000000000002, 19.962000000000003, 12.360000000000001, 15.368000000000002, 13.613, 17.608000000000004, 10.924000000000001, 15.198, 15.905000000000001, 14.027000000000001, 17.572000000000003, 25.483999999999998, 10.951, 12.928, 18.957000000000004, 12.344000000000001, 16.427, 15.501000000000001, 17.60000000000001, 11.41, 12.658999999999999, 15.727, 16.155000000000005, 13.007000000000001, 13.503000000000002, 10.722000000000001, 13.729, 13.035, 15.621, 18.419000000000004, 11.156999999999998, 14.650000000000002, 13.749, 16.271, 15.759000000000002, 11.887, 12.936, 13.383000000000001, 14.917000000000002, 15.071000000000002, 14.694000000000003, 14.072, 13.166, 15.423000000000002, 15.250000000000004, 15.908999999999999, 19.167, 16.930000000000003], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219, 243, 226, 222, 135, 186, 86, 79, 175, 228, 92, 188, 214, 205, 75, 135, 204, 102, 129, 115, 162, 102, 106, 149, 140, 108, 56, 139, 74, 101, 65, 92, 93, 67, 104, 145, 59, 67, 84, 59, 104, 73, 97, 46, 68, 75, 91, 66, 72, 57, 78, 69, 76, 83, 47, 67, 74, 82, 63, 43, 52, 53, 67, 67, 75, 78, 63, 75, 75, 67, 87, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44516001885939344, "mean_inference_ms": 1.393755764932297, "mean_action_processing_ms": 0.0806486913881811, "mean_env_wait_ms": 4.986840181502752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034374850136893137, "ViewRequirementAgentConnector_ms": 0.22919660522824242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10238, "num_agent_steps_trained": 0, "num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.611202565187586, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 10240, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 10238, "timers": {"training_iteration_time_ms": 49772.561, "sample_time_ms": 7090.725, "synch_weights_time_ms": 81.167}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 0, "num_agent_steps_sampled": 10238, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 84, "training_iteration": 10, "trial_id": "default", "date": "2025-12-20_10-54-19", "timestamp": 1766199259, "time_this_iter_s": 49.684799671173096, "time_total_s": 497.7576172351837, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 497.7576172351837, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 85.91408450704223, "ram_util_percent": 14.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5249311529099941}, "default_policy": {"total_loss": 0.5249311529099941, "policy_loss": -0.03511725805001333, "vf_loss": 2.290371999144554, "vf_loss_unclipped": 6.928140234947205, "vf_explained_var": 0.04662097245454788, "entropy": 1.5867893546819687, "mean_kl_loss": 0.014195343772803426, "gradients_default_optimizer_global_norm": 1.1472734041512012, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.008680234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11262, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 26.776999999999987, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 15.060540000000001, "episode_len_mean": 111.76, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459, 5.553000000000003, 10.061000000000002, 15.630000000000006, 19.852, 26.776999999999987, 12.321, 12.078000000000001, 17.142999999999997, 22.002999999999993, 13.219, 22.654000000000003, 25.52499999999999, 19.303, 13.0, 22.502, 25.259000000000004, 14.471, 16.244999999999997, 15.316000000000003, 19.702000000000005, 17.322000000000003, 16.749, 19.555000000000003, 24.345000000000002, 19.962000000000003, 12.360000000000001, 15.368000000000002, 13.613, 17.608000000000004, 10.924000000000001, 15.198, 15.905000000000001, 14.027000000000001, 17.572000000000003, 25.483999999999998, 10.951, 12.928, 18.957000000000004, 12.344000000000001, 16.427, 15.501000000000001, 17.60000000000001, 11.41, 12.658999999999999, 15.727, 16.155000000000005, 13.007000000000001, 13.503000000000002, 10.722000000000001, 13.729, 13.035, 15.621, 18.419000000000004, 11.156999999999998, 14.650000000000002, 13.749, 16.271, 15.759000000000002, 11.887, 12.936, 13.383000000000001, 14.917000000000002, 15.071000000000002, 14.694000000000003, 14.072, 13.166, 15.423000000000002, 15.250000000000004, 15.908999999999999, 19.167, 16.930000000000003, 14.138000000000002, 14.224, 13.713000000000001, 15.016000000000002, 15.516000000000002, 18.362000000000002, 15.804000000000002, 12.123999999999999, 18.281, 15.338000000000001, 15.870000000000001, 13.809000000000001, 11.733, 19.049, 12.265, 13.148000000000001], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219, 243, 226, 222, 135, 186, 86, 79, 175, 228, 92, 188, 214, 205, 75, 135, 204, 102, 129, 115, 162, 102, 106, 149, 140, 108, 56, 139, 74, 101, 65, 92, 93, 67, 104, 145, 59, 67, 84, 59, 104, 73, 97, 46, 68, 75, 91, 66, 72, 57, 78, 69, 76, 83, 47, 67, 74, 82, 63, 43, 52, 53, 67, 67, 75, 78, 63, 75, 75, 67, 87, 82, 75, 57, 66, 62, 67, 93, 60, 41, 79, 78, 85, 56, 47, 83, 51, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4476260475470676, "mean_inference_ms": 1.3944502985618874, "mean_action_processing_ms": 0.08064013509599734, "mean_env_wait_ms": 4.985091796523866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034542083740234375, "ViewRequirementAgentConnector_ms": 0.23047637939453125}}, "episode_reward_max": 26.776999999999987, "episode_reward_min": 4.206999999999996, "episode_reward_mean": 15.060540000000001, "episode_len_mean": 111.76, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.414999999999994, 4.206999999999996, 7.769999999999997, 4.681, 19.814999999999998, 10.547, 5.705, 10.071, 5.262000000000004, 13.037, 14.217, 17.786, 17.459, 5.553000000000003, 10.061000000000002, 15.630000000000006, 19.852, 26.776999999999987, 12.321, 12.078000000000001, 17.142999999999997, 22.002999999999993, 13.219, 22.654000000000003, 25.52499999999999, 19.303, 13.0, 22.502, 25.259000000000004, 14.471, 16.244999999999997, 15.316000000000003, 19.702000000000005, 17.322000000000003, 16.749, 19.555000000000003, 24.345000000000002, 19.962000000000003, 12.360000000000001, 15.368000000000002, 13.613, 17.608000000000004, 10.924000000000001, 15.198, 15.905000000000001, 14.027000000000001, 17.572000000000003, 25.483999999999998, 10.951, 12.928, 18.957000000000004, 12.344000000000001, 16.427, 15.501000000000001, 17.60000000000001, 11.41, 12.658999999999999, 15.727, 16.155000000000005, 13.007000000000001, 13.503000000000002, 10.722000000000001, 13.729, 13.035, 15.621, 18.419000000000004, 11.156999999999998, 14.650000000000002, 13.749, 16.271, 15.759000000000002, 11.887, 12.936, 13.383000000000001, 14.917000000000002, 15.071000000000002, 14.694000000000003, 14.072, 13.166, 15.423000000000002, 15.250000000000004, 15.908999999999999, 19.167, 16.930000000000003, 14.138000000000002, 14.224, 13.713000000000001, 15.016000000000002, 15.516000000000002, 18.362000000000002, 15.804000000000002, 12.123999999999999, 18.281, 15.338000000000001, 15.870000000000001, 13.809000000000001, 11.733, 19.049, 12.265, 13.148000000000001], "episode_lengths": [243, 227, 221, 248, 169, 231, 228, 233, 219, 229, 146, 236, 219, 243, 226, 222, 135, 186, 86, 79, 175, 228, 92, 188, 214, 205, 75, 135, 204, 102, 129, 115, 162, 102, 106, 149, 140, 108, 56, 139, 74, 101, 65, 92, 93, 67, 104, 145, 59, 67, 84, 59, 104, 73, 97, 46, 68, 75, 91, 66, 72, 57, 78, 69, 76, 83, 47, 67, 74, 82, 63, 43, 52, 53, 67, 67, 75, 78, 63, 75, 75, 67, 87, 82, 75, 57, 66, 62, 67, 93, 60, 41, 79, 78, 85, 56, 47, 83, 51, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4476260475470676, "mean_inference_ms": 1.3944502985618874, "mean_action_processing_ms": 0.08064013509599734, "mean_env_wait_ms": 4.985091796523866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034542083740234375, "ViewRequirementAgentConnector_ms": 0.23047637939453125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11262, "num_agent_steps_trained": 0, "num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.45304684715811, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 11264, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 11262, "timers": {"training_iteration_time_ms": 49791.745, "sample_time_ms": 7099.783, "synch_weights_time_ms": 82.409}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 0, "num_agent_steps_sampled": 11262, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 100, "training_iteration": 11, "trial_id": "default", "date": "2025-12-20_10-55-09", "timestamp": 1766199309, "time_this_iter_s": 50.071531534194946, "time_total_s": 547.8291487693787, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 547.8291487693787, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 85.53239436619717, "ram_util_percent": 14.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5923792071640491}, "default_policy": {"total_loss": 0.5923792071640491, "policy_loss": -0.03512679715640843, "vf_loss": 2.5581744849681853, "vf_loss_unclipped": 8.244698619842529, "vf_explained_var": 0.002596566081047058, "entropy": 1.555158969759941, "mean_kl_loss": 0.014615364300016153, "gradients_default_optimizer_global_norm": 0.8488433964550495, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.008560234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12286, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 25.52499999999999, "episode_reward_min": 10.722000000000001, "episode_reward_mean": 15.447590000000002, "episode_len_mean": 83.72, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.321, 12.078000000000001, 17.142999999999997, 22.002999999999993, 13.219, 22.654000000000003, 25.52499999999999, 19.303, 13.0, 22.502, 25.259000000000004, 14.471, 16.244999999999997, 15.316000000000003, 19.702000000000005, 17.322000000000003, 16.749, 19.555000000000003, 24.345000000000002, 19.962000000000003, 12.360000000000001, 15.368000000000002, 13.613, 17.608000000000004, 10.924000000000001, 15.198, 15.905000000000001, 14.027000000000001, 17.572000000000003, 25.483999999999998, 10.951, 12.928, 18.957000000000004, 12.344000000000001, 16.427, 15.501000000000001, 17.60000000000001, 11.41, 12.658999999999999, 15.727, 16.155000000000005, 13.007000000000001, 13.503000000000002, 10.722000000000001, 13.729, 13.035, 15.621, 18.419000000000004, 11.156999999999998, 14.650000000000002, 13.749, 16.271, 15.759000000000002, 11.887, 12.936, 13.383000000000001, 14.917000000000002, 15.071000000000002, 14.694000000000003, 14.072, 13.166, 15.423000000000002, 15.250000000000004, 15.908999999999999, 19.167, 16.930000000000003, 14.138000000000002, 14.224, 13.713000000000001, 15.016000000000002, 15.516000000000002, 18.362000000000002, 15.804000000000002, 12.123999999999999, 18.281, 15.338000000000001, 15.870000000000001, 13.809000000000001, 11.733, 19.049, 12.265, 13.148000000000001, 13.062, 12.155, 13.839, 13.754999999999999, 15.396, 13.043000000000001, 18.296, 17.150000000000006, 11.703999999999999, 15.664000000000003, 15.035000000000002, 13.961, 13.812000000000001, 13.739, 13.269, 16.133000000000003, 14.345000000000002, 12.192], "episode_lengths": [86, 79, 175, 228, 92, 188, 214, 205, 75, 135, 204, 102, 129, 115, 162, 102, 106, 149, 140, 108, 56, 139, 74, 101, 65, 92, 93, 67, 104, 145, 59, 67, 84, 59, 104, 73, 97, 46, 68, 75, 91, 66, 72, 57, 78, 69, 76, 83, 47, 67, 74, 82, 63, 43, 52, 53, 67, 67, 75, 78, 63, 75, 75, 67, 87, 82, 75, 57, 66, 62, 67, 93, 60, 41, 79, 78, 85, 56, 47, 83, 51, 44, 62, 50, 49, 56, 70, 44, 84, 66, 45, 77, 64, 62, 45, 62, 44, 67, 55, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45266719178458137, "mean_inference_ms": 1.3948985290900735, "mean_action_processing_ms": 0.08051722991282968, "mean_env_wait_ms": 4.97608246260759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003417491912841797, "ViewRequirementAgentConnector_ms": 0.23012471199035645}}, "episode_reward_max": 25.52499999999999, "episode_reward_min": 10.722000000000001, "episode_reward_mean": 15.447590000000002, "episode_len_mean": 83.72, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.321, 12.078000000000001, 17.142999999999997, 22.002999999999993, 13.219, 22.654000000000003, 25.52499999999999, 19.303, 13.0, 22.502, 25.259000000000004, 14.471, 16.244999999999997, 15.316000000000003, 19.702000000000005, 17.322000000000003, 16.749, 19.555000000000003, 24.345000000000002, 19.962000000000003, 12.360000000000001, 15.368000000000002, 13.613, 17.608000000000004, 10.924000000000001, 15.198, 15.905000000000001, 14.027000000000001, 17.572000000000003, 25.483999999999998, 10.951, 12.928, 18.957000000000004, 12.344000000000001, 16.427, 15.501000000000001, 17.60000000000001, 11.41, 12.658999999999999, 15.727, 16.155000000000005, 13.007000000000001, 13.503000000000002, 10.722000000000001, 13.729, 13.035, 15.621, 18.419000000000004, 11.156999999999998, 14.650000000000002, 13.749, 16.271, 15.759000000000002, 11.887, 12.936, 13.383000000000001, 14.917000000000002, 15.071000000000002, 14.694000000000003, 14.072, 13.166, 15.423000000000002, 15.250000000000004, 15.908999999999999, 19.167, 16.930000000000003, 14.138000000000002, 14.224, 13.713000000000001, 15.016000000000002, 15.516000000000002, 18.362000000000002, 15.804000000000002, 12.123999999999999, 18.281, 15.338000000000001, 15.870000000000001, 13.809000000000001, 11.733, 19.049, 12.265, 13.148000000000001, 13.062, 12.155, 13.839, 13.754999999999999, 15.396, 13.043000000000001, 18.296, 17.150000000000006, 11.703999999999999, 15.664000000000003, 15.035000000000002, 13.961, 13.812000000000001, 13.739, 13.269, 16.133000000000003, 14.345000000000002, 12.192], "episode_lengths": [86, 79, 175, 228, 92, 188, 214, 205, 75, 135, 204, 102, 129, 115, 162, 102, 106, 149, 140, 108, 56, 139, 74, 101, 65, 92, 93, 67, 104, 145, 59, 67, 84, 59, 104, 73, 97, 46, 68, 75, 91, 66, 72, 57, 78, 69, 76, 83, 47, 67, 74, 82, 63, 43, 52, 53, 67, 67, 75, 78, 63, 75, 75, 67, 87, 82, 75, 57, 66, 62, 67, 93, 60, 41, 79, 78, 85, 56, 47, 83, 51, 44, 62, 50, 49, 56, 70, 44, 84, 66, 45, 77, 64, 62, 45, 62, 44, 67, 55, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45266719178458137, "mean_inference_ms": 1.3948985290900735, "mean_action_processing_ms": 0.08051722991282968, "mean_env_wait_ms": 4.97608246260759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003417491912841797, "ViewRequirementAgentConnector_ms": 0.23012471199035645}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12286, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.446844193851344, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12288, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 12286, "timers": {"training_iteration_time_ms": 49845.533, "sample_time_ms": 7097.217, "synch_weights_time_ms": 81.094}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12286, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 118, "training_iteration": 12, "trial_id": "default", "date": "2025-12-20_10-56-08", "timestamp": 1766199368, "time_this_iter_s": 50.08416938781738, "time_total_s": 597.913318157196, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 597.913318157196, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 74.0156626506024, "ram_util_percent": 14.099999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5140419632196427}, "default_policy": {"total_loss": 0.5140419632196427, "policy_loss": -0.03571255581919104, "vf_loss": 2.2444958120584486, "vf_loss_unclipped": 7.130815005302429, "vf_explained_var": 0.03134821206331253, "entropy": 1.5061258852481842, "mean_kl_loss": 0.015233677321475625, "gradients_default_optimizer_global_norm": 0.6998266406357289, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.008440234375000001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13310, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 25.483999999999998, "episode_reward_min": 10.722000000000001, "episode_reward_mean": 15.051850000000002, "episode_len_mean": 71.93, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.322000000000003, 16.749, 19.555000000000003, 24.345000000000002, 19.962000000000003, 12.360000000000001, 15.368000000000002, 13.613, 17.608000000000004, 10.924000000000001, 15.198, 15.905000000000001, 14.027000000000001, 17.572000000000003, 25.483999999999998, 10.951, 12.928, 18.957000000000004, 12.344000000000001, 16.427, 15.501000000000001, 17.60000000000001, 11.41, 12.658999999999999, 15.727, 16.155000000000005, 13.007000000000001, 13.503000000000002, 10.722000000000001, 13.729, 13.035, 15.621, 18.419000000000004, 11.156999999999998, 14.650000000000002, 13.749, 16.271, 15.759000000000002, 11.887, 12.936, 13.383000000000001, 14.917000000000002, 15.071000000000002, 14.694000000000003, 14.072, 13.166, 15.423000000000002, 15.250000000000004, 15.908999999999999, 19.167, 16.930000000000003, 14.138000000000002, 14.224, 13.713000000000001, 15.016000000000002, 15.516000000000002, 18.362000000000002, 15.804000000000002, 12.123999999999999, 18.281, 15.338000000000001, 15.870000000000001, 13.809000000000001, 11.733, 19.049, 12.265, 13.148000000000001, 13.062, 12.155, 13.839, 13.754999999999999, 15.396, 13.043000000000001, 18.296, 17.150000000000006, 11.703999999999999, 15.664000000000003, 15.035000000000002, 13.961, 13.812000000000001, 13.739, 13.269, 16.133000000000003, 14.345000000000002, 12.192, 12.488, 15.312999999999999, 13.586000000000002, 16.046000000000003, 15.538, 20.491000000000007, 18.364000000000004, 10.876, 14.476999999999999, 15.834, 15.423, 11.205, 16.323000000000004, 16.983, 18.220000000000006], "episode_lengths": [102, 106, 149, 140, 108, 56, 139, 74, 101, 65, 92, 93, 67, 104, 145, 59, 67, 84, 59, 104, 73, 97, 46, 68, 75, 91, 66, 72, 57, 78, 69, 76, 83, 47, 67, 74, 82, 63, 43, 52, 53, 67, 67, 75, 78, 63, 75, 75, 67, 87, 82, 75, 57, 66, 62, 67, 93, 60, 41, 79, 78, 85, 56, 47, 83, 51, 44, 62, 50, 49, 56, 70, 44, 84, 66, 45, 77, 64, 62, 45, 62, 44, 67, 55, 55, 59, 67, 64, 74, 62, 101, 82, 39, 58, 63, 70, 45, 70, 71, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45689484702741895, "mean_inference_ms": 1.3951074423387462, "mean_action_processing_ms": 0.08050461793831493, "mean_env_wait_ms": 4.9721084076195545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003431558609008789, "ViewRequirementAgentConnector_ms": 0.23058009147644043}}, "episode_reward_max": 25.483999999999998, "episode_reward_min": 10.722000000000001, "episode_reward_mean": 15.051850000000002, "episode_len_mean": 71.93, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.322000000000003, 16.749, 19.555000000000003, 24.345000000000002, 19.962000000000003, 12.360000000000001, 15.368000000000002, 13.613, 17.608000000000004, 10.924000000000001, 15.198, 15.905000000000001, 14.027000000000001, 17.572000000000003, 25.483999999999998, 10.951, 12.928, 18.957000000000004, 12.344000000000001, 16.427, 15.501000000000001, 17.60000000000001, 11.41, 12.658999999999999, 15.727, 16.155000000000005, 13.007000000000001, 13.503000000000002, 10.722000000000001, 13.729, 13.035, 15.621, 18.419000000000004, 11.156999999999998, 14.650000000000002, 13.749, 16.271, 15.759000000000002, 11.887, 12.936, 13.383000000000001, 14.917000000000002, 15.071000000000002, 14.694000000000003, 14.072, 13.166, 15.423000000000002, 15.250000000000004, 15.908999999999999, 19.167, 16.930000000000003, 14.138000000000002, 14.224, 13.713000000000001, 15.016000000000002, 15.516000000000002, 18.362000000000002, 15.804000000000002, 12.123999999999999, 18.281, 15.338000000000001, 15.870000000000001, 13.809000000000001, 11.733, 19.049, 12.265, 13.148000000000001, 13.062, 12.155, 13.839, 13.754999999999999, 15.396, 13.043000000000001, 18.296, 17.150000000000006, 11.703999999999999, 15.664000000000003, 15.035000000000002, 13.961, 13.812000000000001, 13.739, 13.269, 16.133000000000003, 14.345000000000002, 12.192, 12.488, 15.312999999999999, 13.586000000000002, 16.046000000000003, 15.538, 20.491000000000007, 18.364000000000004, 10.876, 14.476999999999999, 15.834, 15.423, 11.205, 16.323000000000004, 16.983, 18.220000000000006], "episode_lengths": [102, 106, 149, 140, 108, 56, 139, 74, 101, 65, 92, 93, 67, 104, 145, 59, 67, 84, 59, 104, 73, 97, 46, 68, 75, 91, 66, 72, 57, 78, 69, 76, 83, 47, 67, 74, 82, 63, 43, 52, 53, 67, 67, 75, 78, 63, 75, 75, 67, 87, 82, 75, 57, 66, 62, 67, 93, 60, 41, 79, 78, 85, 56, 47, 83, 51, 44, 62, 50, 49, 56, 70, 44, 84, 66, 45, 77, 64, 62, 45, 62, 44, 67, 55, 55, 59, 67, 64, 74, 62, 101, 82, 39, 58, 63, 70, 45, 70, 71, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45689484702741895, "mean_inference_ms": 1.3951074423387462, "mean_action_processing_ms": 0.08050461793831493, "mean_env_wait_ms": 4.9721084076195545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003431558609008789, "ViewRequirementAgentConnector_ms": 0.23058009147644043}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13310, "num_agent_steps_trained": 0, "num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.40091274616127, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 13312, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 13310, "timers": {"training_iteration_time_ms": 49931.729, "sample_time_ms": 7096.859, "synch_weights_time_ms": 82.426}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 0, "num_agent_steps_sampled": 13310, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 133, "training_iteration": 13, "trial_id": "default", "date": "2025-12-20_10-56-58", "timestamp": 1766199418, "time_this_iter_s": 50.1964271068573, "time_total_s": 648.1097452640533, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 648.1097452640533, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 85.94084507042254, "ram_util_percent": 14.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5461747586727143}, "default_policy": {"total_loss": 0.5461747586727143, "policy_loss": -0.03233052920550108, "vf_loss": 2.357527071237564, "vf_loss_unclipped": 8.16328067779541, "vf_explained_var": -0.03440854400396347, "entropy": 1.4717988133430482, "mean_kl_loss": 0.015458448692834281, "gradients_default_optimizer_global_norm": 0.5125507831573486, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.008320234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14334, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.491000000000007, "episode_reward_min": 10.722000000000001, "episode_reward_mean": 14.712850000000003, "episode_len_mean": 65.27, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.957000000000004, 12.344000000000001, 16.427, 15.501000000000001, 17.60000000000001, 11.41, 12.658999999999999, 15.727, 16.155000000000005, 13.007000000000001, 13.503000000000002, 10.722000000000001, 13.729, 13.035, 15.621, 18.419000000000004, 11.156999999999998, 14.650000000000002, 13.749, 16.271, 15.759000000000002, 11.887, 12.936, 13.383000000000001, 14.917000000000002, 15.071000000000002, 14.694000000000003, 14.072, 13.166, 15.423000000000002, 15.250000000000004, 15.908999999999999, 19.167, 16.930000000000003, 14.138000000000002, 14.224, 13.713000000000001, 15.016000000000002, 15.516000000000002, 18.362000000000002, 15.804000000000002, 12.123999999999999, 18.281, 15.338000000000001, 15.870000000000001, 13.809000000000001, 11.733, 19.049, 12.265, 13.148000000000001, 13.062, 12.155, 13.839, 13.754999999999999, 15.396, 13.043000000000001, 18.296, 17.150000000000006, 11.703999999999999, 15.664000000000003, 15.035000000000002, 13.961, 13.812000000000001, 13.739, 13.269, 16.133000000000003, 14.345000000000002, 12.192, 12.488, 15.312999999999999, 13.586000000000002, 16.046000000000003, 15.538, 20.491000000000007, 18.364000000000004, 10.876, 14.476999999999999, 15.834, 15.423, 11.205, 16.323000000000004, 16.983, 18.220000000000006, 14.842000000000002, 12.955000000000002, 12.873000000000001, 16.149, 18.434, 14.527000000000001, 13.236, 13.511, 13.384, 14.216000000000001, 12.780000000000001, 15.267000000000001, 15.536000000000001, 15.659, 11.895000000000001, 16.586, 14.121000000000002], "episode_lengths": [84, 59, 104, 73, 97, 46, 68, 75, 91, 66, 72, 57, 78, 69, 76, 83, 47, 67, 74, 82, 63, 43, 52, 53, 67, 67, 75, 78, 63, 75, 75, 67, 87, 82, 75, 57, 66, 62, 67, 93, 60, 41, 79, 78, 85, 56, 47, 83, 51, 44, 62, 50, 49, 56, 70, 44, 84, 66, 45, 77, 64, 62, 45, 62, 44, 67, 55, 55, 59, 67, 64, 74, 62, 101, 82, 39, 58, 63, 70, 45, 70, 71, 85, 56, 52, 53, 66, 74, 58, 48, 58, 60, 60, 50, 60, 72, 57, 50, 70, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4612385635645013, "mean_inference_ms": 1.3954789741271665, "mean_action_processing_ms": 0.08049400136328522, "mean_env_wait_ms": 4.968925706138643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003439188003540039, "ViewRequirementAgentConnector_ms": 0.2307450771331787}}, "episode_reward_max": 20.491000000000007, "episode_reward_min": 10.722000000000001, "episode_reward_mean": 14.712850000000003, "episode_len_mean": 65.27, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.957000000000004, 12.344000000000001, 16.427, 15.501000000000001, 17.60000000000001, 11.41, 12.658999999999999, 15.727, 16.155000000000005, 13.007000000000001, 13.503000000000002, 10.722000000000001, 13.729, 13.035, 15.621, 18.419000000000004, 11.156999999999998, 14.650000000000002, 13.749, 16.271, 15.759000000000002, 11.887, 12.936, 13.383000000000001, 14.917000000000002, 15.071000000000002, 14.694000000000003, 14.072, 13.166, 15.423000000000002, 15.250000000000004, 15.908999999999999, 19.167, 16.930000000000003, 14.138000000000002, 14.224, 13.713000000000001, 15.016000000000002, 15.516000000000002, 18.362000000000002, 15.804000000000002, 12.123999999999999, 18.281, 15.338000000000001, 15.870000000000001, 13.809000000000001, 11.733, 19.049, 12.265, 13.148000000000001, 13.062, 12.155, 13.839, 13.754999999999999, 15.396, 13.043000000000001, 18.296, 17.150000000000006, 11.703999999999999, 15.664000000000003, 15.035000000000002, 13.961, 13.812000000000001, 13.739, 13.269, 16.133000000000003, 14.345000000000002, 12.192, 12.488, 15.312999999999999, 13.586000000000002, 16.046000000000003, 15.538, 20.491000000000007, 18.364000000000004, 10.876, 14.476999999999999, 15.834, 15.423, 11.205, 16.323000000000004, 16.983, 18.220000000000006, 14.842000000000002, 12.955000000000002, 12.873000000000001, 16.149, 18.434, 14.527000000000001, 13.236, 13.511, 13.384, 14.216000000000001, 12.780000000000001, 15.267000000000001, 15.536000000000001, 15.659, 11.895000000000001, 16.586, 14.121000000000002], "episode_lengths": [84, 59, 104, 73, 97, 46, 68, 75, 91, 66, 72, 57, 78, 69, 76, 83, 47, 67, 74, 82, 63, 43, 52, 53, 67, 67, 75, 78, 63, 75, 75, 67, 87, 82, 75, 57, 66, 62, 67, 93, 60, 41, 79, 78, 85, 56, 47, 83, 51, 44, 62, 50, 49, 56, 70, 44, 84, 66, 45, 77, 64, 62, 45, 62, 44, 67, 55, 55, 59, 67, 64, 74, 62, 101, 82, 39, 58, 63, 70, 45, 70, 71, 85, 56, 52, 53, 66, 74, 58, 48, 58, 60, 60, 50, 60, 72, 57, 50, 70, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4612385635645013, "mean_inference_ms": 1.3954789741271665, "mean_action_processing_ms": 0.08049400136328522, "mean_env_wait_ms": 4.968925706138643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003439188003540039, "ViewRequirementAgentConnector_ms": 0.2307450771331787}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14334, "num_agent_steps_trained": 0, "num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.82545899600517, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 14336, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 14334, "timers": {"training_iteration_time_ms": 49924.046, "sample_time_ms": 7098.982, "synch_weights_time_ms": 82.701}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 0, "num_agent_steps_sampled": 14334, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 150, "training_iteration": 14, "trial_id": "default", "date": "2025-12-20_10-57-47", "timestamp": 1766199467, "time_this_iter_s": 49.17327260971069, "time_total_s": 697.283017873764, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 697.283017873764, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 85.60857142857142, "ram_util_percent": 14.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5509361602365971}, "default_policy": {"total_loss": 0.5509361602365971, "policy_loss": -0.034551451297011225, "vf_loss": 2.3812172412872314, "vf_loss_unclipped": 8.663327467441558, "vf_explained_var": -0.1292516678571701, "entropy": 1.372876200079918, "mean_kl_loss": 0.016059572258362874, "gradients_default_optimizer_global_norm": 0.4815365023910999, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.008200234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15358, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.491000000000007, "episode_reward_min": 10.876, "episode_reward_mean": 14.790389999999997, "episode_len_mean": 63.31, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.650000000000002, 13.749, 16.271, 15.759000000000002, 11.887, 12.936, 13.383000000000001, 14.917000000000002, 15.071000000000002, 14.694000000000003, 14.072, 13.166, 15.423000000000002, 15.250000000000004, 15.908999999999999, 19.167, 16.930000000000003, 14.138000000000002, 14.224, 13.713000000000001, 15.016000000000002, 15.516000000000002, 18.362000000000002, 15.804000000000002, 12.123999999999999, 18.281, 15.338000000000001, 15.870000000000001, 13.809000000000001, 11.733, 19.049, 12.265, 13.148000000000001, 13.062, 12.155, 13.839, 13.754999999999999, 15.396, 13.043000000000001, 18.296, 17.150000000000006, 11.703999999999999, 15.664000000000003, 15.035000000000002, 13.961, 13.812000000000001, 13.739, 13.269, 16.133000000000003, 14.345000000000002, 12.192, 12.488, 15.312999999999999, 13.586000000000002, 16.046000000000003, 15.538, 20.491000000000007, 18.364000000000004, 10.876, 14.476999999999999, 15.834, 15.423, 11.205, 16.323000000000004, 16.983, 18.220000000000006, 14.842000000000002, 12.955000000000002, 12.873000000000001, 16.149, 18.434, 14.527000000000001, 13.236, 13.511, 13.384, 14.216000000000001, 12.780000000000001, 15.267000000000001, 15.536000000000001, 15.659, 11.895000000000001, 16.586, 14.121000000000002, 14.456000000000001, 14.948, 15.915000000000003, 12.823, 14.719000000000001, 15.549999999999999, 14.161000000000001, 15.466000000000001, 14.046, 19.333999999999996, 17.72, 17.169, 12.760000000000002, 14.136, 12.844999999999999, 14.887, 12.792000000000002], "episode_lengths": [67, 74, 82, 63, 43, 52, 53, 67, 67, 75, 78, 63, 75, 75, 67, 87, 82, 75, 57, 66, 62, 67, 93, 60, 41, 79, 78, 85, 56, 47, 83, 51, 44, 62, 50, 49, 56, 70, 44, 84, 66, 45, 77, 64, 62, 45, 62, 44, 67, 55, 55, 59, 67, 64, 74, 62, 101, 82, 39, 58, 63, 70, 45, 70, 71, 85, 56, 52, 53, 66, 74, 58, 48, 58, 60, 60, 50, 60, 72, 57, 50, 70, 57, 57, 53, 62, 43, 64, 65, 50, 65, 51, 107, 82, 71, 52, 50, 55, 75, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46486461253940803, "mean_inference_ms": 1.3959619658837727, "mean_action_processing_ms": 0.08049410685428528, "mean_env_wait_ms": 4.96723236542447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003419637680053711, "ViewRequirementAgentConnector_ms": 0.23030829429626465}}, "episode_reward_max": 20.491000000000007, "episode_reward_min": 10.876, "episode_reward_mean": 14.790389999999997, "episode_len_mean": 63.31, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.650000000000002, 13.749, 16.271, 15.759000000000002, 11.887, 12.936, 13.383000000000001, 14.917000000000002, 15.071000000000002, 14.694000000000003, 14.072, 13.166, 15.423000000000002, 15.250000000000004, 15.908999999999999, 19.167, 16.930000000000003, 14.138000000000002, 14.224, 13.713000000000001, 15.016000000000002, 15.516000000000002, 18.362000000000002, 15.804000000000002, 12.123999999999999, 18.281, 15.338000000000001, 15.870000000000001, 13.809000000000001, 11.733, 19.049, 12.265, 13.148000000000001, 13.062, 12.155, 13.839, 13.754999999999999, 15.396, 13.043000000000001, 18.296, 17.150000000000006, 11.703999999999999, 15.664000000000003, 15.035000000000002, 13.961, 13.812000000000001, 13.739, 13.269, 16.133000000000003, 14.345000000000002, 12.192, 12.488, 15.312999999999999, 13.586000000000002, 16.046000000000003, 15.538, 20.491000000000007, 18.364000000000004, 10.876, 14.476999999999999, 15.834, 15.423, 11.205, 16.323000000000004, 16.983, 18.220000000000006, 14.842000000000002, 12.955000000000002, 12.873000000000001, 16.149, 18.434, 14.527000000000001, 13.236, 13.511, 13.384, 14.216000000000001, 12.780000000000001, 15.267000000000001, 15.536000000000001, 15.659, 11.895000000000001, 16.586, 14.121000000000002, 14.456000000000001, 14.948, 15.915000000000003, 12.823, 14.719000000000001, 15.549999999999999, 14.161000000000001, 15.466000000000001, 14.046, 19.333999999999996, 17.72, 17.169, 12.760000000000002, 14.136, 12.844999999999999, 14.887, 12.792000000000002], "episode_lengths": [67, 74, 82, 63, 43, 52, 53, 67, 67, 75, 78, 63, 75, 75, 67, 87, 82, 75, 57, 66, 62, 67, 93, 60, 41, 79, 78, 85, 56, 47, 83, 51, 44, 62, 50, 49, 56, 70, 44, 84, 66, 45, 77, 64, 62, 45, 62, 44, 67, 55, 55, 59, 67, 64, 74, 62, 101, 82, 39, 58, 63, 70, 45, 70, 71, 85, 56, 52, 53, 66, 74, 58, 48, 58, 60, 60, 50, 60, 72, 57, 50, 70, 57, 57, 53, 62, 43, 64, 65, 50, 65, 51, 107, 82, 71, 52, 50, 55, 75, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46486461253940803, "mean_inference_ms": 1.3959619658837727, "mean_action_processing_ms": 0.08049410685428528, "mean_env_wait_ms": 4.96723236542447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003419637680053711, "ViewRequirementAgentConnector_ms": 0.23030829429626465}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15358, "num_agent_steps_trained": 0, "num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.45092716948456, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 15360, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 15358, "timers": {"training_iteration_time_ms": 49937.477, "sample_time_ms": 7095.933, "synch_weights_time_ms": 81.742}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 0, "num_agent_steps_sampled": 15358, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 167, "training_iteration": 15, "trial_id": "default", "date": "2025-12-20_10-58-37", "timestamp": 1766199517, "time_this_iter_s": 50.07373547554016, "time_total_s": 747.3567533493042, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 747.3567533493042, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 86.08055555555555, "ram_util_percent": 14.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5557667575776577}, "default_policy": {"total_loss": 0.5557667575776577, "policy_loss": -0.034833759907633065, "vf_loss": 2.403106752038002, "vf_loss_unclipped": 8.368493103981018, "vf_explained_var": 0.024242065846920013, "entropy": 1.423964023590088, "mean_kl_loss": 0.015006671019636996, "gradients_default_optimizer_global_norm": 0.49440382719039916, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.008080234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16382, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.491000000000007, "episode_reward_min": 10.876, "episode_reward_mean": 14.608870000000001, "episode_len_mean": 60.75, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.713000000000001, 15.016000000000002, 15.516000000000002, 18.362000000000002, 15.804000000000002, 12.123999999999999, 18.281, 15.338000000000001, 15.870000000000001, 13.809000000000001, 11.733, 19.049, 12.265, 13.148000000000001, 13.062, 12.155, 13.839, 13.754999999999999, 15.396, 13.043000000000001, 18.296, 17.150000000000006, 11.703999999999999, 15.664000000000003, 15.035000000000002, 13.961, 13.812000000000001, 13.739, 13.269, 16.133000000000003, 14.345000000000002, 12.192, 12.488, 15.312999999999999, 13.586000000000002, 16.046000000000003, 15.538, 20.491000000000007, 18.364000000000004, 10.876, 14.476999999999999, 15.834, 15.423, 11.205, 16.323000000000004, 16.983, 18.220000000000006, 14.842000000000002, 12.955000000000002, 12.873000000000001, 16.149, 18.434, 14.527000000000001, 13.236, 13.511, 13.384, 14.216000000000001, 12.780000000000001, 15.267000000000001, 15.536000000000001, 15.659, 11.895000000000001, 16.586, 14.121000000000002, 14.456000000000001, 14.948, 15.915000000000003, 12.823, 14.719000000000001, 15.549999999999999, 14.161000000000001, 15.466000000000001, 14.046, 19.333999999999996, 17.72, 17.169, 12.760000000000002, 14.136, 12.844999999999999, 14.887, 12.792000000000002, 14.154000000000002, 13.917, 11.643, 15.155000000000001, 12.077000000000002, 11.418, 16.101, 15.404000000000002, 11.357, 17.362000000000002, 13.168, 12.735, 15.449000000000002, 12.633, 11.587, 16.358000000000004, 14.531000000000002, 13.553000000000003, 14.842000000000002], "episode_lengths": [66, 62, 67, 93, 60, 41, 79, 78, 85, 56, 47, 83, 51, 44, 62, 50, 49, 56, 70, 44, 84, 66, 45, 77, 64, 62, 45, 62, 44, 67, 55, 55, 59, 67, 64, 74, 62, 101, 82, 39, 58, 63, 70, 45, 70, 71, 85, 56, 52, 53, 66, 74, 58, 48, 58, 60, 60, 50, 60, 72, 57, 50, 70, 57, 57, 53, 62, 43, 64, 65, 50, 65, 51, 107, 82, 71, 52, 50, 55, 75, 47, 49, 47, 48, 59, 59, 43, 60, 60, 39, 65, 48, 55, 70, 53, 42, 78, 50, 45, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46857121506586985, "mean_inference_ms": 1.3960295960492997, "mean_action_processing_ms": 0.08048236517663523, "mean_env_wait_ms": 4.964684760396788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034286975860595703, "ViewRequirementAgentConnector_ms": 0.23114252090454102}}, "episode_reward_max": 20.491000000000007, "episode_reward_min": 10.876, "episode_reward_mean": 14.608870000000001, "episode_len_mean": 60.75, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.713000000000001, 15.016000000000002, 15.516000000000002, 18.362000000000002, 15.804000000000002, 12.123999999999999, 18.281, 15.338000000000001, 15.870000000000001, 13.809000000000001, 11.733, 19.049, 12.265, 13.148000000000001, 13.062, 12.155, 13.839, 13.754999999999999, 15.396, 13.043000000000001, 18.296, 17.150000000000006, 11.703999999999999, 15.664000000000003, 15.035000000000002, 13.961, 13.812000000000001, 13.739, 13.269, 16.133000000000003, 14.345000000000002, 12.192, 12.488, 15.312999999999999, 13.586000000000002, 16.046000000000003, 15.538, 20.491000000000007, 18.364000000000004, 10.876, 14.476999999999999, 15.834, 15.423, 11.205, 16.323000000000004, 16.983, 18.220000000000006, 14.842000000000002, 12.955000000000002, 12.873000000000001, 16.149, 18.434, 14.527000000000001, 13.236, 13.511, 13.384, 14.216000000000001, 12.780000000000001, 15.267000000000001, 15.536000000000001, 15.659, 11.895000000000001, 16.586, 14.121000000000002, 14.456000000000001, 14.948, 15.915000000000003, 12.823, 14.719000000000001, 15.549999999999999, 14.161000000000001, 15.466000000000001, 14.046, 19.333999999999996, 17.72, 17.169, 12.760000000000002, 14.136, 12.844999999999999, 14.887, 12.792000000000002, 14.154000000000002, 13.917, 11.643, 15.155000000000001, 12.077000000000002, 11.418, 16.101, 15.404000000000002, 11.357, 17.362000000000002, 13.168, 12.735, 15.449000000000002, 12.633, 11.587, 16.358000000000004, 14.531000000000002, 13.553000000000003, 14.842000000000002], "episode_lengths": [66, 62, 67, 93, 60, 41, 79, 78, 85, 56, 47, 83, 51, 44, 62, 50, 49, 56, 70, 44, 84, 66, 45, 77, 64, 62, 45, 62, 44, 67, 55, 55, 59, 67, 64, 74, 62, 101, 82, 39, 58, 63, 70, 45, 70, 71, 85, 56, 52, 53, 66, 74, 58, 48, 58, 60, 60, 50, 60, 72, 57, 50, 70, 57, 57, 53, 62, 43, 64, 65, 50, 65, 51, 107, 82, 71, 52, 50, 55, 75, 47, 49, 47, 48, 59, 59, 43, 60, 60, 39, 65, 48, 55, 70, 53, 42, 78, 50, 45, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46857121506586985, "mean_inference_ms": 1.3960295960492997, "mean_action_processing_ms": 0.08048236517663523, "mean_env_wait_ms": 4.964684760396788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034286975860595703, "ViewRequirementAgentConnector_ms": 0.23114252090454102}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16382, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.325638593717276, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16384, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16382, "timers": {"training_iteration_time_ms": 49929.782, "sample_time_ms": 7098.034, "synch_weights_time_ms": 82.613}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16382, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 186, "training_iteration": 16, "trial_id": "default", "date": "2025-12-20_10-59-28", "timestamp": 1766199568, "time_this_iter_s": 50.3826858997345, "time_total_s": 797.7394392490387, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 797.7394392490387, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 85.79577464788733, "ram_util_percent": 14.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5987004958093166}, "default_policy": {"total_loss": 0.5987004958093166, "policy_loss": -0.031797185982577504, "vf_loss": 2.5605798780918123, "vf_loss_unclipped": 8.525423610210419, "vf_explained_var": 0.047009654343128204, "entropy": 1.3448363810777664, "mean_kl_loss": 0.012192940090289994, "gradients_default_optimizer_global_norm": 0.5622396975755691, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.007960234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17406, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.491000000000007, "episode_reward_min": 10.876, "episode_reward_mean": 14.43649, "episode_len_mean": 58.92, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.043000000000001, 18.296, 17.150000000000006, 11.703999999999999, 15.664000000000003, 15.035000000000002, 13.961, 13.812000000000001, 13.739, 13.269, 16.133000000000003, 14.345000000000002, 12.192, 12.488, 15.312999999999999, 13.586000000000002, 16.046000000000003, 15.538, 20.491000000000007, 18.364000000000004, 10.876, 14.476999999999999, 15.834, 15.423, 11.205, 16.323000000000004, 16.983, 18.220000000000006, 14.842000000000002, 12.955000000000002, 12.873000000000001, 16.149, 18.434, 14.527000000000001, 13.236, 13.511, 13.384, 14.216000000000001, 12.780000000000001, 15.267000000000001, 15.536000000000001, 15.659, 11.895000000000001, 16.586, 14.121000000000002, 14.456000000000001, 14.948, 15.915000000000003, 12.823, 14.719000000000001, 15.549999999999999, 14.161000000000001, 15.466000000000001, 14.046, 19.333999999999996, 17.72, 17.169, 12.760000000000002, 14.136, 12.844999999999999, 14.887, 12.792000000000002, 14.154000000000002, 13.917, 11.643, 15.155000000000001, 12.077000000000002, 11.418, 16.101, 15.404000000000002, 11.357, 17.362000000000002, 13.168, 12.735, 15.449000000000002, 12.633, 11.587, 16.358000000000004, 14.531000000000002, 13.553000000000003, 14.842000000000002, 11.578999999999999, 15.356000000000002, 13.068000000000001, 18.671, 13.364, 15.741, 12.648000000000001, 11.253, 13.412, 12.926, 15.050999999999998, 13.188, 12.955, 13.662, 14.65, 12.199, 12.108, 16.271, 12.895000000000001], "episode_lengths": [44, 84, 66, 45, 77, 64, 62, 45, 62, 44, 67, 55, 55, 59, 67, 64, 74, 62, 101, 82, 39, 58, 63, 70, 45, 70, 71, 85, 56, 52, 53, 66, 74, 58, 48, 58, 60, 60, 50, 60, 72, 57, 50, 70, 57, 57, 53, 62, 43, 64, 65, 50, 65, 51, 107, 82, 71, 52, 50, 55, 75, 47, 49, 47, 48, 59, 59, 43, 60, 60, 39, 65, 48, 55, 70, 53, 42, 78, 50, 45, 76, 42, 60, 46, 73, 54, 73, 46, 49, 51, 52, 60, 48, 54, 50, 57, 42, 43, 69, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4716040444300728, "mean_inference_ms": 1.3948956069908656, "mean_action_processing_ms": 0.08042394546128034, "mean_env_wait_ms": 4.95966228892207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034172534942626953, "ViewRequirementAgentConnector_ms": 0.23040056228637695}}, "episode_reward_max": 20.491000000000007, "episode_reward_min": 10.876, "episode_reward_mean": 14.43649, "episode_len_mean": 58.92, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.043000000000001, 18.296, 17.150000000000006, 11.703999999999999, 15.664000000000003, 15.035000000000002, 13.961, 13.812000000000001, 13.739, 13.269, 16.133000000000003, 14.345000000000002, 12.192, 12.488, 15.312999999999999, 13.586000000000002, 16.046000000000003, 15.538, 20.491000000000007, 18.364000000000004, 10.876, 14.476999999999999, 15.834, 15.423, 11.205, 16.323000000000004, 16.983, 18.220000000000006, 14.842000000000002, 12.955000000000002, 12.873000000000001, 16.149, 18.434, 14.527000000000001, 13.236, 13.511, 13.384, 14.216000000000001, 12.780000000000001, 15.267000000000001, 15.536000000000001, 15.659, 11.895000000000001, 16.586, 14.121000000000002, 14.456000000000001, 14.948, 15.915000000000003, 12.823, 14.719000000000001, 15.549999999999999, 14.161000000000001, 15.466000000000001, 14.046, 19.333999999999996, 17.72, 17.169, 12.760000000000002, 14.136, 12.844999999999999, 14.887, 12.792000000000002, 14.154000000000002, 13.917, 11.643, 15.155000000000001, 12.077000000000002, 11.418, 16.101, 15.404000000000002, 11.357, 17.362000000000002, 13.168, 12.735, 15.449000000000002, 12.633, 11.587, 16.358000000000004, 14.531000000000002, 13.553000000000003, 14.842000000000002, 11.578999999999999, 15.356000000000002, 13.068000000000001, 18.671, 13.364, 15.741, 12.648000000000001, 11.253, 13.412, 12.926, 15.050999999999998, 13.188, 12.955, 13.662, 14.65, 12.199, 12.108, 16.271, 12.895000000000001], "episode_lengths": [44, 84, 66, 45, 77, 64, 62, 45, 62, 44, 67, 55, 55, 59, 67, 64, 74, 62, 101, 82, 39, 58, 63, 70, 45, 70, 71, 85, 56, 52, 53, 66, 74, 58, 48, 58, 60, 60, 50, 60, 72, 57, 50, 70, 57, 57, 53, 62, 43, 64, 65, 50, 65, 51, 107, 82, 71, 52, 50, 55, 75, 47, 49, 47, 48, 59, 59, 43, 60, 60, 39, 65, 48, 55, 70, 53, 42, 78, 50, 45, 76, 42, 60, 46, 73, 54, 73, 46, 49, 51, 52, 60, 48, 54, 50, 57, 42, 43, 69, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4716040444300728, "mean_inference_ms": 1.3948956069908656, "mean_action_processing_ms": 0.08042394546128034, "mean_env_wait_ms": 4.95966228892207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034172534942626953, "ViewRequirementAgentConnector_ms": 0.23040056228637695}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17406, "num_agent_steps_trained": 0, "num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.576056433802414, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 17408, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 17406, "timers": {"training_iteration_time_ms": 49897.699, "sample_time_ms": 7101.48, "synch_weights_time_ms": 80.792}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 0, "num_agent_steps_sampled": 17406, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 205, "training_iteration": 17, "trial_id": "default", "date": "2025-12-20_11-00-25", "timestamp": 1766199625, "time_this_iter_s": 49.770827293395996, "time_total_s": 847.5102665424347, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 847.5102665424347, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 75.22317073170731, "ram_util_percent": 14.099999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6176578775048256}, "default_policy": {"total_loss": 0.6176578775048256, "policy_loss": -0.04039146604482084, "vf_loss": 2.6670267820358275, "vf_loss_unclipped": 8.725434172153474, "vf_explained_var": 0.03055812865495682, "entropy": 1.2956487089395523, "mean_kl_loss": 0.016063197738230884, "gradients_default_optimizer_global_norm": 0.5708721518516541, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.007840234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18430, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.491000000000007, "episode_reward_min": 10.876, "episode_reward_mean": 14.372510000000002, "episode_len_mean": 58.07, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.491000000000007, 18.364000000000004, 10.876, 14.476999999999999, 15.834, 15.423, 11.205, 16.323000000000004, 16.983, 18.220000000000006, 14.842000000000002, 12.955000000000002, 12.873000000000001, 16.149, 18.434, 14.527000000000001, 13.236, 13.511, 13.384, 14.216000000000001, 12.780000000000001, 15.267000000000001, 15.536000000000001, 15.659, 11.895000000000001, 16.586, 14.121000000000002, 14.456000000000001, 14.948, 15.915000000000003, 12.823, 14.719000000000001, 15.549999999999999, 14.161000000000001, 15.466000000000001, 14.046, 19.333999999999996, 17.72, 17.169, 12.760000000000002, 14.136, 12.844999999999999, 14.887, 12.792000000000002, 14.154000000000002, 13.917, 11.643, 15.155000000000001, 12.077000000000002, 11.418, 16.101, 15.404000000000002, 11.357, 17.362000000000002, 13.168, 12.735, 15.449000000000002, 12.633, 11.587, 16.358000000000004, 14.531000000000002, 13.553000000000003, 14.842000000000002, 11.578999999999999, 15.356000000000002, 13.068000000000001, 18.671, 13.364, 15.741, 12.648000000000001, 11.253, 13.412, 12.926, 15.050999999999998, 13.188, 12.955, 13.662, 14.65, 12.199, 12.108, 16.271, 12.895000000000001, 14.804000000000004, 13.575000000000001, 14.943000000000001, 14.332, 11.546, 12.754000000000001, 15.471000000000002, 13.894, 12.203000000000001, 13.189, 12.746, 18.055, 15.77, 14.675, 11.488999999999999, 14.259, 18.996000000000002, 12.215], "episode_lengths": [101, 82, 39, 58, 63, 70, 45, 70, 71, 85, 56, 52, 53, 66, 74, 58, 48, 58, 60, 60, 50, 60, 72, 57, 50, 70, 57, 57, 53, 62, 43, 64, 65, 50, 65, 51, 107, 82, 71, 52, 50, 55, 75, 47, 49, 47, 48, 59, 59, 43, 60, 60, 39, 65, 48, 55, 70, 53, 42, 78, 50, 45, 76, 42, 60, 46, 73, 54, 73, 46, 49, 51, 52, 60, 48, 54, 50, 57, 42, 43, 69, 47, 62, 48, 63, 58, 58, 47, 72, 47, 43, 54, 44, 66, 59, 56, 43, 57, 84, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47425981245269955, "mean_inference_ms": 1.3946192406602025, "mean_action_processing_ms": 0.08040333010290816, "mean_env_wait_ms": 4.956589172251389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034241676330566406, "ViewRequirementAgentConnector_ms": 0.23032307624816895}}, "episode_reward_max": 20.491000000000007, "episode_reward_min": 10.876, "episode_reward_mean": 14.372510000000002, "episode_len_mean": 58.07, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.491000000000007, 18.364000000000004, 10.876, 14.476999999999999, 15.834, 15.423, 11.205, 16.323000000000004, 16.983, 18.220000000000006, 14.842000000000002, 12.955000000000002, 12.873000000000001, 16.149, 18.434, 14.527000000000001, 13.236, 13.511, 13.384, 14.216000000000001, 12.780000000000001, 15.267000000000001, 15.536000000000001, 15.659, 11.895000000000001, 16.586, 14.121000000000002, 14.456000000000001, 14.948, 15.915000000000003, 12.823, 14.719000000000001, 15.549999999999999, 14.161000000000001, 15.466000000000001, 14.046, 19.333999999999996, 17.72, 17.169, 12.760000000000002, 14.136, 12.844999999999999, 14.887, 12.792000000000002, 14.154000000000002, 13.917, 11.643, 15.155000000000001, 12.077000000000002, 11.418, 16.101, 15.404000000000002, 11.357, 17.362000000000002, 13.168, 12.735, 15.449000000000002, 12.633, 11.587, 16.358000000000004, 14.531000000000002, 13.553000000000003, 14.842000000000002, 11.578999999999999, 15.356000000000002, 13.068000000000001, 18.671, 13.364, 15.741, 12.648000000000001, 11.253, 13.412, 12.926, 15.050999999999998, 13.188, 12.955, 13.662, 14.65, 12.199, 12.108, 16.271, 12.895000000000001, 14.804000000000004, 13.575000000000001, 14.943000000000001, 14.332, 11.546, 12.754000000000001, 15.471000000000002, 13.894, 12.203000000000001, 13.189, 12.746, 18.055, 15.77, 14.675, 11.488999999999999, 14.259, 18.996000000000002, 12.215], "episode_lengths": [101, 82, 39, 58, 63, 70, 45, 70, 71, 85, 56, 52, 53, 66, 74, 58, 48, 58, 60, 60, 50, 60, 72, 57, 50, 70, 57, 57, 53, 62, 43, 64, 65, 50, 65, 51, 107, 82, 71, 52, 50, 55, 75, 47, 49, 47, 48, 59, 59, 43, 60, 60, 39, 65, 48, 55, 70, 53, 42, 78, 50, 45, 76, 42, 60, 46, 73, 54, 73, 46, 49, 51, 52, 60, 48, 54, 50, 57, 42, 43, 69, 47, 62, 48, 63, 58, 58, 47, 72, 47, 43, 54, 44, 66, 59, 56, 43, 57, 84, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47425981245269955, "mean_inference_ms": 1.3946192406602025, "mean_action_processing_ms": 0.08040333010290816, "mean_env_wait_ms": 4.956589172251389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034241676330566406, "ViewRequirementAgentConnector_ms": 0.23032307624816895}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18430, "num_agent_steps_trained": 0, "num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.540089756619412, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 18432, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 18430, "timers": {"training_iteration_time_ms": 49865.799, "sample_time_ms": 7102.439, "synch_weights_time_ms": 79.859}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 0, "num_agent_steps_sampled": 18430, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 223, "training_iteration": 18, "trial_id": "default", "date": "2025-12-20_11-01-15", "timestamp": 1766199675, "time_this_iter_s": 49.856332778930664, "time_total_s": 897.3665993213654, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 897.3665993213654, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 85.80845070422535, "ram_util_percent": 14.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5694042801856994}, "default_policy": {"total_loss": 0.5694042801856994, "policy_loss": -0.03439930180320516, "vf_loss": 2.4502009212970735, "vf_loss_unclipped": 8.06524579524994, "vf_explained_var": 0.0705560326576233, "entropy": 1.2979463279247283, "mean_kl_loss": 0.014295407807003358, "gradients_default_optimizer_global_norm": 0.47996478378772733, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.007720234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19454, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 19.333999999999996, "episode_reward_min": 10.949, "episode_reward_mean": 14.189870000000003, "episode_len_mean": 56.62, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.384, 14.216000000000001, 12.780000000000001, 15.267000000000001, 15.536000000000001, 15.659, 11.895000000000001, 16.586, 14.121000000000002, 14.456000000000001, 14.948, 15.915000000000003, 12.823, 14.719000000000001, 15.549999999999999, 14.161000000000001, 15.466000000000001, 14.046, 19.333999999999996, 17.72, 17.169, 12.760000000000002, 14.136, 12.844999999999999, 14.887, 12.792000000000002, 14.154000000000002, 13.917, 11.643, 15.155000000000001, 12.077000000000002, 11.418, 16.101, 15.404000000000002, 11.357, 17.362000000000002, 13.168, 12.735, 15.449000000000002, 12.633, 11.587, 16.358000000000004, 14.531000000000002, 13.553000000000003, 14.842000000000002, 11.578999999999999, 15.356000000000002, 13.068000000000001, 18.671, 13.364, 15.741, 12.648000000000001, 11.253, 13.412, 12.926, 15.050999999999998, 13.188, 12.955, 13.662, 14.65, 12.199, 12.108, 16.271, 12.895000000000001, 14.804000000000004, 13.575000000000001, 14.943000000000001, 14.332, 11.546, 12.754000000000001, 15.471000000000002, 13.894, 12.203000000000001, 13.189, 12.746, 18.055, 15.77, 14.675, 11.488999999999999, 14.259, 18.996000000000002, 12.215, 14.922, 11.825, 15.588999999999999, 16.459, 15.349, 13.794, 16.295, 14.007000000000001, 11.574, 12.382, 17.293000000000003, 13.912, 13.173000000000002, 15.582, 13.974, 10.949, 14.949000000000002, 14.431000000000001], "episode_lengths": [60, 60, 50, 60, 72, 57, 50, 70, 57, 57, 53, 62, 43, 64, 65, 50, 65, 51, 107, 82, 71, 52, 50, 55, 75, 47, 49, 47, 48, 59, 59, 43, 60, 60, 39, 65, 48, 55, 70, 53, 42, 78, 50, 45, 76, 42, 60, 46, 73, 54, 73, 46, 49, 51, 52, 60, 48, 54, 50, 57, 42, 43, 69, 47, 62, 48, 63, 58, 58, 47, 72, 47, 43, 54, 44, 66, 59, 56, 43, 57, 84, 50, 54, 50, 57, 58, 65, 63, 65, 55, 42, 44, 65, 51, 46, 63, 54, 49, 63, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4767320325214673, "mean_inference_ms": 1.3942510708827853, "mean_action_processing_ms": 0.08037831269654079, "mean_env_wait_ms": 4.953567222763322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034279823303222656, "ViewRequirementAgentConnector_ms": 0.23102378845214844}}, "episode_reward_max": 19.333999999999996, "episode_reward_min": 10.949, "episode_reward_mean": 14.189870000000003, "episode_len_mean": 56.62, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.384, 14.216000000000001, 12.780000000000001, 15.267000000000001, 15.536000000000001, 15.659, 11.895000000000001, 16.586, 14.121000000000002, 14.456000000000001, 14.948, 15.915000000000003, 12.823, 14.719000000000001, 15.549999999999999, 14.161000000000001, 15.466000000000001, 14.046, 19.333999999999996, 17.72, 17.169, 12.760000000000002, 14.136, 12.844999999999999, 14.887, 12.792000000000002, 14.154000000000002, 13.917, 11.643, 15.155000000000001, 12.077000000000002, 11.418, 16.101, 15.404000000000002, 11.357, 17.362000000000002, 13.168, 12.735, 15.449000000000002, 12.633, 11.587, 16.358000000000004, 14.531000000000002, 13.553000000000003, 14.842000000000002, 11.578999999999999, 15.356000000000002, 13.068000000000001, 18.671, 13.364, 15.741, 12.648000000000001, 11.253, 13.412, 12.926, 15.050999999999998, 13.188, 12.955, 13.662, 14.65, 12.199, 12.108, 16.271, 12.895000000000001, 14.804000000000004, 13.575000000000001, 14.943000000000001, 14.332, 11.546, 12.754000000000001, 15.471000000000002, 13.894, 12.203000000000001, 13.189, 12.746, 18.055, 15.77, 14.675, 11.488999999999999, 14.259, 18.996000000000002, 12.215, 14.922, 11.825, 15.588999999999999, 16.459, 15.349, 13.794, 16.295, 14.007000000000001, 11.574, 12.382, 17.293000000000003, 13.912, 13.173000000000002, 15.582, 13.974, 10.949, 14.949000000000002, 14.431000000000001], "episode_lengths": [60, 60, 50, 60, 72, 57, 50, 70, 57, 57, 53, 62, 43, 64, 65, 50, 65, 51, 107, 82, 71, 52, 50, 55, 75, 47, 49, 47, 48, 59, 59, 43, 60, 60, 39, 65, 48, 55, 70, 53, 42, 78, 50, 45, 76, 42, 60, 46, 73, 54, 73, 46, 49, 51, 52, 60, 48, 54, 50, 57, 42, 43, 69, 47, 62, 48, 63, 58, 58, 47, 72, 47, 43, 54, 44, 66, 59, 56, 43, 57, 84, 50, 54, 50, 57, 58, 65, 63, 65, 55, 42, 44, 65, 51, 46, 63, 54, 49, 63, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4767320325214673, "mean_inference_ms": 1.3942510708827853, "mean_action_processing_ms": 0.08037831269654079, "mean_env_wait_ms": 4.953567222763322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034279823303222656, "ViewRequirementAgentConnector_ms": 0.23102378845214844}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19454, "num_agent_steps_trained": 0, "num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.444508682632367, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 19456, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 19454, "timers": {"training_iteration_time_ms": 49935.059, "sample_time_ms": 7105.494, "synch_weights_time_ms": 78.065}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 0, "num_agent_steps_sampled": 19454, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 241, "training_iteration": 19, "trial_id": "default", "date": "2025-12-20_11-02-05", "timestamp": 1766199725, "time_this_iter_s": 50.09109687805176, "time_total_s": 947.4576961994171, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 947.4576961994171, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 85.80140845070422, "ram_util_percent": 14.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6612311162054538}, "default_policy": {"total_loss": 0.6612311162054538, "policy_loss": -0.03497343251947314, "vf_loss": 2.817353630065918, "vf_loss_unclipped": 8.88002177476883, "vf_explained_var": 0.023542280495166778, "entropy": 1.2661896258592606, "mean_kl_loss": 0.016414298813197094, "gradients_default_optimizer_global_norm": 0.5795216232538223, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.007600234375000001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20478, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 18.996000000000002, "episode_reward_min": 10.949, "episode_reward_mean": 14.04489, "episode_len_mean": 55.72, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.72, 17.169, 12.760000000000002, 14.136, 12.844999999999999, 14.887, 12.792000000000002, 14.154000000000002, 13.917, 11.643, 15.155000000000001, 12.077000000000002, 11.418, 16.101, 15.404000000000002, 11.357, 17.362000000000002, 13.168, 12.735, 15.449000000000002, 12.633, 11.587, 16.358000000000004, 14.531000000000002, 13.553000000000003, 14.842000000000002, 11.578999999999999, 15.356000000000002, 13.068000000000001, 18.671, 13.364, 15.741, 12.648000000000001, 11.253, 13.412, 12.926, 15.050999999999998, 13.188, 12.955, 13.662, 14.65, 12.199, 12.108, 16.271, 12.895000000000001, 14.804000000000004, 13.575000000000001, 14.943000000000001, 14.332, 11.546, 12.754000000000001, 15.471000000000002, 13.894, 12.203000000000001, 13.189, 12.746, 18.055, 15.77, 14.675, 11.488999999999999, 14.259, 18.996000000000002, 12.215, 14.922, 11.825, 15.588999999999999, 16.459, 15.349, 13.794, 16.295, 14.007000000000001, 11.574, 12.382, 17.293000000000003, 13.912, 13.173000000000002, 15.582, 13.974, 10.949, 14.949000000000002, 14.431000000000001, 12.959000000000001, 12.833, 13.652000000000001, 13.786000000000001, 14.943000000000001, 15.784, 15.294, 11.624, 13.271999999999998, 15.168000000000003, 13.124000000000002, 13.691, 14.489, 15.287, 16.862000000000002, 14.923000000000002, 11.243, 14.940999999999999, 12.489], "episode_lengths": [82, 71, 52, 50, 55, 75, 47, 49, 47, 48, 59, 59, 43, 60, 60, 39, 65, 48, 55, 70, 53, 42, 78, 50, 45, 76, 42, 60, 46, 73, 54, 73, 46, 49, 51, 52, 60, 48, 54, 50, 57, 42, 43, 69, 47, 62, 48, 63, 58, 58, 47, 72, 47, 43, 54, 44, 66, 59, 56, 43, 57, 84, 50, 54, 50, 57, 58, 65, 63, 65, 55, 42, 44, 65, 51, 46, 63, 54, 49, 63, 60, 60, 60, 50, 55, 75, 67, 56, 47, 49, 62, 49, 49, 54, 63, 64, 57, 38, 58, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47906259155920466, "mean_inference_ms": 1.393895868645425, "mean_action_processing_ms": 0.0803654424244267, "mean_env_wait_ms": 4.950813932869823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034258365631103516, "ViewRequirementAgentConnector_ms": 0.23103642463684082}}, "episode_reward_max": 18.996000000000002, "episode_reward_min": 10.949, "episode_reward_mean": 14.04489, "episode_len_mean": 55.72, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.72, 17.169, 12.760000000000002, 14.136, 12.844999999999999, 14.887, 12.792000000000002, 14.154000000000002, 13.917, 11.643, 15.155000000000001, 12.077000000000002, 11.418, 16.101, 15.404000000000002, 11.357, 17.362000000000002, 13.168, 12.735, 15.449000000000002, 12.633, 11.587, 16.358000000000004, 14.531000000000002, 13.553000000000003, 14.842000000000002, 11.578999999999999, 15.356000000000002, 13.068000000000001, 18.671, 13.364, 15.741, 12.648000000000001, 11.253, 13.412, 12.926, 15.050999999999998, 13.188, 12.955, 13.662, 14.65, 12.199, 12.108, 16.271, 12.895000000000001, 14.804000000000004, 13.575000000000001, 14.943000000000001, 14.332, 11.546, 12.754000000000001, 15.471000000000002, 13.894, 12.203000000000001, 13.189, 12.746, 18.055, 15.77, 14.675, 11.488999999999999, 14.259, 18.996000000000002, 12.215, 14.922, 11.825, 15.588999999999999, 16.459, 15.349, 13.794, 16.295, 14.007000000000001, 11.574, 12.382, 17.293000000000003, 13.912, 13.173000000000002, 15.582, 13.974, 10.949, 14.949000000000002, 14.431000000000001, 12.959000000000001, 12.833, 13.652000000000001, 13.786000000000001, 14.943000000000001, 15.784, 15.294, 11.624, 13.271999999999998, 15.168000000000003, 13.124000000000002, 13.691, 14.489, 15.287, 16.862000000000002, 14.923000000000002, 11.243, 14.940999999999999, 12.489], "episode_lengths": [82, 71, 52, 50, 55, 75, 47, 49, 47, 48, 59, 59, 43, 60, 60, 39, 65, 48, 55, 70, 53, 42, 78, 50, 45, 76, 42, 60, 46, 73, 54, 73, 46, 49, 51, 52, 60, 48, 54, 50, 57, 42, 43, 69, 47, 62, 48, 63, 58, 58, 47, 72, 47, 43, 54, 44, 66, 59, 56, 43, 57, 84, 50, 54, 50, 57, 58, 65, 63, 65, 55, 42, 44, 65, 51, 46, 63, 54, 49, 63, 60, 60, 60, 50, 55, 75, 67, 56, 47, 49, 62, 49, 49, 54, 63, 64, 57, 38, 58, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47906259155920466, "mean_inference_ms": 1.393895868645425, "mean_action_processing_ms": 0.0803654424244267, "mean_env_wait_ms": 4.950813932869823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034258365631103516, "ViewRequirementAgentConnector_ms": 0.23103642463684082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20478, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.58118427355344, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20480, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 20478, "timers": {"training_iteration_time_ms": 49942.306, "sample_time_ms": 7109.499, "synch_weights_time_ms": 76.582}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20478, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 260, "training_iteration": 20, "trial_id": "default", "date": "2025-12-20_11-02-55", "timestamp": 1766199775, "time_this_iter_s": 49.75918126106262, "time_total_s": 997.2168774604797, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 997.2168774604797, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 85.8788732394366, "ram_util_percent": 14.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6018632143735886}, "default_policy": {"total_loss": 0.6018632143735886, "policy_loss": -0.03554737970698625, "vf_loss": 2.5800153791904448, "vf_loss_unclipped": 9.458735156059266, "vf_explained_var": -0.0017699375748634338, "entropy": 1.196782898902893, "mean_kl_loss": 0.01502572104882347, "gradients_default_optimizer_global_norm": 0.5020529001951217, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.007480234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 0, "num_agent_steps_sampled": 21502, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 18.996000000000002, "episode_reward_min": 10.949, "episode_reward_mean": 14.1424, "episode_len_mean": 55.76, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.735, 15.449000000000002, 12.633, 11.587, 16.358000000000004, 14.531000000000002, 13.553000000000003, 14.842000000000002, 11.578999999999999, 15.356000000000002, 13.068000000000001, 18.671, 13.364, 15.741, 12.648000000000001, 11.253, 13.412, 12.926, 15.050999999999998, 13.188, 12.955, 13.662, 14.65, 12.199, 12.108, 16.271, 12.895000000000001, 14.804000000000004, 13.575000000000001, 14.943000000000001, 14.332, 11.546, 12.754000000000001, 15.471000000000002, 13.894, 12.203000000000001, 13.189, 12.746, 18.055, 15.77, 14.675, 11.488999999999999, 14.259, 18.996000000000002, 12.215, 14.922, 11.825, 15.588999999999999, 16.459, 15.349, 13.794, 16.295, 14.007000000000001, 11.574, 12.382, 17.293000000000003, 13.912, 13.173000000000002, 15.582, 13.974, 10.949, 14.949000000000002, 14.431000000000001, 12.959000000000001, 12.833, 13.652000000000001, 13.786000000000001, 14.943000000000001, 15.784, 15.294, 11.624, 13.271999999999998, 15.168000000000003, 13.124000000000002, 13.691, 14.489, 15.287, 16.862000000000002, 14.923000000000002, 11.243, 14.940999999999999, 12.489, 13.306999999999999, 17.128, 13.207, 15.73, 13.062000000000001, 14.943000000000001, 14.934, 13.060000000000002, 14.389000000000003, 12.654, 16.093000000000004, 11.64, 14.806000000000001, 15.291, 14.248999999999999, 14.376000000000001, 16.867, 18.079999999999995], "episode_lengths": [55, 70, 53, 42, 78, 50, 45, 76, 42, 60, 46, 73, 54, 73, 46, 49, 51, 52, 60, 48, 54, 50, 57, 42, 43, 69, 47, 62, 48, 63, 58, 58, 47, 72, 47, 43, 54, 44, 66, 59, 56, 43, 57, 84, 50, 54, 50, 57, 58, 65, 63, 65, 55, 42, 44, 65, 51, 46, 63, 54, 49, 63, 60, 60, 60, 50, 55, 75, 67, 56, 47, 49, 62, 49, 49, 54, 63, 64, 57, 38, 58, 50, 53, 67, 57, 56, 49, 63, 61, 45, 61, 44, 59, 43, 51, 60, 52, 55, 63, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4810304702454802, "mean_inference_ms": 1.3934025091916127, "mean_action_processing_ms": 0.08035830456831969, "mean_env_wait_ms": 4.948576191951597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034210681915283203, "ViewRequirementAgentConnector_ms": 0.2310192584991455}}, "episode_reward_max": 18.996000000000002, "episode_reward_min": 10.949, "episode_reward_mean": 14.1424, "episode_len_mean": 55.76, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.735, 15.449000000000002, 12.633, 11.587, 16.358000000000004, 14.531000000000002, 13.553000000000003, 14.842000000000002, 11.578999999999999, 15.356000000000002, 13.068000000000001, 18.671, 13.364, 15.741, 12.648000000000001, 11.253, 13.412, 12.926, 15.050999999999998, 13.188, 12.955, 13.662, 14.65, 12.199, 12.108, 16.271, 12.895000000000001, 14.804000000000004, 13.575000000000001, 14.943000000000001, 14.332, 11.546, 12.754000000000001, 15.471000000000002, 13.894, 12.203000000000001, 13.189, 12.746, 18.055, 15.77, 14.675, 11.488999999999999, 14.259, 18.996000000000002, 12.215, 14.922, 11.825, 15.588999999999999, 16.459, 15.349, 13.794, 16.295, 14.007000000000001, 11.574, 12.382, 17.293000000000003, 13.912, 13.173000000000002, 15.582, 13.974, 10.949, 14.949000000000002, 14.431000000000001, 12.959000000000001, 12.833, 13.652000000000001, 13.786000000000001, 14.943000000000001, 15.784, 15.294, 11.624, 13.271999999999998, 15.168000000000003, 13.124000000000002, 13.691, 14.489, 15.287, 16.862000000000002, 14.923000000000002, 11.243, 14.940999999999999, 12.489, 13.306999999999999, 17.128, 13.207, 15.73, 13.062000000000001, 14.943000000000001, 14.934, 13.060000000000002, 14.389000000000003, 12.654, 16.093000000000004, 11.64, 14.806000000000001, 15.291, 14.248999999999999, 14.376000000000001, 16.867, 18.079999999999995], "episode_lengths": [55, 70, 53, 42, 78, 50, 45, 76, 42, 60, 46, 73, 54, 73, 46, 49, 51, 52, 60, 48, 54, 50, 57, 42, 43, 69, 47, 62, 48, 63, 58, 58, 47, 72, 47, 43, 54, 44, 66, 59, 56, 43, 57, 84, 50, 54, 50, 57, 58, 65, 63, 65, 55, 42, 44, 65, 51, 46, 63, 54, 49, 63, 60, 60, 60, 50, 55, 75, 67, 56, 47, 49, 62, 49, 49, 54, 63, 64, 57, 38, 58, 50, 53, 67, 57, 56, 49, 63, 61, 45, 61, 44, 59, 43, 51, 60, 52, 55, 63, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4810304702454802, "mean_inference_ms": 1.3934025091916127, "mean_action_processing_ms": 0.08035830456831969, "mean_env_wait_ms": 4.948576191951597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034210681915283203, "ViewRequirementAgentConnector_ms": 0.2310192584991455}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21502, "num_agent_steps_trained": 0, "num_env_steps_sampled": 21504, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.473387975243686, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 21504, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 21502, "timers": {"training_iteration_time_ms": 49937.33, "sample_time_ms": 7089.882, "synch_weights_time_ms": 75.488}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 0, "num_agent_steps_sampled": 21502, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 278, "training_iteration": 21, "trial_id": "default", "date": "2025-12-20_11-03-45", "timestamp": 1766199825, "time_this_iter_s": 50.01913404464722, "time_total_s": 1047.236011505127, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1047.236011505127, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 85.79154929577464, "ram_util_percent": 14.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.632488838583231}, "default_policy": {"total_loss": 0.632488838583231, "policy_loss": -0.035143887833692135, "vf_loss": 2.700808185338974, "vf_loss_unclipped": 8.593206655979156, "vf_explained_var": 0.1412965640425682, "entropy": 1.1554304003715514, "mean_kl_loss": 0.010735586390637764, "gradients_default_optimizer_global_norm": 0.5576937980949879, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.007360234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 0, "num_agent_steps_sampled": 22526, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 18.996000000000002, "episode_reward_min": 10.682, "episode_reward_mean": 14.04231, "episode_len_mean": 54.64, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.955, 13.662, 14.65, 12.199, 12.108, 16.271, 12.895000000000001, 14.804000000000004, 13.575000000000001, 14.943000000000001, 14.332, 11.546, 12.754000000000001, 15.471000000000002, 13.894, 12.203000000000001, 13.189, 12.746, 18.055, 15.77, 14.675, 11.488999999999999, 14.259, 18.996000000000002, 12.215, 14.922, 11.825, 15.588999999999999, 16.459, 15.349, 13.794, 16.295, 14.007000000000001, 11.574, 12.382, 17.293000000000003, 13.912, 13.173000000000002, 15.582, 13.974, 10.949, 14.949000000000002, 14.431000000000001, 12.959000000000001, 12.833, 13.652000000000001, 13.786000000000001, 14.943000000000001, 15.784, 15.294, 11.624, 13.271999999999998, 15.168000000000003, 13.124000000000002, 13.691, 14.489, 15.287, 16.862000000000002, 14.923000000000002, 11.243, 14.940999999999999, 12.489, 13.306999999999999, 17.128, 13.207, 15.73, 13.062000000000001, 14.943000000000001, 14.934, 13.060000000000002, 14.389000000000003, 12.654, 16.093000000000004, 11.64, 14.806000000000001, 15.291, 14.248999999999999, 14.376000000000001, 16.867, 18.079999999999995, 11.307, 13.162000000000003, 12.188, 11.86, 15.684000000000003, 18.249000000000002, 15.123, 13.102, 12.91, 13.923000000000002, 10.817, 15.134, 15.534000000000002, 10.682, 12.863000000000001, 13.867, 11.325999999999999, 13.301000000000002, 14.595, 12.309], "episode_lengths": [54, 50, 57, 42, 43, 69, 47, 62, 48, 63, 58, 58, 47, 72, 47, 43, 54, 44, 66, 59, 56, 43, 57, 84, 50, 54, 50, 57, 58, 65, 63, 65, 55, 42, 44, 65, 51, 46, 63, 54, 49, 63, 60, 60, 60, 50, 55, 75, 67, 56, 47, 49, 62, 49, 49, 54, 63, 64, 57, 38, 58, 50, 53, 67, 57, 56, 49, 63, 61, 45, 61, 44, 59, 43, 51, 60, 52, 55, 63, 74, 41, 47, 47, 41, 61, 68, 56, 49, 54, 60, 34, 55, 61, 43, 51, 49, 48, 44, 59, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.483096326379281, "mean_inference_ms": 1.393460548299306, "mean_action_processing_ms": 0.08037429222458929, "mean_env_wait_ms": 4.947188663369736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034308433532714844, "ViewRequirementAgentConnector_ms": 0.23096323013305664}}, "episode_reward_max": 18.996000000000002, "episode_reward_min": 10.682, "episode_reward_mean": 14.04231, "episode_len_mean": 54.64, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.955, 13.662, 14.65, 12.199, 12.108, 16.271, 12.895000000000001, 14.804000000000004, 13.575000000000001, 14.943000000000001, 14.332, 11.546, 12.754000000000001, 15.471000000000002, 13.894, 12.203000000000001, 13.189, 12.746, 18.055, 15.77, 14.675, 11.488999999999999, 14.259, 18.996000000000002, 12.215, 14.922, 11.825, 15.588999999999999, 16.459, 15.349, 13.794, 16.295, 14.007000000000001, 11.574, 12.382, 17.293000000000003, 13.912, 13.173000000000002, 15.582, 13.974, 10.949, 14.949000000000002, 14.431000000000001, 12.959000000000001, 12.833, 13.652000000000001, 13.786000000000001, 14.943000000000001, 15.784, 15.294, 11.624, 13.271999999999998, 15.168000000000003, 13.124000000000002, 13.691, 14.489, 15.287, 16.862000000000002, 14.923000000000002, 11.243, 14.940999999999999, 12.489, 13.306999999999999, 17.128, 13.207, 15.73, 13.062000000000001, 14.943000000000001, 14.934, 13.060000000000002, 14.389000000000003, 12.654, 16.093000000000004, 11.64, 14.806000000000001, 15.291, 14.248999999999999, 14.376000000000001, 16.867, 18.079999999999995, 11.307, 13.162000000000003, 12.188, 11.86, 15.684000000000003, 18.249000000000002, 15.123, 13.102, 12.91, 13.923000000000002, 10.817, 15.134, 15.534000000000002, 10.682, 12.863000000000001, 13.867, 11.325999999999999, 13.301000000000002, 14.595, 12.309], "episode_lengths": [54, 50, 57, 42, 43, 69, 47, 62, 48, 63, 58, 58, 47, 72, 47, 43, 54, 44, 66, 59, 56, 43, 57, 84, 50, 54, 50, 57, 58, 65, 63, 65, 55, 42, 44, 65, 51, 46, 63, 54, 49, 63, 60, 60, 60, 50, 55, 75, 67, 56, 47, 49, 62, 49, 49, 54, 63, 64, 57, 38, 58, 50, 53, 67, 57, 56, 49, 63, 61, 45, 61, 44, 59, 43, 51, 60, 52, 55, 63, 74, 41, 47, 47, 41, 61, 68, 56, 49, 54, 60, 34, 55, 61, 43, 51, 49, 48, 44, 59, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.483096326379281, "mean_inference_ms": 1.393460548299306, "mean_action_processing_ms": 0.08037429222458929, "mean_env_wait_ms": 4.947188663369736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034308433532714844, "ViewRequirementAgentConnector_ms": 0.23096323013305664}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22526, "num_agent_steps_trained": 0, "num_env_steps_sampled": 22528, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.517556832703708, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 22528, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 22526, "timers": {"training_iteration_time_ms": 49920.07, "sample_time_ms": 7090.029, "synch_weights_time_ms": 76.66}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 0, "num_agent_steps_sampled": 22526, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 298, "training_iteration": 22, "trial_id": "default", "date": "2025-12-20_11-04-43", "timestamp": 1766199883, "time_this_iter_s": 49.91132092475891, "time_total_s": 1097.1473324298859, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1097.1473324298859, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 75.41728395061729, "ram_util_percent": 14.099999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1025.0, "total_loss": 0.6516458821005937}, "default_policy": {"total_loss": 0.6516458821005937, "policy_loss": -0.03592291754874878, "vf_loss": 2.7803523249742463, "vf_loss_unclipped": 9.448421350339563, "vf_explained_var": 0.002470906187848347, "entropy": 1.1645770479993123, "mean_kl_loss": 0.010522811690351795, "gradients_default_optimizer_global_norm": 0.7448596278341805, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.007240117187500001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 0, "num_agent_steps_sampled": 23551, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 18.996000000000002, "episode_reward_min": 10.314, "episode_reward_mean": 14.04115, "episode_len_mean": 54.26, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.675, 11.488999999999999, 14.259, 18.996000000000002, 12.215, 14.922, 11.825, 15.588999999999999, 16.459, 15.349, 13.794, 16.295, 14.007000000000001, 11.574, 12.382, 17.293000000000003, 13.912, 13.173000000000002, 15.582, 13.974, 10.949, 14.949000000000002, 14.431000000000001, 12.959000000000001, 12.833, 13.652000000000001, 13.786000000000001, 14.943000000000001, 15.784, 15.294, 11.624, 13.271999999999998, 15.168000000000003, 13.124000000000002, 13.691, 14.489, 15.287, 16.862000000000002, 14.923000000000002, 11.243, 14.940999999999999, 12.489, 13.306999999999999, 17.128, 13.207, 15.73, 13.062000000000001, 14.943000000000001, 14.934, 13.060000000000002, 14.389000000000003, 12.654, 16.093000000000004, 11.64, 14.806000000000001, 15.291, 14.248999999999999, 14.376000000000001, 16.867, 18.079999999999995, 11.307, 13.162000000000003, 12.188, 11.86, 15.684000000000003, 18.249000000000002, 15.123, 13.102, 12.91, 13.923000000000002, 10.817, 15.134, 15.534000000000002, 10.682, 12.863000000000001, 13.867, 11.325999999999999, 13.301000000000002, 14.595, 12.309, 13.913, 13.016, 13.974, 17.87, 18.268000000000004, 12.456, 15.734000000000002, 10.314, 12.732000000000001, 17.148, 13.085, 15.474, 12.599, 11.529000000000002, 10.981000000000002, 14.328, 14.170000000000002, 11.072, 15.068999999999999, 14.174], "episode_lengths": [56, 43, 57, 84, 50, 54, 50, 57, 58, 65, 63, 65, 55, 42, 44, 65, 51, 46, 63, 54, 49, 63, 60, 60, 60, 50, 55, 75, 67, 56, 47, 49, 62, 49, 49, 54, 63, 64, 57, 38, 58, 50, 53, 67, 57, 56, 49, 63, 61, 45, 61, 44, 59, 43, 51, 60, 52, 55, 63, 74, 41, 47, 47, 41, 61, 68, 56, 49, 54, 60, 34, 55, 61, 43, 51, 49, 48, 44, 59, 43, 46, 55, 53, 67, 70, 42, 62, 38, 42, 59, 51, 66, 45, 46, 38, 51, 57, 40, 60, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4850597979459657, "mean_inference_ms": 1.3937954873725167, "mean_action_processing_ms": 0.08040469512051814, "mean_env_wait_ms": 4.94623012811588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034449100494384766, "ViewRequirementAgentConnector_ms": 0.23169326782226562}}, "episode_reward_max": 18.996000000000002, "episode_reward_min": 10.314, "episode_reward_mean": 14.04115, "episode_len_mean": 54.26, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.675, 11.488999999999999, 14.259, 18.996000000000002, 12.215, 14.922, 11.825, 15.588999999999999, 16.459, 15.349, 13.794, 16.295, 14.007000000000001, 11.574, 12.382, 17.293000000000003, 13.912, 13.173000000000002, 15.582, 13.974, 10.949, 14.949000000000002, 14.431000000000001, 12.959000000000001, 12.833, 13.652000000000001, 13.786000000000001, 14.943000000000001, 15.784, 15.294, 11.624, 13.271999999999998, 15.168000000000003, 13.124000000000002, 13.691, 14.489, 15.287, 16.862000000000002, 14.923000000000002, 11.243, 14.940999999999999, 12.489, 13.306999999999999, 17.128, 13.207, 15.73, 13.062000000000001, 14.943000000000001, 14.934, 13.060000000000002, 14.389000000000003, 12.654, 16.093000000000004, 11.64, 14.806000000000001, 15.291, 14.248999999999999, 14.376000000000001, 16.867, 18.079999999999995, 11.307, 13.162000000000003, 12.188, 11.86, 15.684000000000003, 18.249000000000002, 15.123, 13.102, 12.91, 13.923000000000002, 10.817, 15.134, 15.534000000000002, 10.682, 12.863000000000001, 13.867, 11.325999999999999, 13.301000000000002, 14.595, 12.309, 13.913, 13.016, 13.974, 17.87, 18.268000000000004, 12.456, 15.734000000000002, 10.314, 12.732000000000001, 17.148, 13.085, 15.474, 12.599, 11.529000000000002, 10.981000000000002, 14.328, 14.170000000000002, 11.072, 15.068999999999999, 14.174], "episode_lengths": [56, 43, 57, 84, 50, 54, 50, 57, 58, 65, 63, 65, 55, 42, 44, 65, 51, 46, 63, 54, 49, 63, 60, 60, 60, 50, 55, 75, 67, 56, 47, 49, 62, 49, 49, 54, 63, 64, 57, 38, 58, 50, 53, 67, 57, 56, 49, 63, 61, 45, 61, 44, 59, 43, 51, 60, 52, 55, 63, 74, 41, 47, 47, 41, 61, 68, 56, 49, 54, 60, 34, 55, 61, 43, 51, 49, 48, 44, 59, 43, 46, 55, 53, 67, 70, 42, 62, 38, 42, 59, 51, 66, 45, 46, 38, 51, 57, 40, 60, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4850597979459657, "mean_inference_ms": 1.3937954873725167, "mean_action_processing_ms": 0.08040469512051814, "mean_env_wait_ms": 4.94623012811588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034449100494384766, "ViewRequirementAgentConnector_ms": 0.23169326782226562}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23551, "num_agent_steps_trained": 0, "num_env_steps_sampled": 23552, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 19.962447983657718, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 23552, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 23551, "timers": {"training_iteration_time_ms": 50030.317, "sample_time_ms": 7099.501, "synch_weights_time_ms": 75.685}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 0, "num_agent_steps_sampled": 23551, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 318, "training_iteration": 23, "trial_id": "default", "date": "2025-12-20_11-05-34", "timestamp": 1766199934, "time_this_iter_s": 51.29960489273071, "time_total_s": 1148.4469373226166, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1148.4469373226166, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 86.06712328767122, "ram_util_percent": 14.099999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6571508258581161}, "default_policy": {"total_loss": 0.6571508258581161, "policy_loss": -0.032753779354970904, "vf_loss": 2.7858241736888885, "vf_loss_unclipped": 9.534407317638397, "vf_explained_var": 0.07284855246543884, "entropy": 1.081101182103157, "mean_kl_loss": 0.012758661176468667, "gradients_default_optimizer_global_norm": 0.6537511751055718, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0071201171875, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24575, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 18.268000000000004, "episode_reward_min": 10.314, "episode_reward_mean": 13.85796, "episode_len_mean": 52.97, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.949000000000002, 14.431000000000001, 12.959000000000001, 12.833, 13.652000000000001, 13.786000000000001, 14.943000000000001, 15.784, 15.294, 11.624, 13.271999999999998, 15.168000000000003, 13.124000000000002, 13.691, 14.489, 15.287, 16.862000000000002, 14.923000000000002, 11.243, 14.940999999999999, 12.489, 13.306999999999999, 17.128, 13.207, 15.73, 13.062000000000001, 14.943000000000001, 14.934, 13.060000000000002, 14.389000000000003, 12.654, 16.093000000000004, 11.64, 14.806000000000001, 15.291, 14.248999999999999, 14.376000000000001, 16.867, 18.079999999999995, 11.307, 13.162000000000003, 12.188, 11.86, 15.684000000000003, 18.249000000000002, 15.123, 13.102, 12.91, 13.923000000000002, 10.817, 15.134, 15.534000000000002, 10.682, 12.863000000000001, 13.867, 11.325999999999999, 13.301000000000002, 14.595, 12.309, 13.913, 13.016, 13.974, 17.87, 18.268000000000004, 12.456, 15.734000000000002, 10.314, 12.732000000000001, 17.148, 13.085, 15.474, 12.599, 11.529000000000002, 10.981000000000002, 14.328, 14.170000000000002, 11.072, 15.068999999999999, 14.174, 10.937, 14.289, 11.245000000000001, 15.760000000000002, 12.384, 16.687000000000005, 15.293000000000001, 11.908000000000001, 16.201, 12.931999999999999, 13.918000000000001, 12.843, 13.990000000000002, 11.587, 12.878000000000002, 15.366000000000001, 11.983, 13.163, 14.433999999999997, 11.271999999999998, 11.324], "episode_lengths": [63, 60, 60, 60, 50, 55, 75, 67, 56, 47, 49, 62, 49, 49, 54, 63, 64, 57, 38, 58, 50, 53, 67, 57, 56, 49, 63, 61, 45, 61, 44, 59, 43, 51, 60, 52, 55, 63, 74, 41, 47, 47, 41, 61, 68, 56, 49, 54, 60, 34, 55, 61, 43, 51, 49, 48, 44, 59, 43, 46, 55, 53, 67, 70, 42, 62, 38, 42, 59, 51, 66, 45, 46, 38, 51, 57, 40, 60, 57, 34, 50, 40, 69, 42, 61, 60, 45, 67, 45, 52, 43, 58, 38, 49, 61, 40, 46, 57, 39, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48703388682923415, "mean_inference_ms": 1.3960924316040293, "mean_action_processing_ms": 0.08043944122729461, "mean_env_wait_ms": 4.945363510541818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034546852111816406, "ViewRequirementAgentConnector_ms": 0.23201727867126465}}, "episode_reward_max": 18.268000000000004, "episode_reward_min": 10.314, "episode_reward_mean": 13.85796, "episode_len_mean": 52.97, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.949000000000002, 14.431000000000001, 12.959000000000001, 12.833, 13.652000000000001, 13.786000000000001, 14.943000000000001, 15.784, 15.294, 11.624, 13.271999999999998, 15.168000000000003, 13.124000000000002, 13.691, 14.489, 15.287, 16.862000000000002, 14.923000000000002, 11.243, 14.940999999999999, 12.489, 13.306999999999999, 17.128, 13.207, 15.73, 13.062000000000001, 14.943000000000001, 14.934, 13.060000000000002, 14.389000000000003, 12.654, 16.093000000000004, 11.64, 14.806000000000001, 15.291, 14.248999999999999, 14.376000000000001, 16.867, 18.079999999999995, 11.307, 13.162000000000003, 12.188, 11.86, 15.684000000000003, 18.249000000000002, 15.123, 13.102, 12.91, 13.923000000000002, 10.817, 15.134, 15.534000000000002, 10.682, 12.863000000000001, 13.867, 11.325999999999999, 13.301000000000002, 14.595, 12.309, 13.913, 13.016, 13.974, 17.87, 18.268000000000004, 12.456, 15.734000000000002, 10.314, 12.732000000000001, 17.148, 13.085, 15.474, 12.599, 11.529000000000002, 10.981000000000002, 14.328, 14.170000000000002, 11.072, 15.068999999999999, 14.174, 10.937, 14.289, 11.245000000000001, 15.760000000000002, 12.384, 16.687000000000005, 15.293000000000001, 11.908000000000001, 16.201, 12.931999999999999, 13.918000000000001, 12.843, 13.990000000000002, 11.587, 12.878000000000002, 15.366000000000001, 11.983, 13.163, 14.433999999999997, 11.271999999999998, 11.324], "episode_lengths": [63, 60, 60, 60, 50, 55, 75, 67, 56, 47, 49, 62, 49, 49, 54, 63, 64, 57, 38, 58, 50, 53, 67, 57, 56, 49, 63, 61, 45, 61, 44, 59, 43, 51, 60, 52, 55, 63, 74, 41, 47, 47, 41, 61, 68, 56, 49, 54, 60, 34, 55, 61, 43, 51, 49, 48, 44, 59, 43, 46, 55, 53, 67, 70, 42, 62, 38, 42, 59, 51, 66, 45, 46, 38, 51, 57, 40, 60, 57, 34, 50, 40, 69, 42, 61, 60, 45, 67, 45, 52, 43, 58, 38, 49, 61, 40, 46, 57, 39, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48703388682923415, "mean_inference_ms": 1.3960924316040293, "mean_action_processing_ms": 0.08043944122729461, "mean_env_wait_ms": 4.945363510541818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034546852111816406, "ViewRequirementAgentConnector_ms": 0.23201727867126465}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24575, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24576, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.595536612568612, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24576, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 24575, "timers": {"training_iteration_time_ms": 50085.209, "sample_time_ms": 7124.659, "synch_weights_time_ms": 73.995}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24575, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 339, "training_iteration": 24, "trial_id": "default", "date": "2025-12-20_11-06-24", "timestamp": 1766199984, "time_this_iter_s": 49.72542715072632, "time_total_s": 1198.172364473343, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1198.172364473343, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 85.58028169014084, "ram_util_percent": 14.101408450704225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1023.0, "total_loss": 0.6631587110459805}, "default_policy": {"total_loss": 0.6631587110459805, "policy_loss": -0.03509165758732706, "vf_loss": 2.819249212741852, "vf_loss_unclipped": 9.223114323616027, "vf_explained_var": 0.0482833057641983, "entropy": 1.0668352454900742, "mean_kl_loss": 0.010340444828671025, "gradients_default_optimizer_global_norm": 0.5952066838741302, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.007000234375000001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 0, "num_agent_steps_sampled": 25598, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 18.268000000000004, "episode_reward_min": 10.314, "episode_reward_mean": 13.601490000000002, "episode_len_mean": 51.17, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.306999999999999, 17.128, 13.207, 15.73, 13.062000000000001, 14.943000000000001, 14.934, 13.060000000000002, 14.389000000000003, 12.654, 16.093000000000004, 11.64, 14.806000000000001, 15.291, 14.248999999999999, 14.376000000000001, 16.867, 18.079999999999995, 11.307, 13.162000000000003, 12.188, 11.86, 15.684000000000003, 18.249000000000002, 15.123, 13.102, 12.91, 13.923000000000002, 10.817, 15.134, 15.534000000000002, 10.682, 12.863000000000001, 13.867, 11.325999999999999, 13.301000000000002, 14.595, 12.309, 13.913, 13.016, 13.974, 17.87, 18.268000000000004, 12.456, 15.734000000000002, 10.314, 12.732000000000001, 17.148, 13.085, 15.474, 12.599, 11.529000000000002, 10.981000000000002, 14.328, 14.170000000000002, 11.072, 15.068999999999999, 14.174, 10.937, 14.289, 11.245000000000001, 15.760000000000002, 12.384, 16.687000000000005, 15.293000000000001, 11.908000000000001, 16.201, 12.931999999999999, 13.918000000000001, 12.843, 13.990000000000002, 11.587, 12.878000000000002, 15.366000000000001, 11.983, 13.163, 14.433999999999997, 11.271999999999998, 11.324, 14.583, 11.819, 12.034, 12.542, 12.247, 11.049, 13.953000000000001, 12.237000000000002, 14.686000000000002, 13.264000000000001, 11.802, 11.376, 11.848, 13.422, 10.66, 14.876000000000001, 12.240000000000002, 15.353, 14.184000000000001, 11.801, 14.120999999999999], "episode_lengths": [53, 67, 57, 56, 49, 63, 61, 45, 61, 44, 59, 43, 51, 60, 52, 55, 63, 74, 41, 47, 47, 41, 61, 68, 56, 49, 54, 60, 34, 55, 61, 43, 51, 49, 48, 44, 59, 43, 46, 55, 53, 67, 70, 42, 62, 38, 42, 59, 51, 66, 45, 46, 38, 51, 57, 40, 60, 57, 34, 50, 40, 69, 42, 61, 60, 45, 67, 45, 52, 43, 58, 38, 49, 61, 40, 46, 57, 39, 46, 50, 42, 45, 45, 45, 37, 53, 50, 58, 50, 38, 40, 43, 60, 41, 59, 43, 65, 49, 40, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4889294322433894, "mean_inference_ms": 1.3982420260600121, "mean_action_processing_ms": 0.08047023536782513, "mean_env_wait_ms": 4.944414558422207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003462076187133789, "ViewRequirementAgentConnector_ms": 0.23229408264160156}}, "episode_reward_max": 18.268000000000004, "episode_reward_min": 10.314, "episode_reward_mean": 13.601490000000002, "episode_len_mean": 51.17, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.306999999999999, 17.128, 13.207, 15.73, 13.062000000000001, 14.943000000000001, 14.934, 13.060000000000002, 14.389000000000003, 12.654, 16.093000000000004, 11.64, 14.806000000000001, 15.291, 14.248999999999999, 14.376000000000001, 16.867, 18.079999999999995, 11.307, 13.162000000000003, 12.188, 11.86, 15.684000000000003, 18.249000000000002, 15.123, 13.102, 12.91, 13.923000000000002, 10.817, 15.134, 15.534000000000002, 10.682, 12.863000000000001, 13.867, 11.325999999999999, 13.301000000000002, 14.595, 12.309, 13.913, 13.016, 13.974, 17.87, 18.268000000000004, 12.456, 15.734000000000002, 10.314, 12.732000000000001, 17.148, 13.085, 15.474, 12.599, 11.529000000000002, 10.981000000000002, 14.328, 14.170000000000002, 11.072, 15.068999999999999, 14.174, 10.937, 14.289, 11.245000000000001, 15.760000000000002, 12.384, 16.687000000000005, 15.293000000000001, 11.908000000000001, 16.201, 12.931999999999999, 13.918000000000001, 12.843, 13.990000000000002, 11.587, 12.878000000000002, 15.366000000000001, 11.983, 13.163, 14.433999999999997, 11.271999999999998, 11.324, 14.583, 11.819, 12.034, 12.542, 12.247, 11.049, 13.953000000000001, 12.237000000000002, 14.686000000000002, 13.264000000000001, 11.802, 11.376, 11.848, 13.422, 10.66, 14.876000000000001, 12.240000000000002, 15.353, 14.184000000000001, 11.801, 14.120999999999999], "episode_lengths": [53, 67, 57, 56, 49, 63, 61, 45, 61, 44, 59, 43, 51, 60, 52, 55, 63, 74, 41, 47, 47, 41, 61, 68, 56, 49, 54, 60, 34, 55, 61, 43, 51, 49, 48, 44, 59, 43, 46, 55, 53, 67, 70, 42, 62, 38, 42, 59, 51, 66, 45, 46, 38, 51, 57, 40, 60, 57, 34, 50, 40, 69, 42, 61, 60, 45, 67, 45, 52, 43, 58, 38, 49, 61, 40, 46, 57, 39, 46, 50, 42, 45, 45, 45, 37, 53, 50, 58, 50, 38, 40, 43, 60, 41, 59, 43, 65, 49, 40, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4889294322433894, "mean_inference_ms": 1.3982420260600121, "mean_action_processing_ms": 0.08047023536782513, "mean_env_wait_ms": 4.944414558422207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003462076187133789, "ViewRequirementAgentConnector_ms": 0.23229408264160156}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25598, "num_agent_steps_trained": 0, "num_env_steps_sampled": 25600, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.28559739012349, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 25600, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 25598, "timers": {"training_iteration_time_ms": 50126.018, "sample_time_ms": 7130.688, "synch_weights_time_ms": 73.438}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 0, "num_agent_steps_sampled": 25598, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 360, "training_iteration": 25, "trial_id": "default", "date": "2025-12-20_11-07-14", "timestamp": 1766200034, "time_this_iter_s": 50.482258319854736, "time_total_s": 1248.6546227931976, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1248.6546227931976, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 85.74788732394366, "ram_util_percent": 14.107042253521128}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6003348670899868}, "default_policy": {"total_loss": 0.6003348670899868, "policy_loss": -0.032070263545028864, "vf_loss": 2.5552191019058226, "vf_loss_unclipped": 8.476391446590423, "vf_explained_var": 0.11439588516950608, "entropy": 1.0552298367023467, "mean_kl_loss": 0.009872050807780397, "gradients_default_optimizer_global_norm": 0.8180952467024326, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.006880234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 0, "num_agent_steps_sampled": 26622, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 18.268000000000004, "episode_reward_min": 10.314, "episode_reward_mean": 13.467520000000002, "episode_len_mean": 50.55, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.188, 11.86, 15.684000000000003, 18.249000000000002, 15.123, 13.102, 12.91, 13.923000000000002, 10.817, 15.134, 15.534000000000002, 10.682, 12.863000000000001, 13.867, 11.325999999999999, 13.301000000000002, 14.595, 12.309, 13.913, 13.016, 13.974, 17.87, 18.268000000000004, 12.456, 15.734000000000002, 10.314, 12.732000000000001, 17.148, 13.085, 15.474, 12.599, 11.529000000000002, 10.981000000000002, 14.328, 14.170000000000002, 11.072, 15.068999999999999, 14.174, 10.937, 14.289, 11.245000000000001, 15.760000000000002, 12.384, 16.687000000000005, 15.293000000000001, 11.908000000000001, 16.201, 12.931999999999999, 13.918000000000001, 12.843, 13.990000000000002, 11.587, 12.878000000000002, 15.366000000000001, 11.983, 13.163, 14.433999999999997, 11.271999999999998, 11.324, 14.583, 11.819, 12.034, 12.542, 12.247, 11.049, 13.953000000000001, 12.237000000000002, 14.686000000000002, 13.264000000000001, 11.802, 11.376, 11.848, 13.422, 10.66, 14.876000000000001, 12.240000000000002, 15.353, 14.184000000000001, 11.801, 14.120999999999999, 14.161000000000001, 15.858999999999998, 12.509, 15.080000000000002, 13.461, 12.045, 16.131, 16.169, 11.214, 13.577000000000002, 11.113000000000001, 14.226000000000003, 13.656, 16.712, 13.439, 12.316, 14.182000000000002, 12.387, 13.198, 13.453], "episode_lengths": [47, 41, 61, 68, 56, 49, 54, 60, 34, 55, 61, 43, 51, 49, 48, 44, 59, 43, 46, 55, 53, 67, 70, 42, 62, 38, 42, 59, 51, 66, 45, 46, 38, 51, 57, 40, 60, 57, 34, 50, 40, 69, 42, 61, 60, 45, 67, 45, 52, 43, 58, 38, 49, 61, 40, 46, 57, 39, 46, 50, 42, 45, 45, 45, 37, 53, 50, 58, 50, 38, 40, 43, 60, 41, 59, 43, 65, 49, 40, 53, 56, 64, 44, 67, 48, 41, 67, 56, 44, 48, 34, 52, 59, 65, 54, 42, 55, 46, 50, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49069505011129805, "mean_inference_ms": 1.4002606958587933, "mean_action_processing_ms": 0.08049392152635873, "mean_env_wait_ms": 4.942933704027779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003490447998046875, "ViewRequirementAgentConnector_ms": 0.232377290725708}}, "episode_reward_max": 18.268000000000004, "episode_reward_min": 10.314, "episode_reward_mean": 13.467520000000002, "episode_len_mean": 50.55, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.188, 11.86, 15.684000000000003, 18.249000000000002, 15.123, 13.102, 12.91, 13.923000000000002, 10.817, 15.134, 15.534000000000002, 10.682, 12.863000000000001, 13.867, 11.325999999999999, 13.301000000000002, 14.595, 12.309, 13.913, 13.016, 13.974, 17.87, 18.268000000000004, 12.456, 15.734000000000002, 10.314, 12.732000000000001, 17.148, 13.085, 15.474, 12.599, 11.529000000000002, 10.981000000000002, 14.328, 14.170000000000002, 11.072, 15.068999999999999, 14.174, 10.937, 14.289, 11.245000000000001, 15.760000000000002, 12.384, 16.687000000000005, 15.293000000000001, 11.908000000000001, 16.201, 12.931999999999999, 13.918000000000001, 12.843, 13.990000000000002, 11.587, 12.878000000000002, 15.366000000000001, 11.983, 13.163, 14.433999999999997, 11.271999999999998, 11.324, 14.583, 11.819, 12.034, 12.542, 12.247, 11.049, 13.953000000000001, 12.237000000000002, 14.686000000000002, 13.264000000000001, 11.802, 11.376, 11.848, 13.422, 10.66, 14.876000000000001, 12.240000000000002, 15.353, 14.184000000000001, 11.801, 14.120999999999999, 14.161000000000001, 15.858999999999998, 12.509, 15.080000000000002, 13.461, 12.045, 16.131, 16.169, 11.214, 13.577000000000002, 11.113000000000001, 14.226000000000003, 13.656, 16.712, 13.439, 12.316, 14.182000000000002, 12.387, 13.198, 13.453], "episode_lengths": [47, 41, 61, 68, 56, 49, 54, 60, 34, 55, 61, 43, 51, 49, 48, 44, 59, 43, 46, 55, 53, 67, 70, 42, 62, 38, 42, 59, 51, 66, 45, 46, 38, 51, 57, 40, 60, 57, 34, 50, 40, 69, 42, 61, 60, 45, 67, 45, 52, 43, 58, 38, 49, 61, 40, 46, 57, 39, 46, 50, 42, 45, 45, 45, 37, 53, 50, 58, 50, 38, 40, 43, 60, 41, 59, 43, 65, 49, 40, 53, 56, 64, 44, 67, 48, 41, 67, 56, 44, 48, 34, 52, 59, 65, 54, 42, 55, 46, 50, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49069505011129805, "mean_inference_ms": 1.4002606958587933, "mean_action_processing_ms": 0.08049392152635873, "mean_env_wait_ms": 4.942933704027779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003490447998046875, "ViewRequirementAgentConnector_ms": 0.232377290725708}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26622, "num_agent_steps_trained": 0, "num_env_steps_sampled": 26624, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.481372064572025, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 26624, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 26622, "timers": {"training_iteration_time_ms": 50087.711, "sample_time_ms": 7138.171, "synch_weights_time_ms": 73.366}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 0, "num_agent_steps_sampled": 26622, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 380, "training_iteration": 26, "trial_id": "default", "date": "2025-12-20_11-08-04", "timestamp": 1766200084, "time_this_iter_s": 49.99949526786804, "time_total_s": 1298.6541180610657, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1298.6541180610657, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 85.82777777777778, "ram_util_percent": 14.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5940694946795702}, "default_policy": {"total_loss": 0.5940694946795702, "policy_loss": -0.03087462862022221, "vf_loss": 2.524576076865196, "vf_loss_unclipped": 7.294022560119629, "vf_explained_var": 0.252348367869854, "entropy": 1.054277990758419, "mean_kl_loss": 0.010537874704459682, "gradients_default_optimizer_global_norm": 0.8283961668610573, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.006760234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 0, "num_agent_steps_sampled": 27646, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 18.933000000000003, "episode_reward_min": 10.314, "episode_reward_mean": 13.592420000000002, "episode_len_mean": 51.22, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.913, 13.016, 13.974, 17.87, 18.268000000000004, 12.456, 15.734000000000002, 10.314, 12.732000000000001, 17.148, 13.085, 15.474, 12.599, 11.529000000000002, 10.981000000000002, 14.328, 14.170000000000002, 11.072, 15.068999999999999, 14.174, 10.937, 14.289, 11.245000000000001, 15.760000000000002, 12.384, 16.687000000000005, 15.293000000000001, 11.908000000000001, 16.201, 12.931999999999999, 13.918000000000001, 12.843, 13.990000000000002, 11.587, 12.878000000000002, 15.366000000000001, 11.983, 13.163, 14.433999999999997, 11.271999999999998, 11.324, 14.583, 11.819, 12.034, 12.542, 12.247, 11.049, 13.953000000000001, 12.237000000000002, 14.686000000000002, 13.264000000000001, 11.802, 11.376, 11.848, 13.422, 10.66, 14.876000000000001, 12.240000000000002, 15.353, 14.184000000000001, 11.801, 14.120999999999999, 14.161000000000001, 15.858999999999998, 12.509, 15.080000000000002, 13.461, 12.045, 16.131, 16.169, 11.214, 13.577000000000002, 11.113000000000001, 14.226000000000003, 13.656, 16.712, 13.439, 12.316, 14.182000000000002, 12.387, 13.198, 13.453, 10.914, 10.612, 15.49, 15.132000000000003, 18.933000000000003, 14.117999999999999, 13.189, 13.182, 15.555000000000001, 16.681000000000004, 10.936, 15.659000000000002, 13.331999999999999, 12.918, 12.669, 18.365, 15.866000000000003, 12.406], "episode_lengths": [46, 55, 53, 67, 70, 42, 62, 38, 42, 59, 51, 66, 45, 46, 38, 51, 57, 40, 60, 57, 34, 50, 40, 69, 42, 61, 60, 45, 67, 45, 52, 43, 58, 38, 49, 61, 40, 46, 57, 39, 46, 50, 42, 45, 45, 45, 37, 53, 50, 58, 50, 38, 40, 43, 60, 41, 59, 43, 65, 49, 40, 53, 56, 64, 44, 67, 48, 41, 67, 56, 44, 48, 34, 52, 59, 65, 54, 42, 55, 46, 50, 47, 45, 36, 65, 59, 86, 55, 54, 50, 59, 56, 36, 60, 49, 52, 47, 82, 59, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4921909779660982, "mean_inference_ms": 1.4023950403631362, "mean_action_processing_ms": 0.08053802833027845, "mean_env_wait_ms": 4.942664911530955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003489971160888672, "ViewRequirementAgentConnector_ms": 0.23223471641540527}}, "episode_reward_max": 18.933000000000003, "episode_reward_min": 10.314, "episode_reward_mean": 13.592420000000002, "episode_len_mean": 51.22, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.913, 13.016, 13.974, 17.87, 18.268000000000004, 12.456, 15.734000000000002, 10.314, 12.732000000000001, 17.148, 13.085, 15.474, 12.599, 11.529000000000002, 10.981000000000002, 14.328, 14.170000000000002, 11.072, 15.068999999999999, 14.174, 10.937, 14.289, 11.245000000000001, 15.760000000000002, 12.384, 16.687000000000005, 15.293000000000001, 11.908000000000001, 16.201, 12.931999999999999, 13.918000000000001, 12.843, 13.990000000000002, 11.587, 12.878000000000002, 15.366000000000001, 11.983, 13.163, 14.433999999999997, 11.271999999999998, 11.324, 14.583, 11.819, 12.034, 12.542, 12.247, 11.049, 13.953000000000001, 12.237000000000002, 14.686000000000002, 13.264000000000001, 11.802, 11.376, 11.848, 13.422, 10.66, 14.876000000000001, 12.240000000000002, 15.353, 14.184000000000001, 11.801, 14.120999999999999, 14.161000000000001, 15.858999999999998, 12.509, 15.080000000000002, 13.461, 12.045, 16.131, 16.169, 11.214, 13.577000000000002, 11.113000000000001, 14.226000000000003, 13.656, 16.712, 13.439, 12.316, 14.182000000000002, 12.387, 13.198, 13.453, 10.914, 10.612, 15.49, 15.132000000000003, 18.933000000000003, 14.117999999999999, 13.189, 13.182, 15.555000000000001, 16.681000000000004, 10.936, 15.659000000000002, 13.331999999999999, 12.918, 12.669, 18.365, 15.866000000000003, 12.406], "episode_lengths": [46, 55, 53, 67, 70, 42, 62, 38, 42, 59, 51, 66, 45, 46, 38, 51, 57, 40, 60, 57, 34, 50, 40, 69, 42, 61, 60, 45, 67, 45, 52, 43, 58, 38, 49, 61, 40, 46, 57, 39, 46, 50, 42, 45, 45, 45, 37, 53, 50, 58, 50, 38, 40, 43, 60, 41, 59, 43, 65, 49, 40, 53, 56, 64, 44, 67, 48, 41, 67, 56, 44, 48, 34, 52, 59, 65, 54, 42, 55, 46, 50, 47, 45, 36, 65, 59, 86, 55, 54, 50, 59, 56, 36, 60, 49, 52, 47, 82, 59, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4921909779660982, "mean_inference_ms": 1.4023950403631362, "mean_action_processing_ms": 0.08053802833027845, "mean_env_wait_ms": 4.942664911530955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003489971160888672, "ViewRequirementAgentConnector_ms": 0.23223471641540527}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27646, "num_agent_steps_trained": 0, "num_env_steps_sampled": 27648, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.76830748586167, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 27648, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 27646, "timers": {"training_iteration_time_ms": 50041.644, "sample_time_ms": 7138.918, "synch_weights_time_ms": 73.694}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 0, "num_agent_steps_sampled": 27646, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 398, "training_iteration": 27, "trial_id": "default", "date": "2025-12-20_11-09-02", "timestamp": 1766200142, "time_this_iter_s": 49.308791637420654, "time_total_s": 1347.9629096984863, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1347.9629096984863, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 73.86585365853658, "ram_util_percent": 14.099999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7042084351181984}, "default_policy": {"total_loss": 0.7042084351181984, "policy_loss": -0.02769557774299756, "vf_loss": 2.949617105722427, "vf_loss_unclipped": 8.746210992336273, "vf_explained_var": 0.162347674369812, "entropy": 0.9626566261053086, "mean_kl_loss": 0.01007529368307587, "gradients_default_optimizer_global_norm": 0.6472499236464501, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.006640234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28670, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 18.933000000000003, "episode_reward_min": 10.276, "episode_reward_mean": 13.520790000000002, "episode_len_mean": 50.98, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.937, 14.289, 11.245000000000001, 15.760000000000002, 12.384, 16.687000000000005, 15.293000000000001, 11.908000000000001, 16.201, 12.931999999999999, 13.918000000000001, 12.843, 13.990000000000002, 11.587, 12.878000000000002, 15.366000000000001, 11.983, 13.163, 14.433999999999997, 11.271999999999998, 11.324, 14.583, 11.819, 12.034, 12.542, 12.247, 11.049, 13.953000000000001, 12.237000000000002, 14.686000000000002, 13.264000000000001, 11.802, 11.376, 11.848, 13.422, 10.66, 14.876000000000001, 12.240000000000002, 15.353, 14.184000000000001, 11.801, 14.120999999999999, 14.161000000000001, 15.858999999999998, 12.509, 15.080000000000002, 13.461, 12.045, 16.131, 16.169, 11.214, 13.577000000000002, 11.113000000000001, 14.226000000000003, 13.656, 16.712, 13.439, 12.316, 14.182000000000002, 12.387, 13.198, 13.453, 10.914, 10.612, 15.49, 15.132000000000003, 18.933000000000003, 14.117999999999999, 13.189, 13.182, 15.555000000000001, 16.681000000000004, 10.936, 15.659000000000002, 13.331999999999999, 12.918, 12.669, 18.365, 15.866000000000003, 12.406, 12.861, 12.843000000000002, 12.506, 12.496, 13.625, 12.956000000000001, 10.816, 12.318, 16.077, 13.126, 14.117999999999999, 16.655, 14.817, 14.137000000000002, 15.858999999999998, 11.137, 14.189000000000002, 13.933, 15.998000000000001, 10.276], "episode_lengths": [34, 50, 40, 69, 42, 61, 60, 45, 67, 45, 52, 43, 58, 38, 49, 61, 40, 46, 57, 39, 46, 50, 42, 45, 45, 45, 37, 53, 50, 58, 50, 38, 40, 43, 60, 41, 59, 43, 65, 49, 40, 53, 56, 64, 44, 67, 48, 41, 67, 56, 44, 48, 34, 52, 59, 65, 54, 42, 55, 46, 50, 47, 45, 36, 65, 59, 86, 55, 54, 50, 59, 56, 36, 60, 49, 52, 47, 82, 59, 40, 52, 47, 44, 41, 55, 50, 43, 45, 61, 41, 54, 70, 58, 60, 55, 36, 56, 52, 62, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.493671306803009, "mean_inference_ms": 1.4041621945830867, "mean_action_processing_ms": 0.0805612235751924, "mean_env_wait_ms": 4.941809651718898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034856796264648438, "ViewRequirementAgentConnector_ms": 0.23198461532592773}}, "episode_reward_max": 18.933000000000003, "episode_reward_min": 10.276, "episode_reward_mean": 13.520790000000002, "episode_len_mean": 50.98, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.937, 14.289, 11.245000000000001, 15.760000000000002, 12.384, 16.687000000000005, 15.293000000000001, 11.908000000000001, 16.201, 12.931999999999999, 13.918000000000001, 12.843, 13.990000000000002, 11.587, 12.878000000000002, 15.366000000000001, 11.983, 13.163, 14.433999999999997, 11.271999999999998, 11.324, 14.583, 11.819, 12.034, 12.542, 12.247, 11.049, 13.953000000000001, 12.237000000000002, 14.686000000000002, 13.264000000000001, 11.802, 11.376, 11.848, 13.422, 10.66, 14.876000000000001, 12.240000000000002, 15.353, 14.184000000000001, 11.801, 14.120999999999999, 14.161000000000001, 15.858999999999998, 12.509, 15.080000000000002, 13.461, 12.045, 16.131, 16.169, 11.214, 13.577000000000002, 11.113000000000001, 14.226000000000003, 13.656, 16.712, 13.439, 12.316, 14.182000000000002, 12.387, 13.198, 13.453, 10.914, 10.612, 15.49, 15.132000000000003, 18.933000000000003, 14.117999999999999, 13.189, 13.182, 15.555000000000001, 16.681000000000004, 10.936, 15.659000000000002, 13.331999999999999, 12.918, 12.669, 18.365, 15.866000000000003, 12.406, 12.861, 12.843000000000002, 12.506, 12.496, 13.625, 12.956000000000001, 10.816, 12.318, 16.077, 13.126, 14.117999999999999, 16.655, 14.817, 14.137000000000002, 15.858999999999998, 11.137, 14.189000000000002, 13.933, 15.998000000000001, 10.276], "episode_lengths": [34, 50, 40, 69, 42, 61, 60, 45, 67, 45, 52, 43, 58, 38, 49, 61, 40, 46, 57, 39, 46, 50, 42, 45, 45, 45, 37, 53, 50, 58, 50, 38, 40, 43, 60, 41, 59, 43, 65, 49, 40, 53, 56, 64, 44, 67, 48, 41, 67, 56, 44, 48, 34, 52, 59, 65, 54, 42, 55, 46, 50, 47, 45, 36, 65, 59, 86, 55, 54, 50, 59, 56, 36, 60, 49, 52, 47, 82, 59, 40, 52, 47, 44, 41, 55, 50, 43, 45, 61, 41, 54, 70, 58, 60, 55, 36, 56, 52, 62, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.493671306803009, "mean_inference_ms": 1.4041621945830867, "mean_action_processing_ms": 0.0805612235751924, "mean_env_wait_ms": 4.941809651718898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034856796264648438, "ViewRequirementAgentConnector_ms": 0.23198461532592773}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28670, "num_agent_steps_trained": 0, "num_env_steps_sampled": 28672, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.73900767366027, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 28672, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 28670, "timers": {"training_iteration_time_ms": 49993.827, "sample_time_ms": 7139.832, "synch_weights_time_ms": 74.583}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28670, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 418, "training_iteration": 28, "trial_id": "default", "date": "2025-12-20_11-09-52", "timestamp": 1766200192, "time_this_iter_s": 49.3782422542572, "time_total_s": 1397.3411519527435, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1397.3411519527435, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 85.62714285714286, "ram_util_percent": 14.11142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6817517288029193}, "default_policy": {"total_loss": 0.6817517288029193, "policy_loss": -0.028911937633529304, "vf_loss": 2.865147751569748, "vf_loss_unclipped": 8.476351189613343, "vf_explained_var": 0.2742030993103981, "entropy": 1.018055085837841, "mean_kl_loss": 0.011368456276341022, "gradients_default_optimizer_global_norm": 0.7453873500227928, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0065202343749999996, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 0, "num_agent_steps_sampled": 29694, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 18.933000000000003, "episode_reward_min": 10.276, "episode_reward_mean": 13.541799999999999, "episode_len_mean": 51.58, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.271999999999998, 11.324, 14.583, 11.819, 12.034, 12.542, 12.247, 11.049, 13.953000000000001, 12.237000000000002, 14.686000000000002, 13.264000000000001, 11.802, 11.376, 11.848, 13.422, 10.66, 14.876000000000001, 12.240000000000002, 15.353, 14.184000000000001, 11.801, 14.120999999999999, 14.161000000000001, 15.858999999999998, 12.509, 15.080000000000002, 13.461, 12.045, 16.131, 16.169, 11.214, 13.577000000000002, 11.113000000000001, 14.226000000000003, 13.656, 16.712, 13.439, 12.316, 14.182000000000002, 12.387, 13.198, 13.453, 10.914, 10.612, 15.49, 15.132000000000003, 18.933000000000003, 14.117999999999999, 13.189, 13.182, 15.555000000000001, 16.681000000000004, 10.936, 15.659000000000002, 13.331999999999999, 12.918, 12.669, 18.365, 15.866000000000003, 12.406, 12.861, 12.843000000000002, 12.506, 12.496, 13.625, 12.956000000000001, 10.816, 12.318, 16.077, 13.126, 14.117999999999999, 16.655, 14.817, 14.137000000000002, 15.858999999999998, 11.137, 14.189000000000002, 13.933, 15.998000000000001, 10.276, 16.521, 14.822000000000001, 12.834, 14.112000000000002, 11.23, 11.103, 13.817, 14.633000000000003, 12.537, 11.821, 11.139, 15.908000000000001, 14.485000000000001, 12.818999999999999, 17.538000000000004, 14.877, 13.780999999999999, 13.587, 12.334999999999999], "episode_lengths": [39, 46, 50, 42, 45, 45, 45, 37, 53, 50, 58, 50, 38, 40, 43, 60, 41, 59, 43, 65, 49, 40, 53, 56, 64, 44, 67, 48, 41, 67, 56, 44, 48, 34, 52, 59, 65, 54, 42, 55, 46, 50, 47, 45, 36, 65, 59, 86, 55, 54, 50, 59, 56, 36, 60, 49, 52, 47, 82, 59, 40, 52, 47, 44, 41, 55, 50, 43, 45, 61, 41, 54, 70, 58, 60, 55, 36, 56, 52, 62, 39, 67, 64, 43, 52, 38, 46, 52, 49, 49, 50, 39, 59, 65, 61, 71, 57, 50, 65, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49487738588598384, "mean_inference_ms": 1.4040067423894715, "mean_action_processing_ms": 0.08057576122434659, "mean_env_wait_ms": 4.940845218403404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003490924835205078, "ViewRequirementAgentConnector_ms": 0.23229217529296875}}, "episode_reward_max": 18.933000000000003, "episode_reward_min": 10.276, "episode_reward_mean": 13.541799999999999, "episode_len_mean": 51.58, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.271999999999998, 11.324, 14.583, 11.819, 12.034, 12.542, 12.247, 11.049, 13.953000000000001, 12.237000000000002, 14.686000000000002, 13.264000000000001, 11.802, 11.376, 11.848, 13.422, 10.66, 14.876000000000001, 12.240000000000002, 15.353, 14.184000000000001, 11.801, 14.120999999999999, 14.161000000000001, 15.858999999999998, 12.509, 15.080000000000002, 13.461, 12.045, 16.131, 16.169, 11.214, 13.577000000000002, 11.113000000000001, 14.226000000000003, 13.656, 16.712, 13.439, 12.316, 14.182000000000002, 12.387, 13.198, 13.453, 10.914, 10.612, 15.49, 15.132000000000003, 18.933000000000003, 14.117999999999999, 13.189, 13.182, 15.555000000000001, 16.681000000000004, 10.936, 15.659000000000002, 13.331999999999999, 12.918, 12.669, 18.365, 15.866000000000003, 12.406, 12.861, 12.843000000000002, 12.506, 12.496, 13.625, 12.956000000000001, 10.816, 12.318, 16.077, 13.126, 14.117999999999999, 16.655, 14.817, 14.137000000000002, 15.858999999999998, 11.137, 14.189000000000002, 13.933, 15.998000000000001, 10.276, 16.521, 14.822000000000001, 12.834, 14.112000000000002, 11.23, 11.103, 13.817, 14.633000000000003, 12.537, 11.821, 11.139, 15.908000000000001, 14.485000000000001, 12.818999999999999, 17.538000000000004, 14.877, 13.780999999999999, 13.587, 12.334999999999999], "episode_lengths": [39, 46, 50, 42, 45, 45, 45, 37, 53, 50, 58, 50, 38, 40, 43, 60, 41, 59, 43, 65, 49, 40, 53, 56, 64, 44, 67, 48, 41, 67, 56, 44, 48, 34, 52, 59, 65, 54, 42, 55, 46, 50, 47, 45, 36, 65, 59, 86, 55, 54, 50, 59, 56, 36, 60, 49, 52, 47, 82, 59, 40, 52, 47, 44, 41, 55, 50, 43, 45, 61, 41, 54, 70, 58, 60, 55, 36, 56, 52, 62, 39, 67, 64, 43, 52, 38, 46, 52, 49, 49, 50, 39, 59, 65, 61, 71, 57, 50, 65, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49487738588598384, "mean_inference_ms": 1.4040067423894715, "mean_action_processing_ms": 0.08057576122434659, "mean_env_wait_ms": 4.940845218403404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003490924835205078, "ViewRequirementAgentConnector_ms": 0.23229217529296875}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29694, "num_agent_steps_trained": 0, "num_env_steps_sampled": 29696, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.516904369273576, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 29696, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 29694, "timers": {"training_iteration_time_ms": 49976.153, "sample_time_ms": 7134.528, "synch_weights_time_ms": 75.085}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 0, "num_agent_steps_sampled": 29694, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 437, "training_iteration": 29, "trial_id": "default", "date": "2025-12-20_11-10-42", "timestamp": 1766200242, "time_this_iter_s": 49.9136643409729, "time_total_s": 1447.2548162937164, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1447.2548162937164, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 85.88309859154931, "ram_util_percent": 14.19295774647888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.705923730880022}, "default_policy": {"total_loss": 0.705923730880022, "policy_loss": -0.03116118417819962, "vf_loss": 2.9701364040374756, "vf_loss_unclipped": 9.507896029949189, "vf_explained_var": 0.10751724690198898, "entropy": 1.0107900321483612, "mean_kl_loss": 0.011413966964073551, "gradients_default_optimizer_global_norm": 0.7804218158125877, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.006400234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 0, "num_agent_steps_sampled": 30718, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 18.933000000000003, "episode_reward_min": 10.276, "episode_reward_mean": 13.680810000000001, "episode_len_mean": 52.23, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.184000000000001, 11.801, 14.120999999999999, 14.161000000000001, 15.858999999999998, 12.509, 15.080000000000002, 13.461, 12.045, 16.131, 16.169, 11.214, 13.577000000000002, 11.113000000000001, 14.226000000000003, 13.656, 16.712, 13.439, 12.316, 14.182000000000002, 12.387, 13.198, 13.453, 10.914, 10.612, 15.49, 15.132000000000003, 18.933000000000003, 14.117999999999999, 13.189, 13.182, 15.555000000000001, 16.681000000000004, 10.936, 15.659000000000002, 13.331999999999999, 12.918, 12.669, 18.365, 15.866000000000003, 12.406, 12.861, 12.843000000000002, 12.506, 12.496, 13.625, 12.956000000000001, 10.816, 12.318, 16.077, 13.126, 14.117999999999999, 16.655, 14.817, 14.137000000000002, 15.858999999999998, 11.137, 14.189000000000002, 13.933, 15.998000000000001, 10.276, 16.521, 14.822000000000001, 12.834, 14.112000000000002, 11.23, 11.103, 13.817, 14.633000000000003, 12.537, 11.821, 11.139, 15.908000000000001, 14.485000000000001, 12.818999999999999, 17.538000000000004, 14.877, 13.780999999999999, 13.587, 12.334999999999999, 15.139000000000003, 13.795000000000002, 12.995000000000001, 12.134, 12.587, 15.223000000000003, 14.379, 12.268, 14.568, 12.524999999999999, 11.284, 13.088000000000001, 13.222, 11.043999999999999, 14.589000000000006, 16.485, 10.534, 13.929000000000002, 15.293, 11.407], "episode_lengths": [49, 40, 53, 56, 64, 44, 67, 48, 41, 67, 56, 44, 48, 34, 52, 59, 65, 54, 42, 55, 46, 50, 47, 45, 36, 65, 59, 86, 55, 54, 50, 59, 56, 36, 60, 49, 52, 47, 82, 59, 40, 52, 47, 44, 41, 55, 50, 43, 45, 61, 41, 54, 70, 58, 60, 55, 36, 56, 52, 62, 39, 67, 64, 43, 52, 38, 46, 52, 49, 49, 50, 39, 59, 65, 61, 71, 57, 50, 65, 40, 62, 51, 47, 44, 48, 66, 61, 45, 56, 44, 38, 51, 42, 35, 77, 61, 37, 51, 52, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.496049063572203, "mean_inference_ms": 1.4038610273687113, "mean_action_processing_ms": 0.08058863818758973, "mean_env_wait_ms": 4.939875098941717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034761428833007812, "ViewRequirementAgentConnector_ms": 0.23170161247253418}}, "episode_reward_max": 18.933000000000003, "episode_reward_min": 10.276, "episode_reward_mean": 13.680810000000001, "episode_len_mean": 52.23, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.184000000000001, 11.801, 14.120999999999999, 14.161000000000001, 15.858999999999998, 12.509, 15.080000000000002, 13.461, 12.045, 16.131, 16.169, 11.214, 13.577000000000002, 11.113000000000001, 14.226000000000003, 13.656, 16.712, 13.439, 12.316, 14.182000000000002, 12.387, 13.198, 13.453, 10.914, 10.612, 15.49, 15.132000000000003, 18.933000000000003, 14.117999999999999, 13.189, 13.182, 15.555000000000001, 16.681000000000004, 10.936, 15.659000000000002, 13.331999999999999, 12.918, 12.669, 18.365, 15.866000000000003, 12.406, 12.861, 12.843000000000002, 12.506, 12.496, 13.625, 12.956000000000001, 10.816, 12.318, 16.077, 13.126, 14.117999999999999, 16.655, 14.817, 14.137000000000002, 15.858999999999998, 11.137, 14.189000000000002, 13.933, 15.998000000000001, 10.276, 16.521, 14.822000000000001, 12.834, 14.112000000000002, 11.23, 11.103, 13.817, 14.633000000000003, 12.537, 11.821, 11.139, 15.908000000000001, 14.485000000000001, 12.818999999999999, 17.538000000000004, 14.877, 13.780999999999999, 13.587, 12.334999999999999, 15.139000000000003, 13.795000000000002, 12.995000000000001, 12.134, 12.587, 15.223000000000003, 14.379, 12.268, 14.568, 12.524999999999999, 11.284, 13.088000000000001, 13.222, 11.043999999999999, 14.589000000000006, 16.485, 10.534, 13.929000000000002, 15.293, 11.407], "episode_lengths": [49, 40, 53, 56, 64, 44, 67, 48, 41, 67, 56, 44, 48, 34, 52, 59, 65, 54, 42, 55, 46, 50, 47, 45, 36, 65, 59, 86, 55, 54, 50, 59, 56, 36, 60, 49, 52, 47, 82, 59, 40, 52, 47, 44, 41, 55, 50, 43, 45, 61, 41, 54, 70, 58, 60, 55, 36, 56, 52, 62, 39, 67, 64, 43, 52, 38, 46, 52, 49, 49, 50, 39, 59, 65, 61, 71, 57, 50, 65, 40, 62, 51, 47, 44, 48, 66, 61, 45, 56, 44, 38, 51, 42, 35, 77, 61, 37, 51, 52, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.496049063572203, "mean_inference_ms": 1.4038610273687113, "mean_action_processing_ms": 0.08058863818758973, "mean_env_wait_ms": 4.939875098941717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034761428833007812, "ViewRequirementAgentConnector_ms": 0.23170161247253418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30718, "num_agent_steps_trained": 0, "num_env_steps_sampled": 30720, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.76746113746219, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 30720, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 30718, "timers": {"training_iteration_time_ms": 49931.525, "sample_time_ms": 7136.846, "synch_weights_time_ms": 76.384}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 0, "num_agent_steps_sampled": 30718, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 457, "training_iteration": 30, "trial_id": "default", "date": "2025-12-20_11-11-31", "timestamp": 1766200291, "time_this_iter_s": 49.314324378967285, "time_total_s": 1496.5691406726837, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1496.5691406726837, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 85.60285714285715, "ram_util_percent": 14.200000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6875194296240806}, "default_policy": {"total_loss": 0.6875194296240806, "policy_loss": -0.030004352529067545, "vf_loss": 2.8904736638069153, "vf_loss_unclipped": 9.148945379257203, "vf_explained_var": 0.11899397522211075, "entropy": 0.9683129400014877, "mean_kl_loss": 0.011027914729129406, "gradients_default_optimizer_global_norm": 0.6594288125634193, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.006280234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 0, "num_agent_steps_sampled": 31742, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.059000000000005, "episode_reward_min": 10.276, "episode_reward_mean": 13.852380000000004, "episode_len_mean": 53.09, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.182000000000002, 12.387, 13.198, 13.453, 10.914, 10.612, 15.49, 15.132000000000003, 18.933000000000003, 14.117999999999999, 13.189, 13.182, 15.555000000000001, 16.681000000000004, 10.936, 15.659000000000002, 13.331999999999999, 12.918, 12.669, 18.365, 15.866000000000003, 12.406, 12.861, 12.843000000000002, 12.506, 12.496, 13.625, 12.956000000000001, 10.816, 12.318, 16.077, 13.126, 14.117999999999999, 16.655, 14.817, 14.137000000000002, 15.858999999999998, 11.137, 14.189000000000002, 13.933, 15.998000000000001, 10.276, 16.521, 14.822000000000001, 12.834, 14.112000000000002, 11.23, 11.103, 13.817, 14.633000000000003, 12.537, 11.821, 11.139, 15.908000000000001, 14.485000000000001, 12.818999999999999, 17.538000000000004, 14.877, 13.780999999999999, 13.587, 12.334999999999999, 15.139000000000003, 13.795000000000002, 12.995000000000001, 12.134, 12.587, 15.223000000000003, 14.379, 12.268, 14.568, 12.524999999999999, 11.284, 13.088000000000001, 13.222, 11.043999999999999, 14.589000000000006, 16.485, 10.534, 13.929000000000002, 15.293, 11.407, 16.799, 20.059000000000005, 14.179000000000002, 13.067000000000002, 10.972000000000001, 16.637000000000004, 12.943999999999999, 13.744000000000002, 14.991000000000003, 16.652000000000008, 14.476999999999999, 19.464000000000002, 16.143, 13.020000000000001, 13.453000000000001, 15.687000000000001, 12.23, 11.269, 13.144000000000002], "episode_lengths": [55, 46, 50, 47, 45, 36, 65, 59, 86, 55, 54, 50, 59, 56, 36, 60, 49, 52, 47, 82, 59, 40, 52, 47, 44, 41, 55, 50, 43, 45, 61, 41, 54, 70, 58, 60, 55, 36, 56, 52, 62, 39, 67, 64, 43, 52, 38, 46, 52, 49, 49, 50, 39, 59, 65, 61, 71, 57, 50, 65, 40, 62, 51, 47, 44, 48, 66, 61, 45, 56, 44, 38, 51, 42, 35, 77, 61, 37, 51, 52, 46, 65, 85, 60, 49, 38, 88, 49, 44, 58, 67, 52, 77, 64, 42, 45, 56, 46, 39, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49692662239149576, "mean_inference_ms": 1.403372208031356, "mean_action_processing_ms": 0.08057558493748934, "mean_env_wait_ms": 4.938626244972211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034444332122802734, "ViewRequirementAgentConnector_ms": 0.2310018539428711}}, "episode_reward_max": 20.059000000000005, "episode_reward_min": 10.276, "episode_reward_mean": 13.852380000000004, "episode_len_mean": 53.09, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.182000000000002, 12.387, 13.198, 13.453, 10.914, 10.612, 15.49, 15.132000000000003, 18.933000000000003, 14.117999999999999, 13.189, 13.182, 15.555000000000001, 16.681000000000004, 10.936, 15.659000000000002, 13.331999999999999, 12.918, 12.669, 18.365, 15.866000000000003, 12.406, 12.861, 12.843000000000002, 12.506, 12.496, 13.625, 12.956000000000001, 10.816, 12.318, 16.077, 13.126, 14.117999999999999, 16.655, 14.817, 14.137000000000002, 15.858999999999998, 11.137, 14.189000000000002, 13.933, 15.998000000000001, 10.276, 16.521, 14.822000000000001, 12.834, 14.112000000000002, 11.23, 11.103, 13.817, 14.633000000000003, 12.537, 11.821, 11.139, 15.908000000000001, 14.485000000000001, 12.818999999999999, 17.538000000000004, 14.877, 13.780999999999999, 13.587, 12.334999999999999, 15.139000000000003, 13.795000000000002, 12.995000000000001, 12.134, 12.587, 15.223000000000003, 14.379, 12.268, 14.568, 12.524999999999999, 11.284, 13.088000000000001, 13.222, 11.043999999999999, 14.589000000000006, 16.485, 10.534, 13.929000000000002, 15.293, 11.407, 16.799, 20.059000000000005, 14.179000000000002, 13.067000000000002, 10.972000000000001, 16.637000000000004, 12.943999999999999, 13.744000000000002, 14.991000000000003, 16.652000000000008, 14.476999999999999, 19.464000000000002, 16.143, 13.020000000000001, 13.453000000000001, 15.687000000000001, 12.23, 11.269, 13.144000000000002], "episode_lengths": [55, 46, 50, 47, 45, 36, 65, 59, 86, 55, 54, 50, 59, 56, 36, 60, 49, 52, 47, 82, 59, 40, 52, 47, 44, 41, 55, 50, 43, 45, 61, 41, 54, 70, 58, 60, 55, 36, 56, 52, 62, 39, 67, 64, 43, 52, 38, 46, 52, 49, 49, 50, 39, 59, 65, 61, 71, 57, 50, 65, 40, 62, 51, 47, 44, 48, 66, 61, 45, 56, 44, 38, 51, 42, 35, 77, 61, 37, 51, 52, 46, 65, 85, 60, 49, 38, 88, 49, 44, 58, 67, 52, 77, 64, 42, 45, 56, 46, 39, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49692662239149576, "mean_inference_ms": 1.403372208031356, "mean_action_processing_ms": 0.08057558493748934, "mean_env_wait_ms": 4.938626244972211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034444332122802734, "ViewRequirementAgentConnector_ms": 0.2310018539428711}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31742, "num_agent_steps_trained": 0, "num_env_steps_sampled": 31744, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.70727425084356, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 31744, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 31742, "timers": {"training_iteration_time_ms": 49875.032, "sample_time_ms": 7140.236, "synch_weights_time_ms": 79.327}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 0, "num_agent_steps_sampled": 31742, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 476, "training_iteration": 31, "trial_id": "default", "date": "2025-12-20_11-12-20", "timestamp": 1766200340, "time_this_iter_s": 49.45474433898926, "time_total_s": 1546.023885011673, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1546.023885011673, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 85.5642857142857, "ram_util_percent": 14.200000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6929486267268657}, "default_policy": {"total_loss": 0.6929486267268657, "policy_loss": -0.0279913104895968, "vf_loss": 2.9013325035572053, "vf_loss_unclipped": 9.208718013763427, "vf_explained_var": 0.13645385056734086, "entropy": 0.882453054189682, "mean_kl_loss": 0.011488234012767861, "gradients_default_optimizer_global_norm": 0.6973197758197784, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.006160234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32766, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.059000000000005, "episode_reward_min": 10.276, "episode_reward_mean": 13.61335, "episode_len_mean": 51.66, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.406, 12.861, 12.843000000000002, 12.506, 12.496, 13.625, 12.956000000000001, 10.816, 12.318, 16.077, 13.126, 14.117999999999999, 16.655, 14.817, 14.137000000000002, 15.858999999999998, 11.137, 14.189000000000002, 13.933, 15.998000000000001, 10.276, 16.521, 14.822000000000001, 12.834, 14.112000000000002, 11.23, 11.103, 13.817, 14.633000000000003, 12.537, 11.821, 11.139, 15.908000000000001, 14.485000000000001, 12.818999999999999, 17.538000000000004, 14.877, 13.780999999999999, 13.587, 12.334999999999999, 15.139000000000003, 13.795000000000002, 12.995000000000001, 12.134, 12.587, 15.223000000000003, 14.379, 12.268, 14.568, 12.524999999999999, 11.284, 13.088000000000001, 13.222, 11.043999999999999, 14.589000000000006, 16.485, 10.534, 13.929000000000002, 15.293, 11.407, 16.799, 20.059000000000005, 14.179000000000002, 13.067000000000002, 10.972000000000001, 16.637000000000004, 12.943999999999999, 13.744000000000002, 14.991000000000003, 16.652000000000008, 14.476999999999999, 19.464000000000002, 16.143, 13.020000000000001, 13.453000000000001, 15.687000000000001, 12.23, 11.269, 13.144000000000002, 13.026, 13.126000000000001, 11.923, 12.647, 14.356000000000002, 11.542, 13.692, 13.251000000000001, 15.579000000000002, 11.631, 14.367999999999999, 12.29, 11.601, 12.563, 12.103, 12.014000000000001, 13.963, 13.62, 12.937000000000001, 13.738000000000001, 12.898000000000001], "episode_lengths": [40, 52, 47, 44, 41, 55, 50, 43, 45, 61, 41, 54, 70, 58, 60, 55, 36, 56, 52, 62, 39, 67, 64, 43, 52, 38, 46, 52, 49, 49, 50, 39, 59, 65, 61, 71, 57, 50, 65, 40, 62, 51, 47, 44, 48, 66, 61, 45, 56, 44, 38, 51, 42, 35, 77, 61, 37, 51, 52, 46, 65, 85, 60, 49, 38, 88, 49, 44, 58, 67, 52, 77, 64, 42, 45, 56, 46, 39, 45, 45, 42, 44, 46, 53, 48, 59, 46, 63, 44, 61, 43, 45, 47, 43, 41, 49, 54, 43, 42, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4979887375600778, "mean_inference_ms": 1.4030225068618896, "mean_action_processing_ms": 0.08058550955058723, "mean_env_wait_ms": 4.938086767302007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003442525863647461, "ViewRequirementAgentConnector_ms": 0.23103690147399902}}, "episode_reward_max": 20.059000000000005, "episode_reward_min": 10.276, "episode_reward_mean": 13.61335, "episode_len_mean": 51.66, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.406, 12.861, 12.843000000000002, 12.506, 12.496, 13.625, 12.956000000000001, 10.816, 12.318, 16.077, 13.126, 14.117999999999999, 16.655, 14.817, 14.137000000000002, 15.858999999999998, 11.137, 14.189000000000002, 13.933, 15.998000000000001, 10.276, 16.521, 14.822000000000001, 12.834, 14.112000000000002, 11.23, 11.103, 13.817, 14.633000000000003, 12.537, 11.821, 11.139, 15.908000000000001, 14.485000000000001, 12.818999999999999, 17.538000000000004, 14.877, 13.780999999999999, 13.587, 12.334999999999999, 15.139000000000003, 13.795000000000002, 12.995000000000001, 12.134, 12.587, 15.223000000000003, 14.379, 12.268, 14.568, 12.524999999999999, 11.284, 13.088000000000001, 13.222, 11.043999999999999, 14.589000000000006, 16.485, 10.534, 13.929000000000002, 15.293, 11.407, 16.799, 20.059000000000005, 14.179000000000002, 13.067000000000002, 10.972000000000001, 16.637000000000004, 12.943999999999999, 13.744000000000002, 14.991000000000003, 16.652000000000008, 14.476999999999999, 19.464000000000002, 16.143, 13.020000000000001, 13.453000000000001, 15.687000000000001, 12.23, 11.269, 13.144000000000002, 13.026, 13.126000000000001, 11.923, 12.647, 14.356000000000002, 11.542, 13.692, 13.251000000000001, 15.579000000000002, 11.631, 14.367999999999999, 12.29, 11.601, 12.563, 12.103, 12.014000000000001, 13.963, 13.62, 12.937000000000001, 13.738000000000001, 12.898000000000001], "episode_lengths": [40, 52, 47, 44, 41, 55, 50, 43, 45, 61, 41, 54, 70, 58, 60, 55, 36, 56, 52, 62, 39, 67, 64, 43, 52, 38, 46, 52, 49, 49, 50, 39, 59, 65, 61, 71, 57, 50, 65, 40, 62, 51, 47, 44, 48, 66, 61, 45, 56, 44, 38, 51, 42, 35, 77, 61, 37, 51, 52, 46, 65, 85, 60, 49, 38, 88, 49, 44, 58, 67, 52, 77, 64, 42, 45, 56, 46, 39, 45, 45, 42, 44, 46, 53, 48, 59, 46, 63, 44, 61, 43, 45, 47, 43, 41, 49, 54, 43, 42, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4979887375600778, "mean_inference_ms": 1.4030225068618896, "mean_action_processing_ms": 0.08058550955058723, "mean_env_wait_ms": 4.938086767302007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003442525863647461, "ViewRequirementAgentConnector_ms": 0.23103690147399902}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32766, "num_agent_steps_trained": 0, "num_env_steps_sampled": 32768, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.734717678593043, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 32768, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 32766, "timers": {"training_iteration_time_ms": 49822.761, "sample_time_ms": 7143.576, "synch_weights_time_ms": 80.793}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32766, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 497, "training_iteration": 32, "trial_id": "default", "date": "2025-12-20_11-13-18", "timestamp": 1766200398, "time_this_iter_s": 49.38857913017273, "time_total_s": 1595.4124641418457, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1595.4124641418457, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 73.78292682926829, "ram_util_percent": 14.200000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7249108389019966}, "default_policy": {"total_loss": 0.7249108389019966, "policy_loss": -0.029196463781408964, "vf_loss": 3.0331955432891844, "vf_loss_unclipped": 10.732047152519225, "vf_explained_var": 0.10938276499509811, "entropy": 0.8492578580975533, "mean_kl_loss": 0.0104005317382871, "gradients_default_optimizer_global_norm": 0.7761732533574104, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.006040234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 0, "num_agent_steps_sampled": 33790, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.059000000000005, "episode_reward_min": 10.534, "episode_reward_mean": 13.543700000000001, "episode_len_mean": 51.48, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.521, 14.822000000000001, 12.834, 14.112000000000002, 11.23, 11.103, 13.817, 14.633000000000003, 12.537, 11.821, 11.139, 15.908000000000001, 14.485000000000001, 12.818999999999999, 17.538000000000004, 14.877, 13.780999999999999, 13.587, 12.334999999999999, 15.139000000000003, 13.795000000000002, 12.995000000000001, 12.134, 12.587, 15.223000000000003, 14.379, 12.268, 14.568, 12.524999999999999, 11.284, 13.088000000000001, 13.222, 11.043999999999999, 14.589000000000006, 16.485, 10.534, 13.929000000000002, 15.293, 11.407, 16.799, 20.059000000000005, 14.179000000000002, 13.067000000000002, 10.972000000000001, 16.637000000000004, 12.943999999999999, 13.744000000000002, 14.991000000000003, 16.652000000000008, 14.476999999999999, 19.464000000000002, 16.143, 13.020000000000001, 13.453000000000001, 15.687000000000001, 12.23, 11.269, 13.144000000000002, 13.026, 13.126000000000001, 11.923, 12.647, 14.356000000000002, 11.542, 13.692, 13.251000000000001, 15.579000000000002, 11.631, 14.367999999999999, 12.29, 11.601, 12.563, 12.103, 12.014000000000001, 13.963, 13.62, 12.937000000000001, 13.738000000000001, 12.898000000000001, 12.325, 11.737000000000002, 12.75, 13.638, 16.782999999999998, 16.323, 12.687, 12.664, 15.173000000000005, 12.115, 12.355, 13.511, 11.277, 12.328, 14.059, 14.746, 11.767000000000001, 14.112000000000002, 12.837000000000002, 11.823, 11.174], "episode_lengths": [67, 64, 43, 52, 38, 46, 52, 49, 49, 50, 39, 59, 65, 61, 71, 57, 50, 65, 40, 62, 51, 47, 44, 48, 66, 61, 45, 56, 44, 38, 51, 42, 35, 77, 61, 37, 51, 52, 46, 65, 85, 60, 49, 38, 88, 49, 44, 58, 67, 52, 77, 64, 42, 45, 56, 46, 39, 45, 45, 42, 44, 46, 53, 48, 59, 46, 63, 44, 61, 43, 45, 47, 43, 41, 49, 54, 43, 42, 47, 43, 35, 45, 55, 70, 72, 41, 47, 73, 41, 46, 53, 40, 46, 57, 58, 39, 57, 44, 43, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4990070176591423, "mean_inference_ms": 1.4027165988131827, "mean_action_processing_ms": 0.08058662636440132, "mean_env_wait_ms": 4.937218762579835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034637451171875, "ViewRequirementAgentConnector_ms": 0.23131823539733887}}, "episode_reward_max": 20.059000000000005, "episode_reward_min": 10.534, "episode_reward_mean": 13.543700000000001, "episode_len_mean": 51.48, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.521, 14.822000000000001, 12.834, 14.112000000000002, 11.23, 11.103, 13.817, 14.633000000000003, 12.537, 11.821, 11.139, 15.908000000000001, 14.485000000000001, 12.818999999999999, 17.538000000000004, 14.877, 13.780999999999999, 13.587, 12.334999999999999, 15.139000000000003, 13.795000000000002, 12.995000000000001, 12.134, 12.587, 15.223000000000003, 14.379, 12.268, 14.568, 12.524999999999999, 11.284, 13.088000000000001, 13.222, 11.043999999999999, 14.589000000000006, 16.485, 10.534, 13.929000000000002, 15.293, 11.407, 16.799, 20.059000000000005, 14.179000000000002, 13.067000000000002, 10.972000000000001, 16.637000000000004, 12.943999999999999, 13.744000000000002, 14.991000000000003, 16.652000000000008, 14.476999999999999, 19.464000000000002, 16.143, 13.020000000000001, 13.453000000000001, 15.687000000000001, 12.23, 11.269, 13.144000000000002, 13.026, 13.126000000000001, 11.923, 12.647, 14.356000000000002, 11.542, 13.692, 13.251000000000001, 15.579000000000002, 11.631, 14.367999999999999, 12.29, 11.601, 12.563, 12.103, 12.014000000000001, 13.963, 13.62, 12.937000000000001, 13.738000000000001, 12.898000000000001, 12.325, 11.737000000000002, 12.75, 13.638, 16.782999999999998, 16.323, 12.687, 12.664, 15.173000000000005, 12.115, 12.355, 13.511, 11.277, 12.328, 14.059, 14.746, 11.767000000000001, 14.112000000000002, 12.837000000000002, 11.823, 11.174], "episode_lengths": [67, 64, 43, 52, 38, 46, 52, 49, 49, 50, 39, 59, 65, 61, 71, 57, 50, 65, 40, 62, 51, 47, 44, 48, 66, 61, 45, 56, 44, 38, 51, 42, 35, 77, 61, 37, 51, 52, 46, 65, 85, 60, 49, 38, 88, 49, 44, 58, 67, 52, 77, 64, 42, 45, 56, 46, 39, 45, 45, 42, 44, 46, 53, 48, 59, 46, 63, 44, 61, 43, 45, 47, 43, 41, 49, 54, 43, 42, 47, 43, 35, 45, 55, 70, 72, 41, 47, 73, 41, 46, 53, 40, 46, 57, 58, 39, 57, 44, 43, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4990070176591423, "mean_inference_ms": 1.4027165988131827, "mean_action_processing_ms": 0.08058662636440132, "mean_env_wait_ms": 4.937218762579835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034637451171875, "ViewRequirementAgentConnector_ms": 0.23131823539733887}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33790, "num_agent_steps_trained": 0, "num_env_steps_sampled": 33792, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.572059720047246, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 33792, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 33790, "timers": {"training_iteration_time_ms": 49670.756, "sample_time_ms": 7139.642, "synch_weights_time_ms": 80.241}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 0, "num_agent_steps_sampled": 33790, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 518, "training_iteration": 33, "trial_id": "default", "date": "2025-12-20_11-14-08", "timestamp": 1766200448, "time_this_iter_s": 49.7792809009552, "time_total_s": 1645.191745042801, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1645.191745042801, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 85.80422535211268, "ram_util_percent": 14.200000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6882906705141068}, "default_policy": {"total_loss": 0.6882906705141068, "policy_loss": -0.0306715844781138, "vf_loss": 2.894078481197357, "vf_loss_unclipped": 9.678262996673585, "vf_explained_var": 0.18088888078927995, "entropy": 0.9361684679985046, "mean_kl_loss": 0.010972975445633892, "gradients_default_optimizer_global_norm": 0.7163149736821651, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.005920234375000001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 0, "num_agent_steps_sampled": 34814, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.686, "episode_reward_min": 10.534, "episode_reward_mean": 13.480700000000002, "episode_len_mean": 51.17, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.795000000000002, 12.995000000000001, 12.134, 12.587, 15.223000000000003, 14.379, 12.268, 14.568, 12.524999999999999, 11.284, 13.088000000000001, 13.222, 11.043999999999999, 14.589000000000006, 16.485, 10.534, 13.929000000000002, 15.293, 11.407, 16.799, 20.059000000000005, 14.179000000000002, 13.067000000000002, 10.972000000000001, 16.637000000000004, 12.943999999999999, 13.744000000000002, 14.991000000000003, 16.652000000000008, 14.476999999999999, 19.464000000000002, 16.143, 13.020000000000001, 13.453000000000001, 15.687000000000001, 12.23, 11.269, 13.144000000000002, 13.026, 13.126000000000001, 11.923, 12.647, 14.356000000000002, 11.542, 13.692, 13.251000000000001, 15.579000000000002, 11.631, 14.367999999999999, 12.29, 11.601, 12.563, 12.103, 12.014000000000001, 13.963, 13.62, 12.937000000000001, 13.738000000000001, 12.898000000000001, 12.325, 11.737000000000002, 12.75, 13.638, 16.782999999999998, 16.323, 12.687, 12.664, 15.173000000000005, 12.115, 12.355, 13.511, 11.277, 12.328, 14.059, 14.746, 11.767000000000001, 14.112000000000002, 12.837000000000002, 11.823, 11.174, 11.943, 16.055, 12.771, 15.150000000000004, 17.373, 14.203, 10.878, 14.383, 11.53, 12.502, 20.686, 11.738000000000001, 13.771, 14.779, 12.137, 11.110000000000001, 12.126999999999999, 12.040000000000001, 11.727, 11.834999999999999], "episode_lengths": [51, 47, 44, 48, 66, 61, 45, 56, 44, 38, 51, 42, 35, 77, 61, 37, 51, 52, 46, 65, 85, 60, 49, 38, 88, 49, 44, 58, 67, 52, 77, 64, 42, 45, 56, 46, 39, 45, 45, 42, 44, 46, 53, 48, 59, 46, 63, 44, 61, 43, 45, 47, 43, 41, 49, 54, 43, 42, 47, 43, 35, 45, 55, 70, 72, 41, 47, 73, 41, 46, 53, 40, 46, 57, 58, 39, 57, 44, 43, 38, 43, 55, 57, 58, 71, 53, 41, 52, 47, 51, 91, 45, 59, 54, 44, 46, 43, 46, 48, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.499888367675985, "mean_inference_ms": 1.4024708007433633, "mean_action_processing_ms": 0.080574536510724, "mean_env_wait_ms": 4.935997481358762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003440380096435547, "ViewRequirementAgentConnector_ms": 0.23020672798156738}}, "episode_reward_max": 20.686, "episode_reward_min": 10.534, "episode_reward_mean": 13.480700000000002, "episode_len_mean": 51.17, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.795000000000002, 12.995000000000001, 12.134, 12.587, 15.223000000000003, 14.379, 12.268, 14.568, 12.524999999999999, 11.284, 13.088000000000001, 13.222, 11.043999999999999, 14.589000000000006, 16.485, 10.534, 13.929000000000002, 15.293, 11.407, 16.799, 20.059000000000005, 14.179000000000002, 13.067000000000002, 10.972000000000001, 16.637000000000004, 12.943999999999999, 13.744000000000002, 14.991000000000003, 16.652000000000008, 14.476999999999999, 19.464000000000002, 16.143, 13.020000000000001, 13.453000000000001, 15.687000000000001, 12.23, 11.269, 13.144000000000002, 13.026, 13.126000000000001, 11.923, 12.647, 14.356000000000002, 11.542, 13.692, 13.251000000000001, 15.579000000000002, 11.631, 14.367999999999999, 12.29, 11.601, 12.563, 12.103, 12.014000000000001, 13.963, 13.62, 12.937000000000001, 13.738000000000001, 12.898000000000001, 12.325, 11.737000000000002, 12.75, 13.638, 16.782999999999998, 16.323, 12.687, 12.664, 15.173000000000005, 12.115, 12.355, 13.511, 11.277, 12.328, 14.059, 14.746, 11.767000000000001, 14.112000000000002, 12.837000000000002, 11.823, 11.174, 11.943, 16.055, 12.771, 15.150000000000004, 17.373, 14.203, 10.878, 14.383, 11.53, 12.502, 20.686, 11.738000000000001, 13.771, 14.779, 12.137, 11.110000000000001, 12.126999999999999, 12.040000000000001, 11.727, 11.834999999999999], "episode_lengths": [51, 47, 44, 48, 66, 61, 45, 56, 44, 38, 51, 42, 35, 77, 61, 37, 51, 52, 46, 65, 85, 60, 49, 38, 88, 49, 44, 58, 67, 52, 77, 64, 42, 45, 56, 46, 39, 45, 45, 42, 44, 46, 53, 48, 59, 46, 63, 44, 61, 43, 45, 47, 43, 41, 49, 54, 43, 42, 47, 43, 35, 45, 55, 70, 72, 41, 47, 73, 41, 46, 53, 40, 46, 57, 58, 39, 57, 44, 43, 38, 43, 55, 57, 58, 71, 53, 41, 52, 47, 51, 91, 45, 59, 54, 44, 46, 43, 46, 48, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.499888367675985, "mean_inference_ms": 1.4024708007433633, "mean_action_processing_ms": 0.080574536510724, "mean_env_wait_ms": 4.935997481358762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003440380096435547, "ViewRequirementAgentConnector_ms": 0.23020672798156738}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34814, "num_agent_steps_trained": 0, "num_env_steps_sampled": 34816, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.488365427334053, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 34816, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 34814, "timers": {"training_iteration_time_ms": 49696.763, "sample_time_ms": 7112.982, "synch_weights_time_ms": 82.831}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 0, "num_agent_steps_sampled": 34814, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 538, "training_iteration": 34, "trial_id": "default", "date": "2025-12-20_11-14-58", "timestamp": 1766200498, "time_this_iter_s": 49.98419761657715, "time_total_s": 1695.175942659378, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1695.175942659378, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 85.79718309859156, "ram_util_percent": 14.200000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7193021476268768}, "default_policy": {"total_loss": 0.7193021476268768, "policy_loss": -0.023362102103419602, "vf_loss": 2.987245613336563, "vf_loss_unclipped": 9.088635420799255, "vf_explained_var": 0.26313679218292235, "entropy": 0.89238950163126, "mean_kl_loss": 0.011360042003161652, "gradients_default_optimizer_global_norm": 0.7507742688059806, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.005800234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 0, "num_agent_steps_sampled": 35838, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.686, "episode_reward_min": 10.825000000000001, "episode_reward_mean": 13.23338, "episode_len_mean": 50.04, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.179000000000002, 13.067000000000002, 10.972000000000001, 16.637000000000004, 12.943999999999999, 13.744000000000002, 14.991000000000003, 16.652000000000008, 14.476999999999999, 19.464000000000002, 16.143, 13.020000000000001, 13.453000000000001, 15.687000000000001, 12.23, 11.269, 13.144000000000002, 13.026, 13.126000000000001, 11.923, 12.647, 14.356000000000002, 11.542, 13.692, 13.251000000000001, 15.579000000000002, 11.631, 14.367999999999999, 12.29, 11.601, 12.563, 12.103, 12.014000000000001, 13.963, 13.62, 12.937000000000001, 13.738000000000001, 12.898000000000001, 12.325, 11.737000000000002, 12.75, 13.638, 16.782999999999998, 16.323, 12.687, 12.664, 15.173000000000005, 12.115, 12.355, 13.511, 11.277, 12.328, 14.059, 14.746, 11.767000000000001, 14.112000000000002, 12.837000000000002, 11.823, 11.174, 11.943, 16.055, 12.771, 15.150000000000004, 17.373, 14.203, 10.878, 14.383, 11.53, 12.502, 20.686, 11.738000000000001, 13.771, 14.779, 12.137, 11.110000000000001, 12.126999999999999, 12.040000000000001, 11.727, 11.834999999999999, 11.064, 17.796000000000006, 11.221, 13.020999999999999, 11.769, 15.108000000000004, 12.686, 10.962, 12.53, 11.277, 11.572999999999999, 11.299000000000001, 12.057, 13.087, 12.79, 11.581999999999999, 14.885000000000002, 12.835, 13.232000000000001, 10.825000000000001, 11.876], "episode_lengths": [60, 49, 38, 88, 49, 44, 58, 67, 52, 77, 64, 42, 45, 56, 46, 39, 45, 45, 42, 44, 46, 53, 48, 59, 46, 63, 44, 61, 43, 45, 47, 43, 41, 49, 54, 43, 42, 47, 43, 35, 45, 55, 70, 72, 41, 47, 73, 41, 46, 53, 40, 46, 57, 58, 39, 57, 44, 43, 38, 43, 55, 57, 58, 71, 53, 41, 52, 47, 51, 91, 45, 59, 54, 44, 46, 43, 46, 48, 44, 41, 82, 44, 45, 41, 55, 43, 38, 47, 39, 52, 42, 49, 47, 44, 42, 64, 43, 50, 41, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5007706659987043, "mean_inference_ms": 1.402136799665992, "mean_action_processing_ms": 0.08055550625303082, "mean_env_wait_ms": 4.934814662273631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003432035446166992, "ViewRequirementAgentConnector_ms": 0.23012876510620117}}, "episode_reward_max": 20.686, "episode_reward_min": 10.825000000000001, "episode_reward_mean": 13.23338, "episode_len_mean": 50.04, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.179000000000002, 13.067000000000002, 10.972000000000001, 16.637000000000004, 12.943999999999999, 13.744000000000002, 14.991000000000003, 16.652000000000008, 14.476999999999999, 19.464000000000002, 16.143, 13.020000000000001, 13.453000000000001, 15.687000000000001, 12.23, 11.269, 13.144000000000002, 13.026, 13.126000000000001, 11.923, 12.647, 14.356000000000002, 11.542, 13.692, 13.251000000000001, 15.579000000000002, 11.631, 14.367999999999999, 12.29, 11.601, 12.563, 12.103, 12.014000000000001, 13.963, 13.62, 12.937000000000001, 13.738000000000001, 12.898000000000001, 12.325, 11.737000000000002, 12.75, 13.638, 16.782999999999998, 16.323, 12.687, 12.664, 15.173000000000005, 12.115, 12.355, 13.511, 11.277, 12.328, 14.059, 14.746, 11.767000000000001, 14.112000000000002, 12.837000000000002, 11.823, 11.174, 11.943, 16.055, 12.771, 15.150000000000004, 17.373, 14.203, 10.878, 14.383, 11.53, 12.502, 20.686, 11.738000000000001, 13.771, 14.779, 12.137, 11.110000000000001, 12.126999999999999, 12.040000000000001, 11.727, 11.834999999999999, 11.064, 17.796000000000006, 11.221, 13.020999999999999, 11.769, 15.108000000000004, 12.686, 10.962, 12.53, 11.277, 11.572999999999999, 11.299000000000001, 12.057, 13.087, 12.79, 11.581999999999999, 14.885000000000002, 12.835, 13.232000000000001, 10.825000000000001, 11.876], "episode_lengths": [60, 49, 38, 88, 49, 44, 58, 67, 52, 77, 64, 42, 45, 56, 46, 39, 45, 45, 42, 44, 46, 53, 48, 59, 46, 63, 44, 61, 43, 45, 47, 43, 41, 49, 54, 43, 42, 47, 43, 35, 45, 55, 70, 72, 41, 47, 73, 41, 46, 53, 40, 46, 57, 58, 39, 57, 44, 43, 38, 43, 55, 57, 58, 71, 53, 41, 52, 47, 51, 91, 45, 59, 54, 44, 46, 43, 46, 48, 44, 41, 82, 44, 45, 41, 55, 43, 38, 47, 39, 52, 42, 49, 47, 44, 42, 64, 43, 50, 41, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5007706659987043, "mean_inference_ms": 1.402136799665992, "mean_action_processing_ms": 0.08055550625303082, "mean_env_wait_ms": 4.934814662273631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003432035446166992, "ViewRequirementAgentConnector_ms": 0.23012876510620117}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35838, "num_agent_steps_trained": 0, "num_env_steps_sampled": 35840, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.26064499799265, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 35840, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 35838, "timers": {"training_iteration_time_ms": 49702.98, "sample_time_ms": 7112.21, "synch_weights_time_ms": 84.367}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 0, "num_agent_steps_sampled": 35838, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 559, "training_iteration": 35, "trial_id": "default", "date": "2025-12-20_11-15-49", "timestamp": 1766200549, "time_this_iter_s": 50.54432821273804, "time_total_s": 1745.720270872116, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1745.720270872116, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 85.60416666666667, "ram_util_percent": 14.200000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8038729801774025}, "default_policy": {"total_loss": 0.8038729801774025, "policy_loss": -0.03011854854412377, "vf_loss": 3.3520269215106966, "vf_loss_unclipped": 9.304462015628815, "vf_explained_var": 0.47420448064804077, "entropy": 0.849877867102623, "mean_kl_loss": 0.009142893497300974, "gradients_default_optimizer_global_norm": 0.7847114779055119, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.005680234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 36864, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36862, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.686, "episode_reward_min": 10.54, "episode_reward_mean": 12.93157, "episode_len_mean": 48.83, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.542, 13.692, 13.251000000000001, 15.579000000000002, 11.631, 14.367999999999999, 12.29, 11.601, 12.563, 12.103, 12.014000000000001, 13.963, 13.62, 12.937000000000001, 13.738000000000001, 12.898000000000001, 12.325, 11.737000000000002, 12.75, 13.638, 16.782999999999998, 16.323, 12.687, 12.664, 15.173000000000005, 12.115, 12.355, 13.511, 11.277, 12.328, 14.059, 14.746, 11.767000000000001, 14.112000000000002, 12.837000000000002, 11.823, 11.174, 11.943, 16.055, 12.771, 15.150000000000004, 17.373, 14.203, 10.878, 14.383, 11.53, 12.502, 20.686, 11.738000000000001, 13.771, 14.779, 12.137, 11.110000000000001, 12.126999999999999, 12.040000000000001, 11.727, 11.834999999999999, 11.064, 17.796000000000006, 11.221, 13.020999999999999, 11.769, 15.108000000000004, 12.686, 10.962, 12.53, 11.277, 11.572999999999999, 11.299000000000001, 12.057, 13.087, 12.79, 11.581999999999999, 14.885000000000002, 12.835, 13.232000000000001, 10.825000000000001, 11.876, 17.253, 13.235, 12.323, 13.327, 11.187, 12.396, 13.988999999999999, 12.868, 12.669, 12.476, 13.818000000000001, 12.547999999999998, 10.54, 11.056999999999999, 10.572000000000001, 12.602, 11.052999999999999, 14.583000000000006, 11.796000000000001, 12.286, 13.211000000000002, 11.181], "episode_lengths": [48, 59, 46, 63, 44, 61, 43, 45, 47, 43, 41, 49, 54, 43, 42, 47, 43, 35, 45, 55, 70, 72, 41, 47, 73, 41, 46, 53, 40, 46, 57, 58, 39, 57, 44, 43, 38, 43, 55, 57, 58, 71, 53, 41, 52, 47, 51, 91, 45, 59, 54, 44, 46, 43, 46, 48, 44, 41, 82, 44, 45, 41, 55, 43, 38, 47, 39, 52, 42, 49, 47, 44, 42, 64, 43, 50, 41, 40, 68, 45, 49, 44, 39, 42, 67, 46, 47, 37, 56, 52, 38, 36, 40, 47, 39, 54, 48, 42, 51, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5017339063982261, "mean_inference_ms": 1.4018718205322904, "mean_action_processing_ms": 0.08053363799023032, "mean_env_wait_ms": 4.933595261946098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034329891204833984, "ViewRequirementAgentConnector_ms": 0.2299211025238037}}, "episode_reward_max": 20.686, "episode_reward_min": 10.54, "episode_reward_mean": 12.93157, "episode_len_mean": 48.83, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.542, 13.692, 13.251000000000001, 15.579000000000002, 11.631, 14.367999999999999, 12.29, 11.601, 12.563, 12.103, 12.014000000000001, 13.963, 13.62, 12.937000000000001, 13.738000000000001, 12.898000000000001, 12.325, 11.737000000000002, 12.75, 13.638, 16.782999999999998, 16.323, 12.687, 12.664, 15.173000000000005, 12.115, 12.355, 13.511, 11.277, 12.328, 14.059, 14.746, 11.767000000000001, 14.112000000000002, 12.837000000000002, 11.823, 11.174, 11.943, 16.055, 12.771, 15.150000000000004, 17.373, 14.203, 10.878, 14.383, 11.53, 12.502, 20.686, 11.738000000000001, 13.771, 14.779, 12.137, 11.110000000000001, 12.126999999999999, 12.040000000000001, 11.727, 11.834999999999999, 11.064, 17.796000000000006, 11.221, 13.020999999999999, 11.769, 15.108000000000004, 12.686, 10.962, 12.53, 11.277, 11.572999999999999, 11.299000000000001, 12.057, 13.087, 12.79, 11.581999999999999, 14.885000000000002, 12.835, 13.232000000000001, 10.825000000000001, 11.876, 17.253, 13.235, 12.323, 13.327, 11.187, 12.396, 13.988999999999999, 12.868, 12.669, 12.476, 13.818000000000001, 12.547999999999998, 10.54, 11.056999999999999, 10.572000000000001, 12.602, 11.052999999999999, 14.583000000000006, 11.796000000000001, 12.286, 13.211000000000002, 11.181], "episode_lengths": [48, 59, 46, 63, 44, 61, 43, 45, 47, 43, 41, 49, 54, 43, 42, 47, 43, 35, 45, 55, 70, 72, 41, 47, 73, 41, 46, 53, 40, 46, 57, 58, 39, 57, 44, 43, 38, 43, 55, 57, 58, 71, 53, 41, 52, 47, 51, 91, 45, 59, 54, 44, 46, 43, 46, 48, 44, 41, 82, 44, 45, 41, 55, 43, 38, 47, 39, 52, 42, 49, 47, 44, 42, 64, 43, 50, 41, 40, 68, 45, 49, 44, 39, 42, 67, 46, 47, 37, 56, 52, 38, 36, 40, 47, 39, 54, 48, 42, 51, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5017339063982261, "mean_inference_ms": 1.4018718205322904, "mean_action_processing_ms": 0.08053363799023032, "mean_env_wait_ms": 4.933595261946098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034329891204833984, "ViewRequirementAgentConnector_ms": 0.2299211025238037}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36862, "num_agent_steps_trained": 0, "num_env_steps_sampled": 36864, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.3476395146645, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 36864, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 36862, "timers": {"training_iteration_time_ms": 49735.839, "sample_time_ms": 7106.341, "synch_weights_time_ms": 83.483}, "counters": {"num_env_steps_sampled": 36864, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36862, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 581, "training_iteration": 36, "trial_id": "default", "date": "2025-12-20_11-16-39", "timestamp": 1766200599, "time_this_iter_s": 50.328269243240356, "time_total_s": 1796.0485401153564, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1796.0485401153564, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 85.97083333333333, "ram_util_percent": 14.200000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7025639519095421}, "default_policy": {"total_loss": 0.7025639519095421, "policy_loss": -0.026530293107498437, "vf_loss": 2.929784244298935, "vf_loss_unclipped": 6.597897183895111, "vf_explained_var": 0.6098404705524445, "entropy": 0.879971706867218, "mean_kl_loss": 0.01646627020863889, "gradients_default_optimizer_global_norm": 0.8912839278578758, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.005560234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 37888, "num_env_steps_trained": 0, "num_agent_steps_sampled": 37886, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.686, "episode_reward_min": 10.54, "episode_reward_mean": 12.952950000000001, "episode_len_mean": 49.61, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.782999999999998, 16.323, 12.687, 12.664, 15.173000000000005, 12.115, 12.355, 13.511, 11.277, 12.328, 14.059, 14.746, 11.767000000000001, 14.112000000000002, 12.837000000000002, 11.823, 11.174, 11.943, 16.055, 12.771, 15.150000000000004, 17.373, 14.203, 10.878, 14.383, 11.53, 12.502, 20.686, 11.738000000000001, 13.771, 14.779, 12.137, 11.110000000000001, 12.126999999999999, 12.040000000000001, 11.727, 11.834999999999999, 11.064, 17.796000000000006, 11.221, 13.020999999999999, 11.769, 15.108000000000004, 12.686, 10.962, 12.53, 11.277, 11.572999999999999, 11.299000000000001, 12.057, 13.087, 12.79, 11.581999999999999, 14.885000000000002, 12.835, 13.232000000000001, 10.825000000000001, 11.876, 17.253, 13.235, 12.323, 13.327, 11.187, 12.396, 13.988999999999999, 12.868, 12.669, 12.476, 13.818000000000001, 12.547999999999998, 10.54, 11.056999999999999, 10.572000000000001, 12.602, 11.052999999999999, 14.583000000000006, 11.796000000000001, 12.286, 13.211000000000002, 11.181, 14.723, 14.296, 12.294, 14.376000000000001, 11.088999999999999, 12.059, 11.667000000000002, 12.954, 12.383, 11.985999999999999, 20.55900000000001, 10.885, 11.996999999999998, 11.86, 12.030999999999999, 13.935, 14.337, 11.496, 12.943999999999999, 12.506999999999998], "episode_lengths": [70, 72, 41, 47, 73, 41, 46, 53, 40, 46, 57, 58, 39, 57, 44, 43, 38, 43, 55, 57, 58, 71, 53, 41, 52, 47, 51, 91, 45, 59, 54, 44, 46, 43, 46, 48, 44, 41, 82, 44, 45, 41, 55, 43, 38, 47, 39, 52, 42, 49, 47, 44, 42, 64, 43, 50, 41, 40, 68, 45, 49, 44, 39, 42, 67, 46, 47, 37, 56, 52, 38, 36, 40, 47, 39, 54, 48, 42, 51, 41, 66, 66, 42, 62, 40, 51, 40, 49, 44, 40, 124, 43, 42, 40, 44, 45, 51, 42, 46, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5025689202178161, "mean_inference_ms": 1.4018041461902047, "mean_action_processing_ms": 0.08053893271795008, "mean_env_wait_ms": 4.933301477667345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034112930297851562, "ViewRequirementAgentConnector_ms": 0.22985196113586426}}, "episode_reward_max": 20.686, "episode_reward_min": 10.54, "episode_reward_mean": 12.952950000000001, "episode_len_mean": 49.61, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.782999999999998, 16.323, 12.687, 12.664, 15.173000000000005, 12.115, 12.355, 13.511, 11.277, 12.328, 14.059, 14.746, 11.767000000000001, 14.112000000000002, 12.837000000000002, 11.823, 11.174, 11.943, 16.055, 12.771, 15.150000000000004, 17.373, 14.203, 10.878, 14.383, 11.53, 12.502, 20.686, 11.738000000000001, 13.771, 14.779, 12.137, 11.110000000000001, 12.126999999999999, 12.040000000000001, 11.727, 11.834999999999999, 11.064, 17.796000000000006, 11.221, 13.020999999999999, 11.769, 15.108000000000004, 12.686, 10.962, 12.53, 11.277, 11.572999999999999, 11.299000000000001, 12.057, 13.087, 12.79, 11.581999999999999, 14.885000000000002, 12.835, 13.232000000000001, 10.825000000000001, 11.876, 17.253, 13.235, 12.323, 13.327, 11.187, 12.396, 13.988999999999999, 12.868, 12.669, 12.476, 13.818000000000001, 12.547999999999998, 10.54, 11.056999999999999, 10.572000000000001, 12.602, 11.052999999999999, 14.583000000000006, 11.796000000000001, 12.286, 13.211000000000002, 11.181, 14.723, 14.296, 12.294, 14.376000000000001, 11.088999999999999, 12.059, 11.667000000000002, 12.954, 12.383, 11.985999999999999, 20.55900000000001, 10.885, 11.996999999999998, 11.86, 12.030999999999999, 13.935, 14.337, 11.496, 12.943999999999999, 12.506999999999998], "episode_lengths": [70, 72, 41, 47, 73, 41, 46, 53, 40, 46, 57, 58, 39, 57, 44, 43, 38, 43, 55, 57, 58, 71, 53, 41, 52, 47, 51, 91, 45, 59, 54, 44, 46, 43, 46, 48, 44, 41, 82, 44, 45, 41, 55, 43, 38, 47, 39, 52, 42, 49, 47, 44, 42, 64, 43, 50, 41, 40, 68, 45, 49, 44, 39, 42, 67, 46, 47, 37, 56, 52, 38, 36, 40, 47, 39, 54, 48, 42, 51, 41, 66, 66, 42, 62, 40, 51, 40, 49, 44, 40, 124, 43, 42, 40, 44, 45, 51, 42, 46, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5025689202178161, "mean_inference_ms": 1.4018041461902047, "mean_action_processing_ms": 0.08053893271795008, "mean_env_wait_ms": 4.933301477667345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034112930297851562, "ViewRequirementAgentConnector_ms": 0.22985196113586426}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37886, "num_agent_steps_trained": 0, "num_env_steps_sampled": 37888, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.855998643878742, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 37888, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 37886, "timers": {"training_iteration_time_ms": 49715.108, "sample_time_ms": 7106.672, "synch_weights_time_ms": 82.639}, "counters": {"num_env_steps_sampled": 37888, "num_env_steps_trained": 0, "num_agent_steps_sampled": 37886, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 601, "training_iteration": 37, "trial_id": "default", "date": "2025-12-20_11-17-37", "timestamp": 1766200657, "time_this_iter_s": 49.10480260848999, "time_total_s": 1845.1533427238464, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1845.1533427238464, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 73.12682926829268, "ram_util_percent": 14.200000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.738579411804676}, "default_policy": {"total_loss": 0.738579411804676, "policy_loss": -0.024712713225744663, "vf_loss": 3.0694005489349365, "vf_loss_unclipped": 7.721623253822327, "vf_explained_var": 0.5885050743818283, "entropy": 0.9380198433995247, "mean_kl_loss": 0.011576016942490242, "gradients_default_optimizer_global_norm": 0.9543439790606498, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.005440234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 38912, "num_env_steps_trained": 0, "num_agent_steps_sampled": 38910, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.686, "episode_reward_min": 10.033, "episode_reward_mean": 12.95419, "episode_len_mean": 49.57, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.150000000000004, 17.373, 14.203, 10.878, 14.383, 11.53, 12.502, 20.686, 11.738000000000001, 13.771, 14.779, 12.137, 11.110000000000001, 12.126999999999999, 12.040000000000001, 11.727, 11.834999999999999, 11.064, 17.796000000000006, 11.221, 13.020999999999999, 11.769, 15.108000000000004, 12.686, 10.962, 12.53, 11.277, 11.572999999999999, 11.299000000000001, 12.057, 13.087, 12.79, 11.581999999999999, 14.885000000000002, 12.835, 13.232000000000001, 10.825000000000001, 11.876, 17.253, 13.235, 12.323, 13.327, 11.187, 12.396, 13.988999999999999, 12.868, 12.669, 12.476, 13.818000000000001, 12.547999999999998, 10.54, 11.056999999999999, 10.572000000000001, 12.602, 11.052999999999999, 14.583000000000006, 11.796000000000001, 12.286, 13.211000000000002, 11.181, 14.723, 14.296, 12.294, 14.376000000000001, 11.088999999999999, 12.059, 11.667000000000002, 12.954, 12.383, 11.985999999999999, 20.55900000000001, 10.885, 11.996999999999998, 11.86, 12.030999999999999, 13.935, 14.337, 11.496, 12.943999999999999, 12.506999999999998, 18.470999999999997, 13.975999999999999, 13.855, 14.708000000000002, 15.315999999999999, 12.169, 11.669, 12.353, 15.058, 12.779, 13.449000000000002, 11.152999999999999, 10.033, 13.528000000000002, 12.866000000000001, 13.275000000000002, 12.227, 13.767000000000001, 13.303, 12.672], "episode_lengths": [58, 71, 53, 41, 52, 47, 51, 91, 45, 59, 54, 44, 46, 43, 46, 48, 44, 41, 82, 44, 45, 41, 55, 43, 38, 47, 39, 52, 42, 49, 47, 44, 42, 64, 43, 50, 41, 40, 68, 45, 49, 44, 39, 42, 67, 46, 47, 37, 56, 52, 38, 36, 40, 47, 39, 54, 48, 42, 51, 41, 66, 66, 42, 62, 40, 51, 40, 49, 44, 40, 124, 43, 42, 40, 44, 45, 51, 42, 46, 54, 81, 62, 50, 55, 56, 39, 38, 51, 54, 49, 45, 40, 39, 54, 53, 51, 44, 53, 54, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5033272126932787, "mean_inference_ms": 1.4016975751248932, "mean_action_processing_ms": 0.08054339844595376, "mean_env_wait_ms": 4.933046503732361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033905506134033203, "ViewRequirementAgentConnector_ms": 0.22951817512512207}}, "episode_reward_max": 20.686, "episode_reward_min": 10.033, "episode_reward_mean": 12.95419, "episode_len_mean": 49.57, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.150000000000004, 17.373, 14.203, 10.878, 14.383, 11.53, 12.502, 20.686, 11.738000000000001, 13.771, 14.779, 12.137, 11.110000000000001, 12.126999999999999, 12.040000000000001, 11.727, 11.834999999999999, 11.064, 17.796000000000006, 11.221, 13.020999999999999, 11.769, 15.108000000000004, 12.686, 10.962, 12.53, 11.277, 11.572999999999999, 11.299000000000001, 12.057, 13.087, 12.79, 11.581999999999999, 14.885000000000002, 12.835, 13.232000000000001, 10.825000000000001, 11.876, 17.253, 13.235, 12.323, 13.327, 11.187, 12.396, 13.988999999999999, 12.868, 12.669, 12.476, 13.818000000000001, 12.547999999999998, 10.54, 11.056999999999999, 10.572000000000001, 12.602, 11.052999999999999, 14.583000000000006, 11.796000000000001, 12.286, 13.211000000000002, 11.181, 14.723, 14.296, 12.294, 14.376000000000001, 11.088999999999999, 12.059, 11.667000000000002, 12.954, 12.383, 11.985999999999999, 20.55900000000001, 10.885, 11.996999999999998, 11.86, 12.030999999999999, 13.935, 14.337, 11.496, 12.943999999999999, 12.506999999999998, 18.470999999999997, 13.975999999999999, 13.855, 14.708000000000002, 15.315999999999999, 12.169, 11.669, 12.353, 15.058, 12.779, 13.449000000000002, 11.152999999999999, 10.033, 13.528000000000002, 12.866000000000001, 13.275000000000002, 12.227, 13.767000000000001, 13.303, 12.672], "episode_lengths": [58, 71, 53, 41, 52, 47, 51, 91, 45, 59, 54, 44, 46, 43, 46, 48, 44, 41, 82, 44, 45, 41, 55, 43, 38, 47, 39, 52, 42, 49, 47, 44, 42, 64, 43, 50, 41, 40, 68, 45, 49, 44, 39, 42, 67, 46, 47, 37, 56, 52, 38, 36, 40, 47, 39, 54, 48, 42, 51, 41, 66, 66, 42, 62, 40, 51, 40, 49, 44, 40, 124, 43, 42, 40, 44, 45, 51, 42, 46, 54, 81, 62, 50, 55, 56, 39, 38, 51, 54, 49, 45, 40, 39, 54, 53, 51, 44, 53, 54, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5033272126932787, "mean_inference_ms": 1.4016975751248932, "mean_action_processing_ms": 0.08054339844595376, "mean_env_wait_ms": 4.933046503732361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0033905506134033203, "ViewRequirementAgentConnector_ms": 0.22951817512512207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38910, "num_agent_steps_trained": 0, "num_env_steps_sampled": 38912, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.346109503614105, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 38912, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 38910, "timers": {"training_iteration_time_ms": 49810.455, "sample_time_ms": 7107.41, "synch_weights_time_ms": 81.409}, "counters": {"num_env_steps_sampled": 38912, "num_env_steps_trained": 0, "num_agent_steps_sampled": 38910, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 621, "training_iteration": 38, "trial_id": "default", "date": "2025-12-20_11-18-28", "timestamp": 1766200708, "time_this_iter_s": 50.33310294151306, "time_total_s": 1895.4864456653595, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1895.4864456653595, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 85.74507042253522, "ram_util_percent": 14.200000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7432643920183182}, "default_policy": {"total_loss": 0.7432643920183182, "policy_loss": -0.028194758191239087, "vf_loss": 3.0991832852363586, "vf_loss_unclipped": 7.772454309463501, "vf_explained_var": 0.5241824463009834, "entropy": 0.8421057596802711, "mean_kl_loss": 0.012445807731182867, "gradients_default_optimizer_global_norm": 0.8114616267383099, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.005320234375000001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 39936, "num_env_steps_trained": 0, "num_agent_steps_sampled": 39934, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 20.55900000000001, "episode_reward_min": 10.033, "episode_reward_mean": 12.69257, "episode_len_mean": 48.49, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.769, 15.108000000000004, 12.686, 10.962, 12.53, 11.277, 11.572999999999999, 11.299000000000001, 12.057, 13.087, 12.79, 11.581999999999999, 14.885000000000002, 12.835, 13.232000000000001, 10.825000000000001, 11.876, 17.253, 13.235, 12.323, 13.327, 11.187, 12.396, 13.988999999999999, 12.868, 12.669, 12.476, 13.818000000000001, 12.547999999999998, 10.54, 11.056999999999999, 10.572000000000001, 12.602, 11.052999999999999, 14.583000000000006, 11.796000000000001, 12.286, 13.211000000000002, 11.181, 14.723, 14.296, 12.294, 14.376000000000001, 11.088999999999999, 12.059, 11.667000000000002, 12.954, 12.383, 11.985999999999999, 20.55900000000001, 10.885, 11.996999999999998, 11.86, 12.030999999999999, 13.935, 14.337, 11.496, 12.943999999999999, 12.506999999999998, 18.470999999999997, 13.975999999999999, 13.855, 14.708000000000002, 15.315999999999999, 12.169, 11.669, 12.353, 15.058, 12.779, 13.449000000000002, 11.152999999999999, 10.033, 13.528000000000002, 12.866000000000001, 13.275000000000002, 12.227, 13.767000000000001, 13.303, 12.672, 11.184, 11.985000000000001, 11.75, 11.603, 13.668000000000001, 10.76, 15.212, 13.083, 10.542, 11.459, 12.136000000000001, 13.105, 10.66, 10.581, 11.823, 12.372, 12.275, 12.458, 13.028, 13.797, 11.427999999999999], "episode_lengths": [41, 55, 43, 38, 47, 39, 52, 42, 49, 47, 44, 42, 64, 43, 50, 41, 40, 68, 45, 49, 44, 39, 42, 67, 46, 47, 37, 56, 52, 38, 36, 40, 47, 39, 54, 48, 42, 51, 41, 66, 66, 42, 62, 40, 51, 40, 49, 44, 40, 124, 43, 42, 40, 44, 45, 51, 42, 46, 54, 81, 62, 50, 55, 56, 39, 38, 51, 54, 49, 45, 40, 39, 54, 53, 51, 44, 53, 54, 48, 42, 38, 48, 47, 54, 41, 66, 64, 38, 39, 47, 48, 39, 43, 42, 42, 52, 51, 44, 65, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5040831400721896, "mean_inference_ms": 1.401306009307161, "mean_action_processing_ms": 0.08052772158038458, "mean_env_wait_ms": 4.932030311431884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003394603729248047, "ViewRequirementAgentConnector_ms": 0.23039531707763672}}, "episode_reward_max": 20.55900000000001, "episode_reward_min": 10.033, "episode_reward_mean": 12.69257, "episode_len_mean": 48.49, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.769, 15.108000000000004, 12.686, 10.962, 12.53, 11.277, 11.572999999999999, 11.299000000000001, 12.057, 13.087, 12.79, 11.581999999999999, 14.885000000000002, 12.835, 13.232000000000001, 10.825000000000001, 11.876, 17.253, 13.235, 12.323, 13.327, 11.187, 12.396, 13.988999999999999, 12.868, 12.669, 12.476, 13.818000000000001, 12.547999999999998, 10.54, 11.056999999999999, 10.572000000000001, 12.602, 11.052999999999999, 14.583000000000006, 11.796000000000001, 12.286, 13.211000000000002, 11.181, 14.723, 14.296, 12.294, 14.376000000000001, 11.088999999999999, 12.059, 11.667000000000002, 12.954, 12.383, 11.985999999999999, 20.55900000000001, 10.885, 11.996999999999998, 11.86, 12.030999999999999, 13.935, 14.337, 11.496, 12.943999999999999, 12.506999999999998, 18.470999999999997, 13.975999999999999, 13.855, 14.708000000000002, 15.315999999999999, 12.169, 11.669, 12.353, 15.058, 12.779, 13.449000000000002, 11.152999999999999, 10.033, 13.528000000000002, 12.866000000000001, 13.275000000000002, 12.227, 13.767000000000001, 13.303, 12.672, 11.184, 11.985000000000001, 11.75, 11.603, 13.668000000000001, 10.76, 15.212, 13.083, 10.542, 11.459, 12.136000000000001, 13.105, 10.66, 10.581, 11.823, 12.372, 12.275, 12.458, 13.028, 13.797, 11.427999999999999], "episode_lengths": [41, 55, 43, 38, 47, 39, 52, 42, 49, 47, 44, 42, 64, 43, 50, 41, 40, 68, 45, 49, 44, 39, 42, 67, 46, 47, 37, 56, 52, 38, 36, 40, 47, 39, 54, 48, 42, 51, 41, 66, 66, 42, 62, 40, 51, 40, 49, 44, 40, 124, 43, 42, 40, 44, 45, 51, 42, 46, 54, 81, 62, 50, 55, 56, 39, 38, 51, 54, 49, 45, 40, 39, 54, 53, 51, 44, 53, 54, 48, 42, 38, 48, 47, 54, 41, 66, 64, 38, 39, 47, 48, 39, 43, 42, 42, 52, 51, 44, 65, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5040831400721896, "mean_inference_ms": 1.401306009307161, "mean_action_processing_ms": 0.08052772158038458, "mean_env_wait_ms": 4.932030311431884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003394603729248047, "ViewRequirementAgentConnector_ms": 0.23039531707763672}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39934, "num_agent_steps_trained": 0, "num_env_steps_sampled": 39936, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.448016822442543, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 39936, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 39934, "timers": {"training_iteration_time_ms": 49827.269, "sample_time_ms": 7108.751, "synch_weights_time_ms": 81.493}, "counters": {"num_env_steps_sampled": 39936, "num_env_steps_trained": 0, "num_agent_steps_sampled": 39934, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 642, "training_iteration": 39, "trial_id": "default", "date": "2025-12-20_11-19-18", "timestamp": 1766200758, "time_this_iter_s": 50.084580421447754, "time_total_s": 1945.5710260868073, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1945.5710260868073, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 85.95416666666665, "ram_util_percent": 14.200000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6912632547318935}, "default_policy": {"total_loss": 0.6912632547318935, "policy_loss": -0.02809935500845313, "vf_loss": 2.8889628827571867, "vf_loss_unclipped": 6.791722846031189, "vf_explained_var": 0.5969689548015594, "entropy": 0.8554873421788216, "mean_kl_loss": 0.016732892908203213, "gradients_default_optimizer_global_norm": 0.8009835839271545, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.005200234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40958, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 21.376999999999995, "episode_reward_min": 10.033, "episode_reward_mean": 12.600839999999998, "episode_len_mean": 48.57, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.988999999999999, 12.868, 12.669, 12.476, 13.818000000000001, 12.547999999999998, 10.54, 11.056999999999999, 10.572000000000001, 12.602, 11.052999999999999, 14.583000000000006, 11.796000000000001, 12.286, 13.211000000000002, 11.181, 14.723, 14.296, 12.294, 14.376000000000001, 11.088999999999999, 12.059, 11.667000000000002, 12.954, 12.383, 11.985999999999999, 20.55900000000001, 10.885, 11.996999999999998, 11.86, 12.030999999999999, 13.935, 14.337, 11.496, 12.943999999999999, 12.506999999999998, 18.470999999999997, 13.975999999999999, 13.855, 14.708000000000002, 15.315999999999999, 12.169, 11.669, 12.353, 15.058, 12.779, 13.449000000000002, 11.152999999999999, 10.033, 13.528000000000002, 12.866000000000001, 13.275000000000002, 12.227, 13.767000000000001, 13.303, 12.672, 11.184, 11.985000000000001, 11.75, 11.603, 13.668000000000001, 10.76, 15.212, 13.083, 10.542, 11.459, 12.136000000000001, 13.105, 10.66, 10.581, 11.823, 12.372, 12.275, 12.458, 13.028, 13.797, 11.427999999999999, 11.761, 11.056000000000001, 11.608, 12.676000000000002, 11.835, 10.471, 10.443999999999999, 21.376999999999995, 11.526, 12.245999999999999, 12.841000000000001, 11.709, 11.855, 11.428, 12.754999999999999, 10.885, 10.12, 13.158000000000001, 14.708000000000002, 13.503, 11.215000000000002, 10.979999999999999, 10.764], "episode_lengths": [67, 46, 47, 37, 56, 52, 38, 36, 40, 47, 39, 54, 48, 42, 51, 41, 66, 66, 42, 62, 40, 51, 40, 49, 44, 40, 124, 43, 42, 40, 44, 45, 51, 42, 46, 54, 81, 62, 50, 55, 56, 39, 38, 51, 54, 49, 45, 40, 39, 54, 53, 51, 44, 53, 54, 48, 42, 38, 48, 47, 54, 41, 66, 64, 38, 39, 47, 48, 39, 43, 42, 42, 52, 51, 44, 65, 47, 47, 41, 45, 43, 47, 38, 38, 109, 50, 40, 44, 42, 50, 36, 45, 41, 37, 48, 62, 52, 35, 41, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5049191481019387, "mean_inference_ms": 1.400921936448128, "mean_action_processing_ms": 0.0805114591859646, "mean_env_wait_ms": 4.930881093952592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003414154052734375, "ViewRequirementAgentConnector_ms": 0.23288178443908691}}, "episode_reward_max": 21.376999999999995, "episode_reward_min": 10.033, "episode_reward_mean": 12.600839999999998, "episode_len_mean": 48.57, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.988999999999999, 12.868, 12.669, 12.476, 13.818000000000001, 12.547999999999998, 10.54, 11.056999999999999, 10.572000000000001, 12.602, 11.052999999999999, 14.583000000000006, 11.796000000000001, 12.286, 13.211000000000002, 11.181, 14.723, 14.296, 12.294, 14.376000000000001, 11.088999999999999, 12.059, 11.667000000000002, 12.954, 12.383, 11.985999999999999, 20.55900000000001, 10.885, 11.996999999999998, 11.86, 12.030999999999999, 13.935, 14.337, 11.496, 12.943999999999999, 12.506999999999998, 18.470999999999997, 13.975999999999999, 13.855, 14.708000000000002, 15.315999999999999, 12.169, 11.669, 12.353, 15.058, 12.779, 13.449000000000002, 11.152999999999999, 10.033, 13.528000000000002, 12.866000000000001, 13.275000000000002, 12.227, 13.767000000000001, 13.303, 12.672, 11.184, 11.985000000000001, 11.75, 11.603, 13.668000000000001, 10.76, 15.212, 13.083, 10.542, 11.459, 12.136000000000001, 13.105, 10.66, 10.581, 11.823, 12.372, 12.275, 12.458, 13.028, 13.797, 11.427999999999999, 11.761, 11.056000000000001, 11.608, 12.676000000000002, 11.835, 10.471, 10.443999999999999, 21.376999999999995, 11.526, 12.245999999999999, 12.841000000000001, 11.709, 11.855, 11.428, 12.754999999999999, 10.885, 10.12, 13.158000000000001, 14.708000000000002, 13.503, 11.215000000000002, 10.979999999999999, 10.764], "episode_lengths": [67, 46, 47, 37, 56, 52, 38, 36, 40, 47, 39, 54, 48, 42, 51, 41, 66, 66, 42, 62, 40, 51, 40, 49, 44, 40, 124, 43, 42, 40, 44, 45, 51, 42, 46, 54, 81, 62, 50, 55, 56, 39, 38, 51, 54, 49, 45, 40, 39, 54, 53, 51, 44, 53, 54, 48, 42, 38, 48, 47, 54, 41, 66, 64, 38, 39, 47, 48, 39, 43, 42, 42, 52, 51, 44, 65, 47, 47, 41, 45, 43, 47, 38, 38, 109, 50, 40, 44, 42, 50, 36, 45, 41, 37, 48, 62, 52, 35, 41, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5049191481019387, "mean_inference_ms": 1.400921936448128, "mean_action_processing_ms": 0.0805114591859646, "mean_env_wait_ms": 4.930881093952592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003414154052734375, "ViewRequirementAgentConnector_ms": 0.23288178443908691}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40958, "num_agent_steps_trained": 0, "num_env_steps_sampled": 40960, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.339359112853572, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 40960, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 40958, "timers": {"training_iteration_time_ms": 49931.053, "sample_time_ms": 7107.718, "synch_weights_time_ms": 81.131}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40958, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 665, "training_iteration": 40, "trial_id": "default", "date": "2025-12-20_11-20-08", "timestamp": 1766200808, "time_this_iter_s": 50.34866261482239, "time_total_s": 1995.9196887016296, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1995.9196887016296, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 85.73239436619718, "ram_util_percent": 14.200000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8127993829548359}, "default_policy": {"total_loss": 0.8127993829548359, "policy_loss": -0.029002725891768933, "vf_loss": 3.3801175534725187, "vf_loss_unclipped": 9.229853641986846, "vf_explained_var": 0.38103986233472825, "entropy": 0.8312028929591179, "mean_kl_loss": 0.010951802603449324, "gradients_default_optimizer_global_norm": 0.9230237126350402, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.005080234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 41984, "num_env_steps_trained": 0, "num_agent_steps_sampled": 41982, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 21.376999999999995, "episode_reward_min": 10.033, "episode_reward_mean": 12.56413, "episode_len_mean": 48.61, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.088999999999999, 12.059, 11.667000000000002, 12.954, 12.383, 11.985999999999999, 20.55900000000001, 10.885, 11.996999999999998, 11.86, 12.030999999999999, 13.935, 14.337, 11.496, 12.943999999999999, 12.506999999999998, 18.470999999999997, 13.975999999999999, 13.855, 14.708000000000002, 15.315999999999999, 12.169, 11.669, 12.353, 15.058, 12.779, 13.449000000000002, 11.152999999999999, 10.033, 13.528000000000002, 12.866000000000001, 13.275000000000002, 12.227, 13.767000000000001, 13.303, 12.672, 11.184, 11.985000000000001, 11.75, 11.603, 13.668000000000001, 10.76, 15.212, 13.083, 10.542, 11.459, 12.136000000000001, 13.105, 10.66, 10.581, 11.823, 12.372, 12.275, 12.458, 13.028, 13.797, 11.427999999999999, 11.761, 11.056000000000001, 11.608, 12.676000000000002, 11.835, 10.471, 10.443999999999999, 21.376999999999995, 11.526, 12.245999999999999, 12.841000000000001, 11.709, 11.855, 11.428, 12.754999999999999, 10.885, 10.12, 13.158000000000001, 14.708000000000002, 13.503, 11.215000000000002, 10.979999999999999, 10.764, 13.455, 10.548, 13.718, 10.431999999999999, 12.781, 11.488, 11.405, 14.700000000000003, 10.968, 12.509, 14.729000000000001, 11.927, 13.458, 11.603, 16.925, 14.854, 10.739, 12.341000000000001, 10.633, 10.053999999999998], "episode_lengths": [40, 51, 40, 49, 44, 40, 124, 43, 42, 40, 44, 45, 51, 42, 46, 54, 81, 62, 50, 55, 56, 39, 38, 51, 54, 49, 45, 40, 39, 54, 53, 51, 44, 53, 54, 48, 42, 38, 48, 47, 54, 41, 66, 64, 38, 39, 47, 48, 39, 43, 42, 42, 52, 51, 44, 65, 47, 47, 41, 45, 43, 47, 38, 38, 109, 50, 40, 44, 42, 50, 36, 45, 41, 37, 48, 62, 52, 35, 41, 41, 64, 37, 53, 39, 55, 44, 48, 61, 40, 55, 50, 45, 48, 44, 76, 57, 40, 47, 37, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5056055769609887, "mean_inference_ms": 1.4008589603736659, "mean_action_processing_ms": 0.0805247198602378, "mean_env_wait_ms": 4.930759553934312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034449100494384766, "ViewRequirementAgentConnector_ms": 0.23301076889038086}}, "episode_reward_max": 21.376999999999995, "episode_reward_min": 10.033, "episode_reward_mean": 12.56413, "episode_len_mean": 48.61, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.088999999999999, 12.059, 11.667000000000002, 12.954, 12.383, 11.985999999999999, 20.55900000000001, 10.885, 11.996999999999998, 11.86, 12.030999999999999, 13.935, 14.337, 11.496, 12.943999999999999, 12.506999999999998, 18.470999999999997, 13.975999999999999, 13.855, 14.708000000000002, 15.315999999999999, 12.169, 11.669, 12.353, 15.058, 12.779, 13.449000000000002, 11.152999999999999, 10.033, 13.528000000000002, 12.866000000000001, 13.275000000000002, 12.227, 13.767000000000001, 13.303, 12.672, 11.184, 11.985000000000001, 11.75, 11.603, 13.668000000000001, 10.76, 15.212, 13.083, 10.542, 11.459, 12.136000000000001, 13.105, 10.66, 10.581, 11.823, 12.372, 12.275, 12.458, 13.028, 13.797, 11.427999999999999, 11.761, 11.056000000000001, 11.608, 12.676000000000002, 11.835, 10.471, 10.443999999999999, 21.376999999999995, 11.526, 12.245999999999999, 12.841000000000001, 11.709, 11.855, 11.428, 12.754999999999999, 10.885, 10.12, 13.158000000000001, 14.708000000000002, 13.503, 11.215000000000002, 10.979999999999999, 10.764, 13.455, 10.548, 13.718, 10.431999999999999, 12.781, 11.488, 11.405, 14.700000000000003, 10.968, 12.509, 14.729000000000001, 11.927, 13.458, 11.603, 16.925, 14.854, 10.739, 12.341000000000001, 10.633, 10.053999999999998], "episode_lengths": [40, 51, 40, 49, 44, 40, 124, 43, 42, 40, 44, 45, 51, 42, 46, 54, 81, 62, 50, 55, 56, 39, 38, 51, 54, 49, 45, 40, 39, 54, 53, 51, 44, 53, 54, 48, 42, 38, 48, 47, 54, 41, 66, 64, 38, 39, 47, 48, 39, 43, 42, 42, 52, 51, 44, 65, 47, 47, 41, 45, 43, 47, 38, 38, 109, 50, 40, 44, 42, 50, 36, 45, 41, 37, 48, 62, 52, 35, 41, 41, 64, 37, 53, 39, 55, 44, 48, 61, 40, 55, 50, 45, 48, 44, 76, 57, 40, 47, 37, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5056055769609887, "mean_inference_ms": 1.4008589603736659, "mean_action_processing_ms": 0.0805247198602378, "mean_env_wait_ms": 4.930759553934312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034449100494384766, "ViewRequirementAgentConnector_ms": 0.23301076889038086}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41982, "num_agent_steps_trained": 0, "num_env_steps_sampled": 41984, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.53882600525156, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 41984, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 41982, "timers": {"training_iteration_time_ms": 49971.612, "sample_time_ms": 7109.06, "synch_weights_time_ms": 78.42}, "counters": {"num_env_steps_sampled": 41984, "num_env_steps_trained": 0, "num_agent_steps_sampled": 41982, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 685, "training_iteration": 41, "trial_id": "default", "date": "2025-12-20_11-20-58", "timestamp": 1766200858, "time_this_iter_s": 49.85961127281189, "time_total_s": 2045.7792999744415, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2045.7792999744415, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 85.8042253521127, "ram_util_percent": 14.200000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.787338687479496}, "default_policy": {"total_loss": 0.787338687479496, "policy_loss": -0.020840266917366533, "vf_loss": 3.2416074514389037, "vf_loss_unclipped": 9.321513092517852, "vf_explained_var": 0.4481531396508217, "entropy": 0.6734089970588684, "mean_kl_loss": 0.01198157235699, "gradients_default_optimizer_global_norm": 0.8115712732076645, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.004960234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 0, "num_agent_steps_sampled": 43006, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 21.376999999999995, "episode_reward_min": 9.918, "episode_reward_mean": 11.974140000000002, "episode_len_mean": 45.92, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.449000000000002, 11.152999999999999, 10.033, 13.528000000000002, 12.866000000000001, 13.275000000000002, 12.227, 13.767000000000001, 13.303, 12.672, 11.184, 11.985000000000001, 11.75, 11.603, 13.668000000000001, 10.76, 15.212, 13.083, 10.542, 11.459, 12.136000000000001, 13.105, 10.66, 10.581, 11.823, 12.372, 12.275, 12.458, 13.028, 13.797, 11.427999999999999, 11.761, 11.056000000000001, 11.608, 12.676000000000002, 11.835, 10.471, 10.443999999999999, 21.376999999999995, 11.526, 12.245999999999999, 12.841000000000001, 11.709, 11.855, 11.428, 12.754999999999999, 10.885, 10.12, 13.158000000000001, 14.708000000000002, 13.503, 11.215000000000002, 10.979999999999999, 10.764, 13.455, 10.548, 13.718, 10.431999999999999, 12.781, 11.488, 11.405, 14.700000000000003, 10.968, 12.509, 14.729000000000001, 11.927, 13.458, 11.603, 16.925, 14.854, 10.739, 12.341000000000001, 10.633, 10.053999999999998, 10.917, 12.787000000000003, 10.588, 10.948, 10.806, 10.623, 9.918, 12.3, 10.715, 10.858, 10.149000000000001, 10.359, 12.126, 12.290000000000001, 10.036, 11.120999999999999, 10.323, 10.849, 12.228, 10.642999999999999, 11.782, 10.171000000000001, 12.010000000000002, 10.631, 10.683, 10.183], "episode_lengths": [45, 40, 39, 54, 53, 51, 44, 53, 54, 48, 42, 38, 48, 47, 54, 41, 66, 64, 38, 39, 47, 48, 39, 43, 42, 42, 52, 51, 44, 65, 47, 47, 41, 45, 43, 47, 38, 38, 109, 50, 40, 44, 42, 50, 36, 45, 41, 37, 48, 62, 52, 35, 41, 41, 64, 37, 53, 39, 55, 44, 48, 61, 40, 55, 50, 45, 48, 44, 76, 57, 40, 47, 37, 41, 35, 50, 45, 40, 38, 38, 36, 42, 34, 40, 40, 42, 48, 48, 39, 35, 37, 39, 48, 39, 43, 41, 47, 36, 48, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5065490838148756, "mean_inference_ms": 1.400219325211753, "mean_action_processing_ms": 0.08048893803069188, "mean_env_wait_ms": 4.928774908962837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003465414047241211, "ViewRequirementAgentConnector_ms": 0.23355650901794434}}, "episode_reward_max": 21.376999999999995, "episode_reward_min": 9.918, "episode_reward_mean": 11.974140000000002, "episode_len_mean": 45.92, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.449000000000002, 11.152999999999999, 10.033, 13.528000000000002, 12.866000000000001, 13.275000000000002, 12.227, 13.767000000000001, 13.303, 12.672, 11.184, 11.985000000000001, 11.75, 11.603, 13.668000000000001, 10.76, 15.212, 13.083, 10.542, 11.459, 12.136000000000001, 13.105, 10.66, 10.581, 11.823, 12.372, 12.275, 12.458, 13.028, 13.797, 11.427999999999999, 11.761, 11.056000000000001, 11.608, 12.676000000000002, 11.835, 10.471, 10.443999999999999, 21.376999999999995, 11.526, 12.245999999999999, 12.841000000000001, 11.709, 11.855, 11.428, 12.754999999999999, 10.885, 10.12, 13.158000000000001, 14.708000000000002, 13.503, 11.215000000000002, 10.979999999999999, 10.764, 13.455, 10.548, 13.718, 10.431999999999999, 12.781, 11.488, 11.405, 14.700000000000003, 10.968, 12.509, 14.729000000000001, 11.927, 13.458, 11.603, 16.925, 14.854, 10.739, 12.341000000000001, 10.633, 10.053999999999998, 10.917, 12.787000000000003, 10.588, 10.948, 10.806, 10.623, 9.918, 12.3, 10.715, 10.858, 10.149000000000001, 10.359, 12.126, 12.290000000000001, 10.036, 11.120999999999999, 10.323, 10.849, 12.228, 10.642999999999999, 11.782, 10.171000000000001, 12.010000000000002, 10.631, 10.683, 10.183], "episode_lengths": [45, 40, 39, 54, 53, 51, 44, 53, 54, 48, 42, 38, 48, 47, 54, 41, 66, 64, 38, 39, 47, 48, 39, 43, 42, 42, 52, 51, 44, 65, 47, 47, 41, 45, 43, 47, 38, 38, 109, 50, 40, 44, 42, 50, 36, 45, 41, 37, 48, 62, 52, 35, 41, 41, 64, 37, 53, 39, 55, 44, 48, 61, 40, 55, 50, 45, 48, 44, 76, 57, 40, 47, 37, 41, 35, 50, 45, 40, 38, 38, 36, 42, 34, 40, 40, 42, 48, 48, 39, 35, 37, 39, 48, 39, 43, 41, 47, 36, 48, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5065490838148756, "mean_inference_ms": 1.400219325211753, "mean_action_processing_ms": 0.08048893803069188, "mean_env_wait_ms": 4.928774908962837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003465414047241211, "ViewRequirementAgentConnector_ms": 0.23355650901794434}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43006, "num_agent_steps_trained": 0, "num_env_steps_sampled": 43008, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.61479476673203, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 43008, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 43006, "timers": {"training_iteration_time_ms": 50000.341, "sample_time_ms": 7107.326, "synch_weights_time_ms": 76.942}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 0, "num_agent_steps_sampled": 43006, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 711, "training_iteration": 42, "trial_id": "default", "date": "2025-12-20_11-21-55", "timestamp": 1766200915, "time_this_iter_s": 49.67635750770569, "time_total_s": 2095.455657482147, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2095.455657482147, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 75.54814814814814, "ram_util_percent": 14.200000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7131263181567192}, "default_policy": {"total_loss": 0.7131263181567192, "policy_loss": -0.02058183215558529, "vf_loss": 2.9455192744731904, "vf_loss_unclipped": 8.079479777812958, "vf_explained_var": 0.5397520065307617, "entropy": 0.7134368121623993, "mean_kl_loss": 0.008671580866126693, "gradients_default_optimizer_global_norm": 1.1445940271019936, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.004840234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 44032, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44030, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 29.979000000000028, "episode_reward_min": 9.918, "episode_reward_mean": 11.857249999999999, "episode_len_mean": 45.4, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.66, 10.581, 11.823, 12.372, 12.275, 12.458, 13.028, 13.797, 11.427999999999999, 11.761, 11.056000000000001, 11.608, 12.676000000000002, 11.835, 10.471, 10.443999999999999, 21.376999999999995, 11.526, 12.245999999999999, 12.841000000000001, 11.709, 11.855, 11.428, 12.754999999999999, 10.885, 10.12, 13.158000000000001, 14.708000000000002, 13.503, 11.215000000000002, 10.979999999999999, 10.764, 13.455, 10.548, 13.718, 10.431999999999999, 12.781, 11.488, 11.405, 14.700000000000003, 10.968, 12.509, 14.729000000000001, 11.927, 13.458, 11.603, 16.925, 14.854, 10.739, 12.341000000000001, 10.633, 10.053999999999998, 10.917, 12.787000000000003, 10.588, 10.948, 10.806, 10.623, 9.918, 12.3, 10.715, 10.858, 10.149000000000001, 10.359, 12.126, 12.290000000000001, 10.036, 11.120999999999999, 10.323, 10.849, 12.228, 10.642999999999999, 11.782, 10.171000000000001, 12.010000000000002, 10.631, 10.683, 10.183, 11.421, 10.289000000000001, 10.195, 10.248999999999999, 12.957, 10.947000000000001, 10.362, 10.957, 11.193, 12.848, 10.457, 10.011, 10.226, 11.679, 11.676, 11.926, 11.051, 10.208, 11.096999999999998, 29.979000000000028, 10.629, 10.713999999999999], "episode_lengths": [39, 43, 42, 42, 52, 51, 44, 65, 47, 47, 41, 45, 43, 47, 38, 38, 109, 50, 40, 44, 42, 50, 36, 45, 41, 37, 48, 62, 52, 35, 41, 41, 64, 37, 53, 39, 55, 44, 48, 61, 40, 55, 50, 45, 48, 44, 76, 57, 40, 47, 37, 41, 35, 50, 45, 40, 38, 38, 36, 42, 34, 40, 40, 42, 48, 48, 39, 35, 37, 39, 48, 39, 43, 41, 47, 36, 48, 33, 43, 34, 35, 42, 50, 39, 31, 41, 43, 50, 40, 36, 38, 44, 39, 53, 41, 37, 44, 151, 35, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5074440229321273, "mean_inference_ms": 1.4002748888902135, "mean_action_processing_ms": 0.08050904836019729, "mean_env_wait_ms": 4.928806706672616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003464221954345703, "ViewRequirementAgentConnector_ms": 0.23280668258666992}}, "episode_reward_max": 29.979000000000028, "episode_reward_min": 9.918, "episode_reward_mean": 11.857249999999999, "episode_len_mean": 45.4, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.66, 10.581, 11.823, 12.372, 12.275, 12.458, 13.028, 13.797, 11.427999999999999, 11.761, 11.056000000000001, 11.608, 12.676000000000002, 11.835, 10.471, 10.443999999999999, 21.376999999999995, 11.526, 12.245999999999999, 12.841000000000001, 11.709, 11.855, 11.428, 12.754999999999999, 10.885, 10.12, 13.158000000000001, 14.708000000000002, 13.503, 11.215000000000002, 10.979999999999999, 10.764, 13.455, 10.548, 13.718, 10.431999999999999, 12.781, 11.488, 11.405, 14.700000000000003, 10.968, 12.509, 14.729000000000001, 11.927, 13.458, 11.603, 16.925, 14.854, 10.739, 12.341000000000001, 10.633, 10.053999999999998, 10.917, 12.787000000000003, 10.588, 10.948, 10.806, 10.623, 9.918, 12.3, 10.715, 10.858, 10.149000000000001, 10.359, 12.126, 12.290000000000001, 10.036, 11.120999999999999, 10.323, 10.849, 12.228, 10.642999999999999, 11.782, 10.171000000000001, 12.010000000000002, 10.631, 10.683, 10.183, 11.421, 10.289000000000001, 10.195, 10.248999999999999, 12.957, 10.947000000000001, 10.362, 10.957, 11.193, 12.848, 10.457, 10.011, 10.226, 11.679, 11.676, 11.926, 11.051, 10.208, 11.096999999999998, 29.979000000000028, 10.629, 10.713999999999999], "episode_lengths": [39, 43, 42, 42, 52, 51, 44, 65, 47, 47, 41, 45, 43, 47, 38, 38, 109, 50, 40, 44, 42, 50, 36, 45, 41, 37, 48, 62, 52, 35, 41, 41, 64, 37, 53, 39, 55, 44, 48, 61, 40, 55, 50, 45, 48, 44, 76, 57, 40, 47, 37, 41, 35, 50, 45, 40, 38, 38, 36, 42, 34, 40, 40, 42, 48, 48, 39, 35, 37, 39, 48, 39, 43, 41, 47, 36, 48, 33, 43, 34, 35, 42, 50, 39, 31, 41, 43, 50, 40, 36, 38, 44, 39, 53, 41, 37, 44, 151, 35, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5074440229321273, "mean_inference_ms": 1.4002748888902135, "mean_action_processing_ms": 0.08050904836019729, "mean_env_wait_ms": 4.928806706672616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003464221954345703, "ViewRequirementAgentConnector_ms": 0.23280668258666992}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44030, "num_agent_steps_trained": 0, "num_env_steps_sampled": 44032, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.457617944555032, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 44032, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 44030, "timers": {"training_iteration_time_ms": 50028.186, "sample_time_ms": 7105.19, "synch_weights_time_ms": 76.558}, "counters": {"num_env_steps_sampled": 44032, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44030, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 733, "training_iteration": 43, "trial_id": "default", "date": "2025-12-20_11-22-45", "timestamp": 1766200965, "time_this_iter_s": 50.057560205459595, "time_total_s": 2145.513217687607, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2145.513217687607, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 85.84366197183097, "ram_util_percent": 14.200000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.63052898645401}, "default_policy": {"total_loss": 0.63052898645401, "policy_loss": -0.01979635809548199, "vf_loss": 2.610988217592239, "vf_loss_unclipped": 7.465599954128265, "vf_explained_var": 0.5916535183787346, "entropy": 0.6452307581901551, "mean_kl_loss": 0.007013732333052758, "gradients_default_optimizer_global_norm": 1.1793677382171155, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.004720234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 45056, "num_env_steps_trained": 0, "num_agent_steps_sampled": 45054, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 29.979000000000028, "episode_reward_min": 9.905000000000001, "episode_reward_mean": 11.597259999999999, "episode_len_mean": 43.73, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.158000000000001, 14.708000000000002, 13.503, 11.215000000000002, 10.979999999999999, 10.764, 13.455, 10.548, 13.718, 10.431999999999999, 12.781, 11.488, 11.405, 14.700000000000003, 10.968, 12.509, 14.729000000000001, 11.927, 13.458, 11.603, 16.925, 14.854, 10.739, 12.341000000000001, 10.633, 10.053999999999998, 10.917, 12.787000000000003, 10.588, 10.948, 10.806, 10.623, 9.918, 12.3, 10.715, 10.858, 10.149000000000001, 10.359, 12.126, 12.290000000000001, 10.036, 11.120999999999999, 10.323, 10.849, 12.228, 10.642999999999999, 11.782, 10.171000000000001, 12.010000000000002, 10.631, 10.683, 10.183, 11.421, 10.289000000000001, 10.195, 10.248999999999999, 12.957, 10.947000000000001, 10.362, 10.957, 11.193, 12.848, 10.457, 10.011, 10.226, 11.679, 11.676, 11.926, 11.051, 10.208, 11.096999999999998, 29.979000000000028, 10.629, 10.713999999999999, 12.777000000000001, 11.959, 10.338999999999999, 10.090000000000002, 12.316, 11.836, 10.994, 11.763, 10.231, 10.652000000000001, 10.928, 10.006, 11.43, 13.661, 11.399, 10.727, 10.726, 10.642, 10.232000000000001, 10.644, 13.449, 9.905000000000001, 10.946, 10.608, 10.052999999999999, 10.703000000000001], "episode_lengths": [48, 62, 52, 35, 41, 41, 64, 37, 53, 39, 55, 44, 48, 61, 40, 55, 50, 45, 48, 44, 76, 57, 40, 47, 37, 41, 35, 50, 45, 40, 38, 38, 36, 42, 34, 40, 40, 42, 48, 48, 39, 35, 37, 39, 48, 39, 43, 41, 47, 36, 48, 33, 43, 34, 35, 42, 50, 39, 31, 41, 43, 50, 40, 36, 38, 44, 39, 53, 41, 37, 44, 151, 35, 35, 54, 41, 39, 35, 50, 47, 45, 38, 39, 39, 36, 33, 36, 51, 42, 37, 38, 38, 38, 40, 47, 37, 39, 37, 39, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.508539956109282, "mean_inference_ms": 1.4002784329500226, "mean_action_processing_ms": 0.08053042569496575, "mean_env_wait_ms": 4.928807453739359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003479480743408203, "ViewRequirementAgentConnector_ms": 0.2306532859802246}}, "episode_reward_max": 29.979000000000028, "episode_reward_min": 9.905000000000001, "episode_reward_mean": 11.597259999999999, "episode_len_mean": 43.73, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.158000000000001, 14.708000000000002, 13.503, 11.215000000000002, 10.979999999999999, 10.764, 13.455, 10.548, 13.718, 10.431999999999999, 12.781, 11.488, 11.405, 14.700000000000003, 10.968, 12.509, 14.729000000000001, 11.927, 13.458, 11.603, 16.925, 14.854, 10.739, 12.341000000000001, 10.633, 10.053999999999998, 10.917, 12.787000000000003, 10.588, 10.948, 10.806, 10.623, 9.918, 12.3, 10.715, 10.858, 10.149000000000001, 10.359, 12.126, 12.290000000000001, 10.036, 11.120999999999999, 10.323, 10.849, 12.228, 10.642999999999999, 11.782, 10.171000000000001, 12.010000000000002, 10.631, 10.683, 10.183, 11.421, 10.289000000000001, 10.195, 10.248999999999999, 12.957, 10.947000000000001, 10.362, 10.957, 11.193, 12.848, 10.457, 10.011, 10.226, 11.679, 11.676, 11.926, 11.051, 10.208, 11.096999999999998, 29.979000000000028, 10.629, 10.713999999999999, 12.777000000000001, 11.959, 10.338999999999999, 10.090000000000002, 12.316, 11.836, 10.994, 11.763, 10.231, 10.652000000000001, 10.928, 10.006, 11.43, 13.661, 11.399, 10.727, 10.726, 10.642, 10.232000000000001, 10.644, 13.449, 9.905000000000001, 10.946, 10.608, 10.052999999999999, 10.703000000000001], "episode_lengths": [48, 62, 52, 35, 41, 41, 64, 37, 53, 39, 55, 44, 48, 61, 40, 55, 50, 45, 48, 44, 76, 57, 40, 47, 37, 41, 35, 50, 45, 40, 38, 38, 36, 42, 34, 40, 40, 42, 48, 48, 39, 35, 37, 39, 48, 39, 43, 41, 47, 36, 48, 33, 43, 34, 35, 42, 50, 39, 31, 41, 43, 50, 40, 36, 38, 44, 39, 53, 41, 37, 44, 151, 35, 35, 54, 41, 39, 35, 50, 47, 45, 38, 39, 39, 36, 33, 36, 51, 42, 37, 38, 38, 38, 40, 47, 37, 39, 37, 39, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.508539956109282, "mean_inference_ms": 1.4002784329500226, "mean_action_processing_ms": 0.08053042569496575, "mean_env_wait_ms": 4.928807453739359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003479480743408203, "ViewRequirementAgentConnector_ms": 0.2306532859802246}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45054, "num_agent_steps_trained": 0, "num_env_steps_sampled": 45056, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.54750330696524, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 45056, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 45054, "timers": {"training_iteration_time_ms": 50013.802, "sample_time_ms": 7109.162, "synch_weights_time_ms": 76.64}, "counters": {"num_env_steps_sampled": 45056, "num_env_steps_trained": 0, "num_agent_steps_sampled": 45054, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 759, "training_iteration": 44, "trial_id": "default", "date": "2025-12-20_11-23-35", "timestamp": 1766201015, "time_this_iter_s": 49.83882927894592, "time_total_s": 2195.3520469665527, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2195.3520469665527, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 85.84507042253519, "ram_util_percent": 14.200000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7749558553099632}, "default_policy": {"total_loss": 0.7749558553099632, "policy_loss": -0.018030533735873176, "vf_loss": 3.179711067676544, "vf_loss_unclipped": 9.625851786136627, "vf_explained_var": 0.4347798451781273, "entropy": 0.5497454211115838, "mean_kl_loss": 0.006535606965030638, "gradients_default_optimizer_global_norm": 1.1415909357368945, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.004600234375000001, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 46080, "num_env_steps_trained": 0, "num_agent_steps_sampled": 46078, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 29.979000000000028, "episode_reward_min": 9.875, "episode_reward_mean": 11.17763, "episode_len_mean": 41.33, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.917, 12.787000000000003, 10.588, 10.948, 10.806, 10.623, 9.918, 12.3, 10.715, 10.858, 10.149000000000001, 10.359, 12.126, 12.290000000000001, 10.036, 11.120999999999999, 10.323, 10.849, 12.228, 10.642999999999999, 11.782, 10.171000000000001, 12.010000000000002, 10.631, 10.683, 10.183, 11.421, 10.289000000000001, 10.195, 10.248999999999999, 12.957, 10.947000000000001, 10.362, 10.957, 11.193, 12.848, 10.457, 10.011, 10.226, 11.679, 11.676, 11.926, 11.051, 10.208, 11.096999999999998, 29.979000000000028, 10.629, 10.713999999999999, 12.777000000000001, 11.959, 10.338999999999999, 10.090000000000002, 12.316, 11.836, 10.994, 11.763, 10.231, 10.652000000000001, 10.928, 10.006, 11.43, 13.661, 11.399, 10.727, 10.726, 10.642, 10.232000000000001, 10.644, 13.449, 9.905000000000001, 10.946, 10.608, 10.052999999999999, 10.703000000000001, 10.432, 9.875, 10.639999999999999, 11.206, 10.21, 10.338000000000001, 11.271, 10.868000000000002, 10.822000000000001, 11.796, 10.526000000000002, 10.336, 10.831000000000001, 10.006, 10.177, 10.19, 13.049, 10.198, 10.316, 10.403, 11.144, 11.659, 10.027999999999999, 13.505999999999998, 10.843, 10.962000000000002], "episode_lengths": [35, 50, 45, 40, 38, 38, 36, 42, 34, 40, 40, 42, 48, 48, 39, 35, 37, 39, 48, 39, 43, 41, 47, 36, 48, 33, 43, 34, 35, 42, 50, 39, 31, 41, 43, 50, 40, 36, 38, 44, 39, 53, 41, 37, 44, 151, 35, 35, 54, 41, 39, 35, 50, 47, 45, 38, 39, 39, 36, 33, 36, 51, 42, 37, 38, 38, 38, 40, 47, 37, 39, 37, 39, 36, 39, 32, 39, 46, 36, 40, 41, 43, 37, 43, 38, 39, 39, 35, 31, 34, 50, 35, 37, 34, 38, 39, 39, 53, 41, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5098076667172688, "mean_inference_ms": 1.400534701736711, "mean_action_processing_ms": 0.08056422336467849, "mean_env_wait_ms": 4.929170095384292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034618377685546875, "ViewRequirementAgentConnector_ms": 0.23125100135803223}}, "episode_reward_max": 29.979000000000028, "episode_reward_min": 9.875, "episode_reward_mean": 11.17763, "episode_len_mean": 41.33, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.917, 12.787000000000003, 10.588, 10.948, 10.806, 10.623, 9.918, 12.3, 10.715, 10.858, 10.149000000000001, 10.359, 12.126, 12.290000000000001, 10.036, 11.120999999999999, 10.323, 10.849, 12.228, 10.642999999999999, 11.782, 10.171000000000001, 12.010000000000002, 10.631, 10.683, 10.183, 11.421, 10.289000000000001, 10.195, 10.248999999999999, 12.957, 10.947000000000001, 10.362, 10.957, 11.193, 12.848, 10.457, 10.011, 10.226, 11.679, 11.676, 11.926, 11.051, 10.208, 11.096999999999998, 29.979000000000028, 10.629, 10.713999999999999, 12.777000000000001, 11.959, 10.338999999999999, 10.090000000000002, 12.316, 11.836, 10.994, 11.763, 10.231, 10.652000000000001, 10.928, 10.006, 11.43, 13.661, 11.399, 10.727, 10.726, 10.642, 10.232000000000001, 10.644, 13.449, 9.905000000000001, 10.946, 10.608, 10.052999999999999, 10.703000000000001, 10.432, 9.875, 10.639999999999999, 11.206, 10.21, 10.338000000000001, 11.271, 10.868000000000002, 10.822000000000001, 11.796, 10.526000000000002, 10.336, 10.831000000000001, 10.006, 10.177, 10.19, 13.049, 10.198, 10.316, 10.403, 11.144, 11.659, 10.027999999999999, 13.505999999999998, 10.843, 10.962000000000002], "episode_lengths": [35, 50, 45, 40, 38, 38, 36, 42, 34, 40, 40, 42, 48, 48, 39, 35, 37, 39, 48, 39, 43, 41, 47, 36, 48, 33, 43, 34, 35, 42, 50, 39, 31, 41, 43, 50, 40, 36, 38, 44, 39, 53, 41, 37, 44, 151, 35, 35, 54, 41, 39, 35, 50, 47, 45, 38, 39, 39, 36, 33, 36, 51, 42, 37, 38, 38, 38, 40, 47, 37, 39, 37, 39, 36, 39, 32, 39, 46, 36, 40, 41, 43, 37, 43, 38, 39, 39, 35, 31, 34, 50, 35, 37, 34, 38, 39, 39, 53, 41, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5098076667172688, "mean_inference_ms": 1.400534701736711, "mean_action_processing_ms": 0.08056422336467849, "mean_env_wait_ms": 4.929170095384292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034618377685546875, "ViewRequirementAgentConnector_ms": 0.23125100135803223}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46078, "num_agent_steps_trained": 0, "num_env_steps_sampled": 46080, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.295384996556184, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 46080, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 46078, "timers": {"training_iteration_time_ms": 50005.151, "sample_time_ms": 7114.56, "synch_weights_time_ms": 76.456}, "counters": {"num_env_steps_sampled": 46080, "num_env_steps_trained": 0, "num_agent_steps_sampled": 46078, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 785, "training_iteration": 45, "trial_id": "default", "date": "2025-12-20_11-24-26", "timestamp": 1766201066, "time_this_iter_s": 50.45936155319214, "time_total_s": 2245.811408519745, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2245.811408519745, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 85.92777777777776, "ram_util_percent": 14.200000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7220342636108399}, "default_policy": {"total_loss": 0.7220342636108399, "policy_loss": -0.013235354772768914, "vf_loss": 2.9487326800823213, "vf_loss_unclipped": 8.84039124250412, "vf_explained_var": 0.5090426966547966, "entropy": 0.5610133379697799, "mean_kl_loss": 0.0066723003345734, "gradients_default_optimizer_global_norm": 1.038678640127182, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.004480234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 47104, "num_env_steps_trained": 0, "num_agent_steps_sampled": 47102, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 29.979000000000028, "episode_reward_min": 9.875, "episode_reward_mean": 11.125470000000002, "episode_len_mean": 40.95, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.421, 10.289000000000001, 10.195, 10.248999999999999, 12.957, 10.947000000000001, 10.362, 10.957, 11.193, 12.848, 10.457, 10.011, 10.226, 11.679, 11.676, 11.926, 11.051, 10.208, 11.096999999999998, 29.979000000000028, 10.629, 10.713999999999999, 12.777000000000001, 11.959, 10.338999999999999, 10.090000000000002, 12.316, 11.836, 10.994, 11.763, 10.231, 10.652000000000001, 10.928, 10.006, 11.43, 13.661, 11.399, 10.727, 10.726, 10.642, 10.232000000000001, 10.644, 13.449, 9.905000000000001, 10.946, 10.608, 10.052999999999999, 10.703000000000001, 10.432, 9.875, 10.639999999999999, 11.206, 10.21, 10.338000000000001, 11.271, 10.868000000000002, 10.822000000000001, 11.796, 10.526000000000002, 10.336, 10.831000000000001, 10.006, 10.177, 10.19, 13.049, 10.198, 10.316, 10.403, 11.144, 11.659, 10.027999999999999, 13.505999999999998, 10.843, 10.962000000000002, 10.312999999999999, 11.049000000000001, 9.928, 10.423, 10.370000000000001, 10.338000000000001, 10.326, 10.049, 11.607999999999999, 10.629000000000001, 10.437, 10.543000000000001, 11.993, 10.622000000000002, 10.209000000000001, 11.394, 10.997, 11.379000000000001, 11.07, 11.492999999999999, 11.021, 10.104, 10.768, 10.827, 12.516000000000002, 10.422], "episode_lengths": [43, 34, 35, 42, 50, 39, 31, 41, 43, 50, 40, 36, 38, 44, 39, 53, 41, 37, 44, 151, 35, 35, 54, 41, 39, 35, 50, 47, 45, 38, 39, 39, 36, 33, 36, 51, 42, 37, 38, 38, 38, 40, 47, 37, 39, 37, 39, 36, 39, 32, 39, 46, 36, 40, 41, 43, 37, 43, 38, 39, 39, 35, 31, 34, 50, 35, 37, 34, 38, 39, 39, 53, 41, 42, 36, 38, 38, 38, 30, 39, 37, 40, 44, 39, 38, 39, 47, 38, 36, 42, 43, 40, 39, 42, 40, 36, 42, 38, 47, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5109706401820147, "mean_inference_ms": 1.4007045379011152, "mean_action_processing_ms": 0.08057066205399169, "mean_env_wait_ms": 4.928624648564742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034613609313964844, "ViewRequirementAgentConnector_ms": 0.231675386428833}}, "episode_reward_max": 29.979000000000028, "episode_reward_min": 9.875, "episode_reward_mean": 11.125470000000002, "episode_len_mean": 40.95, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.421, 10.289000000000001, 10.195, 10.248999999999999, 12.957, 10.947000000000001, 10.362, 10.957, 11.193, 12.848, 10.457, 10.011, 10.226, 11.679, 11.676, 11.926, 11.051, 10.208, 11.096999999999998, 29.979000000000028, 10.629, 10.713999999999999, 12.777000000000001, 11.959, 10.338999999999999, 10.090000000000002, 12.316, 11.836, 10.994, 11.763, 10.231, 10.652000000000001, 10.928, 10.006, 11.43, 13.661, 11.399, 10.727, 10.726, 10.642, 10.232000000000001, 10.644, 13.449, 9.905000000000001, 10.946, 10.608, 10.052999999999999, 10.703000000000001, 10.432, 9.875, 10.639999999999999, 11.206, 10.21, 10.338000000000001, 11.271, 10.868000000000002, 10.822000000000001, 11.796, 10.526000000000002, 10.336, 10.831000000000001, 10.006, 10.177, 10.19, 13.049, 10.198, 10.316, 10.403, 11.144, 11.659, 10.027999999999999, 13.505999999999998, 10.843, 10.962000000000002, 10.312999999999999, 11.049000000000001, 9.928, 10.423, 10.370000000000001, 10.338000000000001, 10.326, 10.049, 11.607999999999999, 10.629000000000001, 10.437, 10.543000000000001, 11.993, 10.622000000000002, 10.209000000000001, 11.394, 10.997, 11.379000000000001, 11.07, 11.492999999999999, 11.021, 10.104, 10.768, 10.827, 12.516000000000002, 10.422], "episode_lengths": [43, 34, 35, 42, 50, 39, 31, 41, 43, 50, 40, 36, 38, 44, 39, 53, 41, 37, 44, 151, 35, 35, 54, 41, 39, 35, 50, 47, 45, 38, 39, 39, 36, 33, 36, 51, 42, 37, 38, 38, 38, 40, 47, 37, 39, 37, 39, 36, 39, 32, 39, 46, 36, 40, 41, 43, 37, 43, 38, 39, 39, 35, 31, 34, 50, 35, 37, 34, 38, 39, 39, 53, 41, 42, 36, 38, 38, 38, 30, 39, 37, 40, 44, 39, 38, 39, 47, 38, 36, 42, 43, 40, 39, 42, 40, 36, 42, 38, 47, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5109706401820147, "mean_inference_ms": 1.4007045379011152, "mean_action_processing_ms": 0.08057066205399169, "mean_env_wait_ms": 4.928624648564742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034613609313964844, "ViewRequirementAgentConnector_ms": 0.231675386428833}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47102, "num_agent_steps_trained": 0, "num_env_steps_sampled": 47104, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.689175488844743, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 47104, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 47102, "timers": {"training_iteration_time_ms": 49922.074, "sample_time_ms": 7118.39, "synch_weights_time_ms": 76.236}, "counters": {"num_env_steps_sampled": 47104, "num_env_steps_trained": 0, "num_agent_steps_sampled": 47102, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 811, "training_iteration": 46, "trial_id": "default", "date": "2025-12-20_11-25-15", "timestamp": 1766201115, "time_this_iter_s": 49.49839496612549, "time_total_s": 2295.3098034858704, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2295.3098034858704, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 85.53428571428572, "ram_util_percent": 14.200000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.886687870323658}, "default_policy": {"total_loss": 0.886687870323658, "policy_loss": -0.020045337127521635, "vf_loss": 3.631962555646896, "vf_loss_unclipped": 11.925378131866456, "vf_explained_var": 0.1927674740552902, "entropy": 0.46555516868829727, "mean_kl_loss": 0.008283445780216425, "gradients_default_optimizer_global_norm": 1.2157986238598824, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.004360234375, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 48128, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48126, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 13.661, "episode_reward_min": 9.875, "episode_reward_mean": 10.87208, "episode_len_mean": 39.52, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.316, 11.836, 10.994, 11.763, 10.231, 10.652000000000001, 10.928, 10.006, 11.43, 13.661, 11.399, 10.727, 10.726, 10.642, 10.232000000000001, 10.644, 13.449, 9.905000000000001, 10.946, 10.608, 10.052999999999999, 10.703000000000001, 10.432, 9.875, 10.639999999999999, 11.206, 10.21, 10.338000000000001, 11.271, 10.868000000000002, 10.822000000000001, 11.796, 10.526000000000002, 10.336, 10.831000000000001, 10.006, 10.177, 10.19, 13.049, 10.198, 10.316, 10.403, 11.144, 11.659, 10.027999999999999, 13.505999999999998, 10.843, 10.962000000000002, 10.312999999999999, 11.049000000000001, 9.928, 10.423, 10.370000000000001, 10.338000000000001, 10.326, 10.049, 11.607999999999999, 10.629000000000001, 10.437, 10.543000000000001, 11.993, 10.622000000000002, 10.209000000000001, 11.394, 10.997, 11.379000000000001, 11.07, 11.492999999999999, 11.021, 10.104, 10.768, 10.827, 12.516000000000002, 10.422, 10.009, 10.733, 11.250000000000002, 10.627, 10.834, 11.731, 11.361, 11.821, 10.437, 11.061, 12.222, 10.519000000000002, 10.831, 10.535, 10.943999999999999, 10.552999999999999, 10.373999999999999, 10.752, 11.146, 10.645999999999999, 10.532, 10.405, 10.551, 10.582999999999998, 9.909, 10.531], "episode_lengths": [50, 47, 45, 38, 39, 39, 36, 33, 36, 51, 42, 37, 38, 38, 38, 40, 47, 37, 39, 37, 39, 36, 39, 32, 39, 46, 36, 40, 41, 43, 37, 43, 38, 39, 39, 35, 31, 34, 50, 35, 37, 34, 38, 39, 39, 53, 41, 42, 36, 38, 38, 38, 30, 39, 37, 40, 44, 39, 38, 39, 47, 38, 36, 42, 43, 40, 39, 42, 40, 36, 42, 38, 47, 37, 36, 38, 41, 38, 38, 45, 41, 44, 39, 42, 44, 37, 38, 39, 39, 40, 42, 39, 38, 39, 38, 35, 39, 44, 36, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5120921218420947, "mean_inference_ms": 1.4003514354762177, "mean_action_processing_ms": 0.0805396223596068, "mean_env_wait_ms": 4.926907687397096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034456253051757812, "ViewRequirementAgentConnector_ms": 0.23066425323486328}}, "episode_reward_max": 13.661, "episode_reward_min": 9.875, "episode_reward_mean": 10.87208, "episode_len_mean": 39.52, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.316, 11.836, 10.994, 11.763, 10.231, 10.652000000000001, 10.928, 10.006, 11.43, 13.661, 11.399, 10.727, 10.726, 10.642, 10.232000000000001, 10.644, 13.449, 9.905000000000001, 10.946, 10.608, 10.052999999999999, 10.703000000000001, 10.432, 9.875, 10.639999999999999, 11.206, 10.21, 10.338000000000001, 11.271, 10.868000000000002, 10.822000000000001, 11.796, 10.526000000000002, 10.336, 10.831000000000001, 10.006, 10.177, 10.19, 13.049, 10.198, 10.316, 10.403, 11.144, 11.659, 10.027999999999999, 13.505999999999998, 10.843, 10.962000000000002, 10.312999999999999, 11.049000000000001, 9.928, 10.423, 10.370000000000001, 10.338000000000001, 10.326, 10.049, 11.607999999999999, 10.629000000000001, 10.437, 10.543000000000001, 11.993, 10.622000000000002, 10.209000000000001, 11.394, 10.997, 11.379000000000001, 11.07, 11.492999999999999, 11.021, 10.104, 10.768, 10.827, 12.516000000000002, 10.422, 10.009, 10.733, 11.250000000000002, 10.627, 10.834, 11.731, 11.361, 11.821, 10.437, 11.061, 12.222, 10.519000000000002, 10.831, 10.535, 10.943999999999999, 10.552999999999999, 10.373999999999999, 10.752, 11.146, 10.645999999999999, 10.532, 10.405, 10.551, 10.582999999999998, 9.909, 10.531], "episode_lengths": [50, 47, 45, 38, 39, 39, 36, 33, 36, 51, 42, 37, 38, 38, 38, 40, 47, 37, 39, 37, 39, 36, 39, 32, 39, 46, 36, 40, 41, 43, 37, 43, 38, 39, 39, 35, 31, 34, 50, 35, 37, 34, 38, 39, 39, 53, 41, 42, 36, 38, 38, 38, 30, 39, 37, 40, 44, 39, 38, 39, 47, 38, 36, 42, 43, 40, 39, 42, 40, 36, 42, 38, 47, 37, 36, 38, 41, 38, 38, 45, 41, 44, 39, 42, 44, 37, 38, 39, 39, 40, 42, 39, 38, 39, 38, 35, 39, 44, 36, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5120921218420947, "mean_inference_ms": 1.4003514354762177, "mean_action_processing_ms": 0.0805396223596068, "mean_env_wait_ms": 4.926907687397096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034456253051757812, "ViewRequirementAgentConnector_ms": 0.23066425323486328}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48126, "num_agent_steps_trained": 0, "num_env_steps_sampled": 48128, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.370025569864936, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 48128, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 48126, "timers": {"training_iteration_time_ms": 50039.209, "sample_time_ms": 7121.266, "synch_weights_time_ms": 76.979}, "counters": {"num_env_steps_sampled": 48128, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48126, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 837, "training_iteration": 47, "trial_id": "default", "date": "2025-12-20_11-26-13", "timestamp": 1766201173, "time_this_iter_s": 50.273075580596924, "time_total_s": 2345.5828790664673, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2345.5828790664673, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 75.12560975609755, "ram_util_percent": 14.200000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.8063225671648979}, "default_policy": {"total_loss": 0.8063225671648979, "policy_loss": -0.018773251236416398, "vf_loss": 3.3057776987552643, "vf_loss_unclipped": 11.320628118515014, "vf_explained_var": 0.2214808091521263, "entropy": 0.424789534509182, "mean_kl_loss": 0.005035629905144834, "gradients_default_optimizer_global_norm": 0.9519910305738449, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0042402343750000005, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 0, "num_agent_steps_sampled": 49150, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 13.505999999999998, "episode_reward_min": 9.909, "episode_reward_mean": 10.817409999999997, "episode_len_mean": 39.25, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.21, 10.338000000000001, 11.271, 10.868000000000002, 10.822000000000001, 11.796, 10.526000000000002, 10.336, 10.831000000000001, 10.006, 10.177, 10.19, 13.049, 10.198, 10.316, 10.403, 11.144, 11.659, 10.027999999999999, 13.505999999999998, 10.843, 10.962000000000002, 10.312999999999999, 11.049000000000001, 9.928, 10.423, 10.370000000000001, 10.338000000000001, 10.326, 10.049, 11.607999999999999, 10.629000000000001, 10.437, 10.543000000000001, 11.993, 10.622000000000002, 10.209000000000001, 11.394, 10.997, 11.379000000000001, 11.07, 11.492999999999999, 11.021, 10.104, 10.768, 10.827, 12.516000000000002, 10.422, 10.009, 10.733, 11.250000000000002, 10.627, 10.834, 11.731, 11.361, 11.821, 10.437, 11.061, 12.222, 10.519000000000002, 10.831, 10.535, 10.943999999999999, 10.552999999999999, 10.373999999999999, 10.752, 11.146, 10.645999999999999, 10.532, 10.405, 10.551, 10.582999999999998, 9.909, 10.531, 10.428, 10.649, 11.92, 10.321, 10.314, 10.224, 12.101, 11.045, 10.523000000000001, 10.858, 10.221, 11.525, 10.529, 10.107000000000001, 10.326, 10.222999999999999, 10.937000000000001, 10.74, 11.068, 11.202, 10.321, 10.870000000000001, 12.196, 10.824000000000002, 10.542000000000002, 10.523000000000001], "episode_lengths": [36, 40, 41, 43, 37, 43, 38, 39, 39, 35, 31, 34, 50, 35, 37, 34, 38, 39, 39, 53, 41, 42, 36, 38, 38, 38, 30, 39, 37, 40, 44, 39, 38, 39, 47, 38, 36, 42, 43, 40, 39, 42, 40, 36, 42, 38, 47, 37, 36, 38, 41, 38, 38, 45, 41, 44, 39, 42, 44, 37, 38, 39, 39, 40, 42, 39, 38, 39, 38, 35, 39, 44, 36, 38, 37, 38, 45, 37, 36, 37, 42, 37, 37, 42, 37, 46, 38, 36, 37, 37, 38, 39, 39, 33, 37, 41, 52, 37, 39, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5132920569234721, "mean_inference_ms": 1.4005761238239682, "mean_action_processing_ms": 0.08054982848342704, "mean_env_wait_ms": 4.92646213208168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003464937210083008, "ViewRequirementAgentConnector_ms": 0.23197674751281738}}, "episode_reward_max": 13.505999999999998, "episode_reward_min": 9.909, "episode_reward_mean": 10.817409999999997, "episode_len_mean": 39.25, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.21, 10.338000000000001, 11.271, 10.868000000000002, 10.822000000000001, 11.796, 10.526000000000002, 10.336, 10.831000000000001, 10.006, 10.177, 10.19, 13.049, 10.198, 10.316, 10.403, 11.144, 11.659, 10.027999999999999, 13.505999999999998, 10.843, 10.962000000000002, 10.312999999999999, 11.049000000000001, 9.928, 10.423, 10.370000000000001, 10.338000000000001, 10.326, 10.049, 11.607999999999999, 10.629000000000001, 10.437, 10.543000000000001, 11.993, 10.622000000000002, 10.209000000000001, 11.394, 10.997, 11.379000000000001, 11.07, 11.492999999999999, 11.021, 10.104, 10.768, 10.827, 12.516000000000002, 10.422, 10.009, 10.733, 11.250000000000002, 10.627, 10.834, 11.731, 11.361, 11.821, 10.437, 11.061, 12.222, 10.519000000000002, 10.831, 10.535, 10.943999999999999, 10.552999999999999, 10.373999999999999, 10.752, 11.146, 10.645999999999999, 10.532, 10.405, 10.551, 10.582999999999998, 9.909, 10.531, 10.428, 10.649, 11.92, 10.321, 10.314, 10.224, 12.101, 11.045, 10.523000000000001, 10.858, 10.221, 11.525, 10.529, 10.107000000000001, 10.326, 10.222999999999999, 10.937000000000001, 10.74, 11.068, 11.202, 10.321, 10.870000000000001, 12.196, 10.824000000000002, 10.542000000000002, 10.523000000000001], "episode_lengths": [36, 40, 41, 43, 37, 43, 38, 39, 39, 35, 31, 34, 50, 35, 37, 34, 38, 39, 39, 53, 41, 42, 36, 38, 38, 38, 30, 39, 37, 40, 44, 39, 38, 39, 47, 38, 36, 42, 43, 40, 39, 42, 40, 36, 42, 38, 47, 37, 36, 38, 41, 38, 38, 45, 41, 44, 39, 42, 44, 37, 38, 39, 39, 40, 42, 39, 38, 39, 38, 35, 39, 44, 36, 38, 37, 38, 45, 37, 36, 37, 42, 37, 37, 42, 37, 46, 38, 36, 37, 37, 38, 39, 39, 33, 37, 41, 52, 37, 39, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5132920569234721, "mean_inference_ms": 1.4005761238239682, "mean_action_processing_ms": 0.08054982848342704, "mean_env_wait_ms": 4.92646213208168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003464937210083008, "ViewRequirementAgentConnector_ms": 0.23197674751281738}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49150, "num_agent_steps_trained": 0, "num_env_steps_sampled": 49152, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.46976507841781, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 49152, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 49150, "timers": {"training_iteration_time_ms": 50008.807, "sample_time_ms": 7129.448, "synch_weights_time_ms": 77.614}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 0, "num_agent_steps_sampled": 49150, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 863, "training_iteration": 48, "trial_id": "default", "date": "2025-12-20_11-27-03", "timestamp": 1766201223, "time_this_iter_s": 50.02808594703674, "time_total_s": 2395.610965013504, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2395.610965013504, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 85.60000000000001, "ram_util_percent": 14.200000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1025.0, "total_loss": 0.8901161798616735}, "default_policy": {"total_loss": 0.8901161798616735, "policy_loss": -0.017071152299006537, "vf_loss": 3.6321491264715426, "vf_loss_unclipped": 13.021261750197992, "vf_explained_var": -0.053039556596337294, "entropy": 0.35478112246932053, "mean_kl_loss": 0.006543873507658512, "gradients_default_optimizer_global_norm": 1.0151670771401102, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0041201171875, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 0, "num_agent_steps_sampled": 50175, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.516000000000002, "episode_reward_min": 9.909, "episode_reward_mean": 10.781630000000002, "episode_len_mean": 39.18, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.338000000000001, 10.326, 10.049, 11.607999999999999, 10.629000000000001, 10.437, 10.543000000000001, 11.993, 10.622000000000002, 10.209000000000001, 11.394, 10.997, 11.379000000000001, 11.07, 11.492999999999999, 11.021, 10.104, 10.768, 10.827, 12.516000000000002, 10.422, 10.009, 10.733, 11.250000000000002, 10.627, 10.834, 11.731, 11.361, 11.821, 10.437, 11.061, 12.222, 10.519000000000002, 10.831, 10.535, 10.943999999999999, 10.552999999999999, 10.373999999999999, 10.752, 11.146, 10.645999999999999, 10.532, 10.405, 10.551, 10.582999999999998, 9.909, 10.531, 10.428, 10.649, 11.92, 10.321, 10.314, 10.224, 12.101, 11.045, 10.523000000000001, 10.858, 10.221, 11.525, 10.529, 10.107000000000001, 10.326, 10.222999999999999, 10.937000000000001, 10.74, 11.068, 11.202, 10.321, 10.870000000000001, 12.196, 10.824000000000002, 10.542000000000002, 10.523000000000001, 10.422, 10.854000000000001, 10.423000000000002, 10.314, 10.936, 10.679, 10.325000000000001, 11.575, 10.829, 10.617, 10.523000000000001, 10.638, 10.942, 10.531, 10.222000000000001, 11.065000000000001, 11.07, 10.619000000000002, 10.635, 10.617, 10.429, 10.942, 10.533, 10.955, 10.631, 10.535, 10.123000000000001], "episode_lengths": [39, 37, 40, 44, 39, 38, 39, 47, 38, 36, 42, 43, 40, 39, 42, 40, 36, 42, 38, 47, 37, 36, 38, 41, 38, 38, 45, 41, 44, 39, 42, 44, 37, 38, 39, 39, 40, 42, 39, 38, 39, 38, 35, 39, 44, 36, 38, 37, 38, 45, 37, 36, 37, 42, 37, 37, 42, 37, 46, 38, 36, 37, 37, 38, 39, 39, 33, 37, 41, 52, 37, 39, 37, 37, 40, 37, 37, 39, 42, 37, 41, 38, 37, 37, 40, 39, 37, 37, 41, 41, 37, 38, 37, 37, 39, 38, 40, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5144723749533587, "mean_inference_ms": 1.400746941754502, "mean_action_processing_ms": 0.08056817691970697, "mean_env_wait_ms": 4.9259272133918435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034546852111816406, "ViewRequirementAgentConnector_ms": 0.23103642463684082}}, "episode_reward_max": 12.516000000000002, "episode_reward_min": 9.909, "episode_reward_mean": 10.781630000000002, "episode_len_mean": 39.18, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.338000000000001, 10.326, 10.049, 11.607999999999999, 10.629000000000001, 10.437, 10.543000000000001, 11.993, 10.622000000000002, 10.209000000000001, 11.394, 10.997, 11.379000000000001, 11.07, 11.492999999999999, 11.021, 10.104, 10.768, 10.827, 12.516000000000002, 10.422, 10.009, 10.733, 11.250000000000002, 10.627, 10.834, 11.731, 11.361, 11.821, 10.437, 11.061, 12.222, 10.519000000000002, 10.831, 10.535, 10.943999999999999, 10.552999999999999, 10.373999999999999, 10.752, 11.146, 10.645999999999999, 10.532, 10.405, 10.551, 10.582999999999998, 9.909, 10.531, 10.428, 10.649, 11.92, 10.321, 10.314, 10.224, 12.101, 11.045, 10.523000000000001, 10.858, 10.221, 11.525, 10.529, 10.107000000000001, 10.326, 10.222999999999999, 10.937000000000001, 10.74, 11.068, 11.202, 10.321, 10.870000000000001, 12.196, 10.824000000000002, 10.542000000000002, 10.523000000000001, 10.422, 10.854000000000001, 10.423000000000002, 10.314, 10.936, 10.679, 10.325000000000001, 11.575, 10.829, 10.617, 10.523000000000001, 10.638, 10.942, 10.531, 10.222000000000001, 11.065000000000001, 11.07, 10.619000000000002, 10.635, 10.617, 10.429, 10.942, 10.533, 10.955, 10.631, 10.535, 10.123000000000001], "episode_lengths": [39, 37, 40, 44, 39, 38, 39, 47, 38, 36, 42, 43, 40, 39, 42, 40, 36, 42, 38, 47, 37, 36, 38, 41, 38, 38, 45, 41, 44, 39, 42, 44, 37, 38, 39, 39, 40, 42, 39, 38, 39, 38, 35, 39, 44, 36, 38, 37, 38, 45, 37, 36, 37, 42, 37, 37, 42, 37, 46, 38, 36, 37, 37, 38, 39, 39, 33, 37, 41, 52, 37, 39, 37, 37, 40, 37, 37, 39, 42, 37, 41, 38, 37, 37, 40, 39, 37, 37, 41, 41, 37, 38, 37, 37, 39, 38, 40, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5144723749533587, "mean_inference_ms": 1.400746941754502, "mean_action_processing_ms": 0.08056817691970697, "mean_env_wait_ms": 4.9259272133918435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034546852111816406, "ViewRequirementAgentConnector_ms": 0.23103642463684082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50175, "num_agent_steps_trained": 0, "num_env_steps_sampled": 50176, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.026729970950484, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 50176, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 50175, "timers": {"training_iteration_time_ms": 50114.153, "sample_time_ms": 7135.49, "synch_weights_time_ms": 78.458}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 0, "num_agent_steps_sampled": 50175, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 890, "training_iteration": 49, "trial_id": "default", "date": "2025-12-20_11-27-54", "timestamp": 1766201274, "time_this_iter_s": 51.1354546546936, "time_total_s": 2446.7464196681976, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2446.7464196681976, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 86.03150684931506, "ram_util_percent": 14.200000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1023.0, "total_loss": 0.7438596069812775}, "default_policy": {"total_loss": 0.7438596069812775, "policy_loss": -0.01250556944287382, "vf_loss": 3.028845328092575, "vf_loss_unclipped": 10.322839069366456, "vf_explained_var": 0.21501936614513398, "entropy": 0.316566626727581, "mean_kl_loss": 0.0045814597604525885, "gradients_default_optimizer_global_norm": 1.0529474109411239, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.004000234375, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 51200, "num_env_steps_trained": 0, "num_agent_steps_sampled": 51198, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.222, "episode_reward_min": 9.909, "episode_reward_mean": 10.70179, "episode_len_mean": 38.53, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.361, 11.821, 10.437, 11.061, 12.222, 10.519000000000002, 10.831, 10.535, 10.943999999999999, 10.552999999999999, 10.373999999999999, 10.752, 11.146, 10.645999999999999, 10.532, 10.405, 10.551, 10.582999999999998, 9.909, 10.531, 10.428, 10.649, 11.92, 10.321, 10.314, 10.224, 12.101, 11.045, 10.523000000000001, 10.858, 10.221, 11.525, 10.529, 10.107000000000001, 10.326, 10.222999999999999, 10.937000000000001, 10.74, 11.068, 11.202, 10.321, 10.870000000000001, 12.196, 10.824000000000002, 10.542000000000002, 10.523000000000001, 10.422, 10.854000000000001, 10.423000000000002, 10.314, 10.936, 10.679, 10.325000000000001, 11.575, 10.829, 10.617, 10.523000000000001, 10.638, 10.942, 10.531, 10.222000000000001, 11.065000000000001, 11.07, 10.619000000000002, 10.635, 10.617, 10.429, 10.942, 10.533, 10.955, 10.631, 10.535, 10.123000000000001, 10.226, 10.418000000000001, 10.521, 10.412, 10.133000000000001, 10.437000000000001, 10.322000000000001, 11.999, 10.625, 10.423, 10.733, 10.652, 10.605, 10.020000000000001, 10.634, 10.523000000000001, 10.423000000000002, 10.529, 10.520000000000001, 10.422, 10.302, 11.042, 11.743, 10.325000000000001, 10.713000000000001, 10.623000000000001, 10.620000000000001], "episode_lengths": [41, 44, 39, 42, 44, 37, 38, 39, 39, 40, 42, 39, 38, 39, 38, 35, 39, 44, 36, 38, 37, 38, 45, 37, 36, 37, 42, 37, 37, 42, 37, 46, 38, 36, 37, 37, 38, 39, 39, 33, 37, 41, 52, 37, 39, 37, 37, 40, 37, 37, 39, 42, 37, 41, 38, 37, 37, 40, 39, 37, 37, 41, 41, 37, 38, 37, 37, 39, 38, 40, 38, 38, 38, 38, 37, 37, 36, 38, 37, 38, 44, 38, 37, 38, 40, 35, 37, 38, 37, 37, 38, 37, 37, 35, 39, 39, 37, 36, 37, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5155719904249989, "mean_inference_ms": 1.400647936725334, "mean_action_processing_ms": 0.08056964045045363, "mean_env_wait_ms": 4.925078049719677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003446340560913086, "ViewRequirementAgentConnector_ms": 0.23075604438781738}}, "episode_reward_max": 12.222, "episode_reward_min": 9.909, "episode_reward_mean": 10.70179, "episode_len_mean": 38.53, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.361, 11.821, 10.437, 11.061, 12.222, 10.519000000000002, 10.831, 10.535, 10.943999999999999, 10.552999999999999, 10.373999999999999, 10.752, 11.146, 10.645999999999999, 10.532, 10.405, 10.551, 10.582999999999998, 9.909, 10.531, 10.428, 10.649, 11.92, 10.321, 10.314, 10.224, 12.101, 11.045, 10.523000000000001, 10.858, 10.221, 11.525, 10.529, 10.107000000000001, 10.326, 10.222999999999999, 10.937000000000001, 10.74, 11.068, 11.202, 10.321, 10.870000000000001, 12.196, 10.824000000000002, 10.542000000000002, 10.523000000000001, 10.422, 10.854000000000001, 10.423000000000002, 10.314, 10.936, 10.679, 10.325000000000001, 11.575, 10.829, 10.617, 10.523000000000001, 10.638, 10.942, 10.531, 10.222000000000001, 11.065000000000001, 11.07, 10.619000000000002, 10.635, 10.617, 10.429, 10.942, 10.533, 10.955, 10.631, 10.535, 10.123000000000001, 10.226, 10.418000000000001, 10.521, 10.412, 10.133000000000001, 10.437000000000001, 10.322000000000001, 11.999, 10.625, 10.423, 10.733, 10.652, 10.605, 10.020000000000001, 10.634, 10.523000000000001, 10.423000000000002, 10.529, 10.520000000000001, 10.422, 10.302, 11.042, 11.743, 10.325000000000001, 10.713000000000001, 10.623000000000001, 10.620000000000001], "episode_lengths": [41, 44, 39, 42, 44, 37, 38, 39, 39, 40, 42, 39, 38, 39, 38, 35, 39, 44, 36, 38, 37, 38, 45, 37, 36, 37, 42, 37, 37, 42, 37, 46, 38, 36, 37, 37, 38, 39, 39, 33, 37, 41, 52, 37, 39, 37, 37, 40, 37, 37, 39, 42, 37, 41, 38, 37, 37, 40, 39, 37, 37, 41, 41, 37, 38, 37, 37, 39, 38, 40, 38, 38, 38, 38, 37, 37, 36, 38, 37, 38, 44, 38, 37, 38, 40, 35, 37, 38, 37, 37, 38, 37, 37, 35, 39, 39, 37, 36, 37, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5155719904249989, "mean_inference_ms": 1.400647936725334, "mean_action_processing_ms": 0.08056964045045363, "mean_env_wait_ms": 4.925078049719677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003446340560913086, "ViewRequirementAgentConnector_ms": 0.23075604438781738}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51198, "num_agent_steps_trained": 0, "num_env_steps_sampled": 51200, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.507987609242154, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 51200, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 51198, "timers": {"training_iteration_time_ms": 50072.752, "sample_time_ms": 7136.249, "synch_weights_time_ms": 79.449}, "counters": {"num_env_steps_sampled": 51200, "num_env_steps_trained": 0, "num_agent_steps_sampled": 51198, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 917, "training_iteration": 50, "trial_id": "default", "date": "2025-12-20_11-28-44", "timestamp": 1766201324, "time_this_iter_s": 49.93582820892334, "time_total_s": 2496.682247877121, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2496.682247877121, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 85.73943661971829, "ram_util_percent": 14.200000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7541798427700996}, "default_policy": {"total_loss": 0.7541798427700996, "policy_loss": -0.012295310106128454, "vf_loss": 3.070361942052841, "vf_loss_unclipped": 11.03912079334259, "vf_explained_var": 0.16003734469413758, "entropy": 0.324813199788332, "mean_kl_loss": 0.003679922116589296, "gradients_default_optimizer_global_norm": 1.9753778479993342, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00392015625, "curr_kl_coeff": 0.02500000037252903}}, "num_env_steps_sampled": 52224, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52222, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.196, "episode_reward_min": 9.919, "episode_reward_mean": 10.65734, "episode_len_mean": 38.23, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.045, 10.523000000000001, 10.858, 10.221, 11.525, 10.529, 10.107000000000001, 10.326, 10.222999999999999, 10.937000000000001, 10.74, 11.068, 11.202, 10.321, 10.870000000000001, 12.196, 10.824000000000002, 10.542000000000002, 10.523000000000001, 10.422, 10.854000000000001, 10.423000000000002, 10.314, 10.936, 10.679, 10.325000000000001, 11.575, 10.829, 10.617, 10.523000000000001, 10.638, 10.942, 10.531, 10.222000000000001, 11.065000000000001, 11.07, 10.619000000000002, 10.635, 10.617, 10.429, 10.942, 10.533, 10.955, 10.631, 10.535, 10.123000000000001, 10.226, 10.418000000000001, 10.521, 10.412, 10.133000000000001, 10.437000000000001, 10.322000000000001, 11.999, 10.625, 10.423, 10.733, 10.652, 10.605, 10.020000000000001, 10.634, 10.523000000000001, 10.423000000000002, 10.529, 10.520000000000001, 10.422, 10.302, 11.042, 11.743, 10.325000000000001, 10.713000000000001, 10.623000000000001, 10.620000000000001, 10.590000000000002, 10.120000000000001, 10.945, 10.323, 10.623000000000001, 10.421, 10.63, 11.676, 10.534, 10.952, 10.63, 10.745000000000001, 11.363, 10.86, 10.114, 10.743, 10.417, 10.425, 9.994, 9.923, 10.42, 9.919, 10.733, 11.264, 11.693999999999999, 10.644, 10.523000000000001], "episode_lengths": [37, 37, 42, 37, 46, 38, 36, 37, 37, 38, 39, 39, 33, 37, 41, 52, 37, 39, 37, 37, 40, 37, 37, 39, 42, 37, 41, 38, 37, 37, 40, 39, 37, 37, 41, 41, 37, 38, 37, 37, 39, 38, 40, 38, 38, 38, 38, 37, 37, 36, 38, 37, 38, 44, 38, 37, 38, 40, 35, 37, 38, 37, 37, 38, 37, 37, 35, 39, 39, 37, 36, 37, 37, 34, 38, 40, 37, 37, 37, 38, 42, 38, 40, 38, 39, 41, 41, 38, 39, 36, 37, 35, 38, 37, 37, 38, 41, 41, 39, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5167793526998615, "mean_inference_ms": 1.4008732194411315, "mean_action_processing_ms": 0.08059163635892684, "mean_env_wait_ms": 4.925100573990859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003496408462524414, "ViewRequirementAgentConnector_ms": 0.23287725448608398}}, "episode_reward_max": 12.196, "episode_reward_min": 9.919, "episode_reward_mean": 10.65734, "episode_len_mean": 38.23, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.045, 10.523000000000001, 10.858, 10.221, 11.525, 10.529, 10.107000000000001, 10.326, 10.222999999999999, 10.937000000000001, 10.74, 11.068, 11.202, 10.321, 10.870000000000001, 12.196, 10.824000000000002, 10.542000000000002, 10.523000000000001, 10.422, 10.854000000000001, 10.423000000000002, 10.314, 10.936, 10.679, 10.325000000000001, 11.575, 10.829, 10.617, 10.523000000000001, 10.638, 10.942, 10.531, 10.222000000000001, 11.065000000000001, 11.07, 10.619000000000002, 10.635, 10.617, 10.429, 10.942, 10.533, 10.955, 10.631, 10.535, 10.123000000000001, 10.226, 10.418000000000001, 10.521, 10.412, 10.133000000000001, 10.437000000000001, 10.322000000000001, 11.999, 10.625, 10.423, 10.733, 10.652, 10.605, 10.020000000000001, 10.634, 10.523000000000001, 10.423000000000002, 10.529, 10.520000000000001, 10.422, 10.302, 11.042, 11.743, 10.325000000000001, 10.713000000000001, 10.623000000000001, 10.620000000000001, 10.590000000000002, 10.120000000000001, 10.945, 10.323, 10.623000000000001, 10.421, 10.63, 11.676, 10.534, 10.952, 10.63, 10.745000000000001, 11.363, 10.86, 10.114, 10.743, 10.417, 10.425, 9.994, 9.923, 10.42, 9.919, 10.733, 11.264, 11.693999999999999, 10.644, 10.523000000000001], "episode_lengths": [37, 37, 42, 37, 46, 38, 36, 37, 37, 38, 39, 39, 33, 37, 41, 52, 37, 39, 37, 37, 40, 37, 37, 39, 42, 37, 41, 38, 37, 37, 40, 39, 37, 37, 41, 41, 37, 38, 37, 37, 39, 38, 40, 38, 38, 38, 38, 37, 37, 36, 38, 37, 38, 44, 38, 37, 38, 40, 35, 37, 38, 37, 37, 38, 37, 37, 35, 39, 39, 37, 36, 37, 37, 34, 38, 40, 37, 37, 37, 38, 42, 38, 40, 38, 39, 41, 41, 38, 39, 36, 37, 35, 38, 37, 37, 38, 41, 41, 39, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5167793526998615, "mean_inference_ms": 1.4008732194411315, "mean_action_processing_ms": 0.08059163635892684, "mean_env_wait_ms": 4.925100573990859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003496408462524414, "ViewRequirementAgentConnector_ms": 0.23287725448608398}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52222, "num_agent_steps_trained": 0, "num_env_steps_sampled": 52224, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.20346942451628, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 52224, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 52222, "timers": {"training_iteration_time_ms": 50155.509, "sample_time_ms": 7161.266, "synch_weights_time_ms": 78.978}, "counters": {"num_env_steps_sampled": 52224, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52222, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 944, "training_iteration": 51, "trial_id": "default", "date": "2025-12-20_11-29-35", "timestamp": 1766201375, "time_this_iter_s": 50.68769812583923, "time_total_s": 2547.36994600296, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2547.36994600296, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 85.40972222222223, "ram_util_percent": 14.200000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.7719741180539131}, "default_policy": {"total_loss": 0.7719741180539131, "policy_loss": -0.01172196991974488, "vf_loss": 3.1390103697776794, "vf_loss_unclipped": 12.866381335258485, "vf_explained_var": -0.09361065775156022, "entropy": 0.2944333903491497, "mean_kl_loss": 0.00390889209170382, "gradients_default_optimizer_global_norm": 1.2782793708145619, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0038401562500000003, "curr_kl_coeff": 0.012500000186264515}}, "num_env_steps_sampled": 53248, "num_env_steps_trained": 0, "num_agent_steps_sampled": 53246, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.873000000000001, "episode_reward_min": 9.919, "episode_reward_mean": 10.697880000000003, "episode_len_mean": 38.35, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.575, 10.829, 10.617, 10.523000000000001, 10.638, 10.942, 10.531, 10.222000000000001, 11.065000000000001, 11.07, 10.619000000000002, 10.635, 10.617, 10.429, 10.942, 10.533, 10.955, 10.631, 10.535, 10.123000000000001, 10.226, 10.418000000000001, 10.521, 10.412, 10.133000000000001, 10.437000000000001, 10.322000000000001, 11.999, 10.625, 10.423, 10.733, 10.652, 10.605, 10.020000000000001, 10.634, 10.523000000000001, 10.423000000000002, 10.529, 10.520000000000001, 10.422, 10.302, 11.042, 11.743, 10.325000000000001, 10.713000000000001, 10.623000000000001, 10.620000000000001, 10.590000000000002, 10.120000000000001, 10.945, 10.323, 10.623000000000001, 10.421, 10.63, 11.676, 10.534, 10.952, 10.63, 10.745000000000001, 11.363, 10.86, 10.114, 10.743, 10.417, 10.425, 9.994, 9.923, 10.42, 9.919, 10.733, 11.264, 11.693999999999999, 10.644, 10.523000000000001, 10.938, 10.732000000000001, 11.05, 10.622, 12.336, 10.423000000000002, 10.467, 12.873000000000001, 10.622, 10.623000000000001, 10.523000000000001, 10.43, 12.748000000000001, 10.619, 10.520000000000001, 10.529, 10.518, 10.422, 10.527000000000001, 10.731000000000002, 10.744, 10.423, 10.622, 10.858, 10.325000000000001, 11.362], "episode_lengths": [41, 38, 37, 37, 40, 39, 37, 37, 41, 41, 37, 38, 37, 37, 39, 38, 40, 38, 38, 38, 38, 37, 37, 36, 38, 37, 38, 44, 38, 37, 38, 40, 35, 37, 38, 37, 37, 38, 37, 37, 35, 39, 39, 37, 36, 37, 37, 34, 38, 40, 37, 37, 37, 38, 42, 38, 40, 38, 39, 41, 41, 38, 39, 36, 37, 35, 38, 37, 37, 38, 41, 41, 39, 37, 39, 38, 40, 37, 48, 37, 43, 48, 37, 37, 37, 38, 49, 37, 37, 38, 37, 37, 37, 38, 39, 37, 37, 40, 37, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5178668932848985, "mean_inference_ms": 1.400932959248707, "mean_action_processing_ms": 0.08062087641243215, "mean_env_wait_ms": 4.925153367835402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034699440002441406, "ViewRequirementAgentConnector_ms": 0.2319014072418213}}, "episode_reward_max": 12.873000000000001, "episode_reward_min": 9.919, "episode_reward_mean": 10.697880000000003, "episode_len_mean": 38.35, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.575, 10.829, 10.617, 10.523000000000001, 10.638, 10.942, 10.531, 10.222000000000001, 11.065000000000001, 11.07, 10.619000000000002, 10.635, 10.617, 10.429, 10.942, 10.533, 10.955, 10.631, 10.535, 10.123000000000001, 10.226, 10.418000000000001, 10.521, 10.412, 10.133000000000001, 10.437000000000001, 10.322000000000001, 11.999, 10.625, 10.423, 10.733, 10.652, 10.605, 10.020000000000001, 10.634, 10.523000000000001, 10.423000000000002, 10.529, 10.520000000000001, 10.422, 10.302, 11.042, 11.743, 10.325000000000001, 10.713000000000001, 10.623000000000001, 10.620000000000001, 10.590000000000002, 10.120000000000001, 10.945, 10.323, 10.623000000000001, 10.421, 10.63, 11.676, 10.534, 10.952, 10.63, 10.745000000000001, 11.363, 10.86, 10.114, 10.743, 10.417, 10.425, 9.994, 9.923, 10.42, 9.919, 10.733, 11.264, 11.693999999999999, 10.644, 10.523000000000001, 10.938, 10.732000000000001, 11.05, 10.622, 12.336, 10.423000000000002, 10.467, 12.873000000000001, 10.622, 10.623000000000001, 10.523000000000001, 10.43, 12.748000000000001, 10.619, 10.520000000000001, 10.529, 10.518, 10.422, 10.527000000000001, 10.731000000000002, 10.744, 10.423, 10.622, 10.858, 10.325000000000001, 11.362], "episode_lengths": [41, 38, 37, 37, 40, 39, 37, 37, 41, 41, 37, 38, 37, 37, 39, 38, 40, 38, 38, 38, 38, 37, 37, 36, 38, 37, 38, 44, 38, 37, 38, 40, 35, 37, 38, 37, 37, 38, 37, 37, 35, 39, 39, 37, 36, 37, 37, 34, 38, 40, 37, 37, 37, 38, 42, 38, 40, 38, 39, 41, 41, 38, 39, 36, 37, 35, 38, 37, 37, 38, 41, 41, 39, 37, 39, 38, 40, 37, 48, 37, 43, 48, 37, 37, 37, 38, 49, 37, 37, 38, 37, 37, 37, 38, 39, 37, 37, 40, 37, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5178668932848985, "mean_inference_ms": 1.400932959248707, "mean_action_processing_ms": 0.08062087641243215, "mean_env_wait_ms": 4.925153367835402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034699440002441406, "ViewRequirementAgentConnector_ms": 0.2319014072418213}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53246, "num_agent_steps_trained": 0, "num_env_steps_sampled": 53248, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.636713506997605, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 53248, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 53246, "timers": {"training_iteration_time_ms": 50150.232, "sample_time_ms": 7161.893, "synch_weights_time_ms": 80.497}, "counters": {"num_env_steps_sampled": 53248, "num_env_steps_trained": 0, "num_agent_steps_sampled": 53246, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 970, "training_iteration": 52, "trial_id": "default", "date": "2025-12-20_11-30-32", "timestamp": 1766201432, "time_this_iter_s": 49.624430894851685, "time_total_s": 2596.994376897812, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2596.994376897812, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 75.48024691358025, "ram_util_percent": 14.200000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5792423270642757}, "default_policy": {"total_loss": 0.5792423270642757, "policy_loss": -0.010583269223570824, "vf_loss": 2.3634693890810015, "vf_loss_unclipped": 10.647170162200927, "vf_explained_var": 0.22086644917726517, "entropy": 0.28415309004485606, "mean_kl_loss": 0.003954256356519181, "gradients_default_optimizer_global_norm": 1.1539193496108056, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00376015625, "curr_kl_coeff": 0.0062500000931322575}}, "num_env_steps_sampled": 54272, "num_env_steps_trained": 0, "num_agent_steps_sampled": 54270, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.873000000000001, "episode_reward_min": 9.919, "episode_reward_mean": 10.697470000000001, "episode_len_mean": 38.0, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.625, 10.423, 10.733, 10.652, 10.605, 10.020000000000001, 10.634, 10.523000000000001, 10.423000000000002, 10.529, 10.520000000000001, 10.422, 10.302, 11.042, 11.743, 10.325000000000001, 10.713000000000001, 10.623000000000001, 10.620000000000001, 10.590000000000002, 10.120000000000001, 10.945, 10.323, 10.623000000000001, 10.421, 10.63, 11.676, 10.534, 10.952, 10.63, 10.745000000000001, 11.363, 10.86, 10.114, 10.743, 10.417, 10.425, 9.994, 9.923, 10.42, 9.919, 10.733, 11.264, 11.693999999999999, 10.644, 10.523000000000001, 10.938, 10.732000000000001, 11.05, 10.622, 12.336, 10.423000000000002, 10.467, 12.873000000000001, 10.622, 10.623000000000001, 10.523000000000001, 10.43, 12.748000000000001, 10.619, 10.520000000000001, 10.529, 10.518, 10.422, 10.527000000000001, 10.731000000000002, 10.744, 10.423, 10.622, 10.858, 10.325000000000001, 11.362, 10.831, 10.520000000000001, 10.621, 10.623000000000001, 10.305, 11.129999999999999, 10.620000000000001, 11.040000000000001, 11.748000000000001, 10.623000000000001, 10.63, 10.215000000000002, 10.625, 10.811, 10.53, 10.623000000000001, 10.073, 10.309000000000001, 10.419, 10.508000000000001, 10.623000000000001, 10.839000000000002, 10.844000000000001, 10.520000000000001, 10.623000000000001, 10.623000000000001, 10.833, 10.749], "episode_lengths": [38, 37, 38, 40, 35, 37, 38, 37, 37, 38, 37, 37, 35, 39, 39, 37, 36, 37, 37, 34, 38, 40, 37, 37, 37, 38, 42, 38, 40, 38, 39, 41, 41, 38, 39, 36, 37, 35, 38, 37, 37, 38, 41, 41, 39, 37, 39, 38, 40, 37, 48, 37, 43, 48, 37, 37, 37, 38, 49, 37, 37, 38, 37, 37, 37, 38, 39, 37, 37, 40, 37, 41, 38, 37, 37, 37, 35, 38, 37, 38, 39, 37, 38, 36, 37, 36, 38, 37, 31, 36, 37, 36, 37, 39, 39, 37, 37, 37, 38, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5190225120116766, "mean_inference_ms": 1.4007989348529575, "mean_action_processing_ms": 0.08062927726124013, "mean_env_wait_ms": 4.924749602153577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003437519073486328, "ViewRequirementAgentConnector_ms": 0.23236608505249023}}, "episode_reward_max": 12.873000000000001, "episode_reward_min": 9.919, "episode_reward_mean": 10.697470000000001, "episode_len_mean": 38.0, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.625, 10.423, 10.733, 10.652, 10.605, 10.020000000000001, 10.634, 10.523000000000001, 10.423000000000002, 10.529, 10.520000000000001, 10.422, 10.302, 11.042, 11.743, 10.325000000000001, 10.713000000000001, 10.623000000000001, 10.620000000000001, 10.590000000000002, 10.120000000000001, 10.945, 10.323, 10.623000000000001, 10.421, 10.63, 11.676, 10.534, 10.952, 10.63, 10.745000000000001, 11.363, 10.86, 10.114, 10.743, 10.417, 10.425, 9.994, 9.923, 10.42, 9.919, 10.733, 11.264, 11.693999999999999, 10.644, 10.523000000000001, 10.938, 10.732000000000001, 11.05, 10.622, 12.336, 10.423000000000002, 10.467, 12.873000000000001, 10.622, 10.623000000000001, 10.523000000000001, 10.43, 12.748000000000001, 10.619, 10.520000000000001, 10.529, 10.518, 10.422, 10.527000000000001, 10.731000000000002, 10.744, 10.423, 10.622, 10.858, 10.325000000000001, 11.362, 10.831, 10.520000000000001, 10.621, 10.623000000000001, 10.305, 11.129999999999999, 10.620000000000001, 11.040000000000001, 11.748000000000001, 10.623000000000001, 10.63, 10.215000000000002, 10.625, 10.811, 10.53, 10.623000000000001, 10.073, 10.309000000000001, 10.419, 10.508000000000001, 10.623000000000001, 10.839000000000002, 10.844000000000001, 10.520000000000001, 10.623000000000001, 10.623000000000001, 10.833, 10.749], "episode_lengths": [38, 37, 38, 40, 35, 37, 38, 37, 37, 38, 37, 37, 35, 39, 39, 37, 36, 37, 37, 34, 38, 40, 37, 37, 37, 38, 42, 38, 40, 38, 39, 41, 41, 38, 39, 36, 37, 35, 38, 37, 37, 38, 41, 41, 39, 37, 39, 38, 40, 37, 48, 37, 43, 48, 37, 37, 37, 38, 49, 37, 37, 38, 37, 37, 37, 38, 39, 37, 37, 40, 37, 41, 38, 37, 37, 37, 35, 38, 37, 38, 39, 37, 38, 36, 37, 36, 38, 37, 31, 36, 37, 36, 37, 39, 39, 37, 37, 37, 38, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5190225120116766, "mean_inference_ms": 1.4007989348529575, "mean_action_processing_ms": 0.08062927726124013, "mean_env_wait_ms": 4.924749602153577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003437519073486328, "ViewRequirementAgentConnector_ms": 0.23236608505249023}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54270, "num_agent_steps_trained": 0, "num_env_steps_sampled": 54272, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 19.977363014795042, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 54272, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 54270, "timers": {"training_iteration_time_ms": 50270.561, "sample_time_ms": 7162.493, "synch_weights_time_ms": 80.972}, "counters": {"num_env_steps_sampled": 54272, "num_env_steps_trained": 0, "num_agent_steps_sampled": 54270, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 998, "training_iteration": 53, "trial_id": "default", "date": "2025-12-20_11-31-24", "timestamp": 1766201484, "time_this_iter_s": 51.26172113418579, "time_total_s": 2648.2560980319977, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2648.2560980319977, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 86.01780821917808, "ram_util_percent": 14.572602739726026}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.633556567132473}, "default_policy": {"total_loss": 0.633556567132473, "policy_loss": -0.01035115085542202, "vf_loss": 2.580515670776367, "vf_loss_unclipped": 10.32770082950592, "vf_explained_var": 0.2682227909564972, "entropy": 0.33137016743421555, "mean_kl_loss": 0.0039698351595500725, "gradients_default_optimizer_global_norm": 1.4331236533820628, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0036801562500000003, "curr_kl_coeff": 0.0031250000465661287}}, "num_env_steps_sampled": 55296, "num_env_steps_trained": 0, "num_agent_steps_sampled": 55294, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.936, "episode_reward_min": 9.919, "episode_reward_mean": 10.77392, "episode_len_mean": 38.26, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.534, 10.952, 10.63, 10.745000000000001, 11.363, 10.86, 10.114, 10.743, 10.417, 10.425, 9.994, 9.923, 10.42, 9.919, 10.733, 11.264, 11.693999999999999, 10.644, 10.523000000000001, 10.938, 10.732000000000001, 11.05, 10.622, 12.336, 10.423000000000002, 10.467, 12.873000000000001, 10.622, 10.623000000000001, 10.523000000000001, 10.43, 12.748000000000001, 10.619, 10.520000000000001, 10.529, 10.518, 10.422, 10.527000000000001, 10.731000000000002, 10.744, 10.423, 10.622, 10.858, 10.325000000000001, 11.362, 10.831, 10.520000000000001, 10.621, 10.623000000000001, 10.305, 11.129999999999999, 10.620000000000001, 11.040000000000001, 11.748000000000001, 10.623000000000001, 10.63, 10.215000000000002, 10.625, 10.811, 10.53, 10.623000000000001, 10.073, 10.309000000000001, 10.419, 10.508000000000001, 10.623000000000001, 10.839000000000002, 10.844000000000001, 10.520000000000001, 10.623000000000001, 10.623000000000001, 10.833, 10.749, 10.611, 10.712, 10.833, 10.719999999999999, 10.623000000000001, 10.814, 10.814, 10.42, 10.421000000000001, 10.836000000000002, 10.623000000000001, 10.619, 10.635, 10.809000000000001, 12.936, 11.712, 11.461, 11.577, 10.507000000000001, 11.870000000000001, 11.592000000000002, 10.623000000000001, 10.623000000000001, 10.623000000000001, 10.408999999999999, 10.523000000000001, 10.504000000000001], "episode_lengths": [38, 40, 38, 39, 41, 41, 38, 39, 36, 37, 35, 38, 37, 37, 38, 41, 41, 39, 37, 39, 38, 40, 37, 48, 37, 43, 48, 37, 37, 37, 38, 49, 37, 37, 38, 37, 37, 37, 38, 39, 37, 37, 40, 37, 41, 38, 37, 37, 37, 35, 38, 37, 38, 39, 37, 38, 36, 37, 36, 38, 37, 31, 36, 37, 36, 37, 39, 39, 37, 37, 37, 38, 39, 36, 36, 38, 36, 37, 36, 36, 37, 37, 40, 37, 37, 38, 36, 47, 48, 41, 43, 36, 41, 45, 37, 37, 37, 36, 37, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5201851597850642, "mean_inference_ms": 1.4009816523764882, "mean_action_processing_ms": 0.08066236350836531, "mean_env_wait_ms": 4.925046119925088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003436565399169922, "ViewRequirementAgentConnector_ms": 0.23192763328552246}}, "episode_reward_max": 12.936, "episode_reward_min": 9.919, "episode_reward_mean": 10.77392, "episode_len_mean": 38.26, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.534, 10.952, 10.63, 10.745000000000001, 11.363, 10.86, 10.114, 10.743, 10.417, 10.425, 9.994, 9.923, 10.42, 9.919, 10.733, 11.264, 11.693999999999999, 10.644, 10.523000000000001, 10.938, 10.732000000000001, 11.05, 10.622, 12.336, 10.423000000000002, 10.467, 12.873000000000001, 10.622, 10.623000000000001, 10.523000000000001, 10.43, 12.748000000000001, 10.619, 10.520000000000001, 10.529, 10.518, 10.422, 10.527000000000001, 10.731000000000002, 10.744, 10.423, 10.622, 10.858, 10.325000000000001, 11.362, 10.831, 10.520000000000001, 10.621, 10.623000000000001, 10.305, 11.129999999999999, 10.620000000000001, 11.040000000000001, 11.748000000000001, 10.623000000000001, 10.63, 10.215000000000002, 10.625, 10.811, 10.53, 10.623000000000001, 10.073, 10.309000000000001, 10.419, 10.508000000000001, 10.623000000000001, 10.839000000000002, 10.844000000000001, 10.520000000000001, 10.623000000000001, 10.623000000000001, 10.833, 10.749, 10.611, 10.712, 10.833, 10.719999999999999, 10.623000000000001, 10.814, 10.814, 10.42, 10.421000000000001, 10.836000000000002, 10.623000000000001, 10.619, 10.635, 10.809000000000001, 12.936, 11.712, 11.461, 11.577, 10.507000000000001, 11.870000000000001, 11.592000000000002, 10.623000000000001, 10.623000000000001, 10.623000000000001, 10.408999999999999, 10.523000000000001, 10.504000000000001], "episode_lengths": [38, 40, 38, 39, 41, 41, 38, 39, 36, 37, 35, 38, 37, 37, 38, 41, 41, 39, 37, 39, 38, 40, 37, 48, 37, 43, 48, 37, 37, 37, 38, 49, 37, 37, 38, 37, 37, 37, 38, 39, 37, 37, 40, 37, 41, 38, 37, 37, 37, 35, 38, 37, 38, 39, 37, 38, 36, 37, 36, 38, 37, 31, 36, 37, 36, 37, 39, 39, 37, 37, 37, 38, 39, 36, 36, 38, 36, 37, 36, 36, 37, 37, 40, 37, 37, 38, 36, 47, 48, 41, 43, 36, 41, 45, 37, 37, 37, 36, 37, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5201851597850642, "mean_inference_ms": 1.4009816523764882, "mean_action_processing_ms": 0.08066236350836531, "mean_env_wait_ms": 4.925046119925088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003436565399169922, "ViewRequirementAgentConnector_ms": 0.23192763328552246}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55294, "num_agent_steps_trained": 0, "num_env_steps_sampled": 55296, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.191014924301147, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 55296, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 55294, "timers": {"training_iteration_time_ms": 50358.549, "sample_time_ms": 7162.919, "synch_weights_time_ms": 80.562}, "counters": {"num_env_steps_sampled": 55296, "num_env_steps_trained": 0, "num_agent_steps_sampled": 55294, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1025, "training_iteration": 54, "trial_id": "default", "date": "2025-12-20_11-32-14", "timestamp": 1766201534, "time_this_iter_s": 50.718671560287476, "time_total_s": 2698.974769592285, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2698.974769592285, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 85.91111111111111, "ram_util_percent": 14.801388888888887}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6172660864889622}, "default_policy": {"total_loss": 0.6172660864889622, "policy_loss": -0.0077723216265439985, "vf_loss": 2.5042022079229356, "vf_loss_unclipped": 10.7127534866333, "vf_explained_var": 0.23205565065145492, "entropy": 0.2763235453516245, "mean_kl_loss": 0.0015261450126231146, "gradients_default_optimizer_global_norm": 1.4212730526924133, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00360015625, "curr_kl_coeff": 0.0015625000232830644}}, "num_env_steps_sampled": 56320, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56318, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.936, "episode_reward_min": 10.073, "episode_reward_mean": 10.75134, "episode_len_mean": 37.86, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.873000000000001, 10.622, 10.623000000000001, 10.523000000000001, 10.43, 12.748000000000001, 10.619, 10.520000000000001, 10.529, 10.518, 10.422, 10.527000000000001, 10.731000000000002, 10.744, 10.423, 10.622, 10.858, 10.325000000000001, 11.362, 10.831, 10.520000000000001, 10.621, 10.623000000000001, 10.305, 11.129999999999999, 10.620000000000001, 11.040000000000001, 11.748000000000001, 10.623000000000001, 10.63, 10.215000000000002, 10.625, 10.811, 10.53, 10.623000000000001, 10.073, 10.309000000000001, 10.419, 10.508000000000001, 10.623000000000001, 10.839000000000002, 10.844000000000001, 10.520000000000001, 10.623000000000001, 10.623000000000001, 10.833, 10.749, 10.611, 10.712, 10.833, 10.719999999999999, 10.623000000000001, 10.814, 10.814, 10.42, 10.421000000000001, 10.836000000000002, 10.623000000000001, 10.619, 10.635, 10.809000000000001, 12.936, 11.712, 11.461, 11.577, 10.507000000000001, 11.870000000000001, 11.592000000000002, 10.623000000000001, 10.623000000000001, 10.623000000000001, 10.408999999999999, 10.523000000000001, 10.504000000000001, 10.63, 10.621, 10.838000000000001, 10.63, 10.122, 10.32, 10.318000000000001, 11.855, 10.508000000000001, 10.916, 10.203000000000001, 10.193, 10.835, 10.508000000000001, 10.212, 10.622, 11.06, 10.832, 10.523000000000001, 10.522, 10.612, 10.942, 10.725000000000001, 10.621, 10.326, 10.713000000000001], "episode_lengths": [48, 37, 37, 37, 38, 49, 37, 37, 38, 37, 37, 37, 38, 39, 37, 37, 40, 37, 41, 38, 37, 37, 37, 35, 38, 37, 38, 39, 37, 38, 36, 37, 36, 38, 37, 31, 36, 37, 36, 37, 39, 39, 37, 37, 37, 38, 39, 36, 36, 38, 36, 37, 36, 36, 37, 37, 40, 37, 37, 38, 36, 47, 48, 41, 43, 36, 41, 45, 37, 37, 37, 36, 37, 36, 38, 37, 39, 38, 38, 37, 37, 41, 36, 37, 36, 34, 39, 36, 36, 37, 40, 38, 37, 37, 36, 39, 38, 37, 38, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.521136254823866, "mean_inference_ms": 1.4008376501142181, "mean_action_processing_ms": 0.08067703895809317, "mean_env_wait_ms": 4.924670598167736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003393888473510742, "ViewRequirementAgentConnector_ms": 0.23040437698364258}}, "episode_reward_max": 12.936, "episode_reward_min": 10.073, "episode_reward_mean": 10.75134, "episode_len_mean": 37.86, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.873000000000001, 10.622, 10.623000000000001, 10.523000000000001, 10.43, 12.748000000000001, 10.619, 10.520000000000001, 10.529, 10.518, 10.422, 10.527000000000001, 10.731000000000002, 10.744, 10.423, 10.622, 10.858, 10.325000000000001, 11.362, 10.831, 10.520000000000001, 10.621, 10.623000000000001, 10.305, 11.129999999999999, 10.620000000000001, 11.040000000000001, 11.748000000000001, 10.623000000000001, 10.63, 10.215000000000002, 10.625, 10.811, 10.53, 10.623000000000001, 10.073, 10.309000000000001, 10.419, 10.508000000000001, 10.623000000000001, 10.839000000000002, 10.844000000000001, 10.520000000000001, 10.623000000000001, 10.623000000000001, 10.833, 10.749, 10.611, 10.712, 10.833, 10.719999999999999, 10.623000000000001, 10.814, 10.814, 10.42, 10.421000000000001, 10.836000000000002, 10.623000000000001, 10.619, 10.635, 10.809000000000001, 12.936, 11.712, 11.461, 11.577, 10.507000000000001, 11.870000000000001, 11.592000000000002, 10.623000000000001, 10.623000000000001, 10.623000000000001, 10.408999999999999, 10.523000000000001, 10.504000000000001, 10.63, 10.621, 10.838000000000001, 10.63, 10.122, 10.32, 10.318000000000001, 11.855, 10.508000000000001, 10.916, 10.203000000000001, 10.193, 10.835, 10.508000000000001, 10.212, 10.622, 11.06, 10.832, 10.523000000000001, 10.522, 10.612, 10.942, 10.725000000000001, 10.621, 10.326, 10.713000000000001], "episode_lengths": [48, 37, 37, 37, 38, 49, 37, 37, 38, 37, 37, 37, 38, 39, 37, 37, 40, 37, 41, 38, 37, 37, 37, 35, 38, 37, 38, 39, 37, 38, 36, 37, 36, 38, 37, 31, 36, 37, 36, 37, 39, 39, 37, 37, 37, 38, 39, 36, 36, 38, 36, 37, 36, 36, 37, 37, 40, 37, 37, 38, 36, 47, 48, 41, 43, 36, 41, 45, 37, 37, 37, 36, 37, 36, 38, 37, 39, 38, 38, 37, 37, 41, 36, 37, 36, 34, 39, 36, 36, 37, 40, 38, 37, 37, 36, 39, 38, 37, 38, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.521136254823866, "mean_inference_ms": 1.4008376501142181, "mean_action_processing_ms": 0.08067703895809317, "mean_env_wait_ms": 4.924670598167736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003393888473510742, "ViewRequirementAgentConnector_ms": 0.23040437698364258}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56318, "num_agent_steps_trained": 0, "num_env_steps_sampled": 56320, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.318601868961334, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 56320, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 56318, "timers": {"training_iteration_time_ms": 50352.784, "sample_time_ms": 7158.784, "synch_weights_time_ms": 79.648}, "counters": {"num_env_steps_sampled": 56320, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56318, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1051, "training_iteration": 55, "trial_id": "default", "date": "2025-12-20_11-33-05", "timestamp": 1766201585, "time_this_iter_s": 50.400065898895264, "time_total_s": 2749.3748354911804, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2749.3748354911804, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 85.95416666666668, "ram_util_percent": 14.799999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5732569359242916}, "default_policy": {"total_loss": 0.5732569359242916, "policy_loss": -0.01212082956917584, "vf_loss": 2.346068200469017, "vf_loss_unclipped": 9.65620814561844, "vf_explained_var": 0.40569962859153746, "entropy": 0.3173437789082527, "mean_kl_loss": 0.002044793533787015, "gradients_default_optimizer_global_norm": 1.3091511286795139, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00352015625, "curr_kl_coeff": 0.0007812500116415322}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 0, "num_agent_steps_sampled": 57342, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.936, "episode_reward_min": 9.975000000000001, "episode_reward_mean": 10.712750000000002, "episode_len_mean": 37.54, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.623000000000001, 10.63, 10.215000000000002, 10.625, 10.811, 10.53, 10.623000000000001, 10.073, 10.309000000000001, 10.419, 10.508000000000001, 10.623000000000001, 10.839000000000002, 10.844000000000001, 10.520000000000001, 10.623000000000001, 10.623000000000001, 10.833, 10.749, 10.611, 10.712, 10.833, 10.719999999999999, 10.623000000000001, 10.814, 10.814, 10.42, 10.421000000000001, 10.836000000000002, 10.623000000000001, 10.619, 10.635, 10.809000000000001, 12.936, 11.712, 11.461, 11.577, 10.507000000000001, 11.870000000000001, 11.592000000000002, 10.623000000000001, 10.623000000000001, 10.623000000000001, 10.408999999999999, 10.523000000000001, 10.504000000000001, 10.63, 10.621, 10.838000000000001, 10.63, 10.122, 10.32, 10.318000000000001, 11.855, 10.508000000000001, 10.916, 10.203000000000001, 10.193, 10.835, 10.508000000000001, 10.212, 10.622, 11.06, 10.832, 10.523000000000001, 10.522, 10.612, 10.942, 10.725000000000001, 10.621, 10.326, 10.713000000000001, 10.944, 10.623000000000001, 10.949000000000002, 10.622, 10.632000000000001, 10.518, 10.79, 11.248, 10.617, 10.618, 10.623000000000001, 10.620000000000001, 10.312000000000001, 10.511, 10.927, 10.201, 10.619, 11.445, 9.975000000000001, 10.814, 10.811, 10.623000000000001, 11.134, 10.924, 11.258000000000001, 10.408, 10.529, 10.303], "episode_lengths": [37, 38, 36, 37, 36, 38, 37, 31, 36, 37, 36, 37, 39, 39, 37, 37, 37, 38, 39, 36, 36, 38, 36, 37, 36, 36, 37, 37, 40, 37, 37, 38, 36, 47, 48, 41, 43, 36, 41, 45, 37, 37, 37, 36, 37, 36, 38, 37, 39, 38, 38, 37, 37, 41, 36, 37, 36, 34, 39, 36, 36, 37, 40, 38, 37, 37, 36, 39, 38, 37, 38, 36, 41, 37, 40, 37, 38, 37, 35, 39, 37, 37, 37, 37, 36, 37, 37, 35, 37, 39, 34, 36, 36, 37, 39, 37, 41, 36, 38, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5221057533590707, "mean_inference_ms": 1.400475005867308, "mean_action_processing_ms": 0.08066053018042213, "mean_env_wait_ms": 4.923834981933553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003427267074584961, "ViewRequirementAgentConnector_ms": 0.2304990291595459}}, "episode_reward_max": 12.936, "episode_reward_min": 9.975000000000001, "episode_reward_mean": 10.712750000000002, "episode_len_mean": 37.54, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.623000000000001, 10.63, 10.215000000000002, 10.625, 10.811, 10.53, 10.623000000000001, 10.073, 10.309000000000001, 10.419, 10.508000000000001, 10.623000000000001, 10.839000000000002, 10.844000000000001, 10.520000000000001, 10.623000000000001, 10.623000000000001, 10.833, 10.749, 10.611, 10.712, 10.833, 10.719999999999999, 10.623000000000001, 10.814, 10.814, 10.42, 10.421000000000001, 10.836000000000002, 10.623000000000001, 10.619, 10.635, 10.809000000000001, 12.936, 11.712, 11.461, 11.577, 10.507000000000001, 11.870000000000001, 11.592000000000002, 10.623000000000001, 10.623000000000001, 10.623000000000001, 10.408999999999999, 10.523000000000001, 10.504000000000001, 10.63, 10.621, 10.838000000000001, 10.63, 10.122, 10.32, 10.318000000000001, 11.855, 10.508000000000001, 10.916, 10.203000000000001, 10.193, 10.835, 10.508000000000001, 10.212, 10.622, 11.06, 10.832, 10.523000000000001, 10.522, 10.612, 10.942, 10.725000000000001, 10.621, 10.326, 10.713000000000001, 10.944, 10.623000000000001, 10.949000000000002, 10.622, 10.632000000000001, 10.518, 10.79, 11.248, 10.617, 10.618, 10.623000000000001, 10.620000000000001, 10.312000000000001, 10.511, 10.927, 10.201, 10.619, 11.445, 9.975000000000001, 10.814, 10.811, 10.623000000000001, 11.134, 10.924, 11.258000000000001, 10.408, 10.529, 10.303], "episode_lengths": [37, 38, 36, 37, 36, 38, 37, 31, 36, 37, 36, 37, 39, 39, 37, 37, 37, 38, 39, 36, 36, 38, 36, 37, 36, 36, 37, 37, 40, 37, 37, 38, 36, 47, 48, 41, 43, 36, 41, 45, 37, 37, 37, 36, 37, 36, 38, 37, 39, 38, 38, 37, 37, 41, 36, 37, 36, 34, 39, 36, 36, 37, 40, 38, 37, 37, 36, 39, 38, 37, 38, 36, 41, 37, 40, 37, 38, 37, 35, 39, 37, 37, 37, 37, 36, 37, 37, 35, 37, 39, 34, 36, 36, 37, 39, 37, 41, 36, 38, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5221057533590707, "mean_inference_ms": 1.400475005867308, "mean_action_processing_ms": 0.08066053018042213, "mean_env_wait_ms": 4.923834981933553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003427267074584961, "ViewRequirementAgentConnector_ms": 0.2304990291595459}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57342, "num_agent_steps_trained": 0, "num_env_steps_sampled": 57344, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.147617042737743, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 57344, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 57342, "timers": {"training_iteration_time_ms": 50485.823, "sample_time_ms": 7156.96, "synch_weights_time_ms": 79.5}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 0, "num_agent_steps_sampled": 57342, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1079, "training_iteration": 56, "trial_id": "default", "date": "2025-12-20_11-33-56", "timestamp": 1766201636, "time_this_iter_s": 50.83094120025635, "time_total_s": 2800.2057766914368, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2800.2057766914368, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 85.96666666666667, "ram_util_percent": 14.799999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5550436958670616}, "default_policy": {"total_loss": 0.5550436958670616, "policy_loss": -0.008881647000089287, "vf_loss": 2.260192945599556, "vf_loss_unclipped": 9.083078444004059, "vf_explained_var": 0.46930198520421984, "entropy": 0.31941133812069894, "mean_kl_loss": 0.0018945100725886732, "gradients_default_optimizer_global_norm": 1.333757396042347, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00344015625, "curr_kl_coeff": 0.0003906250058207661}}, "num_env_steps_sampled": 58368, "num_env_steps_trained": 0, "num_agent_steps_sampled": 58366, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.936, "episode_reward_min": 9.975000000000001, "episode_reward_mean": 10.72892, "episode_len_mean": 37.58, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.836000000000002, 10.623000000000001, 10.619, 10.635, 10.809000000000001, 12.936, 11.712, 11.461, 11.577, 10.507000000000001, 11.870000000000001, 11.592000000000002, 10.623000000000001, 10.623000000000001, 10.623000000000001, 10.408999999999999, 10.523000000000001, 10.504000000000001, 10.63, 10.621, 10.838000000000001, 10.63, 10.122, 10.32, 10.318000000000001, 11.855, 10.508000000000001, 10.916, 10.203000000000001, 10.193, 10.835, 10.508000000000001, 10.212, 10.622, 11.06, 10.832, 10.523000000000001, 10.522, 10.612, 10.942, 10.725000000000001, 10.621, 10.326, 10.713000000000001, 10.944, 10.623000000000001, 10.949000000000002, 10.622, 10.632000000000001, 10.518, 10.79, 11.248, 10.617, 10.618, 10.623000000000001, 10.620000000000001, 10.312000000000001, 10.511, 10.927, 10.201, 10.619, 11.445, 9.975000000000001, 10.814, 10.811, 10.623000000000001, 11.134, 10.924, 11.258000000000001, 10.408, 10.529, 10.303, 10.71, 10.631, 10.504, 10.308, 10.731000000000002, 10.506, 10.407, 12.404, 10.328000000000001, 10.523000000000001, 10.623000000000001, 10.508000000000001, 10.327, 10.222999999999999, 10.51, 10.617, 10.711000000000002, 10.119, 11.649000000000001, 10.819999999999999, 10.839000000000002, 10.411000000000001, 10.811, 10.509, 11.033, 10.712, 10.508000000000001, 10.623000000000001], "episode_lengths": [40, 37, 37, 38, 36, 47, 48, 41, 43, 36, 41, 45, 37, 37, 37, 36, 37, 36, 38, 37, 39, 38, 38, 37, 37, 41, 36, 37, 36, 34, 39, 36, 36, 37, 40, 38, 37, 37, 36, 39, 38, 37, 38, 36, 41, 37, 40, 37, 38, 37, 35, 39, 37, 37, 37, 37, 36, 37, 37, 35, 37, 39, 34, 36, 36, 37, 39, 37, 41, 36, 38, 35, 36, 38, 36, 36, 38, 36, 36, 44, 38, 37, 37, 36, 38, 37, 36, 37, 36, 37, 38, 34, 39, 36, 36, 36, 38, 36, 36, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5230596852261676, "mean_inference_ms": 1.4002372246711323, "mean_action_processing_ms": 0.08065273891175799, "mean_env_wait_ms": 4.923288482157611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034606456756591797, "ViewRequirementAgentConnector_ms": 0.23093557357788086}}, "episode_reward_max": 12.936, "episode_reward_min": 9.975000000000001, "episode_reward_mean": 10.72892, "episode_len_mean": 37.58, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.836000000000002, 10.623000000000001, 10.619, 10.635, 10.809000000000001, 12.936, 11.712, 11.461, 11.577, 10.507000000000001, 11.870000000000001, 11.592000000000002, 10.623000000000001, 10.623000000000001, 10.623000000000001, 10.408999999999999, 10.523000000000001, 10.504000000000001, 10.63, 10.621, 10.838000000000001, 10.63, 10.122, 10.32, 10.318000000000001, 11.855, 10.508000000000001, 10.916, 10.203000000000001, 10.193, 10.835, 10.508000000000001, 10.212, 10.622, 11.06, 10.832, 10.523000000000001, 10.522, 10.612, 10.942, 10.725000000000001, 10.621, 10.326, 10.713000000000001, 10.944, 10.623000000000001, 10.949000000000002, 10.622, 10.632000000000001, 10.518, 10.79, 11.248, 10.617, 10.618, 10.623000000000001, 10.620000000000001, 10.312000000000001, 10.511, 10.927, 10.201, 10.619, 11.445, 9.975000000000001, 10.814, 10.811, 10.623000000000001, 11.134, 10.924, 11.258000000000001, 10.408, 10.529, 10.303, 10.71, 10.631, 10.504, 10.308, 10.731000000000002, 10.506, 10.407, 12.404, 10.328000000000001, 10.523000000000001, 10.623000000000001, 10.508000000000001, 10.327, 10.222999999999999, 10.51, 10.617, 10.711000000000002, 10.119, 11.649000000000001, 10.819999999999999, 10.839000000000002, 10.411000000000001, 10.811, 10.509, 11.033, 10.712, 10.508000000000001, 10.623000000000001], "episode_lengths": [40, 37, 37, 38, 36, 47, 48, 41, 43, 36, 41, 45, 37, 37, 37, 36, 37, 36, 38, 37, 39, 38, 38, 37, 37, 41, 36, 37, 36, 34, 39, 36, 36, 37, 40, 38, 37, 37, 36, 39, 38, 37, 38, 36, 41, 37, 40, 37, 38, 37, 35, 39, 37, 37, 37, 37, 36, 37, 37, 35, 37, 39, 34, 36, 36, 37, 39, 37, 41, 36, 38, 35, 36, 38, 36, 36, 38, 36, 36, 44, 38, 37, 37, 36, 38, 37, 36, 37, 36, 37, 38, 34, 39, 36, 36, 36, 38, 36, 36, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5230596852261676, "mean_inference_ms": 1.4002372246711323, "mean_action_processing_ms": 0.08065273891175799, "mean_env_wait_ms": 4.923288482157611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034606456756591797, "ViewRequirementAgentConnector_ms": 0.23093557357788086}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58366, "num_agent_steps_trained": 0, "num_env_steps_sampled": 58368, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.31430501778601, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 58368, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 58366, "timers": {"training_iteration_time_ms": 50499.609, "sample_time_ms": 7157.767, "synch_weights_time_ms": 78.395}, "counters": {"num_env_steps_sampled": 58368, "num_env_steps_trained": 0, "num_agent_steps_sampled": 58366, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1107, "training_iteration": 57, "trial_id": "default", "date": "2025-12-20_11-34-53", "timestamp": 1766201693, "time_this_iter_s": 50.41096878051758, "time_total_s": 2850.6167454719543, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2850.6167454719543, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 75.95243902439024, "ram_util_percent": 14.915853658536589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5488452732563018}, "default_policy": {"total_loss": 0.5488452732563018, "policy_loss": -0.008622575923800469, "vf_loss": 2.233792778849602, "vf_loss_unclipped": 9.577088582515717, "vf_explained_var": 0.41475310921669006, "entropy": 0.28516397178173064, "mean_kl_loss": 0.0016817861274603275, "gradients_default_optimizer_global_norm": 1.464992281794548, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0033601562500000003, "curr_kl_coeff": 0.00019531250291038305}}, "num_env_steps_sampled": 59392, "num_env_steps_trained": 0, "num_agent_steps_sampled": 59390, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.404, "episode_reward_min": 9.975000000000001, "episode_reward_mean": 10.68836, "episode_len_mean": 37.27, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.916, 10.203000000000001, 10.193, 10.835, 10.508000000000001, 10.212, 10.622, 11.06, 10.832, 10.523000000000001, 10.522, 10.612, 10.942, 10.725000000000001, 10.621, 10.326, 10.713000000000001, 10.944, 10.623000000000001, 10.949000000000002, 10.622, 10.632000000000001, 10.518, 10.79, 11.248, 10.617, 10.618, 10.623000000000001, 10.620000000000001, 10.312000000000001, 10.511, 10.927, 10.201, 10.619, 11.445, 9.975000000000001, 10.814, 10.811, 10.623000000000001, 11.134, 10.924, 11.258000000000001, 10.408, 10.529, 10.303, 10.71, 10.631, 10.504, 10.308, 10.731000000000002, 10.506, 10.407, 12.404, 10.328000000000001, 10.523000000000001, 10.623000000000001, 10.508000000000001, 10.327, 10.222999999999999, 10.51, 10.617, 10.711000000000002, 10.119, 11.649000000000001, 10.819999999999999, 10.839000000000002, 10.411000000000001, 10.811, 10.509, 11.033, 10.712, 10.508000000000001, 10.623000000000001, 10.623000000000001, 10.623000000000001, 11.026, 10.520000000000001, 10.520000000000001, 10.712000000000002, 10.619, 12.07, 10.623000000000001, 10.619, 10.953000000000001, 10.620000000000001, 10.620000000000001, 10.528, 10.620000000000001, 10.623000000000001, 12.216000000000001, 11.071000000000002, 10.228, 10.608, 10.814, 10.317, 10.622, 11.027000000000001, 10.203000000000001, 10.623000000000001, 10.620000000000001], "episode_lengths": [37, 36, 34, 39, 36, 36, 37, 40, 38, 37, 37, 36, 39, 38, 37, 38, 36, 41, 37, 40, 37, 38, 37, 35, 39, 37, 37, 37, 37, 36, 37, 37, 35, 37, 39, 34, 36, 36, 37, 39, 37, 41, 36, 38, 35, 36, 38, 36, 36, 38, 36, 36, 44, 38, 37, 37, 36, 38, 37, 36, 37, 36, 37, 38, 34, 39, 36, 36, 36, 38, 36, 36, 37, 37, 37, 37, 37, 37, 36, 37, 41, 37, 37, 40, 37, 37, 38, 37, 37, 47, 42, 38, 36, 36, 37, 37, 38, 35, 37, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5239033930954203, "mean_inference_ms": 1.399871957858212, "mean_action_processing_ms": 0.08063216340697837, "mean_env_wait_ms": 4.92236764007943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034723281860351562, "ViewRequirementAgentConnector_ms": 0.23054742813110352}}, "episode_reward_max": 12.404, "episode_reward_min": 9.975000000000001, "episode_reward_mean": 10.68836, "episode_len_mean": 37.27, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.916, 10.203000000000001, 10.193, 10.835, 10.508000000000001, 10.212, 10.622, 11.06, 10.832, 10.523000000000001, 10.522, 10.612, 10.942, 10.725000000000001, 10.621, 10.326, 10.713000000000001, 10.944, 10.623000000000001, 10.949000000000002, 10.622, 10.632000000000001, 10.518, 10.79, 11.248, 10.617, 10.618, 10.623000000000001, 10.620000000000001, 10.312000000000001, 10.511, 10.927, 10.201, 10.619, 11.445, 9.975000000000001, 10.814, 10.811, 10.623000000000001, 11.134, 10.924, 11.258000000000001, 10.408, 10.529, 10.303, 10.71, 10.631, 10.504, 10.308, 10.731000000000002, 10.506, 10.407, 12.404, 10.328000000000001, 10.523000000000001, 10.623000000000001, 10.508000000000001, 10.327, 10.222999999999999, 10.51, 10.617, 10.711000000000002, 10.119, 11.649000000000001, 10.819999999999999, 10.839000000000002, 10.411000000000001, 10.811, 10.509, 11.033, 10.712, 10.508000000000001, 10.623000000000001, 10.623000000000001, 10.623000000000001, 11.026, 10.520000000000001, 10.520000000000001, 10.712000000000002, 10.619, 12.07, 10.623000000000001, 10.619, 10.953000000000001, 10.620000000000001, 10.620000000000001, 10.528, 10.620000000000001, 10.623000000000001, 12.216000000000001, 11.071000000000002, 10.228, 10.608, 10.814, 10.317, 10.622, 11.027000000000001, 10.203000000000001, 10.623000000000001, 10.620000000000001], "episode_lengths": [37, 36, 34, 39, 36, 36, 37, 40, 38, 37, 37, 36, 39, 38, 37, 38, 36, 41, 37, 40, 37, 38, 37, 35, 39, 37, 37, 37, 37, 36, 37, 37, 35, 37, 39, 34, 36, 36, 37, 39, 37, 41, 36, 38, 35, 36, 38, 36, 36, 38, 36, 36, 44, 38, 37, 37, 36, 38, 37, 36, 37, 36, 37, 38, 34, 39, 36, 36, 36, 38, 36, 36, 37, 37, 37, 37, 37, 37, 36, 37, 41, 37, 37, 40, 37, 37, 38, 37, 37, 47, 42, 38, 36, 36, 37, 37, 38, 35, 37, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5239033930954203, "mean_inference_ms": 1.399871957858212, "mean_action_processing_ms": 0.08063216340697837, "mean_env_wait_ms": 4.92236764007943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034723281860351562, "ViewRequirementAgentConnector_ms": 0.23054742813110352}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59390, "num_agent_steps_trained": 0, "num_env_steps_sampled": 59392, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.2509687769459, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 59392, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 59390, "timers": {"training_iteration_time_ms": 50553.658, "sample_time_ms": 7147.769, "synch_weights_time_ms": 77.177}, "counters": {"num_env_steps_sampled": 59392, "num_env_steps_trained": 0, "num_agent_steps_sampled": 59390, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1134, "training_iteration": 58, "trial_id": "default", "date": "2025-12-20_11-35-44", "timestamp": 1766201744, "time_this_iter_s": 50.57051634788513, "time_total_s": 2901.1872618198395, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2901.1872618198395, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 85.62916666666666, "ram_util_percent": 14.900000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5854105420410634}, "default_policy": {"total_loss": 0.5854105420410634, "policy_loss": -0.009622294176369905, "vf_loss": 2.384077048301697, "vf_loss_unclipped": 9.224649310112, "vf_explained_var": 0.4337743192911148, "entropy": 0.2936751753091812, "mean_kl_loss": 0.0018881039183952452, "gradients_default_optimizer_global_norm": 1.333096796274185, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00328015625, "curr_kl_coeff": 9.765625145519152e-05}}, "num_env_steps_sampled": 60416, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60414, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 13.952, "episode_reward_min": 9.975000000000001, "episode_reward_mean": 10.733120000000003, "episode_len_mean": 37.66, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.618, 10.623000000000001, 10.620000000000001, 10.312000000000001, 10.511, 10.927, 10.201, 10.619, 11.445, 9.975000000000001, 10.814, 10.811, 10.623000000000001, 11.134, 10.924, 11.258000000000001, 10.408, 10.529, 10.303, 10.71, 10.631, 10.504, 10.308, 10.731000000000002, 10.506, 10.407, 12.404, 10.328000000000001, 10.523000000000001, 10.623000000000001, 10.508000000000001, 10.327, 10.222999999999999, 10.51, 10.617, 10.711000000000002, 10.119, 11.649000000000001, 10.819999999999999, 10.839000000000002, 10.411000000000001, 10.811, 10.509, 11.033, 10.712, 10.508000000000001, 10.623000000000001, 10.623000000000001, 10.623000000000001, 11.026, 10.520000000000001, 10.520000000000001, 10.712000000000002, 10.619, 12.07, 10.623000000000001, 10.619, 10.953000000000001, 10.620000000000001, 10.620000000000001, 10.528, 10.620000000000001, 10.623000000000001, 12.216000000000001, 11.071000000000002, 10.228, 10.608, 10.814, 10.317, 10.622, 11.027000000000001, 10.203000000000001, 10.623000000000001, 10.620000000000001, 10.241, 10.728000000000002, 10.623000000000001, 10.712, 10.823, 10.839000000000002, 10.419, 10.84, 10.442, 10.712, 10.641, 10.807, 10.623000000000001, 10.418, 10.303, 13.952, 10.623000000000001, 10.741000000000001, 10.623000000000001, 10.834000000000001, 10.616, 10.634, 11.528, 10.73, 10.979, 11.353], "episode_lengths": [37, 37, 37, 36, 37, 37, 35, 37, 39, 34, 36, 36, 37, 39, 37, 41, 36, 38, 35, 36, 38, 36, 36, 38, 36, 36, 44, 38, 37, 37, 36, 38, 37, 36, 37, 36, 37, 38, 34, 39, 36, 36, 36, 38, 36, 36, 37, 37, 37, 37, 37, 37, 36, 37, 41, 37, 37, 40, 37, 37, 38, 37, 37, 47, 42, 38, 36, 36, 37, 37, 38, 35, 37, 37, 40, 38, 37, 36, 38, 39, 37, 39, 40, 36, 39, 36, 37, 36, 36, 50, 37, 39, 37, 38, 37, 38, 49, 38, 43, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5247422021864537, "mean_inference_ms": 1.3999518211312323, "mean_action_processing_ms": 0.08064268051373585, "mean_env_wait_ms": 4.922305094863638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003473520278930664, "ViewRequirementAgentConnector_ms": 0.23171472549438477}}, "episode_reward_max": 13.952, "episode_reward_min": 9.975000000000001, "episode_reward_mean": 10.733120000000003, "episode_len_mean": 37.66, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.618, 10.623000000000001, 10.620000000000001, 10.312000000000001, 10.511, 10.927, 10.201, 10.619, 11.445, 9.975000000000001, 10.814, 10.811, 10.623000000000001, 11.134, 10.924, 11.258000000000001, 10.408, 10.529, 10.303, 10.71, 10.631, 10.504, 10.308, 10.731000000000002, 10.506, 10.407, 12.404, 10.328000000000001, 10.523000000000001, 10.623000000000001, 10.508000000000001, 10.327, 10.222999999999999, 10.51, 10.617, 10.711000000000002, 10.119, 11.649000000000001, 10.819999999999999, 10.839000000000002, 10.411000000000001, 10.811, 10.509, 11.033, 10.712, 10.508000000000001, 10.623000000000001, 10.623000000000001, 10.623000000000001, 11.026, 10.520000000000001, 10.520000000000001, 10.712000000000002, 10.619, 12.07, 10.623000000000001, 10.619, 10.953000000000001, 10.620000000000001, 10.620000000000001, 10.528, 10.620000000000001, 10.623000000000001, 12.216000000000001, 11.071000000000002, 10.228, 10.608, 10.814, 10.317, 10.622, 11.027000000000001, 10.203000000000001, 10.623000000000001, 10.620000000000001, 10.241, 10.728000000000002, 10.623000000000001, 10.712, 10.823, 10.839000000000002, 10.419, 10.84, 10.442, 10.712, 10.641, 10.807, 10.623000000000001, 10.418, 10.303, 13.952, 10.623000000000001, 10.741000000000001, 10.623000000000001, 10.834000000000001, 10.616, 10.634, 11.528, 10.73, 10.979, 11.353], "episode_lengths": [37, 37, 37, 36, 37, 37, 35, 37, 39, 34, 36, 36, 37, 39, 37, 41, 36, 38, 35, 36, 38, 36, 36, 38, 36, 36, 44, 38, 37, 37, 36, 38, 37, 36, 37, 36, 37, 38, 34, 39, 36, 36, 36, 38, 36, 36, 37, 37, 37, 37, 37, 37, 36, 37, 41, 37, 37, 40, 37, 37, 38, 37, 37, 47, 42, 38, 36, 36, 37, 37, 38, 35, 37, 37, 40, 38, 37, 36, 38, 39, 37, 39, 40, 36, 39, 36, 37, 36, 36, 50, 37, 39, 37, 38, 37, 38, 49, 38, 43, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5247422021864537, "mean_inference_ms": 1.3999518211312323, "mean_action_processing_ms": 0.08064268051373585, "mean_env_wait_ms": 4.922305094863638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003473520278930664, "ViewRequirementAgentConnector_ms": 0.23171472549438477}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60414, "num_agent_steps_trained": 0, "num_env_steps_sampled": 60416, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.548021759903573, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 60416, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 60414, "timers": {"training_iteration_time_ms": 50423.937, "sample_time_ms": 7153.379, "synch_weights_time_ms": 76.983}, "counters": {"num_env_steps_sampled": 60416, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60414, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1160, "training_iteration": 59, "trial_id": "default", "date": "2025-12-20_11-36-34", "timestamp": 1766201794, "time_this_iter_s": 49.837968587875366, "time_total_s": 2951.025230407715, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2951.025230407715, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 85.68732394366197, "ram_util_percent": 14.392957746478869}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.6049546606838703}, "default_policy": {"total_loss": 0.6049546606838703, "policy_loss": -0.01051289183087647, "vf_loss": 2.4654492318630217, "vf_loss_unclipped": 9.94304279088974, "vf_explained_var": 0.33861769884824755, "entropy": 0.27287276200950145, "mean_kl_loss": 0.003178360816990122, "gradients_default_optimizer_global_norm": 1.0276474073529243, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00320015625, "curr_kl_coeff": 4.882812572759576e-05}}, "num_env_steps_sampled": 61440, "num_env_steps_trained": 0, "num_agent_steps_sampled": 61438, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 13.952, "episode_reward_min": 10.119, "episode_reward_mean": 10.743190000000004, "episode_len_mean": 37.89, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.328000000000001, 10.523000000000001, 10.623000000000001, 10.508000000000001, 10.327, 10.222999999999999, 10.51, 10.617, 10.711000000000002, 10.119, 11.649000000000001, 10.819999999999999, 10.839000000000002, 10.411000000000001, 10.811, 10.509, 11.033, 10.712, 10.508000000000001, 10.623000000000001, 10.623000000000001, 10.623000000000001, 11.026, 10.520000000000001, 10.520000000000001, 10.712000000000002, 10.619, 12.07, 10.623000000000001, 10.619, 10.953000000000001, 10.620000000000001, 10.620000000000001, 10.528, 10.620000000000001, 10.623000000000001, 12.216000000000001, 11.071000000000002, 10.228, 10.608, 10.814, 10.317, 10.622, 11.027000000000001, 10.203000000000001, 10.623000000000001, 10.620000000000001, 10.241, 10.728000000000002, 10.623000000000001, 10.712, 10.823, 10.839000000000002, 10.419, 10.84, 10.442, 10.712, 10.641, 10.807, 10.623000000000001, 10.418, 10.303, 13.952, 10.623000000000001, 10.741000000000001, 10.623000000000001, 10.834000000000001, 10.616, 10.634, 11.528, 10.73, 10.979, 11.353, 10.620000000000001, 10.518, 11.674000000000001, 10.620000000000001, 10.733, 11.347000000000001, 10.527000000000001, 10.728000000000002, 10.82, 10.836, 10.506, 10.625, 10.743, 11.898, 10.623000000000001, 10.520000000000001, 10.596000000000002, 10.428, 10.623000000000001, 10.622, 10.809000000000001, 10.422, 10.421000000000001, 10.621, 10.622, 10.738, 10.623000000000001], "episode_lengths": [38, 37, 37, 36, 38, 37, 36, 37, 36, 37, 38, 34, 39, 36, 36, 36, 38, 36, 36, 37, 37, 37, 37, 37, 37, 36, 37, 41, 37, 37, 40, 37, 37, 38, 37, 37, 47, 42, 38, 36, 36, 37, 37, 38, 35, 37, 37, 40, 38, 37, 36, 38, 39, 37, 39, 40, 36, 39, 36, 37, 36, 36, 50, 37, 39, 37, 38, 37, 38, 49, 38, 43, 41, 37, 37, 42, 37, 38, 39, 38, 37, 37, 39, 36, 39, 39, 46, 37, 37, 36, 38, 38, 37, 36, 37, 37, 37, 37, 39, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5255307786524237, "mean_inference_ms": 1.399947552672846, "mean_action_processing_ms": 0.08064187849335255, "mean_env_wait_ms": 4.921884631321728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034940242767333984, "ViewRequirementAgentConnector_ms": 0.2321794033050537}}, "episode_reward_max": 13.952, "episode_reward_min": 10.119, "episode_reward_mean": 10.743190000000004, "episode_len_mean": 37.89, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.328000000000001, 10.523000000000001, 10.623000000000001, 10.508000000000001, 10.327, 10.222999999999999, 10.51, 10.617, 10.711000000000002, 10.119, 11.649000000000001, 10.819999999999999, 10.839000000000002, 10.411000000000001, 10.811, 10.509, 11.033, 10.712, 10.508000000000001, 10.623000000000001, 10.623000000000001, 10.623000000000001, 11.026, 10.520000000000001, 10.520000000000001, 10.712000000000002, 10.619, 12.07, 10.623000000000001, 10.619, 10.953000000000001, 10.620000000000001, 10.620000000000001, 10.528, 10.620000000000001, 10.623000000000001, 12.216000000000001, 11.071000000000002, 10.228, 10.608, 10.814, 10.317, 10.622, 11.027000000000001, 10.203000000000001, 10.623000000000001, 10.620000000000001, 10.241, 10.728000000000002, 10.623000000000001, 10.712, 10.823, 10.839000000000002, 10.419, 10.84, 10.442, 10.712, 10.641, 10.807, 10.623000000000001, 10.418, 10.303, 13.952, 10.623000000000001, 10.741000000000001, 10.623000000000001, 10.834000000000001, 10.616, 10.634, 11.528, 10.73, 10.979, 11.353, 10.620000000000001, 10.518, 11.674000000000001, 10.620000000000001, 10.733, 11.347000000000001, 10.527000000000001, 10.728000000000002, 10.82, 10.836, 10.506, 10.625, 10.743, 11.898, 10.623000000000001, 10.520000000000001, 10.596000000000002, 10.428, 10.623000000000001, 10.622, 10.809000000000001, 10.422, 10.421000000000001, 10.621, 10.622, 10.738, 10.623000000000001], "episode_lengths": [38, 37, 37, 36, 38, 37, 36, 37, 36, 37, 38, 34, 39, 36, 36, 36, 38, 36, 36, 37, 37, 37, 37, 37, 37, 36, 37, 41, 37, 37, 40, 37, 37, 38, 37, 37, 47, 42, 38, 36, 36, 37, 37, 38, 35, 37, 37, 40, 38, 37, 36, 38, 39, 37, 39, 40, 36, 39, 36, 37, 36, 36, 50, 37, 39, 37, 38, 37, 38, 49, 38, 43, 41, 37, 37, 42, 37, 38, 39, 38, 37, 37, 39, 36, 39, 39, 46, 37, 37, 36, 38, 38, 37, 36, 37, 37, 37, 37, 39, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5255307786524237, "mean_inference_ms": 1.399947552672846, "mean_action_processing_ms": 0.08064187849335255, "mean_env_wait_ms": 4.921884631321728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034940242767333984, "ViewRequirementAgentConnector_ms": 0.2321794033050537}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61438, "num_agent_steps_trained": 0, "num_env_steps_sampled": 61440, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.37275160012106, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 61440, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 61438, "timers": {"training_iteration_time_ms": 50457.085, "sample_time_ms": 7153.929, "synch_weights_time_ms": 76.28}, "counters": {"num_env_steps_sampled": 61440, "num_env_steps_trained": 0, "num_agent_steps_sampled": 61438, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1187, "training_iteration": 60, "trial_id": "default", "date": "2025-12-20_11-37-24", "timestamp": 1766201844, "time_this_iter_s": 50.266114950180054, "time_total_s": 3001.291345357895, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3001.291345357895, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 85.76901408450703, "ram_util_percent": 14.302816901408445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.5163693584501743}, "default_policy": {"total_loss": 0.5163693584501743, "policy_loss": -0.016478141606785356, "vf_loss": 2.1346447229385377, "vf_loss_unclipped": 9.728864479064942, "vf_explained_var": 0.3966583326458931, "entropy": 0.2543829414993525, "mean_kl_loss": 0.007804845884990641, "gradients_default_optimizer_global_norm": 0.7034910596907139, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00312015625, "curr_kl_coeff": 4.882812572759576e-05}}, "num_env_steps_sampled": 62464, "num_env_steps_trained": 0, "num_agent_steps_sampled": 62462, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 13.952, "episode_reward_min": 10.203000000000001, "episode_reward_mean": 10.744360000000002, "episode_len_mean": 38.06, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.623000000000001, 10.619, 10.953000000000001, 10.620000000000001, 10.620000000000001, 10.528, 10.620000000000001, 10.623000000000001, 12.216000000000001, 11.071000000000002, 10.228, 10.608, 10.814, 10.317, 10.622, 11.027000000000001, 10.203000000000001, 10.623000000000001, 10.620000000000001, 10.241, 10.728000000000002, 10.623000000000001, 10.712, 10.823, 10.839000000000002, 10.419, 10.84, 10.442, 10.712, 10.641, 10.807, 10.623000000000001, 10.418, 10.303, 13.952, 10.623000000000001, 10.741000000000001, 10.623000000000001, 10.834000000000001, 10.616, 10.634, 11.528, 10.73, 10.979, 11.353, 10.620000000000001, 10.518, 11.674000000000001, 10.620000000000001, 10.733, 11.347000000000001, 10.527000000000001, 10.728000000000002, 10.82, 10.836, 10.506, 10.625, 10.743, 11.898, 10.623000000000001, 10.520000000000001, 10.596000000000002, 10.428, 10.623000000000001, 10.622, 10.809000000000001, 10.422, 10.421000000000001, 10.621, 10.622, 10.738, 10.623000000000001, 11.346000000000002, 10.954, 10.951, 10.620000000000001, 10.520000000000001, 10.729, 10.422, 10.622, 10.838000000000001, 10.71, 10.605, 10.620000000000001, 10.321000000000002, 10.423, 10.623000000000001, 10.304000000000002, 10.93, 10.620000000000001, 10.622, 11.351, 10.833, 10.42, 10.619, 10.832, 10.32, 10.418000000000001, 10.623000000000001, 11.038], "episode_lengths": [37, 37, 40, 37, 37, 38, 37, 37, 47, 42, 38, 36, 36, 37, 37, 38, 35, 37, 37, 40, 38, 37, 36, 38, 39, 37, 39, 40, 36, 39, 36, 37, 36, 36, 50, 37, 39, 37, 38, 37, 38, 49, 38, 43, 41, 37, 37, 42, 37, 38, 39, 38, 37, 37, 39, 36, 39, 39, 46, 37, 37, 36, 38, 38, 37, 36, 37, 37, 37, 37, 39, 37, 39, 40, 40, 37, 37, 38, 37, 37, 39, 36, 36, 37, 37, 37, 37, 35, 38, 37, 37, 40, 38, 37, 37, 38, 37, 37, 37, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5265693542960733, "mean_inference_ms": 1.400571575964305, "mean_action_processing_ms": 0.08068036671792518, "mean_env_wait_ms": 4.922985964949876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036573410034179688, "ViewRequirementAgentConnector_ms": 0.23800897598266602}}, "episode_reward_max": 13.952, "episode_reward_min": 10.203000000000001, "episode_reward_mean": 10.744360000000002, "episode_len_mean": 38.06, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.623000000000001, 10.619, 10.953000000000001, 10.620000000000001, 10.620000000000001, 10.528, 10.620000000000001, 10.623000000000001, 12.216000000000001, 11.071000000000002, 10.228, 10.608, 10.814, 10.317, 10.622, 11.027000000000001, 10.203000000000001, 10.623000000000001, 10.620000000000001, 10.241, 10.728000000000002, 10.623000000000001, 10.712, 10.823, 10.839000000000002, 10.419, 10.84, 10.442, 10.712, 10.641, 10.807, 10.623000000000001, 10.418, 10.303, 13.952, 10.623000000000001, 10.741000000000001, 10.623000000000001, 10.834000000000001, 10.616, 10.634, 11.528, 10.73, 10.979, 11.353, 10.620000000000001, 10.518, 11.674000000000001, 10.620000000000001, 10.733, 11.347000000000001, 10.527000000000001, 10.728000000000002, 10.82, 10.836, 10.506, 10.625, 10.743, 11.898, 10.623000000000001, 10.520000000000001, 10.596000000000002, 10.428, 10.623000000000001, 10.622, 10.809000000000001, 10.422, 10.421000000000001, 10.621, 10.622, 10.738, 10.623000000000001, 11.346000000000002, 10.954, 10.951, 10.620000000000001, 10.520000000000001, 10.729, 10.422, 10.622, 10.838000000000001, 10.71, 10.605, 10.620000000000001, 10.321000000000002, 10.423, 10.623000000000001, 10.304000000000002, 10.93, 10.620000000000001, 10.622, 11.351, 10.833, 10.42, 10.619, 10.832, 10.32, 10.418000000000001, 10.623000000000001, 11.038], "episode_lengths": [37, 37, 40, 37, 37, 38, 37, 37, 47, 42, 38, 36, 36, 37, 37, 38, 35, 37, 37, 40, 38, 37, 36, 38, 39, 37, 39, 40, 36, 39, 36, 37, 36, 36, 50, 37, 39, 37, 38, 37, 38, 49, 38, 43, 41, 37, 37, 42, 37, 38, 39, 38, 37, 37, 39, 36, 39, 39, 46, 37, 37, 36, 38, 38, 37, 36, 37, 37, 37, 37, 39, 37, 39, 40, 40, 37, 37, 38, 37, 37, 39, 36, 36, 37, 37, 37, 37, 35, 38, 37, 37, 40, 38, 37, 37, 38, 37, 37, 37, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5265693542960733, "mean_inference_ms": 1.400571575964305, "mean_action_processing_ms": 0.08068036671792518, "mean_env_wait_ms": 4.922985964949876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036573410034179688, "ViewRequirementAgentConnector_ms": 0.23800897598266602}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62462, "num_agent_steps_trained": 0, "num_env_steps_sampled": 62464, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.42683981250596, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 62464, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 62462, "timers": {"training_iteration_time_ms": 50401.662, "sample_time_ms": 7182.144, "synch_weights_time_ms": 76.215}, "counters": {"num_env_steps_sampled": 62464, "num_env_steps_trained": 0, "num_agent_steps_sampled": 62462, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1215, "training_iteration": 61, "trial_id": "default", "date": "2025-12-20_11-38-14", "timestamp": 1766201894, "time_this_iter_s": 50.13320326805115, "time_total_s": 3051.424548625946, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3051.424548625946, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 84.98333333333335, "ram_util_percent": 14.348611111111113}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.48395985215902326}, "default_policy": {"total_loss": 0.48395985215902326, "policy_loss": -0.007720554003026336, "vf_loss": 1.9694489121437073, "vf_loss_unclipped": 9.12419706583023, "vf_explained_var": 0.4281618267297745, "entropy": 0.21854595951735972, "mean_kl_loss": 0.001550535145612386, "gradients_default_optimizer_global_norm": 1.2327153474092483, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0030401562500000003, "curr_kl_coeff": 2.441406286379788e-05}}, "num_env_steps_sampled": 63488, "num_env_steps_trained": 0, "num_agent_steps_sampled": 63486, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 13.952, "episode_reward_min": 10.303, "episode_reward_mean": 10.748999999999999, "episode_len_mean": 38.04, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.442, 10.712, 10.641, 10.807, 10.623000000000001, 10.418, 10.303, 13.952, 10.623000000000001, 10.741000000000001, 10.623000000000001, 10.834000000000001, 10.616, 10.634, 11.528, 10.73, 10.979, 11.353, 10.620000000000001, 10.518, 11.674000000000001, 10.620000000000001, 10.733, 11.347000000000001, 10.527000000000001, 10.728000000000002, 10.82, 10.836, 10.506, 10.625, 10.743, 11.898, 10.623000000000001, 10.520000000000001, 10.596000000000002, 10.428, 10.623000000000001, 10.622, 10.809000000000001, 10.422, 10.421000000000001, 10.621, 10.622, 10.738, 10.623000000000001, 11.346000000000002, 10.954, 10.951, 10.620000000000001, 10.520000000000001, 10.729, 10.422, 10.622, 10.838000000000001, 10.71, 10.605, 10.620000000000001, 10.321000000000002, 10.423, 10.623000000000001, 10.304000000000002, 10.93, 10.620000000000001, 10.622, 11.351, 10.833, 10.42, 10.619, 10.832, 10.32, 10.418000000000001, 10.623000000000001, 11.038, 10.725000000000001, 10.610000000000001, 10.619000000000002, 10.429000000000002, 10.73, 10.627, 10.627, 10.838000000000001, 10.618, 10.521, 10.619, 10.716000000000001, 10.623000000000001, 10.924, 10.63, 10.811, 10.835, 10.725000000000001, 10.835, 11.181000000000001, 10.829, 10.628, 10.628000000000002, 10.731000000000002, 10.831, 10.731000000000002, 10.623000000000001], "episode_lengths": [40, 36, 39, 36, 37, 36, 36, 50, 37, 39, 37, 38, 37, 38, 49, 38, 43, 41, 37, 37, 42, 37, 38, 39, 38, 37, 37, 39, 36, 39, 39, 46, 37, 37, 36, 38, 38, 37, 36, 37, 37, 37, 37, 39, 37, 39, 40, 40, 37, 37, 38, 37, 37, 39, 36, 36, 37, 37, 37, 37, 35, 38, 37, 37, 40, 38, 37, 37, 38, 37, 37, 37, 39, 38, 36, 37, 38, 38, 38, 38, 39, 37, 37, 37, 37, 37, 37, 38, 36, 39, 38, 39, 43, 38, 38, 38, 38, 38, 38, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275666301937829, "mean_inference_ms": 1.4012484397633147, "mean_action_processing_ms": 0.08072737207678346, "mean_env_wait_ms": 4.92431133910087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036573410034179688, "ViewRequirementAgentConnector_ms": 0.23761773109436035}}, "episode_reward_max": 13.952, "episode_reward_min": 10.303, "episode_reward_mean": 10.748999999999999, "episode_len_mean": 38.04, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.442, 10.712, 10.641, 10.807, 10.623000000000001, 10.418, 10.303, 13.952, 10.623000000000001, 10.741000000000001, 10.623000000000001, 10.834000000000001, 10.616, 10.634, 11.528, 10.73, 10.979, 11.353, 10.620000000000001, 10.518, 11.674000000000001, 10.620000000000001, 10.733, 11.347000000000001, 10.527000000000001, 10.728000000000002, 10.82, 10.836, 10.506, 10.625, 10.743, 11.898, 10.623000000000001, 10.520000000000001, 10.596000000000002, 10.428, 10.623000000000001, 10.622, 10.809000000000001, 10.422, 10.421000000000001, 10.621, 10.622, 10.738, 10.623000000000001, 11.346000000000002, 10.954, 10.951, 10.620000000000001, 10.520000000000001, 10.729, 10.422, 10.622, 10.838000000000001, 10.71, 10.605, 10.620000000000001, 10.321000000000002, 10.423, 10.623000000000001, 10.304000000000002, 10.93, 10.620000000000001, 10.622, 11.351, 10.833, 10.42, 10.619, 10.832, 10.32, 10.418000000000001, 10.623000000000001, 11.038, 10.725000000000001, 10.610000000000001, 10.619000000000002, 10.429000000000002, 10.73, 10.627, 10.627, 10.838000000000001, 10.618, 10.521, 10.619, 10.716000000000001, 10.623000000000001, 10.924, 10.63, 10.811, 10.835, 10.725000000000001, 10.835, 11.181000000000001, 10.829, 10.628, 10.628000000000002, 10.731000000000002, 10.831, 10.731000000000002, 10.623000000000001], "episode_lengths": [40, 36, 39, 36, 37, 36, 36, 50, 37, 39, 37, 38, 37, 38, 49, 38, 43, 41, 37, 37, 42, 37, 38, 39, 38, 37, 37, 39, 36, 39, 39, 46, 37, 37, 36, 38, 38, 37, 36, 37, 37, 37, 37, 39, 37, 39, 40, 40, 37, 37, 38, 37, 37, 39, 36, 36, 37, 37, 37, 37, 35, 38, 37, 37, 40, 38, 37, 37, 38, 37, 37, 37, 39, 38, 36, 37, 38, 38, 38, 38, 39, 37, 37, 37, 37, 37, 37, 38, 36, 39, 38, 39, 43, 38, 38, 38, 38, 38, 38, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275666301937829, "mean_inference_ms": 1.4012484397633147, "mean_action_processing_ms": 0.08072737207678346, "mean_env_wait_ms": 4.92431133910087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036573410034179688, "ViewRequirementAgentConnector_ms": 0.23761773109436035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63486, "num_agent_steps_trained": 0, "num_env_steps_sampled": 63488, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.48126384752012, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 63488, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 63486, "timers": {"training_iteration_time_ms": 50439.321, "sample_time_ms": 7186.828, "synch_weights_time_ms": 74.393}, "counters": {"num_env_steps_sampled": 63488, "num_env_steps_trained": 0, "num_agent_steps_sampled": 63486, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1242, "training_iteration": 62, "trial_id": "default", "date": "2025-12-20_11-39-12", "timestamp": 1766201952, "time_this_iter_s": 50.000253200531006, "time_total_s": 3101.424801826477, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3101.424801826477, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 75.2679012345679, "ram_util_percent": 14.400000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.42896554842591283}, "default_policy": {"total_loss": 0.42896554842591283, "policy_loss": -0.009827453270554542, "vf_loss": 1.7574424296617508, "vf_loss_unclipped": 8.31944524049759, "vf_explained_var": 0.4893957421183586, "entropy": 0.18672444932162763, "mean_kl_loss": 0.0023107393002480326, "gradients_default_optimizer_global_norm": 0.7981548018753528, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00296015625, "curr_kl_coeff": 1.220703143189894e-05}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64510, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.898, "episode_reward_min": 10.304000000000002, "episode_reward_mean": 10.70226, "episode_len_mean": 37.8, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.836, 10.506, 10.625, 10.743, 11.898, 10.623000000000001, 10.520000000000001, 10.596000000000002, 10.428, 10.623000000000001, 10.622, 10.809000000000001, 10.422, 10.421000000000001, 10.621, 10.622, 10.738, 10.623000000000001, 11.346000000000002, 10.954, 10.951, 10.620000000000001, 10.520000000000001, 10.729, 10.422, 10.622, 10.838000000000001, 10.71, 10.605, 10.620000000000001, 10.321000000000002, 10.423, 10.623000000000001, 10.304000000000002, 10.93, 10.620000000000001, 10.622, 11.351, 10.833, 10.42, 10.619, 10.832, 10.32, 10.418000000000001, 10.623000000000001, 11.038, 10.725000000000001, 10.610000000000001, 10.619000000000002, 10.429000000000002, 10.73, 10.627, 10.627, 10.838000000000001, 10.618, 10.521, 10.619, 10.716000000000001, 10.623000000000001, 10.924, 10.63, 10.811, 10.835, 10.725000000000001, 10.835, 11.181000000000001, 10.829, 10.628, 10.628000000000002, 10.731000000000002, 10.831, 10.731000000000002, 10.623000000000001, 10.835, 10.623000000000001, 10.727000000000002, 10.318999999999999, 10.625000000000002, 10.73, 10.819, 11.022, 10.42, 10.729, 10.73, 10.835, 10.620000000000001, 10.695, 10.521, 10.727000000000002, 10.838000000000001, 10.73, 10.835, 10.838000000000001, 10.332, 10.835, 10.838000000000001, 10.628, 10.838000000000001, 11.045, 10.738000000000001], "episode_lengths": [39, 36, 39, 39, 46, 37, 37, 36, 38, 38, 37, 36, 37, 37, 37, 37, 39, 37, 39, 40, 40, 37, 37, 38, 37, 37, 39, 36, 36, 37, 37, 37, 37, 35, 38, 37, 37, 40, 38, 37, 37, 38, 37, 37, 37, 39, 38, 36, 37, 38, 38, 38, 38, 39, 37, 37, 37, 37, 37, 37, 38, 36, 39, 38, 39, 43, 38, 38, 38, 38, 38, 38, 37, 39, 37, 38, 37, 38, 38, 37, 37, 37, 38, 38, 39, 37, 34, 37, 38, 39, 38, 39, 39, 38, 39, 39, 38, 39, 39, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5284411106716553, "mean_inference_ms": 1.401321108176881, "mean_action_processing_ms": 0.08073121463347352, "mean_env_wait_ms": 4.924425519596931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036325454711914062, "ViewRequirementAgentConnector_ms": 0.23683953285217285}}, "episode_reward_max": 11.898, "episode_reward_min": 10.304000000000002, "episode_reward_mean": 10.70226, "episode_len_mean": 37.8, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.836, 10.506, 10.625, 10.743, 11.898, 10.623000000000001, 10.520000000000001, 10.596000000000002, 10.428, 10.623000000000001, 10.622, 10.809000000000001, 10.422, 10.421000000000001, 10.621, 10.622, 10.738, 10.623000000000001, 11.346000000000002, 10.954, 10.951, 10.620000000000001, 10.520000000000001, 10.729, 10.422, 10.622, 10.838000000000001, 10.71, 10.605, 10.620000000000001, 10.321000000000002, 10.423, 10.623000000000001, 10.304000000000002, 10.93, 10.620000000000001, 10.622, 11.351, 10.833, 10.42, 10.619, 10.832, 10.32, 10.418000000000001, 10.623000000000001, 11.038, 10.725000000000001, 10.610000000000001, 10.619000000000002, 10.429000000000002, 10.73, 10.627, 10.627, 10.838000000000001, 10.618, 10.521, 10.619, 10.716000000000001, 10.623000000000001, 10.924, 10.63, 10.811, 10.835, 10.725000000000001, 10.835, 11.181000000000001, 10.829, 10.628, 10.628000000000002, 10.731000000000002, 10.831, 10.731000000000002, 10.623000000000001, 10.835, 10.623000000000001, 10.727000000000002, 10.318999999999999, 10.625000000000002, 10.73, 10.819, 11.022, 10.42, 10.729, 10.73, 10.835, 10.620000000000001, 10.695, 10.521, 10.727000000000002, 10.838000000000001, 10.73, 10.835, 10.838000000000001, 10.332, 10.835, 10.838000000000001, 10.628, 10.838000000000001, 11.045, 10.738000000000001], "episode_lengths": [39, 36, 39, 39, 46, 37, 37, 36, 38, 38, 37, 36, 37, 37, 37, 37, 39, 37, 39, 40, 40, 37, 37, 38, 37, 37, 39, 36, 36, 37, 37, 37, 37, 35, 38, 37, 37, 40, 38, 37, 37, 38, 37, 37, 37, 39, 38, 36, 37, 38, 38, 38, 38, 39, 37, 37, 37, 37, 37, 37, 38, 36, 39, 38, 39, 43, 38, 38, 38, 38, 38, 38, 37, 39, 37, 38, 37, 38, 38, 37, 37, 37, 38, 38, 39, 37, 34, 37, 38, 39, 38, 39, 39, 38, 39, 39, 38, 39, 39, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5284411106716553, "mean_inference_ms": 1.401321108176881, "mean_action_processing_ms": 0.08073121463347352, "mean_env_wait_ms": 4.924425519596931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036325454711914062, "ViewRequirementAgentConnector_ms": 0.23683953285217285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64510, "num_agent_steps_trained": 0, "num_env_steps_sampled": 64512, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.300263632243656, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 64512, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 64510, "timers": {"training_iteration_time_ms": 50357.79, "sample_time_ms": 7184.788, "synch_weights_time_ms": 74.488}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64510, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1269, "training_iteration": 63, "trial_id": "default", "date": "2025-12-20_11-40-02", "timestamp": 1766202002, "time_this_iter_s": 50.44565224647522, "time_total_s": 3151.8704540729523, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3151.8704540729523, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 86.02222222222223, "ram_util_percent": 14.400000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.3517498396337032}, "default_policy": {"total_loss": 0.3517498396337032, "policy_loss": -0.006550330715253949, "vf_loss": 1.435330054163933, "vf_loss_unclipped": 7.332042944431305, "vf_explained_var": 0.5691202446818352, "entropy": 0.17984030917286872, "mean_kl_loss": 0.0013094280895046494, "gradients_default_optimizer_global_norm": 0.8809201411902905, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00288015625, "curr_kl_coeff": 6.10351571594947e-06}}, "num_env_steps_sampled": 65536, "num_env_steps_trained": 0, "num_agent_steps_sampled": 65534, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.351, "episode_reward_min": 10.113, "episode_reward_mean": 10.69477, "episode_len_mean": 37.83, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.838000000000001, 10.71, 10.605, 10.620000000000001, 10.321000000000002, 10.423, 10.623000000000001, 10.304000000000002, 10.93, 10.620000000000001, 10.622, 11.351, 10.833, 10.42, 10.619, 10.832, 10.32, 10.418000000000001, 10.623000000000001, 11.038, 10.725000000000001, 10.610000000000001, 10.619000000000002, 10.429000000000002, 10.73, 10.627, 10.627, 10.838000000000001, 10.618, 10.521, 10.619, 10.716000000000001, 10.623000000000001, 10.924, 10.63, 10.811, 10.835, 10.725000000000001, 10.835, 11.181000000000001, 10.829, 10.628, 10.628000000000002, 10.731000000000002, 10.831, 10.731000000000002, 10.623000000000001, 10.835, 10.623000000000001, 10.727000000000002, 10.318999999999999, 10.625000000000002, 10.73, 10.819, 11.022, 10.42, 10.729, 10.73, 10.835, 10.620000000000001, 10.695, 10.521, 10.727000000000002, 10.838000000000001, 10.73, 10.835, 10.838000000000001, 10.332, 10.835, 10.838000000000001, 10.628, 10.838000000000001, 11.045, 10.738000000000001, 10.73, 10.639, 10.835, 10.113, 10.524000000000001, 11.285, 10.838000000000001, 10.73, 10.622, 10.838000000000001, 10.835, 10.620000000000001, 10.731000000000002, 10.731000000000002, 10.623000000000001, 10.631, 10.321000000000002, 10.422, 10.523000000000001, 10.838000000000001, 10.807, 10.731000000000002, 10.529, 10.729, 10.838000000000001, 10.628], "episode_lengths": [39, 36, 36, 37, 37, 37, 37, 35, 38, 37, 37, 40, 38, 37, 37, 38, 37, 37, 37, 39, 38, 36, 37, 38, 38, 38, 38, 39, 37, 37, 37, 37, 37, 37, 38, 36, 39, 38, 39, 43, 38, 38, 38, 38, 38, 38, 37, 39, 37, 38, 37, 38, 38, 37, 37, 37, 38, 38, 39, 37, 34, 37, 38, 39, 38, 39, 39, 38, 39, 39, 38, 39, 39, 39, 38, 39, 39, 36, 38, 43, 39, 38, 37, 39, 39, 37, 38, 38, 37, 38, 37, 37, 37, 39, 36, 38, 38, 38, 39, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.529219998060008, "mean_inference_ms": 1.401634161833759, "mean_action_processing_ms": 0.08075552225856673, "mean_env_wait_ms": 4.924941008275076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003549814224243164, "ViewRequirementAgentConnector_ms": 0.23338890075683594}}, "episode_reward_max": 11.351, "episode_reward_min": 10.113, "episode_reward_mean": 10.69477, "episode_len_mean": 37.83, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.838000000000001, 10.71, 10.605, 10.620000000000001, 10.321000000000002, 10.423, 10.623000000000001, 10.304000000000002, 10.93, 10.620000000000001, 10.622, 11.351, 10.833, 10.42, 10.619, 10.832, 10.32, 10.418000000000001, 10.623000000000001, 11.038, 10.725000000000001, 10.610000000000001, 10.619000000000002, 10.429000000000002, 10.73, 10.627, 10.627, 10.838000000000001, 10.618, 10.521, 10.619, 10.716000000000001, 10.623000000000001, 10.924, 10.63, 10.811, 10.835, 10.725000000000001, 10.835, 11.181000000000001, 10.829, 10.628, 10.628000000000002, 10.731000000000002, 10.831, 10.731000000000002, 10.623000000000001, 10.835, 10.623000000000001, 10.727000000000002, 10.318999999999999, 10.625000000000002, 10.73, 10.819, 11.022, 10.42, 10.729, 10.73, 10.835, 10.620000000000001, 10.695, 10.521, 10.727000000000002, 10.838000000000001, 10.73, 10.835, 10.838000000000001, 10.332, 10.835, 10.838000000000001, 10.628, 10.838000000000001, 11.045, 10.738000000000001, 10.73, 10.639, 10.835, 10.113, 10.524000000000001, 11.285, 10.838000000000001, 10.73, 10.622, 10.838000000000001, 10.835, 10.620000000000001, 10.731000000000002, 10.731000000000002, 10.623000000000001, 10.631, 10.321000000000002, 10.422, 10.523000000000001, 10.838000000000001, 10.807, 10.731000000000002, 10.529, 10.729, 10.838000000000001, 10.628], "episode_lengths": [39, 36, 36, 37, 37, 37, 37, 35, 38, 37, 37, 40, 38, 37, 37, 38, 37, 37, 37, 39, 38, 36, 37, 38, 38, 38, 38, 39, 37, 37, 37, 37, 37, 37, 38, 36, 39, 38, 39, 43, 38, 38, 38, 38, 38, 38, 37, 39, 37, 38, 37, 38, 38, 37, 37, 37, 38, 38, 39, 37, 34, 37, 38, 39, 38, 39, 39, 38, 39, 39, 38, 39, 39, 39, 38, 39, 39, 36, 38, 43, 39, 38, 37, 39, 39, 37, 38, 38, 37, 38, 37, 37, 37, 39, 36, 38, 38, 38, 39, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.529219998060008, "mean_inference_ms": 1.401634161833759, "mean_action_processing_ms": 0.08075552225856673, "mean_env_wait_ms": 4.924941008275076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003549814224243164, "ViewRequirementAgentConnector_ms": 0.23338890075683594}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65534, "num_agent_steps_trained": 0, "num_env_steps_sampled": 65536, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.37760543606346, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 65536, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 65534, "timers": {"training_iteration_time_ms": 50311.351, "sample_time_ms": 7184.29, "synch_weights_time_ms": 73.815}, "counters": {"num_env_steps_sampled": 65536, "num_env_steps_trained": 0, "num_agent_steps_sampled": 65534, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1295, "training_iteration": 64, "trial_id": "default", "date": "2025-12-20_11-40-53", "timestamp": 1766202053, "time_this_iter_s": 50.25722074508667, "time_total_s": 3202.127674818039, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3202.127674818039, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 85.81267605633802, "ram_util_percent": 14.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.42258521169424057}, "default_policy": {"total_loss": 0.42258521169424057, "policy_loss": -0.00449535483494401, "vf_loss": 1.7106451719999314, "vf_loss_unclipped": 7.817960464954377, "vf_explained_var": 0.5372583627700805, "entropy": 0.20163143202662467, "mean_kl_loss": 0.0014379916356293209, "gradients_default_optimizer_global_norm": 0.8352820701897145, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0028001562499999997, "curr_kl_coeff": 3.051757857974735e-06}}, "num_env_steps_sampled": 66560, "num_env_steps_trained": 0, "num_agent_steps_sampled": 66558, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.874, "episode_reward_min": 10.113, "episode_reward_mean": 10.70492, "episode_len_mean": 37.94, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.618, 10.521, 10.619, 10.716000000000001, 10.623000000000001, 10.924, 10.63, 10.811, 10.835, 10.725000000000001, 10.835, 11.181000000000001, 10.829, 10.628, 10.628000000000002, 10.731000000000002, 10.831, 10.731000000000002, 10.623000000000001, 10.835, 10.623000000000001, 10.727000000000002, 10.318999999999999, 10.625000000000002, 10.73, 10.819, 11.022, 10.42, 10.729, 10.73, 10.835, 10.620000000000001, 10.695, 10.521, 10.727000000000002, 10.838000000000001, 10.73, 10.835, 10.838000000000001, 10.332, 10.835, 10.838000000000001, 10.628, 10.838000000000001, 11.045, 10.738000000000001, 10.73, 10.639, 10.835, 10.113, 10.524000000000001, 11.285, 10.838000000000001, 10.73, 10.622, 10.838000000000001, 10.835, 10.620000000000001, 10.731000000000002, 10.731000000000002, 10.623000000000001, 10.631, 10.321000000000002, 10.422, 10.523000000000001, 10.838000000000001, 10.807, 10.731000000000002, 10.529, 10.729, 10.838000000000001, 10.628, 10.838000000000001, 10.73, 10.63, 10.838000000000001, 10.731000000000002, 10.519000000000002, 10.627, 10.421, 10.728, 10.518, 10.628, 11.004999999999999, 11.874, 10.522000000000002, 10.426000000000002, 10.63, 10.530000000000001, 10.729, 10.626000000000001, 10.628, 10.729, 10.727000000000002, 10.634, 10.423, 10.73, 10.524000000000001, 10.507000000000001, 10.838000000000001], "episode_lengths": [37, 37, 37, 37, 37, 37, 38, 36, 39, 38, 39, 43, 38, 38, 38, 38, 38, 38, 37, 39, 37, 38, 37, 38, 38, 37, 37, 37, 38, 38, 39, 37, 34, 37, 38, 39, 38, 39, 39, 38, 39, 39, 38, 39, 39, 39, 38, 39, 39, 36, 38, 43, 39, 38, 37, 39, 39, 37, 38, 38, 37, 38, 37, 37, 37, 39, 36, 38, 38, 38, 39, 38, 39, 38, 38, 39, 38, 37, 38, 37, 38, 37, 38, 36, 39, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5299311024350566, "mean_inference_ms": 1.401627553533072, "mean_action_processing_ms": 0.08075728566562633, "mean_env_wait_ms": 4.924523515364922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035085678100585938, "ViewRequirementAgentConnector_ms": 0.2322089672088623}}, "episode_reward_max": 11.874, "episode_reward_min": 10.113, "episode_reward_mean": 10.70492, "episode_len_mean": 37.94, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.618, 10.521, 10.619, 10.716000000000001, 10.623000000000001, 10.924, 10.63, 10.811, 10.835, 10.725000000000001, 10.835, 11.181000000000001, 10.829, 10.628, 10.628000000000002, 10.731000000000002, 10.831, 10.731000000000002, 10.623000000000001, 10.835, 10.623000000000001, 10.727000000000002, 10.318999999999999, 10.625000000000002, 10.73, 10.819, 11.022, 10.42, 10.729, 10.73, 10.835, 10.620000000000001, 10.695, 10.521, 10.727000000000002, 10.838000000000001, 10.73, 10.835, 10.838000000000001, 10.332, 10.835, 10.838000000000001, 10.628, 10.838000000000001, 11.045, 10.738000000000001, 10.73, 10.639, 10.835, 10.113, 10.524000000000001, 11.285, 10.838000000000001, 10.73, 10.622, 10.838000000000001, 10.835, 10.620000000000001, 10.731000000000002, 10.731000000000002, 10.623000000000001, 10.631, 10.321000000000002, 10.422, 10.523000000000001, 10.838000000000001, 10.807, 10.731000000000002, 10.529, 10.729, 10.838000000000001, 10.628, 10.838000000000001, 10.73, 10.63, 10.838000000000001, 10.731000000000002, 10.519000000000002, 10.627, 10.421, 10.728, 10.518, 10.628, 11.004999999999999, 11.874, 10.522000000000002, 10.426000000000002, 10.63, 10.530000000000001, 10.729, 10.626000000000001, 10.628, 10.729, 10.727000000000002, 10.634, 10.423, 10.73, 10.524000000000001, 10.507000000000001, 10.838000000000001], "episode_lengths": [37, 37, 37, 37, 37, 37, 38, 36, 39, 38, 39, 43, 38, 38, 38, 38, 38, 38, 37, 39, 37, 38, 37, 38, 38, 37, 37, 37, 38, 38, 39, 37, 34, 37, 38, 39, 38, 39, 39, 38, 39, 39, 38, 39, 39, 39, 38, 39, 39, 36, 38, 43, 39, 38, 37, 39, 39, 37, 38, 38, 37, 38, 37, 37, 37, 39, 36, 38, 38, 38, 39, 38, 39, 38, 38, 39, 38, 37, 38, 37, 38, 37, 38, 36, 39, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5299311024350566, "mean_inference_ms": 1.401627553533072, "mean_action_processing_ms": 0.08075728566562633, "mean_env_wait_ms": 4.924523515364922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035085678100585938, "ViewRequirementAgentConnector_ms": 0.2322089672088623}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66558, "num_agent_steps_trained": 0, "num_env_steps_sampled": 66560, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.186741594029918, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 66560, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 66558, "timers": {"training_iteration_time_ms": 50344.268, "sample_time_ms": 7193.827, "synch_weights_time_ms": 73.408}, "counters": {"num_env_steps_sampled": 66560, "num_env_steps_trained": 0, "num_agent_steps_sampled": 66558, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1323, "training_iteration": 65, "trial_id": "default", "date": "2025-12-20_11-41-43", "timestamp": 1766202103, "time_this_iter_s": 50.72983384132385, "time_total_s": 3252.857508659363, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3252.857508659363, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 85.80277777777778, "ram_util_percent": 14.400000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.3301600828766823}, "default_policy": {"total_loss": 0.3301600828766823, "policy_loss": -0.004712058149743825, "vf_loss": 1.3414061069488525, "vf_loss_unclipped": 6.804418098926544, "vf_explained_var": 0.6175049901008606, "entropy": 0.17119705379009248, "mean_kl_loss": 0.0016732117042948858, "gradients_default_optimizer_global_norm": 0.9087522111833095, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0027201562500000004, "curr_kl_coeff": 1.5258789289873675e-06}}, "num_env_steps_sampled": 67584, "num_env_steps_trained": 0, "num_agent_steps_sampled": 67582, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.874, "episode_reward_min": 10.113, "episode_reward_mean": 10.68654, "episode_len_mean": 37.99, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.022, 10.42, 10.729, 10.73, 10.835, 10.620000000000001, 10.695, 10.521, 10.727000000000002, 10.838000000000001, 10.73, 10.835, 10.838000000000001, 10.332, 10.835, 10.838000000000001, 10.628, 10.838000000000001, 11.045, 10.738000000000001, 10.73, 10.639, 10.835, 10.113, 10.524000000000001, 11.285, 10.838000000000001, 10.73, 10.622, 10.838000000000001, 10.835, 10.620000000000001, 10.731000000000002, 10.731000000000002, 10.623000000000001, 10.631, 10.321000000000002, 10.422, 10.523000000000001, 10.838000000000001, 10.807, 10.731000000000002, 10.529, 10.729, 10.838000000000001, 10.628, 10.838000000000001, 10.73, 10.63, 10.838000000000001, 10.731000000000002, 10.519000000000002, 10.627, 10.421, 10.728, 10.518, 10.628, 11.004999999999999, 11.874, 10.522000000000002, 10.426000000000002, 10.63, 10.530000000000001, 10.729, 10.626000000000001, 10.628, 10.729, 10.727000000000002, 10.634, 10.423, 10.73, 10.524000000000001, 10.507000000000001, 10.838000000000001, 10.838000000000001, 10.835, 10.838000000000001, 10.838000000000001, 10.623000000000001, 10.728, 10.731000000000002, 10.63, 10.714, 10.838000000000001, 10.421, 10.838000000000001, 10.728000000000002, 10.838000000000001, 10.523000000000001, 10.637, 10.528, 10.423, 10.628, 10.528, 10.330000000000002, 10.526000000000002, 10.838000000000001, 10.530000000000001, 10.423, 10.527000000000001], "episode_lengths": [37, 37, 38, 38, 39, 37, 34, 37, 38, 39, 38, 39, 39, 38, 39, 39, 38, 39, 39, 39, 38, 39, 39, 36, 38, 43, 39, 38, 37, 39, 39, 37, 38, 38, 37, 38, 37, 37, 37, 39, 36, 38, 38, 38, 39, 38, 39, 38, 38, 39, 38, 37, 38, 37, 38, 37, 38, 36, 39, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 39, 39, 39, 39, 39, 37, 38, 38, 38, 36, 39, 37, 39, 38, 39, 37, 38, 38, 37, 38, 38, 38, 38, 39, 38, 37, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5305647434752915, "mean_inference_ms": 1.401684141067928, "mean_action_processing_ms": 0.08076055592996041, "mean_env_wait_ms": 4.924136848531631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003518342971801758, "ViewRequirementAgentConnector_ms": 0.2320878505706787}}, "episode_reward_max": 11.874, "episode_reward_min": 10.113, "episode_reward_mean": 10.68654, "episode_len_mean": 37.99, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.022, 10.42, 10.729, 10.73, 10.835, 10.620000000000001, 10.695, 10.521, 10.727000000000002, 10.838000000000001, 10.73, 10.835, 10.838000000000001, 10.332, 10.835, 10.838000000000001, 10.628, 10.838000000000001, 11.045, 10.738000000000001, 10.73, 10.639, 10.835, 10.113, 10.524000000000001, 11.285, 10.838000000000001, 10.73, 10.622, 10.838000000000001, 10.835, 10.620000000000001, 10.731000000000002, 10.731000000000002, 10.623000000000001, 10.631, 10.321000000000002, 10.422, 10.523000000000001, 10.838000000000001, 10.807, 10.731000000000002, 10.529, 10.729, 10.838000000000001, 10.628, 10.838000000000001, 10.73, 10.63, 10.838000000000001, 10.731000000000002, 10.519000000000002, 10.627, 10.421, 10.728, 10.518, 10.628, 11.004999999999999, 11.874, 10.522000000000002, 10.426000000000002, 10.63, 10.530000000000001, 10.729, 10.626000000000001, 10.628, 10.729, 10.727000000000002, 10.634, 10.423, 10.73, 10.524000000000001, 10.507000000000001, 10.838000000000001, 10.838000000000001, 10.835, 10.838000000000001, 10.838000000000001, 10.623000000000001, 10.728, 10.731000000000002, 10.63, 10.714, 10.838000000000001, 10.421, 10.838000000000001, 10.728000000000002, 10.838000000000001, 10.523000000000001, 10.637, 10.528, 10.423, 10.628, 10.528, 10.330000000000002, 10.526000000000002, 10.838000000000001, 10.530000000000001, 10.423, 10.527000000000001], "episode_lengths": [37, 37, 38, 38, 39, 37, 34, 37, 38, 39, 38, 39, 39, 38, 39, 39, 38, 39, 39, 39, 38, 39, 39, 36, 38, 43, 39, 38, 37, 39, 39, 37, 38, 38, 37, 38, 37, 37, 37, 39, 36, 38, 38, 38, 39, 38, 39, 38, 38, 39, 38, 37, 38, 37, 38, 37, 38, 36, 39, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 39, 39, 39, 39, 39, 37, 38, 38, 38, 36, 39, 37, 39, 38, 39, 37, 38, 38, 37, 38, 38, 38, 38, 39, 38, 37, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5305647434752915, "mean_inference_ms": 1.401684141067928, "mean_action_processing_ms": 0.08076055592996041, "mean_env_wait_ms": 4.924136848531631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003518342971801758, "ViewRequirementAgentConnector_ms": 0.2320878505706787}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67582, "num_agent_steps_trained": 0, "num_env_steps_sampled": 67584, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.188082520804613, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 67584, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 67582, "timers": {"training_iteration_time_ms": 50334.08, "sample_time_ms": 7193.409, "synch_weights_time_ms": 73.816}, "counters": {"num_env_steps_sampled": 67584, "num_env_steps_trained": 0, "num_agent_steps_sampled": 67582, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1349, "training_iteration": 66, "trial_id": "default", "date": "2025-12-20_11-42-34", "timestamp": 1766202154, "time_this_iter_s": 50.725780963897705, "time_total_s": 3303.5832896232605, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3303.5832896232605, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 85.92777777777778, "ram_util_percent": 14.400000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.3416040791198611}, "default_policy": {"total_loss": 0.3416040791198611, "policy_loss": -0.011046418908517808, "vf_loss": 1.4126071274280547, "vf_loss_unclipped": 5.802906361222267, "vf_explained_var": 0.6613823980093002, "entropy": 0.18428719229996204, "mean_kl_loss": 0.008075104052295501, "gradients_default_optimizer_global_norm": 0.8415835060179233, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00264015625, "curr_kl_coeff": 1.5258789289873675e-06}}, "num_env_steps_sampled": 68608, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68606, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.874, "episode_reward_min": 10.321000000000002, "episode_reward_mean": 10.699539999999999, "episode_len_mean": 38.12, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.622, 10.838000000000001, 10.835, 10.620000000000001, 10.731000000000002, 10.731000000000002, 10.623000000000001, 10.631, 10.321000000000002, 10.422, 10.523000000000001, 10.838000000000001, 10.807, 10.731000000000002, 10.529, 10.729, 10.838000000000001, 10.628, 10.838000000000001, 10.73, 10.63, 10.838000000000001, 10.731000000000002, 10.519000000000002, 10.627, 10.421, 10.728, 10.518, 10.628, 11.004999999999999, 11.874, 10.522000000000002, 10.426000000000002, 10.63, 10.530000000000001, 10.729, 10.626000000000001, 10.628, 10.729, 10.727000000000002, 10.634, 10.423, 10.73, 10.524000000000001, 10.507000000000001, 10.838000000000001, 10.838000000000001, 10.835, 10.838000000000001, 10.838000000000001, 10.623000000000001, 10.728, 10.731000000000002, 10.63, 10.714, 10.838000000000001, 10.421, 10.838000000000001, 10.728000000000002, 10.838000000000001, 10.523000000000001, 10.637, 10.528, 10.423, 10.628, 10.528, 10.330000000000002, 10.526000000000002, 10.838000000000001, 10.530000000000001, 10.423, 10.527000000000001, 10.42, 10.838000000000001, 10.731000000000002, 10.838000000000001, 10.838000000000001, 10.729, 10.628, 10.729, 10.712, 10.63, 10.73, 10.628, 10.838000000000001, 10.838000000000001, 11.579, 10.726000000000003, 10.543000000000001, 10.726000000000003, 10.943999999999999, 11.477, 10.838000000000001, 10.837, 11.048000000000002, 10.327000000000002, 10.628, 10.527000000000001, 10.731000000000002], "episode_lengths": [38, 37, 39, 39, 37, 38, 38, 37, 38, 37, 37, 37, 39, 36, 38, 38, 38, 39, 38, 39, 38, 38, 39, 38, 37, 38, 37, 38, 37, 38, 36, 39, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 39, 39, 39, 39, 39, 37, 38, 38, 38, 36, 39, 37, 39, 38, 39, 37, 38, 38, 37, 38, 38, 38, 38, 39, 38, 37, 38, 37, 39, 38, 39, 39, 38, 38, 38, 37, 38, 38, 38, 39, 39, 43, 38, 40, 38, 39, 43, 39, 39, 40, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5312333200008463, "mean_inference_ms": 1.4018633112322292, "mean_action_processing_ms": 0.08077440275834297, "mean_env_wait_ms": 4.924074851480224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035054683685302734, "ViewRequirementAgentConnector_ms": 0.23165607452392578}}, "episode_reward_max": 11.874, "episode_reward_min": 10.321000000000002, "episode_reward_mean": 10.699539999999999, "episode_len_mean": 38.12, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.622, 10.838000000000001, 10.835, 10.620000000000001, 10.731000000000002, 10.731000000000002, 10.623000000000001, 10.631, 10.321000000000002, 10.422, 10.523000000000001, 10.838000000000001, 10.807, 10.731000000000002, 10.529, 10.729, 10.838000000000001, 10.628, 10.838000000000001, 10.73, 10.63, 10.838000000000001, 10.731000000000002, 10.519000000000002, 10.627, 10.421, 10.728, 10.518, 10.628, 11.004999999999999, 11.874, 10.522000000000002, 10.426000000000002, 10.63, 10.530000000000001, 10.729, 10.626000000000001, 10.628, 10.729, 10.727000000000002, 10.634, 10.423, 10.73, 10.524000000000001, 10.507000000000001, 10.838000000000001, 10.838000000000001, 10.835, 10.838000000000001, 10.838000000000001, 10.623000000000001, 10.728, 10.731000000000002, 10.63, 10.714, 10.838000000000001, 10.421, 10.838000000000001, 10.728000000000002, 10.838000000000001, 10.523000000000001, 10.637, 10.528, 10.423, 10.628, 10.528, 10.330000000000002, 10.526000000000002, 10.838000000000001, 10.530000000000001, 10.423, 10.527000000000001, 10.42, 10.838000000000001, 10.731000000000002, 10.838000000000001, 10.838000000000001, 10.729, 10.628, 10.729, 10.712, 10.63, 10.73, 10.628, 10.838000000000001, 10.838000000000001, 11.579, 10.726000000000003, 10.543000000000001, 10.726000000000003, 10.943999999999999, 11.477, 10.838000000000001, 10.837, 11.048000000000002, 10.327000000000002, 10.628, 10.527000000000001, 10.731000000000002], "episode_lengths": [38, 37, 39, 39, 37, 38, 38, 37, 38, 37, 37, 37, 39, 36, 38, 38, 38, 39, 38, 39, 38, 38, 39, 38, 37, 38, 37, 38, 37, 38, 36, 39, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 39, 39, 39, 39, 39, 37, 38, 38, 38, 36, 39, 37, 39, 38, 39, 37, 38, 38, 37, 38, 38, 38, 38, 39, 38, 37, 38, 37, 39, 38, 39, 39, 38, 38, 38, 37, 38, 38, 38, 39, 39, 43, 38, 40, 38, 39, 43, 39, 39, 40, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5312333200008463, "mean_inference_ms": 1.4018633112322292, "mean_action_processing_ms": 0.08077440275834297, "mean_env_wait_ms": 4.924074851480224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035054683685302734, "ViewRequirementAgentConnector_ms": 0.23165607452392578}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68606, "num_agent_steps_trained": 0, "num_env_steps_sampled": 68608, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.49833622638888, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 68608, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 68606, "timers": {"training_iteration_time_ms": 50288.829, "sample_time_ms": 7189.557, "synch_weights_time_ms": 75.676}, "counters": {"num_env_steps_sampled": 68608, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68606, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1376, "training_iteration": 67, "trial_id": "default", "date": "2025-12-20_11-43-32", "timestamp": 1766202212, "time_this_iter_s": 49.95861840248108, "time_total_s": 3353.5419080257416, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3353.5419080257416, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 75.58170731707317, "ram_util_percent": 14.400000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.2555980945006013}, "default_policy": {"total_loss": 0.2555980945006013, "policy_loss": -0.003731855261139572, "vf_loss": 1.0390344187617302, "vf_loss_unclipped": 3.8546050548553468, "vf_explained_var": 0.7777084738016129, "entropy": 0.16236159913241863, "mean_kl_loss": 0.0014817753744858276, "gradients_default_optimizer_global_norm": 1.3552436459809543, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00256015625, "curr_kl_coeff": 7.629394644936838e-07}}, "num_env_steps_sampled": 69632, "num_env_steps_trained": 0, "num_agent_steps_sampled": 69630, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.874, "episode_reward_min": 10.327000000000002, "episode_reward_mean": 10.693910000000002, "episode_len_mean": 38.18, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.728, 10.518, 10.628, 11.004999999999999, 11.874, 10.522000000000002, 10.426000000000002, 10.63, 10.530000000000001, 10.729, 10.626000000000001, 10.628, 10.729, 10.727000000000002, 10.634, 10.423, 10.73, 10.524000000000001, 10.507000000000001, 10.838000000000001, 10.838000000000001, 10.835, 10.838000000000001, 10.838000000000001, 10.623000000000001, 10.728, 10.731000000000002, 10.63, 10.714, 10.838000000000001, 10.421, 10.838000000000001, 10.728000000000002, 10.838000000000001, 10.523000000000001, 10.637, 10.528, 10.423, 10.628, 10.528, 10.330000000000002, 10.526000000000002, 10.838000000000001, 10.530000000000001, 10.423, 10.527000000000001, 10.42, 10.838000000000001, 10.731000000000002, 10.838000000000001, 10.838000000000001, 10.729, 10.628, 10.729, 10.712, 10.63, 10.73, 10.628, 10.838000000000001, 10.838000000000001, 11.579, 10.726000000000003, 10.543000000000001, 10.726000000000003, 10.943999999999999, 11.477, 10.838000000000001, 10.837, 11.048000000000002, 10.327000000000002, 10.628, 10.527000000000001, 10.731000000000002, 10.73, 10.426, 10.727000000000002, 10.63, 10.627, 10.729, 10.838000000000001, 10.84, 10.423, 10.526000000000002, 10.53, 10.528, 10.628, 10.527000000000001, 10.528, 10.73, 10.527000000000001, 11.241000000000001, 10.42, 10.627, 10.838000000000001, 10.63, 10.628, 10.63, 10.63, 10.73, 10.63], "episode_lengths": [38, 37, 38, 36, 39, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 39, 39, 39, 39, 39, 37, 38, 38, 38, 36, 39, 37, 39, 38, 39, 37, 38, 38, 37, 38, 38, 38, 38, 39, 38, 37, 38, 37, 39, 38, 39, 39, 38, 38, 38, 37, 38, 38, 38, 39, 39, 43, 38, 40, 38, 39, 43, 39, 39, 40, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 37, 38, 38, 38, 38, 38, 38, 38, 38, 39, 37, 38, 39, 38, 38, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5317734406720542, "mean_inference_ms": 1.4015658585145778, "mean_action_processing_ms": 0.08075836082143281, "mean_env_wait_ms": 4.923175935703482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003471851348876953, "ViewRequirementAgentConnector_ms": 0.23055291175842285}}, "episode_reward_max": 11.874, "episode_reward_min": 10.327000000000002, "episode_reward_mean": 10.693910000000002, "episode_len_mean": 38.18, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.728, 10.518, 10.628, 11.004999999999999, 11.874, 10.522000000000002, 10.426000000000002, 10.63, 10.530000000000001, 10.729, 10.626000000000001, 10.628, 10.729, 10.727000000000002, 10.634, 10.423, 10.73, 10.524000000000001, 10.507000000000001, 10.838000000000001, 10.838000000000001, 10.835, 10.838000000000001, 10.838000000000001, 10.623000000000001, 10.728, 10.731000000000002, 10.63, 10.714, 10.838000000000001, 10.421, 10.838000000000001, 10.728000000000002, 10.838000000000001, 10.523000000000001, 10.637, 10.528, 10.423, 10.628, 10.528, 10.330000000000002, 10.526000000000002, 10.838000000000001, 10.530000000000001, 10.423, 10.527000000000001, 10.42, 10.838000000000001, 10.731000000000002, 10.838000000000001, 10.838000000000001, 10.729, 10.628, 10.729, 10.712, 10.63, 10.73, 10.628, 10.838000000000001, 10.838000000000001, 11.579, 10.726000000000003, 10.543000000000001, 10.726000000000003, 10.943999999999999, 11.477, 10.838000000000001, 10.837, 11.048000000000002, 10.327000000000002, 10.628, 10.527000000000001, 10.731000000000002, 10.73, 10.426, 10.727000000000002, 10.63, 10.627, 10.729, 10.838000000000001, 10.84, 10.423, 10.526000000000002, 10.53, 10.528, 10.628, 10.527000000000001, 10.528, 10.73, 10.527000000000001, 11.241000000000001, 10.42, 10.627, 10.838000000000001, 10.63, 10.628, 10.63, 10.63, 10.73, 10.63], "episode_lengths": [38, 37, 38, 36, 39, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 39, 39, 39, 39, 39, 37, 38, 38, 38, 36, 39, 37, 39, 38, 39, 37, 38, 38, 37, 38, 38, 38, 38, 39, 38, 37, 38, 37, 39, 38, 39, 39, 38, 38, 38, 37, 38, 38, 38, 39, 39, 43, 38, 40, 38, 39, 43, 39, 39, 40, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 37, 38, 38, 38, 38, 38, 38, 38, 38, 39, 37, 38, 39, 38, 38, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5317734406720542, "mean_inference_ms": 1.4015658585145778, "mean_action_processing_ms": 0.08075836082143281, "mean_env_wait_ms": 4.923175935703482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003471851348876953, "ViewRequirementAgentConnector_ms": 0.23055291175842285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69630, "num_agent_steps_trained": 0, "num_env_steps_sampled": 69632, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.342411746403283, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 69632, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 69630, "timers": {"training_iteration_time_ms": 50266.099, "sample_time_ms": 7190.389, "synch_weights_time_ms": 76.272}, "counters": {"num_env_steps_sampled": 69632, "num_env_steps_trained": 0, "num_agent_steps_sampled": 69630, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1403, "training_iteration": 68, "trial_id": "default", "date": "2025-12-20_11-44-22", "timestamp": 1766202262, "time_this_iter_s": 50.34114980697632, "time_total_s": 3403.883057832718, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3403.883057832718, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 86.0625, "ram_util_percent": 14.400000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.27313568368554114}, "default_policy": {"total_loss": 0.27313568368554114, "policy_loss": -0.006152282329276204, "vf_loss": 1.1187403924763202, "vf_loss_unclipped": 4.22388034760952, "vf_explained_var": 0.7793618932366371, "entropy": 0.15512170270085335, "mean_kl_loss": 0.0021164230542055408, "gradients_default_optimizer_global_norm": 0.8031078785657882, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00248015625, "curr_kl_coeff": 3.814697322468419e-07}}, "num_env_steps_sampled": 70656, "num_env_steps_trained": 0, "num_agent_steps_sampled": 70654, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.579, "episode_reward_min": 10.309000000000001, "episode_reward_mean": 10.679179999999999, "episode_len_mean": 38.23, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.63, 10.714, 10.838000000000001, 10.421, 10.838000000000001, 10.728000000000002, 10.838000000000001, 10.523000000000001, 10.637, 10.528, 10.423, 10.628, 10.528, 10.330000000000002, 10.526000000000002, 10.838000000000001, 10.530000000000001, 10.423, 10.527000000000001, 10.42, 10.838000000000001, 10.731000000000002, 10.838000000000001, 10.838000000000001, 10.729, 10.628, 10.729, 10.712, 10.63, 10.73, 10.628, 10.838000000000001, 10.838000000000001, 11.579, 10.726000000000003, 10.543000000000001, 10.726000000000003, 10.943999999999999, 11.477, 10.838000000000001, 10.837, 11.048000000000002, 10.327000000000002, 10.628, 10.527000000000001, 10.731000000000002, 10.73, 10.426, 10.727000000000002, 10.63, 10.627, 10.729, 10.838000000000001, 10.84, 10.423, 10.526000000000002, 10.53, 10.528, 10.628, 10.527000000000001, 10.528, 10.73, 10.527000000000001, 11.241000000000001, 10.42, 10.627, 10.838000000000001, 10.63, 10.628, 10.63, 10.63, 10.73, 10.63, 10.63, 10.73, 10.73, 10.628, 10.845, 10.629999999999999, 10.942, 10.73, 10.73, 10.63, 10.527000000000001, 10.63, 10.526000000000002, 10.63, 10.63, 10.729, 10.526000000000002, 10.63, 10.940999999999999, 10.838000000000001, 10.63, 10.528, 10.530000000000001, 10.309000000000001, 10.725000000000001, 10.63, 10.73], "episode_lengths": [38, 36, 39, 37, 39, 38, 39, 37, 38, 38, 37, 38, 38, 38, 38, 39, 38, 37, 38, 37, 39, 38, 39, 39, 38, 38, 38, 37, 38, 38, 38, 39, 39, 43, 38, 40, 38, 39, 43, 39, 39, 40, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 37, 38, 38, 38, 38, 38, 38, 38, 38, 39, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 40, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 38, 38, 38, 36, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.53234136366484, "mean_inference_ms": 1.401518866097681, "mean_action_processing_ms": 0.08076167165340382, "mean_env_wait_ms": 4.922921721473914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034186840057373047, "ViewRequirementAgentConnector_ms": 0.22924280166625977}}, "episode_reward_max": 11.579, "episode_reward_min": 10.309000000000001, "episode_reward_mean": 10.679179999999999, "episode_len_mean": 38.23, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.63, 10.714, 10.838000000000001, 10.421, 10.838000000000001, 10.728000000000002, 10.838000000000001, 10.523000000000001, 10.637, 10.528, 10.423, 10.628, 10.528, 10.330000000000002, 10.526000000000002, 10.838000000000001, 10.530000000000001, 10.423, 10.527000000000001, 10.42, 10.838000000000001, 10.731000000000002, 10.838000000000001, 10.838000000000001, 10.729, 10.628, 10.729, 10.712, 10.63, 10.73, 10.628, 10.838000000000001, 10.838000000000001, 11.579, 10.726000000000003, 10.543000000000001, 10.726000000000003, 10.943999999999999, 11.477, 10.838000000000001, 10.837, 11.048000000000002, 10.327000000000002, 10.628, 10.527000000000001, 10.731000000000002, 10.73, 10.426, 10.727000000000002, 10.63, 10.627, 10.729, 10.838000000000001, 10.84, 10.423, 10.526000000000002, 10.53, 10.528, 10.628, 10.527000000000001, 10.528, 10.73, 10.527000000000001, 11.241000000000001, 10.42, 10.627, 10.838000000000001, 10.63, 10.628, 10.63, 10.63, 10.73, 10.63, 10.63, 10.73, 10.73, 10.628, 10.845, 10.629999999999999, 10.942, 10.73, 10.73, 10.63, 10.527000000000001, 10.63, 10.526000000000002, 10.63, 10.63, 10.729, 10.526000000000002, 10.63, 10.940999999999999, 10.838000000000001, 10.63, 10.528, 10.530000000000001, 10.309000000000001, 10.725000000000001, 10.63, 10.73], "episode_lengths": [38, 36, 39, 37, 39, 38, 39, 37, 38, 38, 37, 38, 38, 38, 38, 39, 38, 37, 38, 37, 39, 38, 39, 39, 38, 38, 38, 37, 38, 38, 38, 39, 39, 43, 38, 40, 38, 39, 43, 39, 39, 40, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 37, 38, 38, 38, 38, 38, 38, 38, 38, 39, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 40, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 38, 38, 38, 36, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.53234136366484, "mean_inference_ms": 1.401518866097681, "mean_action_processing_ms": 0.08076167165340382, "mean_env_wait_ms": 4.922921721473914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034186840057373047, "ViewRequirementAgentConnector_ms": 0.22924280166625977}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70654, "num_agent_steps_trained": 0, "num_env_steps_sampled": 70656, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.320506534519065, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 70656, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 70654, "timers": {"training_iteration_time_ms": 50321.899, "sample_time_ms": 7180.335, "synch_weights_time_ms": 74.3}, "counters": {"num_env_steps_sampled": 70656, "num_env_steps_trained": 0, "num_agent_steps_sampled": 70654, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1430, "training_iteration": 69, "trial_id": "default", "date": "2025-12-20_11-45-13", "timestamp": 1766202313, "time_this_iter_s": 50.39549541473389, "time_total_s": 3454.278553247452, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3454.278553247452, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 85.83098591549295, "ram_util_percent": 14.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.13594568353146314}, "default_policy": {"total_loss": 0.13594568353146314, "policy_loss": -0.003952472127275541, "vf_loss": 0.5611194916069507, "vf_loss_unclipped": 1.8609874650835991, "vf_explained_var": 0.9187598824501038, "entropy": 0.1539072722196579, "mean_kl_loss": 0.002428444698186638, "gradients_default_optimizer_global_norm": 0.39882226902991535, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00240015625, "curr_kl_coeff": 1.9073486612342094e-07}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 0, "num_agent_steps_sampled": 71678, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.579, "episode_reward_min": 10.309000000000001, "episode_reward_mean": 10.692510000000002, "episode_len_mean": 38.18, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.729, 10.712, 10.63, 10.73, 10.628, 10.838000000000001, 10.838000000000001, 11.579, 10.726000000000003, 10.543000000000001, 10.726000000000003, 10.943999999999999, 11.477, 10.838000000000001, 10.837, 11.048000000000002, 10.327000000000002, 10.628, 10.527000000000001, 10.731000000000002, 10.73, 10.426, 10.727000000000002, 10.63, 10.627, 10.729, 10.838000000000001, 10.84, 10.423, 10.526000000000002, 10.53, 10.528, 10.628, 10.527000000000001, 10.528, 10.73, 10.527000000000001, 11.241000000000001, 10.42, 10.627, 10.838000000000001, 10.63, 10.628, 10.63, 10.63, 10.73, 10.63, 10.63, 10.73, 10.73, 10.628, 10.845, 10.629999999999999, 10.942, 10.73, 10.73, 10.63, 10.527000000000001, 10.63, 10.526000000000002, 10.63, 10.63, 10.729, 10.526000000000002, 10.63, 10.940999999999999, 10.838000000000001, 10.63, 10.528, 10.530000000000001, 10.309000000000001, 10.725000000000001, 10.63, 10.73, 10.73, 10.528, 10.339000000000002, 10.63, 10.727000000000002, 10.616000000000001, 10.63, 10.728000000000002, 10.73, 10.73, 10.918000000000001, 10.921000000000001, 10.63, 10.63, 10.73, 10.63, 10.629000000000001, 10.706000000000001, 10.817, 10.727000000000002, 10.73, 10.73, 10.63, 10.73, 10.727000000000002, 10.530000000000001], "episode_lengths": [38, 37, 38, 38, 38, 39, 39, 43, 38, 40, 38, 39, 43, 39, 39, 40, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 37, 38, 38, 38, 38, 38, 38, 38, 38, 39, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 40, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 38, 38, 38, 36, 38, 38, 38, 38, 38, 39, 38, 38, 37, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 36, 37, 38, 38, 38, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5328084670540433, "mean_inference_ms": 1.4012912863482754, "mean_action_processing_ms": 0.08075480652653855, "mean_env_wait_ms": 4.922409664422747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034105777740478516, "ViewRequirementAgentConnector_ms": 0.229353666305542}}, "episode_reward_max": 11.579, "episode_reward_min": 10.309000000000001, "episode_reward_mean": 10.692510000000002, "episode_len_mean": 38.18, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.729, 10.712, 10.63, 10.73, 10.628, 10.838000000000001, 10.838000000000001, 11.579, 10.726000000000003, 10.543000000000001, 10.726000000000003, 10.943999999999999, 11.477, 10.838000000000001, 10.837, 11.048000000000002, 10.327000000000002, 10.628, 10.527000000000001, 10.731000000000002, 10.73, 10.426, 10.727000000000002, 10.63, 10.627, 10.729, 10.838000000000001, 10.84, 10.423, 10.526000000000002, 10.53, 10.528, 10.628, 10.527000000000001, 10.528, 10.73, 10.527000000000001, 11.241000000000001, 10.42, 10.627, 10.838000000000001, 10.63, 10.628, 10.63, 10.63, 10.73, 10.63, 10.63, 10.73, 10.73, 10.628, 10.845, 10.629999999999999, 10.942, 10.73, 10.73, 10.63, 10.527000000000001, 10.63, 10.526000000000002, 10.63, 10.63, 10.729, 10.526000000000002, 10.63, 10.940999999999999, 10.838000000000001, 10.63, 10.528, 10.530000000000001, 10.309000000000001, 10.725000000000001, 10.63, 10.73, 10.73, 10.528, 10.339000000000002, 10.63, 10.727000000000002, 10.616000000000001, 10.63, 10.728000000000002, 10.73, 10.73, 10.918000000000001, 10.921000000000001, 10.63, 10.63, 10.73, 10.63, 10.629000000000001, 10.706000000000001, 10.817, 10.727000000000002, 10.73, 10.73, 10.63, 10.73, 10.727000000000002, 10.530000000000001], "episode_lengths": [38, 37, 38, 38, 38, 39, 39, 43, 38, 40, 38, 39, 43, 39, 39, 40, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 37, 38, 38, 38, 38, 38, 38, 38, 38, 39, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 40, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 38, 38, 38, 36, 38, 38, 38, 38, 38, 39, 38, 38, 37, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 36, 37, 38, 38, 38, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5328084670540433, "mean_inference_ms": 1.4012912863482754, "mean_action_processing_ms": 0.08075480652653855, "mean_env_wait_ms": 4.922409664422747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034105777740478516, "ViewRequirementAgentConnector_ms": 0.229353666305542}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71678, "num_agent_steps_trained": 0, "num_env_steps_sampled": 71680, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.208339526252406, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 71680, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 71678, "timers": {"training_iteration_time_ms": 50362.792, "sample_time_ms": 7179.81, "synch_weights_time_ms": 74.095}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 0, "num_agent_steps_sampled": 71678, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1456, "training_iteration": 70, "trial_id": "default", "date": "2025-12-20_11-46-03", "timestamp": 1766202363, "time_this_iter_s": 50.675509452819824, "time_total_s": 3504.9540627002716, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3504.9540627002716, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 85.69444444444444, "ram_util_percent": 14.431944444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.3188161768019199}, "default_policy": {"total_loss": 0.3188161768019199, "policy_loss": -0.009310656460002065, "vf_loss": 1.314081872627139, "vf_loss_unclipped": 4.8412181556224825, "vf_explained_var": 0.7663938522338867, "entropy": 0.16400203593075274, "mean_kl_loss": 0.002149981495425557, "gradients_default_optimizer_global_norm": 0.5673614863306284, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00232015625, "curr_kl_coeff": 9.536743306171047e-08}}, "num_env_steps_sampled": 72704, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72702, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.663, "episode_reward_min": 10.309000000000001, "episode_reward_mean": 10.719249999999999, "episode_len_mean": 38.1, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.423, 10.526000000000002, 10.53, 10.528, 10.628, 10.527000000000001, 10.528, 10.73, 10.527000000000001, 11.241000000000001, 10.42, 10.627, 10.838000000000001, 10.63, 10.628, 10.63, 10.63, 10.73, 10.63, 10.63, 10.73, 10.73, 10.628, 10.845, 10.629999999999999, 10.942, 10.73, 10.73, 10.63, 10.527000000000001, 10.63, 10.526000000000002, 10.63, 10.63, 10.729, 10.526000000000002, 10.63, 10.940999999999999, 10.838000000000001, 10.63, 10.528, 10.530000000000001, 10.309000000000001, 10.725000000000001, 10.63, 10.73, 10.73, 10.528, 10.339000000000002, 10.63, 10.727000000000002, 10.616000000000001, 10.63, 10.728000000000002, 10.73, 10.73, 10.918000000000001, 10.921000000000001, 10.63, 10.63, 10.73, 10.63, 10.629000000000001, 10.706000000000001, 10.817, 10.727000000000002, 10.73, 10.73, 10.63, 10.73, 10.727000000000002, 10.530000000000001, 10.73, 10.628, 10.73, 10.838000000000001, 10.729, 10.917, 10.541, 10.73, 10.727000000000002, 10.428, 10.727000000000002, 10.727000000000002, 10.921000000000001, 10.63, 12.505, 10.73, 10.618, 10.729, 10.932, 12.663, 10.445000000000002, 11.754, 10.529, 10.623000000000001, 10.427000000000001, 10.833, 10.628, 10.838000000000001], "episode_lengths": [37, 38, 38, 38, 38, 38, 38, 38, 38, 39, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 40, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 38, 38, 38, 36, 38, 38, 38, 38, 38, 39, 38, 38, 37, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 36, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 37, 39, 38, 38, 38, 38, 38, 37, 38, 46, 38, 37, 38, 38, 42, 40, 37, 38, 37, 38, 38, 38, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5334696680995381, "mean_inference_ms": 1.4013586506462172, "mean_action_processing_ms": 0.0807619152216513, "mean_env_wait_ms": 4.9230193565338505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003529787063598633, "ViewRequirementAgentConnector_ms": 0.2352612018585205}}, "episode_reward_max": 12.663, "episode_reward_min": 10.309000000000001, "episode_reward_mean": 10.719249999999999, "episode_len_mean": 38.1, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.423, 10.526000000000002, 10.53, 10.528, 10.628, 10.527000000000001, 10.528, 10.73, 10.527000000000001, 11.241000000000001, 10.42, 10.627, 10.838000000000001, 10.63, 10.628, 10.63, 10.63, 10.73, 10.63, 10.63, 10.73, 10.73, 10.628, 10.845, 10.629999999999999, 10.942, 10.73, 10.73, 10.63, 10.527000000000001, 10.63, 10.526000000000002, 10.63, 10.63, 10.729, 10.526000000000002, 10.63, 10.940999999999999, 10.838000000000001, 10.63, 10.528, 10.530000000000001, 10.309000000000001, 10.725000000000001, 10.63, 10.73, 10.73, 10.528, 10.339000000000002, 10.63, 10.727000000000002, 10.616000000000001, 10.63, 10.728000000000002, 10.73, 10.73, 10.918000000000001, 10.921000000000001, 10.63, 10.63, 10.73, 10.63, 10.629000000000001, 10.706000000000001, 10.817, 10.727000000000002, 10.73, 10.73, 10.63, 10.73, 10.727000000000002, 10.530000000000001, 10.73, 10.628, 10.73, 10.838000000000001, 10.729, 10.917, 10.541, 10.73, 10.727000000000002, 10.428, 10.727000000000002, 10.727000000000002, 10.921000000000001, 10.63, 12.505, 10.73, 10.618, 10.729, 10.932, 12.663, 10.445000000000002, 11.754, 10.529, 10.623000000000001, 10.427000000000001, 10.833, 10.628, 10.838000000000001], "episode_lengths": [37, 38, 38, 38, 38, 38, 38, 38, 38, 39, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 40, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 38, 38, 38, 36, 38, 38, 38, 38, 38, 39, 38, 38, 37, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 36, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 37, 39, 38, 38, 38, 38, 38, 37, 38, 46, 38, 37, 38, 38, 42, 40, 37, 38, 37, 38, 38, 38, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5334696680995381, "mean_inference_ms": 1.4013586506462172, "mean_action_processing_ms": 0.0807619152216513, "mean_env_wait_ms": 4.9230193565338505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003529787063598633, "ViewRequirementAgentConnector_ms": 0.2352612018585205}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72702, "num_agent_steps_trained": 0, "num_env_steps_sampled": 72704, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.099861345467634, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 72704, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 72702, "timers": {"training_iteration_time_ms": 50444.339, "sample_time_ms": 7181.559, "synch_weights_time_ms": 75.421}, "counters": {"num_env_steps_sampled": 72704, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72702, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1484, "training_iteration": 71, "trial_id": "default", "date": "2025-12-20_11-46-54", "timestamp": 1766202414, "time_this_iter_s": 50.94926977157593, "time_total_s": 3555.9033324718475, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3555.9033324718475, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 85.11917808219178, "ram_util_percent": 14.428767123287674}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.08119168430566788}, "default_policy": {"total_loss": 0.08119168430566788, "policy_loss": -0.0016219439450651408, "vf_loss": 0.3325160041451454, "vf_loss_unclipped": 1.200308057665825, "vf_explained_var": 0.9525832563638688, "entropy": 0.1359278280287981, "mean_kl_loss": 0.0009200126007613107, "gradients_default_optimizer_global_norm": 0.2710999514907598, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00224015625, "curr_kl_coeff": 4.7683716530855236e-08}}, "num_env_steps_sampled": 73728, "num_env_steps_trained": 0, "num_agent_steps_sampled": 73726, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.663, "episode_reward_min": 10.215000000000002, "episode_reward_mean": 10.723410000000003, "episode_len_mean": 37.98, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.63, 10.527000000000001, 10.63, 10.526000000000002, 10.63, 10.63, 10.729, 10.526000000000002, 10.63, 10.940999999999999, 10.838000000000001, 10.63, 10.528, 10.530000000000001, 10.309000000000001, 10.725000000000001, 10.63, 10.73, 10.73, 10.528, 10.339000000000002, 10.63, 10.727000000000002, 10.616000000000001, 10.63, 10.728000000000002, 10.73, 10.73, 10.918000000000001, 10.921000000000001, 10.63, 10.63, 10.73, 10.63, 10.629000000000001, 10.706000000000001, 10.817, 10.727000000000002, 10.73, 10.73, 10.63, 10.73, 10.727000000000002, 10.530000000000001, 10.73, 10.628, 10.73, 10.838000000000001, 10.729, 10.917, 10.541, 10.73, 10.727000000000002, 10.428, 10.727000000000002, 10.727000000000002, 10.921000000000001, 10.63, 12.505, 10.73, 10.618, 10.729, 10.932, 12.663, 10.445000000000002, 11.754, 10.529, 10.623000000000001, 10.427000000000001, 10.833, 10.628, 10.838000000000001, 10.73, 10.628, 10.628, 10.526000000000002, 10.215000000000002, 10.63, 10.73, 10.73, 10.73, 10.73, 10.411, 10.73, 10.714, 10.73, 10.729, 10.921000000000001, 10.63, 10.73, 10.628, 10.73, 10.73, 10.523000000000001, 10.727000000000002, 10.73, 10.932, 10.63], "episode_lengths": [38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 38, 38, 38, 36, 38, 38, 38, 38, 38, 39, 38, 38, 37, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 36, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 37, 39, 38, 38, 38, 38, 38, 37, 38, 46, 38, 37, 38, 38, 42, 40, 37, 38, 37, 38, 38, 38, 39, 38, 38, 38, 38, 35, 38, 38, 38, 38, 38, 36, 38, 36, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5341499524387356, "mean_inference_ms": 1.4018021998542016, "mean_action_processing_ms": 0.08079252959658799, "mean_env_wait_ms": 4.924410445145323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035369396209716797, "ViewRequirementAgentConnector_ms": 0.23528695106506348}}, "episode_reward_max": 12.663, "episode_reward_min": 10.215000000000002, "episode_reward_mean": 10.723410000000003, "episode_len_mean": 37.98, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.63, 10.527000000000001, 10.63, 10.526000000000002, 10.63, 10.63, 10.729, 10.526000000000002, 10.63, 10.940999999999999, 10.838000000000001, 10.63, 10.528, 10.530000000000001, 10.309000000000001, 10.725000000000001, 10.63, 10.73, 10.73, 10.528, 10.339000000000002, 10.63, 10.727000000000002, 10.616000000000001, 10.63, 10.728000000000002, 10.73, 10.73, 10.918000000000001, 10.921000000000001, 10.63, 10.63, 10.73, 10.63, 10.629000000000001, 10.706000000000001, 10.817, 10.727000000000002, 10.73, 10.73, 10.63, 10.73, 10.727000000000002, 10.530000000000001, 10.73, 10.628, 10.73, 10.838000000000001, 10.729, 10.917, 10.541, 10.73, 10.727000000000002, 10.428, 10.727000000000002, 10.727000000000002, 10.921000000000001, 10.63, 12.505, 10.73, 10.618, 10.729, 10.932, 12.663, 10.445000000000002, 11.754, 10.529, 10.623000000000001, 10.427000000000001, 10.833, 10.628, 10.838000000000001, 10.73, 10.628, 10.628, 10.526000000000002, 10.215000000000002, 10.63, 10.73, 10.73, 10.73, 10.73, 10.411, 10.73, 10.714, 10.73, 10.729, 10.921000000000001, 10.63, 10.73, 10.628, 10.73, 10.73, 10.523000000000001, 10.727000000000002, 10.73, 10.932, 10.63], "episode_lengths": [38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 39, 38, 38, 38, 36, 38, 38, 38, 38, 38, 39, 38, 38, 37, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 36, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 37, 39, 38, 38, 38, 38, 38, 37, 38, 46, 38, 37, 38, 38, 42, 40, 37, 38, 37, 38, 38, 38, 39, 38, 38, 38, 38, 35, 38, 38, 38, 38, 38, 36, 38, 36, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5341499524387356, "mean_inference_ms": 1.4018021998542016, "mean_action_processing_ms": 0.08079252959658799, "mean_env_wait_ms": 4.924410445145323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035369396209716797, "ViewRequirementAgentConnector_ms": 0.23528695106506348}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73726, "num_agent_steps_trained": 0, "num_env_steps_sampled": 73728, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.219620914576243, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 73728, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 73726, "timers": {"training_iteration_time_ms": 50509.033, "sample_time_ms": 7184.249, "synch_weights_time_ms": 75.007}, "counters": {"num_env_steps_sampled": 73728, "num_env_steps_trained": 0, "num_agent_steps_sampled": 73726, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1510, "training_iteration": 72, "trial_id": "default", "date": "2025-12-20_11-47-52", "timestamp": 1766202472, "time_this_iter_s": 50.647140979766846, "time_total_s": 3606.5504734516144, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3606.5504734516144, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 75.4451219512195, "ram_util_percent": 14.475609756097562}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.062281129974871875}, "default_policy": {"total_loss": 0.062281129974871875, "policy_loss": -0.0006150886416435242, "vf_loss": 0.2528167001903057, "vf_loss_unclipped": 1.4313429906964301, "vf_explained_var": 0.943849167227745, "entropy": 0.1374698530882597, "mean_kl_loss": 0.00027144437039865464, "gradients_default_optimizer_global_norm": 0.14002678459510207, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0021601562499999998, "curr_kl_coeff": 2.3841858265427618e-08}}, "num_env_steps_sampled": 74752, "num_env_steps_trained": 0, "num_agent_steps_sampled": 74750, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.663, "episode_reward_min": 10.215000000000002, "episode_reward_mean": 10.743840000000004, "episode_len_mean": 37.87, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.918000000000001, 10.921000000000001, 10.63, 10.63, 10.73, 10.63, 10.629000000000001, 10.706000000000001, 10.817, 10.727000000000002, 10.73, 10.73, 10.63, 10.73, 10.727000000000002, 10.530000000000001, 10.73, 10.628, 10.73, 10.838000000000001, 10.729, 10.917, 10.541, 10.73, 10.727000000000002, 10.428, 10.727000000000002, 10.727000000000002, 10.921000000000001, 10.63, 12.505, 10.73, 10.618, 10.729, 10.932, 12.663, 10.445000000000002, 11.754, 10.529, 10.623000000000001, 10.427000000000001, 10.833, 10.628, 10.838000000000001, 10.73, 10.628, 10.628, 10.526000000000002, 10.215000000000002, 10.63, 10.73, 10.73, 10.73, 10.73, 10.411, 10.73, 10.714, 10.73, 10.729, 10.921000000000001, 10.63, 10.73, 10.628, 10.73, 10.73, 10.523000000000001, 10.727000000000002, 10.73, 10.932, 10.63, 11.136000000000001, 10.73, 10.31, 10.73, 10.73, 10.73, 10.73, 10.628, 10.523000000000001, 10.426, 10.73, 10.73, 10.73, 10.309000000000001, 10.825000000000001, 10.73, 10.919, 10.729, 10.73, 10.921000000000001, 10.814, 10.63, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73], "episode_lengths": [38, 38, 37, 37, 38, 38, 38, 38, 38, 36, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 37, 39, 38, 38, 38, 38, 38, 37, 38, 46, 38, 37, 38, 38, 42, 40, 37, 38, 37, 38, 38, 38, 39, 38, 38, 38, 38, 35, 38, 38, 38, 38, 38, 36, 38, 36, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 35, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 36, 37, 38, 37, 38, 38, 37, 36, 38, 38, 38, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5348047452539566, "mean_inference_ms": 1.401861623178448, "mean_action_processing_ms": 0.0807971113154499, "mean_env_wait_ms": 4.925055143400478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035631656646728516, "ViewRequirementAgentConnector_ms": 0.2360367774963379}}, "episode_reward_max": 12.663, "episode_reward_min": 10.215000000000002, "episode_reward_mean": 10.743840000000004, "episode_len_mean": 37.87, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.918000000000001, 10.921000000000001, 10.63, 10.63, 10.73, 10.63, 10.629000000000001, 10.706000000000001, 10.817, 10.727000000000002, 10.73, 10.73, 10.63, 10.73, 10.727000000000002, 10.530000000000001, 10.73, 10.628, 10.73, 10.838000000000001, 10.729, 10.917, 10.541, 10.73, 10.727000000000002, 10.428, 10.727000000000002, 10.727000000000002, 10.921000000000001, 10.63, 12.505, 10.73, 10.618, 10.729, 10.932, 12.663, 10.445000000000002, 11.754, 10.529, 10.623000000000001, 10.427000000000001, 10.833, 10.628, 10.838000000000001, 10.73, 10.628, 10.628, 10.526000000000002, 10.215000000000002, 10.63, 10.73, 10.73, 10.73, 10.73, 10.411, 10.73, 10.714, 10.73, 10.729, 10.921000000000001, 10.63, 10.73, 10.628, 10.73, 10.73, 10.523000000000001, 10.727000000000002, 10.73, 10.932, 10.63, 11.136000000000001, 10.73, 10.31, 10.73, 10.73, 10.73, 10.73, 10.628, 10.523000000000001, 10.426, 10.73, 10.73, 10.73, 10.309000000000001, 10.825000000000001, 10.73, 10.919, 10.729, 10.73, 10.921000000000001, 10.814, 10.63, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73], "episode_lengths": [38, 38, 37, 37, 38, 38, 38, 38, 38, 36, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 37, 39, 38, 38, 38, 38, 38, 37, 38, 46, 38, 37, 38, 38, 42, 40, 37, 38, 37, 38, 38, 38, 39, 38, 38, 38, 38, 35, 38, 38, 38, 38, 38, 36, 38, 36, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 35, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 36, 37, 38, 37, 38, 38, 37, 36, 38, 38, 38, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5348047452539566, "mean_inference_ms": 1.401861623178448, "mean_action_processing_ms": 0.0807971113154499, "mean_env_wait_ms": 4.925055143400478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035631656646728516, "ViewRequirementAgentConnector_ms": 0.2360367774963379}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74750, "num_agent_steps_trained": 0, "num_env_steps_sampled": 74752, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.49563624539284, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 74752, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 74750, "timers": {"training_iteration_time_ms": 50460.951, "sample_time_ms": 7183.923, "synch_weights_time_ms": 74.604}, "counters": {"num_env_steps_sampled": 74752, "num_env_steps_trained": 0, "num_agent_steps_sampled": 74750, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1538, "training_iteration": 73, "trial_id": "default", "date": "2025-12-20_11-48-42", "timestamp": 1766202522, "time_this_iter_s": 49.9650559425354, "time_total_s": 3656.51552939415, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3656.51552939415, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 85.86338028169013, "ram_util_percent": 14.43380281690141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.15850601270794867}, "default_policy": {"total_loss": 0.15850601270794867, "policy_loss": -0.005099516548216343, "vf_loss": 0.6556329235434533, "vf_loss_unclipped": 2.555881606042385, "vf_explained_var": 0.892240709066391, "entropy": 0.1401290711015463, "mean_kl_loss": 0.000662027644182217, "gradients_default_optimizer_global_norm": 0.23859493657946587, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00208015625, "curr_kl_coeff": 1.1920929132713809e-08}}, "num_env_steps_sampled": 75776, "num_env_steps_trained": 0, "num_agent_steps_sampled": 75774, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.663, "episode_reward_min": 10.215000000000002, "episode_reward_mean": 10.741430000000001, "episode_len_mean": 37.78, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.727000000000002, 10.727000000000002, 10.921000000000001, 10.63, 12.505, 10.73, 10.618, 10.729, 10.932, 12.663, 10.445000000000002, 11.754, 10.529, 10.623000000000001, 10.427000000000001, 10.833, 10.628, 10.838000000000001, 10.73, 10.628, 10.628, 10.526000000000002, 10.215000000000002, 10.63, 10.73, 10.73, 10.73, 10.73, 10.411, 10.73, 10.714, 10.73, 10.729, 10.921000000000001, 10.63, 10.73, 10.628, 10.73, 10.73, 10.523000000000001, 10.727000000000002, 10.73, 10.932, 10.63, 11.136000000000001, 10.73, 10.31, 10.73, 10.73, 10.73, 10.73, 10.628, 10.523000000000001, 10.426, 10.73, 10.73, 10.73, 10.309000000000001, 10.825000000000001, 10.73, 10.919, 10.729, 10.73, 10.921000000000001, 10.814, 10.63, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.63, 10.73, 10.835, 10.521, 10.73, 10.73, 10.73, 10.73, 10.73, 10.527000000000001, 10.919, 10.611, 10.73, 10.73, 10.819, 10.63, 10.627, 10.73, 10.73, 10.928, 10.73, 10.73, 10.73, 10.276, 10.73, 10.73, 10.629000000000001, 10.73], "episode_lengths": [38, 38, 37, 38, 46, 38, 37, 38, 38, 42, 40, 37, 38, 37, 38, 38, 38, 39, 38, 38, 38, 38, 35, 38, 38, 38, 38, 38, 36, 38, 36, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 35, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 36, 37, 38, 37, 38, 38, 37, 36, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 35, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 31, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5357043416775683, "mean_inference_ms": 1.4025378900538867, "mean_action_processing_ms": 0.08083555518796923, "mean_env_wait_ms": 4.927464787328989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036568641662597656, "ViewRequirementAgentConnector_ms": 0.24225759506225586}}, "episode_reward_max": 12.663, "episode_reward_min": 10.215000000000002, "episode_reward_mean": 10.741430000000001, "episode_len_mean": 37.78, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.727000000000002, 10.727000000000002, 10.921000000000001, 10.63, 12.505, 10.73, 10.618, 10.729, 10.932, 12.663, 10.445000000000002, 11.754, 10.529, 10.623000000000001, 10.427000000000001, 10.833, 10.628, 10.838000000000001, 10.73, 10.628, 10.628, 10.526000000000002, 10.215000000000002, 10.63, 10.73, 10.73, 10.73, 10.73, 10.411, 10.73, 10.714, 10.73, 10.729, 10.921000000000001, 10.63, 10.73, 10.628, 10.73, 10.73, 10.523000000000001, 10.727000000000002, 10.73, 10.932, 10.63, 11.136000000000001, 10.73, 10.31, 10.73, 10.73, 10.73, 10.73, 10.628, 10.523000000000001, 10.426, 10.73, 10.73, 10.73, 10.309000000000001, 10.825000000000001, 10.73, 10.919, 10.729, 10.73, 10.921000000000001, 10.814, 10.63, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.63, 10.73, 10.835, 10.521, 10.73, 10.73, 10.73, 10.73, 10.73, 10.527000000000001, 10.919, 10.611, 10.73, 10.73, 10.819, 10.63, 10.627, 10.73, 10.73, 10.928, 10.73, 10.73, 10.73, 10.276, 10.73, 10.73, 10.629000000000001, 10.73], "episode_lengths": [38, 38, 37, 38, 46, 38, 37, 38, 38, 42, 40, 37, 38, 37, 38, 38, 38, 39, 38, 38, 38, 38, 35, 38, 38, 38, 38, 38, 36, 38, 36, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 35, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 36, 37, 38, 37, 38, 38, 37, 36, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 35, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 31, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5357043416775683, "mean_inference_ms": 1.4025378900538867, "mean_action_processing_ms": 0.08083555518796923, "mean_env_wait_ms": 4.927464787328989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036568641662597656, "ViewRequirementAgentConnector_ms": 0.24225759506225586}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75774, "num_agent_steps_trained": 0, "num_env_steps_sampled": 75776, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.167509917606996, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 75776, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 75774, "timers": {"training_iteration_time_ms": 50513.299, "sample_time_ms": 7262.853, "synch_weights_time_ms": 74.648}, "counters": {"num_env_steps_sampled": 75776, "num_env_steps_trained": 0, "num_agent_steps_sampled": 75774, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1566, "training_iteration": 74, "trial_id": "default", "date": "2025-12-20_11-49-33", "timestamp": 1766202573, "time_this_iter_s": 50.7778480052948, "time_total_s": 3707.2933773994446, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3707.2933773994446, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 84.4361111111111, "ram_util_percent": 14.455555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.15258987601846458}, "default_policy": {"total_loss": 0.15258987601846458, "policy_loss": -0.004023723630234599, "vf_loss": 0.6276525046676398, "vf_loss_unclipped": 1.8101912930607795, "vf_explained_var": 0.9179301008582115, "entropy": 0.14399187862873078, "mean_kl_loss": 0.000711909334346239, "gradients_default_optimizer_global_norm": 0.2578479964286089, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00200015625, "curr_kl_coeff": 5.9604645663569045e-09}}, "num_env_steps_sampled": 76800, "num_env_steps_trained": 0, "num_agent_steps_sampled": 76798, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.169, "episode_reward_min": 10.276, "episode_reward_mean": 10.716370000000001, "episode_len_mean": 37.74, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.411, 10.73, 10.714, 10.73, 10.729, 10.921000000000001, 10.63, 10.73, 10.628, 10.73, 10.73, 10.523000000000001, 10.727000000000002, 10.73, 10.932, 10.63, 11.136000000000001, 10.73, 10.31, 10.73, 10.73, 10.73, 10.73, 10.628, 10.523000000000001, 10.426, 10.73, 10.73, 10.73, 10.309000000000001, 10.825000000000001, 10.73, 10.919, 10.729, 10.73, 10.921000000000001, 10.814, 10.63, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.63, 10.73, 10.835, 10.521, 10.73, 10.73, 10.73, 10.73, 10.73, 10.527000000000001, 10.919, 10.611, 10.73, 10.73, 10.819, 10.63, 10.627, 10.73, 10.73, 10.928, 10.73, 10.73, 10.73, 10.276, 10.73, 10.73, 10.629000000000001, 10.73, 10.63, 10.838000000000001, 10.729, 10.73, 11.169, 10.818000000000001, 10.73, 10.628, 10.73, 10.819, 10.63, 10.73, 10.729, 10.63, 10.726000000000003, 10.737000000000002, 10.73, 10.821000000000002, 10.838000000000001, 10.919, 10.920000000000002, 10.52, 10.73, 10.828000000000001, 10.531, 10.73], "episode_lengths": [38, 38, 36, 38, 36, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 35, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 36, 37, 38, 37, 38, 38, 37, 36, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 35, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 31, 38, 38, 38, 38, 38, 39, 38, 38, 45, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 39, 38, 37, 39, 37, 37, 37, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5365045300553575, "mean_inference_ms": 1.4032519565306993, "mean_action_processing_ms": 0.08088097460455511, "mean_env_wait_ms": 4.929153161017984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035893917083740234, "ViewRequirementAgentConnector_ms": 0.23816156387329102}}, "episode_reward_max": 11.169, "episode_reward_min": 10.276, "episode_reward_mean": 10.716370000000001, "episode_len_mean": 37.74, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.411, 10.73, 10.714, 10.73, 10.729, 10.921000000000001, 10.63, 10.73, 10.628, 10.73, 10.73, 10.523000000000001, 10.727000000000002, 10.73, 10.932, 10.63, 11.136000000000001, 10.73, 10.31, 10.73, 10.73, 10.73, 10.73, 10.628, 10.523000000000001, 10.426, 10.73, 10.73, 10.73, 10.309000000000001, 10.825000000000001, 10.73, 10.919, 10.729, 10.73, 10.921000000000001, 10.814, 10.63, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.63, 10.73, 10.835, 10.521, 10.73, 10.73, 10.73, 10.73, 10.73, 10.527000000000001, 10.919, 10.611, 10.73, 10.73, 10.819, 10.63, 10.627, 10.73, 10.73, 10.928, 10.73, 10.73, 10.73, 10.276, 10.73, 10.73, 10.629000000000001, 10.73, 10.63, 10.838000000000001, 10.729, 10.73, 11.169, 10.818000000000001, 10.73, 10.628, 10.73, 10.819, 10.63, 10.73, 10.729, 10.63, 10.726000000000003, 10.737000000000002, 10.73, 10.821000000000002, 10.838000000000001, 10.919, 10.920000000000002, 10.52, 10.73, 10.828000000000001, 10.531, 10.73], "episode_lengths": [38, 38, 36, 38, 36, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 35, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 36, 37, 38, 37, 38, 38, 37, 36, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 35, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 31, 38, 38, 38, 38, 38, 39, 38, 38, 45, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 39, 38, 37, 39, 37, 37, 37, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5365045300553575, "mean_inference_ms": 1.4032519565306993, "mean_action_processing_ms": 0.08088097460455511, "mean_env_wait_ms": 4.929153161017984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035893917083740234, "ViewRequirementAgentConnector_ms": 0.23816156387329102}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76798, "num_agent_steps_trained": 0, "num_env_steps_sampled": 76800, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.22832606548456, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 76800, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 76798, "timers": {"training_iteration_time_ms": 50502.871, "sample_time_ms": 7259.437, "synch_weights_time_ms": 75.256}, "counters": {"num_env_steps_sampled": 76800, "num_env_steps_trained": 0, "num_agent_steps_sampled": 76798, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1592, "training_iteration": 75, "trial_id": "default", "date": "2025-12-20_11-50-24", "timestamp": 1766202624, "time_this_iter_s": 50.62538814544678, "time_total_s": 3757.9187655448914, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3757.9187655448914, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 85.78611111111111, "ram_util_percent": 14.483333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.08333469042554498}, "default_policy": {"total_loss": 0.08333469042554498, "policy_loss": -0.0024853399489074947, "vf_loss": 0.3442534297704697, "vf_loss_unclipped": 1.1951837338507176, "vf_explained_var": 0.9533441349864006, "entropy": 0.12165343314409256, "mean_kl_loss": 0.0005945797616321635, "gradients_default_optimizer_global_norm": 0.10465904930606484, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00192015625, "curr_kl_coeff": 2.9802322831784522e-09}}, "num_env_steps_sampled": 77824, "num_env_steps_trained": 0, "num_agent_steps_sampled": 77822, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.252, "episode_reward_min": 10.276, "episode_reward_mean": 10.730160000000001, "episode_len_mean": 37.8, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.426, 10.73, 10.73, 10.73, 10.309000000000001, 10.825000000000001, 10.73, 10.919, 10.729, 10.73, 10.921000000000001, 10.814, 10.63, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.63, 10.73, 10.835, 10.521, 10.73, 10.73, 10.73, 10.73, 10.73, 10.527000000000001, 10.919, 10.611, 10.73, 10.73, 10.819, 10.63, 10.627, 10.73, 10.73, 10.928, 10.73, 10.73, 10.73, 10.276, 10.73, 10.73, 10.629000000000001, 10.73, 10.63, 10.838000000000001, 10.729, 10.73, 11.169, 10.818000000000001, 10.73, 10.628, 10.73, 10.819, 10.63, 10.73, 10.729, 10.63, 10.726000000000003, 10.737000000000002, 10.73, 10.821000000000002, 10.838000000000001, 10.919, 10.920000000000002, 10.52, 10.73, 10.828000000000001, 10.531, 10.73, 10.73, 10.73, 10.643, 10.73, 10.530000000000001, 10.73, 10.73, 10.729, 10.610000000000001, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.838000000000001, 10.73, 10.921000000000001, 10.73, 10.729, 10.729, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 11.252], "episode_lengths": [38, 38, 38, 38, 36, 37, 38, 37, 38, 38, 37, 36, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 35, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 31, 38, 38, 38, 38, 38, 39, 38, 38, 45, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 39, 38, 37, 39, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 36, 38, 38, 38, 38, 38, 38, 39, 38, 37, 38, 38, 38, 38, 38, 38, 38, 37, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5372439000841606, "mean_inference_ms": 1.4037062598179262, "mean_action_processing_ms": 0.08090510332580626, "mean_env_wait_ms": 4.9302642232303375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003620624542236328, "ViewRequirementAgentConnector_ms": 0.23798179626464844}}, "episode_reward_max": 11.252, "episode_reward_min": 10.276, "episode_reward_mean": 10.730160000000001, "episode_len_mean": 37.8, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.426, 10.73, 10.73, 10.73, 10.309000000000001, 10.825000000000001, 10.73, 10.919, 10.729, 10.73, 10.921000000000001, 10.814, 10.63, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.63, 10.73, 10.835, 10.521, 10.73, 10.73, 10.73, 10.73, 10.73, 10.527000000000001, 10.919, 10.611, 10.73, 10.73, 10.819, 10.63, 10.627, 10.73, 10.73, 10.928, 10.73, 10.73, 10.73, 10.276, 10.73, 10.73, 10.629000000000001, 10.73, 10.63, 10.838000000000001, 10.729, 10.73, 11.169, 10.818000000000001, 10.73, 10.628, 10.73, 10.819, 10.63, 10.73, 10.729, 10.63, 10.726000000000003, 10.737000000000002, 10.73, 10.821000000000002, 10.838000000000001, 10.919, 10.920000000000002, 10.52, 10.73, 10.828000000000001, 10.531, 10.73, 10.73, 10.73, 10.643, 10.73, 10.530000000000001, 10.73, 10.73, 10.729, 10.610000000000001, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.838000000000001, 10.73, 10.921000000000001, 10.73, 10.729, 10.729, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 11.252], "episode_lengths": [38, 38, 38, 38, 36, 37, 38, 37, 38, 38, 37, 36, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 35, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 31, 38, 38, 38, 38, 38, 39, 38, 38, 45, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 39, 38, 37, 39, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 36, 38, 38, 38, 38, 38, 38, 39, 38, 37, 38, 38, 38, 38, 38, 38, 38, 37, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5372439000841606, "mean_inference_ms": 1.4037062598179262, "mean_action_processing_ms": 0.08090510332580626, "mean_env_wait_ms": 4.9302642232303375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003620624542236328, "ViewRequirementAgentConnector_ms": 0.23798179626464844}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77822, "num_agent_steps_trained": 0, "num_env_steps_sampled": 77824, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.42703333700579, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 77824, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 77822, "timers": {"training_iteration_time_ms": 50443.536, "sample_time_ms": 7260.575, "synch_weights_time_ms": 75.157}, "counters": {"num_env_steps_sampled": 77824, "num_env_steps_trained": 0, "num_agent_steps_sampled": 77822, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1619, "training_iteration": 76, "trial_id": "default", "date": "2025-12-20_11-51-14", "timestamp": 1766202674, "time_this_iter_s": 50.13274002075195, "time_total_s": 3808.0515055656433, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3808.0515055656433, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 85.94583333333334, "ram_util_percent": 14.409722222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.07925664251670242}, "default_policy": {"total_loss": 0.07925664251670242, "policy_loss": -0.005853461194783449, "vf_loss": 0.3413389943540096, "vf_loss_unclipped": 1.2534946128726006, "vf_explained_var": 0.9498191148042678, "entropy": 0.11699253413826227, "mean_kl_loss": 0.0006519369623930515, "gradients_default_optimizer_global_norm": 0.23033393137156963, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0018401562500000002, "curr_kl_coeff": 1.4901161415892261e-09}}, "num_env_steps_sampled": 78848, "num_env_steps_trained": 0, "num_agent_steps_sampled": 78846, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.252, "episode_reward_min": 10.276, "episode_reward_mean": 10.731660000000003, "episode_len_mean": 37.87, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.527000000000001, 10.919, 10.611, 10.73, 10.73, 10.819, 10.63, 10.627, 10.73, 10.73, 10.928, 10.73, 10.73, 10.73, 10.276, 10.73, 10.73, 10.629000000000001, 10.73, 10.63, 10.838000000000001, 10.729, 10.73, 11.169, 10.818000000000001, 10.73, 10.628, 10.73, 10.819, 10.63, 10.73, 10.729, 10.63, 10.726000000000003, 10.737000000000002, 10.73, 10.821000000000002, 10.838000000000001, 10.919, 10.920000000000002, 10.52, 10.73, 10.828000000000001, 10.531, 10.73, 10.73, 10.73, 10.643, 10.73, 10.530000000000001, 10.73, 10.73, 10.729, 10.610000000000001, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.838000000000001, 10.73, 10.921000000000001, 10.73, 10.729, 10.729, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 11.252, 10.73, 10.727000000000002, 10.838000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.713000000000001, 10.73, 10.73, 10.73, 10.628, 10.73, 10.628, 11.057, 10.63, 10.628, 10.73, 10.73, 10.73, 10.729, 10.73, 10.729, 10.409, 10.623000000000001, 10.73], "episode_lengths": [38, 38, 37, 35, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 31, 38, 38, 38, 38, 38, 39, 38, 38, 45, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 39, 38, 37, 39, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 36, 38, 38, 38, 38, 38, 38, 39, 38, 37, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 39, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 40, 38, 38, 38, 38, 38, 38, 38, 38, 36, 37, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5379590180298304, "mean_inference_ms": 1.4042973600616575, "mean_action_processing_ms": 0.08093905605977636, "mean_env_wait_ms": 4.931336644472148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035910606384277344, "ViewRequirementAgentConnector_ms": 0.23642182350158691}}, "episode_reward_max": 11.252, "episode_reward_min": 10.276, "episode_reward_mean": 10.731660000000003, "episode_len_mean": 37.87, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.527000000000001, 10.919, 10.611, 10.73, 10.73, 10.819, 10.63, 10.627, 10.73, 10.73, 10.928, 10.73, 10.73, 10.73, 10.276, 10.73, 10.73, 10.629000000000001, 10.73, 10.63, 10.838000000000001, 10.729, 10.73, 11.169, 10.818000000000001, 10.73, 10.628, 10.73, 10.819, 10.63, 10.73, 10.729, 10.63, 10.726000000000003, 10.737000000000002, 10.73, 10.821000000000002, 10.838000000000001, 10.919, 10.920000000000002, 10.52, 10.73, 10.828000000000001, 10.531, 10.73, 10.73, 10.73, 10.643, 10.73, 10.530000000000001, 10.73, 10.73, 10.729, 10.610000000000001, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.838000000000001, 10.73, 10.921000000000001, 10.73, 10.729, 10.729, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 11.252, 10.73, 10.727000000000002, 10.838000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.713000000000001, 10.73, 10.73, 10.73, 10.628, 10.73, 10.628, 11.057, 10.63, 10.628, 10.73, 10.73, 10.73, 10.729, 10.73, 10.729, 10.409, 10.623000000000001, 10.73], "episode_lengths": [38, 38, 37, 35, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 31, 38, 38, 38, 38, 38, 39, 38, 38, 45, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 39, 38, 37, 39, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 36, 38, 38, 38, 38, 38, 38, 39, 38, 37, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 39, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 40, 38, 38, 38, 38, 38, 38, 38, 38, 36, 37, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5379590180298304, "mean_inference_ms": 1.4042973600616575, "mean_action_processing_ms": 0.08093905605977636, "mean_env_wait_ms": 4.931336644472148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035910606384277344, "ViewRequirementAgentConnector_ms": 0.23642182350158691}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78846, "num_agent_steps_trained": 0, "num_env_steps_sampled": 78848, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.531894935423686, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 78848, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 78846, "timers": {"training_iteration_time_ms": 50435.368, "sample_time_ms": 7260.623, "synch_weights_time_ms": 74.4}, "counters": {"num_env_steps_sampled": 78848, "num_env_steps_trained": 0, "num_agent_steps_sampled": 78846, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1646, "training_iteration": 77, "trial_id": "default", "date": "2025-12-20_11-52-11", "timestamp": 1766202731, "time_this_iter_s": 49.88158583641052, "time_total_s": 3857.933091402054, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3857.933091402054, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 75.43827160493828, "ram_util_percent": 14.45925925925926}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1025.0, "total_loss": 0.11867051208164633}, "default_policy": {"total_loss": 0.11867051208164633, "policy_loss": -0.0032666451013760598, "vf_loss": 0.4885820161278655, "vf_loss_unclipped": 1.660685517439028, "vf_explained_var": 0.9286254949686004, "entropy": 0.11322411276945253, "mean_kl_loss": 0.0008163577016181612, "gradients_default_optimizer_global_norm": 0.276804981616939, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0017600781250000004, "curr_kl_coeff": 7.450580707946131e-10}}, "num_env_steps_sampled": 79872, "num_env_steps_trained": 0, "num_agent_steps_sampled": 79871, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.252, "episode_reward_min": 10.409, "episode_reward_mean": 10.729580000000004, "episode_len_mean": 37.85, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.819, 10.63, 10.73, 10.729, 10.63, 10.726000000000003, 10.737000000000002, 10.73, 10.821000000000002, 10.838000000000001, 10.919, 10.920000000000002, 10.52, 10.73, 10.828000000000001, 10.531, 10.73, 10.73, 10.73, 10.643, 10.73, 10.530000000000001, 10.73, 10.73, 10.729, 10.610000000000001, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.838000000000001, 10.73, 10.921000000000001, 10.73, 10.729, 10.729, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 11.252, 10.73, 10.727000000000002, 10.838000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.713000000000001, 10.73, 10.73, 10.73, 10.628, 10.73, 10.628, 11.057, 10.63, 10.628, 10.73, 10.73, 10.73, 10.729, 10.73, 10.729, 10.409, 10.623000000000001, 10.73, 10.919, 10.628, 10.73, 10.63, 10.521, 10.817000000000002, 10.73, 10.73, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.514000000000001, 10.621, 10.921000000000001, 10.73, 10.737, 10.729, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.622, 10.732000000000001, 10.73], "episode_lengths": [38, 37, 38, 38, 38, 38, 38, 39, 38, 37, 39, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 36, 38, 38, 38, 38, 38, 38, 39, 38, 37, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 39, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 40, 38, 38, 38, 38, 38, 38, 38, 38, 36, 37, 38, 37, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 37, 38, 37, 37, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5384454149491434, "mean_inference_ms": 1.4042269142019006, "mean_action_processing_ms": 0.08093455067992206, "mean_env_wait_ms": 4.930675205565919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003485441207885742, "ViewRequirementAgentConnector_ms": 0.2312006950378418}}, "episode_reward_max": 11.252, "episode_reward_min": 10.409, "episode_reward_mean": 10.729580000000004, "episode_len_mean": 37.85, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.819, 10.63, 10.73, 10.729, 10.63, 10.726000000000003, 10.737000000000002, 10.73, 10.821000000000002, 10.838000000000001, 10.919, 10.920000000000002, 10.52, 10.73, 10.828000000000001, 10.531, 10.73, 10.73, 10.73, 10.643, 10.73, 10.530000000000001, 10.73, 10.73, 10.729, 10.610000000000001, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.838000000000001, 10.73, 10.921000000000001, 10.73, 10.729, 10.729, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 11.252, 10.73, 10.727000000000002, 10.838000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.713000000000001, 10.73, 10.73, 10.73, 10.628, 10.73, 10.628, 11.057, 10.63, 10.628, 10.73, 10.73, 10.73, 10.729, 10.73, 10.729, 10.409, 10.623000000000001, 10.73, 10.919, 10.628, 10.73, 10.63, 10.521, 10.817000000000002, 10.73, 10.73, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.514000000000001, 10.621, 10.921000000000001, 10.73, 10.737, 10.729, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.622, 10.732000000000001, 10.73], "episode_lengths": [38, 37, 38, 38, 38, 38, 38, 39, 38, 37, 39, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 36, 38, 38, 38, 38, 38, 38, 39, 38, 37, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 39, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 40, 38, 38, 38, 38, 38, 38, 38, 38, 36, 37, 38, 37, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 37, 38, 37, 37, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5384454149491434, "mean_inference_ms": 1.4042269142019006, "mean_action_processing_ms": 0.08093455067992206, "mean_env_wait_ms": 4.930675205565919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003485441207885742, "ViewRequirementAgentConnector_ms": 0.2312006950378418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79871, "num_agent_steps_trained": 0, "num_env_steps_sampled": 79872, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.02515503131492, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 79872, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 79871, "timers": {"training_iteration_time_ms": 50515.118, "sample_time_ms": 7260.412, "synch_weights_time_ms": 73.502}, "counters": {"num_env_steps_sampled": 79872, "num_env_steps_trained": 0, "num_agent_steps_sampled": 79871, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1674, "training_iteration": 78, "trial_id": "default", "date": "2025-12-20_11-53-03", "timestamp": 1766202783, "time_this_iter_s": 51.13872170448303, "time_total_s": 3909.071813106537, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3909.071813106537, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 86.17534246575343, "ram_util_percent": 14.439726027397262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1023.0, "total_loss": 0.09963771507609635}, "default_policy": {"total_loss": 0.09963771507609635, "policy_loss": -0.002979425829835236, "vf_loss": 0.41138791777193545, "vf_loss_unclipped": 1.3156224317848682, "vf_explained_var": 0.9481985494494438, "entropy": 0.1305837558582425, "mean_kl_loss": 0.0006110268259832963, "gradients_default_optimizer_global_norm": 0.23953465409576893, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0016801562500000002, "curr_kl_coeff": 3.7252903539730653e-10}}, "num_env_steps_sampled": 80896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80894, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.164, "episode_reward_min": 10.102, "episode_reward_mean": 10.734200000000001, "episode_len_mean": 37.84, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.610000000000001, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.838000000000001, 10.73, 10.921000000000001, 10.73, 10.729, 10.729, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 11.252, 10.73, 10.727000000000002, 10.838000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.713000000000001, 10.73, 10.73, 10.73, 10.628, 10.73, 10.628, 11.057, 10.63, 10.628, 10.73, 10.73, 10.73, 10.729, 10.73, 10.729, 10.409, 10.623000000000001, 10.73, 10.919, 10.628, 10.73, 10.63, 10.521, 10.817000000000002, 10.73, 10.73, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.514000000000001, 10.621, 10.921000000000001, 10.73, 10.737, 10.729, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.622, 10.732000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.393, 12.164, 10.73, 10.73, 10.920000000000002, 10.73, 10.628, 10.628, 10.73, 10.921000000000001, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.102, 10.73, 10.73, 10.73, 10.523000000000001, 10.73, 10.73], "episode_lengths": [36, 38, 38, 38, 38, 38, 38, 39, 38, 37, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 39, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 40, 38, 38, 38, 38, 38, 38, 38, 38, 36, 37, 38, 37, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 37, 38, 37, 37, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 34, 43, 38, 38, 37, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 36, 38, 38, 38, 37, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5388286423857309, "mean_inference_ms": 1.4040311681816235, "mean_action_processing_ms": 0.08092415585332159, "mean_env_wait_ms": 4.929964655407166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003409862518310547, "ViewRequirementAgentConnector_ms": 0.22948193550109863}}, "episode_reward_max": 12.164, "episode_reward_min": 10.102, "episode_reward_mean": 10.734200000000001, "episode_len_mean": 37.84, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.610000000000001, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.838000000000001, 10.73, 10.921000000000001, 10.73, 10.729, 10.729, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 11.252, 10.73, 10.727000000000002, 10.838000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.713000000000001, 10.73, 10.73, 10.73, 10.628, 10.73, 10.628, 11.057, 10.63, 10.628, 10.73, 10.73, 10.73, 10.729, 10.73, 10.729, 10.409, 10.623000000000001, 10.73, 10.919, 10.628, 10.73, 10.63, 10.521, 10.817000000000002, 10.73, 10.73, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.514000000000001, 10.621, 10.921000000000001, 10.73, 10.737, 10.729, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.622, 10.732000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.393, 12.164, 10.73, 10.73, 10.920000000000002, 10.73, 10.628, 10.628, 10.73, 10.921000000000001, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.102, 10.73, 10.73, 10.73, 10.523000000000001, 10.73, 10.73], "episode_lengths": [36, 38, 38, 38, 38, 38, 38, 39, 38, 37, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 39, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 40, 38, 38, 38, 38, 38, 38, 38, 38, 36, 37, 38, 37, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 37, 38, 37, 37, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 34, 43, 38, 38, 37, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 36, 38, 38, 38, 37, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5388286423857309, "mean_inference_ms": 1.4040311681816235, "mean_action_processing_ms": 0.08092415585332159, "mean_env_wait_ms": 4.929964655407166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003409862518310547, "ViewRequirementAgentConnector_ms": 0.22948193550109863}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80894, "num_agent_steps_trained": 0, "num_env_steps_sampled": 80896, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.463878618344438, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 80896, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 80894, "timers": {"training_iteration_time_ms": 50479.812, "sample_time_ms": 7259.961, "synch_weights_time_ms": 75.117}, "counters": {"num_env_steps_sampled": 80896, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80894, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1700, "training_iteration": 79, "trial_id": "default", "date": "2025-12-20_11-53-53", "timestamp": 1766202833, "time_this_iter_s": 50.04215741157532, "time_total_s": 3959.113970518112, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3959.113970518112, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 85.84647887323945, "ram_util_percent": 14.42112676056338}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1025.0, "total_loss": 0.0660803950414425}, "default_policy": {"total_loss": 0.0660803950414425, "policy_loss": -0.00019673243301307283, "vf_loss": 0.2658839236672332, "vf_loss_unclipped": 0.5910674006473727, "vf_explained_var": 0.976994861916798, "entropy": 0.115376835734379, "mean_kl_loss": 0.0002616244558697467, "gradients_default_optimizer_global_norm": 0.046650253963179705, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.001600078125, "curr_kl_coeff": 1.8626451769865326e-10}}, "num_env_steps_sampled": 81920, "num_env_steps_trained": 0, "num_agent_steps_sampled": 81919, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.164, "episode_reward_min": 10.102, "episode_reward_mean": 10.732560000000001, "episode_len_mean": 37.79, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.73, 10.628, 10.73, 10.628, 11.057, 10.63, 10.628, 10.73, 10.73, 10.73, 10.729, 10.73, 10.729, 10.409, 10.623000000000001, 10.73, 10.919, 10.628, 10.73, 10.63, 10.521, 10.817000000000002, 10.73, 10.73, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.514000000000001, 10.621, 10.921000000000001, 10.73, 10.737, 10.729, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.622, 10.732000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.393, 12.164, 10.73, 10.73, 10.920000000000002, 10.73, 10.628, 10.628, 10.73, 10.921000000000001, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.102, 10.73, 10.73, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.928, 10.73, 10.729, 10.73, 10.63, 10.628, 10.73, 10.919, 10.921000000000001, 10.73, 10.921000000000001, 10.73, 10.729, 10.623000000000001, 10.728, 10.73, 10.73, 10.917, 10.623000000000001, 10.73, 10.817000000000002, 10.73, 10.921000000000001, 10.73], "episode_lengths": [38, 38, 38, 38, 38, 38, 40, 38, 38, 38, 38, 38, 38, 38, 38, 36, 37, 38, 37, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 37, 38, 37, 37, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 34, 43, 38, 38, 37, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 36, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 37, 38, 37, 38, 38, 37, 38, 38, 38, 37, 37, 38, 37, 38, 37, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392231707157147, "mean_inference_ms": 1.4037883675635738, "mean_action_processing_ms": 0.08091257821006889, "mean_env_wait_ms": 4.929207702471578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003370523452758789, "ViewRequirementAgentConnector_ms": 0.22882294654846191}}, "episode_reward_max": 12.164, "episode_reward_min": 10.102, "episode_reward_mean": 10.732560000000001, "episode_len_mean": 37.79, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.73, 10.628, 10.73, 10.628, 11.057, 10.63, 10.628, 10.73, 10.73, 10.73, 10.729, 10.73, 10.729, 10.409, 10.623000000000001, 10.73, 10.919, 10.628, 10.73, 10.63, 10.521, 10.817000000000002, 10.73, 10.73, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.514000000000001, 10.621, 10.921000000000001, 10.73, 10.737, 10.729, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.622, 10.732000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.393, 12.164, 10.73, 10.73, 10.920000000000002, 10.73, 10.628, 10.628, 10.73, 10.921000000000001, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.102, 10.73, 10.73, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.928, 10.73, 10.729, 10.73, 10.63, 10.628, 10.73, 10.919, 10.921000000000001, 10.73, 10.921000000000001, 10.73, 10.729, 10.623000000000001, 10.728, 10.73, 10.73, 10.917, 10.623000000000001, 10.73, 10.817000000000002, 10.73, 10.921000000000001, 10.73], "episode_lengths": [38, 38, 38, 38, 38, 38, 40, 38, 38, 38, 38, 38, 38, 38, 38, 36, 37, 38, 37, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 37, 38, 37, 37, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 34, 43, 38, 38, 37, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 36, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 37, 38, 37, 38, 38, 37, 38, 38, 38, 37, 37, 38, 37, 38, 37, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5392231707157147, "mean_inference_ms": 1.4037883675635738, "mean_action_processing_ms": 0.08091257821006889, "mean_env_wait_ms": 4.929207702471578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003370523452758789, "ViewRequirementAgentConnector_ms": 0.22882294654846191}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81919, "num_agent_steps_trained": 0, "num_env_steps_sampled": 81920, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 19.814378759665715, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 81920, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 81919, "timers": {"training_iteration_time_ms": 50580.558, "sample_time_ms": 7257.374, "synch_weights_time_ms": 73.182}, "counters": {"num_env_steps_sampled": 81920, "num_env_steps_trained": 0, "num_agent_steps_sampled": 81919, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1728, "training_iteration": 80, "trial_id": "default", "date": "2025-12-20_11-54-44", "timestamp": 1766202884, "time_this_iter_s": 51.684565782547, "time_total_s": 4010.798536300659, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4010.798536300659, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 86.22054794520545, "ram_util_percent": 14.473972602739725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1023.0, "total_loss": 0.22117190174758433}, "default_policy": {"total_loss": 0.22117190174758433, "policy_loss": -0.0043770487769506875, "vf_loss": 0.9028700210154057, "vf_loss_unclipped": 3.023658898472786, "vf_explained_var": 0.8656642660498619, "entropy": 0.10533864293247461, "mean_kl_loss": 0.0005569967871247528, "gradients_default_optimizer_global_norm": 0.3723538566380739, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0015201562499999998, "curr_kl_coeff": 9.313225884932663e-11}}, "num_env_steps_sampled": 82944, "num_env_steps_trained": 0, "num_agent_steps_sampled": 82942, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.164, "episode_reward_min": 10.102, "episode_reward_mean": 10.748950000000002, "episode_len_mean": 37.81, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.514000000000001, 10.621, 10.921000000000001, 10.73, 10.737, 10.729, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.622, 10.732000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.393, 12.164, 10.73, 10.73, 10.920000000000002, 10.73, 10.628, 10.628, 10.73, 10.921000000000001, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.102, 10.73, 10.73, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.928, 10.73, 10.729, 10.73, 10.63, 10.628, 10.73, 10.919, 10.921000000000001, 10.73, 10.921000000000001, 10.73, 10.729, 10.623000000000001, 10.728, 10.73, 10.73, 10.917, 10.623000000000001, 10.73, 10.817000000000002, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 11.137, 10.928, 10.623000000000001, 10.832, 10.628, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.623000000000001, 11.859000000000002, 10.73, 10.53, 10.73, 10.73, 10.73, 10.523000000000001, 10.63, 10.73, 10.623000000000001, 10.628], "episode_lengths": [38, 38, 38, 37, 38, 37, 37, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 34, 43, 38, 38, 37, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 36, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 37, 38, 37, 38, 38, 37, 38, 38, 38, 37, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 37, 41, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5395686576191929, "mean_inference_ms": 1.4035993776137026, "mean_action_processing_ms": 0.08090280786442464, "mean_env_wait_ms": 4.928610483114859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035581588745117188, "ViewRequirementAgentConnector_ms": 0.2290208339691162}}, "episode_reward_max": 12.164, "episode_reward_min": 10.102, "episode_reward_mean": 10.748950000000002, "episode_len_mean": 37.81, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.514000000000001, 10.621, 10.921000000000001, 10.73, 10.737, 10.729, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.622, 10.732000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.393, 12.164, 10.73, 10.73, 10.920000000000002, 10.73, 10.628, 10.628, 10.73, 10.921000000000001, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.102, 10.73, 10.73, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.928, 10.73, 10.729, 10.73, 10.63, 10.628, 10.73, 10.919, 10.921000000000001, 10.73, 10.921000000000001, 10.73, 10.729, 10.623000000000001, 10.728, 10.73, 10.73, 10.917, 10.623000000000001, 10.73, 10.817000000000002, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 11.137, 10.928, 10.623000000000001, 10.832, 10.628, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.623000000000001, 11.859000000000002, 10.73, 10.53, 10.73, 10.73, 10.73, 10.523000000000001, 10.63, 10.73, 10.623000000000001, 10.628], "episode_lengths": [38, 38, 38, 37, 38, 37, 37, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 34, 43, 38, 38, 37, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 36, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 37, 38, 37, 38, 38, 37, 38, 38, 38, 37, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 37, 41, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5395686576191929, "mean_inference_ms": 1.4035993776137026, "mean_action_processing_ms": 0.08090280786442464, "mean_env_wait_ms": 4.928610483114859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035581588745117188, "ViewRequirementAgentConnector_ms": 0.2290208339691162}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82942, "num_agent_steps_trained": 0, "num_env_steps_sampled": 82944, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.346652735775148, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 82944, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 82942, "timers": {"training_iteration_time_ms": 50518.767, "sample_time_ms": 7202.332, "synch_weights_time_ms": 72.528}, "counters": {"num_env_steps_sampled": 82944, "num_env_steps_trained": 0, "num_agent_steps_sampled": 82942, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1754, "training_iteration": 81, "trial_id": "default", "date": "2025-12-20_11-55-35", "timestamp": 1766202935, "time_this_iter_s": 50.33218193054199, "time_total_s": 4061.130718231201, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4061.130718231201, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 85.93333333333334, "ram_util_percent": 14.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.06656253705732525}, "default_policy": {"total_loss": 0.06656253705732525, "policy_loss": -0.0010074200108647346, "vf_loss": 0.2708624344319105, "vf_loss_unclipped": 0.6489332094788551, "vf_explained_var": 0.9744742065668106, "entropy": 0.09581232257187366, "mean_kl_loss": 0.00060442841057049, "gradients_default_optimizer_global_norm": 0.10576860886067152, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00144015625, "curr_kl_coeff": 4.6566129424663316e-11}}, "num_env_steps_sampled": 83968, "num_env_steps_trained": 0, "num_agent_steps_sampled": 83966, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.859000000000002, "episode_reward_min": 10.102, "episode_reward_mean": 10.728760000000005, "episode_len_mean": 37.78, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.920000000000002, 10.73, 10.628, 10.628, 10.73, 10.921000000000001, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.102, 10.73, 10.73, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.928, 10.73, 10.729, 10.73, 10.63, 10.628, 10.73, 10.919, 10.921000000000001, 10.73, 10.921000000000001, 10.73, 10.729, 10.623000000000001, 10.728, 10.73, 10.73, 10.917, 10.623000000000001, 10.73, 10.817000000000002, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 11.137, 10.928, 10.623000000000001, 10.832, 10.628, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.623000000000001, 11.859000000000002, 10.73, 10.53, 10.73, 10.73, 10.73, 10.523000000000001, 10.63, 10.73, 10.623000000000001, 10.628, 10.833, 10.729, 10.623000000000001, 10.73, 10.523000000000001, 10.73, 10.73, 10.628, 10.628, 10.73, 10.73, 10.526000000000002, 10.628, 10.309000000000001, 10.73, 10.729000000000001, 10.622, 10.628, 10.73, 10.73, 10.729, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.919], "episode_lengths": [37, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 36, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 37, 38, 37, 38, 38, 37, 38, 38, 38, 37, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 37, 41, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 36, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5399614370929815, "mean_inference_ms": 1.4033842422649496, "mean_action_processing_ms": 0.08089210638917671, "mean_env_wait_ms": 4.928031764681315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0037665367126464844, "ViewRequirementAgentConnector_ms": 0.22965717315673828}}, "episode_reward_max": 11.859000000000002, "episode_reward_min": 10.102, "episode_reward_mean": 10.728760000000005, "episode_len_mean": 37.78, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.920000000000002, 10.73, 10.628, 10.628, 10.73, 10.921000000000001, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.102, 10.73, 10.73, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.928, 10.73, 10.729, 10.73, 10.63, 10.628, 10.73, 10.919, 10.921000000000001, 10.73, 10.921000000000001, 10.73, 10.729, 10.623000000000001, 10.728, 10.73, 10.73, 10.917, 10.623000000000001, 10.73, 10.817000000000002, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 11.137, 10.928, 10.623000000000001, 10.832, 10.628, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.623000000000001, 11.859000000000002, 10.73, 10.53, 10.73, 10.73, 10.73, 10.523000000000001, 10.63, 10.73, 10.623000000000001, 10.628, 10.833, 10.729, 10.623000000000001, 10.73, 10.523000000000001, 10.73, 10.73, 10.628, 10.628, 10.73, 10.73, 10.526000000000002, 10.628, 10.309000000000001, 10.73, 10.729000000000001, 10.622, 10.628, 10.73, 10.73, 10.729, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.919], "episode_lengths": [37, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 36, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 37, 38, 37, 38, 38, 37, 38, 38, 38, 37, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 37, 41, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 36, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5399614370929815, "mean_inference_ms": 1.4033842422649496, "mean_action_processing_ms": 0.08089210638917671, "mean_env_wait_ms": 4.928031764681315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0037665367126464844, "ViewRequirementAgentConnector_ms": 0.22965717315673828}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83966, "num_agent_steps_trained": 0, "num_env_steps_sampled": 83968, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.1347473306009, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 83968, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 83966, "timers": {"training_iteration_time_ms": 50540.12, "sample_time_ms": 7199.553, "synch_weights_time_ms": 73.49}, "counters": {"num_env_steps_sampled": 83968, "num_env_steps_trained": 0, "num_agent_steps_sampled": 83966, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1782, "training_iteration": 82, "trial_id": "default", "date": "2025-12-20_11-56-33", "timestamp": 1766202993, "time_this_iter_s": 50.86340379714966, "time_total_s": 4111.994122028351, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4111.994122028351, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 75.60722891566266, "ram_util_percent": 14.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.08398084696382284}, "default_policy": {"total_loss": 0.08398084696382284, "policy_loss": -0.0038507952820509674, "vf_loss": 0.35190220847725867, "vf_loss_unclipped": 1.3711676962673665, "vf_explained_var": 0.9464828357100487, "entropy": 0.09992966670542955, "mean_kl_loss": 0.0005618630587576945, "gradients_default_optimizer_global_norm": 0.10863701878115535, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0013601562500000003, "curr_kl_coeff": 2.3283064712331658e-11}}, "num_env_steps_sampled": 84992, "num_env_steps_trained": 0, "num_agent_steps_sampled": 84990, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.859000000000002, "episode_reward_min": 10.306000000000001, "episode_reward_mean": 10.730060000000002, "episode_len_mean": 37.82, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.63, 10.628, 10.73, 10.919, 10.921000000000001, 10.73, 10.921000000000001, 10.73, 10.729, 10.623000000000001, 10.728, 10.73, 10.73, 10.917, 10.623000000000001, 10.73, 10.817000000000002, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 11.137, 10.928, 10.623000000000001, 10.832, 10.628, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.623000000000001, 11.859000000000002, 10.73, 10.53, 10.73, 10.73, 10.73, 10.523000000000001, 10.63, 10.73, 10.623000000000001, 10.628, 10.833, 10.729, 10.623000000000001, 10.73, 10.523000000000001, 10.73, 10.73, 10.628, 10.628, 10.73, 10.73, 10.526000000000002, 10.628, 10.309000000000001, 10.73, 10.729000000000001, 10.622, 10.628, 10.73, 10.73, 10.729, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.919, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.73, 10.73, 10.306000000000001, 10.729, 10.73, 10.838000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.917, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73], "episode_lengths": [38, 38, 38, 37, 37, 38, 37, 38, 38, 37, 38, 38, 38, 37, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 37, 41, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 36, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 39, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5403483150024992, "mean_inference_ms": 1.4033395137718199, "mean_action_processing_ms": 0.0808915556679688, "mean_env_wait_ms": 4.927709593650015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003844738006591797, "ViewRequirementAgentConnector_ms": 0.23095273971557617}}, "episode_reward_max": 11.859000000000002, "episode_reward_min": 10.306000000000001, "episode_reward_mean": 10.730060000000002, "episode_len_mean": 37.82, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.63, 10.628, 10.73, 10.919, 10.921000000000001, 10.73, 10.921000000000001, 10.73, 10.729, 10.623000000000001, 10.728, 10.73, 10.73, 10.917, 10.623000000000001, 10.73, 10.817000000000002, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 11.137, 10.928, 10.623000000000001, 10.832, 10.628, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.623000000000001, 11.859000000000002, 10.73, 10.53, 10.73, 10.73, 10.73, 10.523000000000001, 10.63, 10.73, 10.623000000000001, 10.628, 10.833, 10.729, 10.623000000000001, 10.73, 10.523000000000001, 10.73, 10.73, 10.628, 10.628, 10.73, 10.73, 10.526000000000002, 10.628, 10.309000000000001, 10.73, 10.729000000000001, 10.622, 10.628, 10.73, 10.73, 10.729, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.919, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.73, 10.73, 10.306000000000001, 10.729, 10.73, 10.838000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.917, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73], "episode_lengths": [38, 38, 38, 37, 37, 38, 37, 38, 38, 37, 38, 38, 38, 37, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 37, 41, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 36, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 39, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5403483150024992, "mean_inference_ms": 1.4033395137718199, "mean_action_processing_ms": 0.0808915556679688, "mean_env_wait_ms": 4.927709593650015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003844738006591797, "ViewRequirementAgentConnector_ms": 0.23095273971557617}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84990, "num_agent_steps_trained": 0, "num_env_steps_sampled": 84992, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.100141003445803, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 84992, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 84990, "timers": {"training_iteration_time_ms": 50638.425, "sample_time_ms": 7213.013, "synch_weights_time_ms": 74.783}, "counters": {"num_env_steps_sampled": 84992, "num_env_steps_trained": 0, "num_agent_steps_sampled": 84990, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1808, "training_iteration": 83, "trial_id": "default", "date": "2025-12-20_11-57-24", "timestamp": 1766203044, "time_this_iter_s": 50.947842836380005, "time_total_s": 4162.941964864731, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4162.941964864731, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 85.80416666666666, "ram_util_percent": 14.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.06359120369888842}, "default_policy": {"total_loss": 0.06359120369888842, "policy_loss": -0.0006114694057032466, "vf_loss": 0.2573954712599516, "vf_loss_unclipped": 0.9603093415498734, "vf_explained_var": 0.962260314822197, "entropy": 0.10748324822634459, "mean_kl_loss": 0.0002685464821347239, "gradients_default_optimizer_global_norm": 0.09668923416174949, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00128015625, "curr_kl_coeff": 1.1641532356165829e-11}}, "num_env_steps_sampled": 86016, "num_env_steps_trained": 0, "num_agent_steps_sampled": 86014, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.859000000000002, "episode_reward_min": 10.306000000000001, "episode_reward_mean": 10.735710000000005, "episode_len_mean": 37.89, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.628, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.623000000000001, 11.859000000000002, 10.73, 10.53, 10.73, 10.73, 10.73, 10.523000000000001, 10.63, 10.73, 10.623000000000001, 10.628, 10.833, 10.729, 10.623000000000001, 10.73, 10.523000000000001, 10.73, 10.73, 10.628, 10.628, 10.73, 10.73, 10.526000000000002, 10.628, 10.309000000000001, 10.73, 10.729000000000001, 10.622, 10.628, 10.73, 10.73, 10.729, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.919, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.73, 10.73, 10.306000000000001, 10.729, 10.73, 10.838000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.917, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 11.137, 10.73, 10.73, 11.759000000000002, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.920000000000002, 10.73, 10.919, 10.814], "episode_lengths": [38, 38, 38, 38, 37, 38, 37, 41, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 36, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 39, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 38, 41, 38, 38, 38, 38, 38, 38, 37, 38, 37, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5407734682587191, "mean_inference_ms": 1.403320149784992, "mean_action_processing_ms": 0.08089493111906718, "mean_env_wait_ms": 4.927462427996104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0038530826568603516, "ViewRequirementAgentConnector_ms": 0.2321789264678955}}, "episode_reward_max": 11.859000000000002, "episode_reward_min": 10.306000000000001, "episode_reward_mean": 10.735710000000005, "episode_len_mean": 37.89, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.628, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.623000000000001, 11.859000000000002, 10.73, 10.53, 10.73, 10.73, 10.73, 10.523000000000001, 10.63, 10.73, 10.623000000000001, 10.628, 10.833, 10.729, 10.623000000000001, 10.73, 10.523000000000001, 10.73, 10.73, 10.628, 10.628, 10.73, 10.73, 10.526000000000002, 10.628, 10.309000000000001, 10.73, 10.729000000000001, 10.622, 10.628, 10.73, 10.73, 10.729, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.919, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.73, 10.73, 10.306000000000001, 10.729, 10.73, 10.838000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.917, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 11.137, 10.73, 10.73, 11.759000000000002, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.920000000000002, 10.73, 10.919, 10.814], "episode_lengths": [38, 38, 38, 38, 37, 38, 37, 41, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 36, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 39, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 38, 41, 38, 38, 38, 38, 38, 38, 37, 38, 37, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5407734682587191, "mean_inference_ms": 1.403320149784992, "mean_action_processing_ms": 0.08089493111906718, "mean_env_wait_ms": 4.927462427996104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0038530826568603516, "ViewRequirementAgentConnector_ms": 0.2321789264678955}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86014, "num_agent_steps_trained": 0, "num_env_steps_sampled": 86016, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 20.235203814435163, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 86016, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 86014, "timers": {"training_iteration_time_ms": 50621.441, "sample_time_ms": 7135.068, "synch_weights_time_ms": 74.815}, "counters": {"num_env_steps_sampled": 86016, "num_env_steps_trained": 0, "num_agent_steps_sampled": 86014, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1836, "training_iteration": 84, "trial_id": "default", "date": "2025-12-20_11-58-15", "timestamp": 1766203095, "time_this_iter_s": 50.611130475997925, "time_total_s": 4213.553095340729, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4213.553095340729, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 85.99027777777776, "ram_util_percent": 14.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1025.0, "total_loss": 0.1545218212030283}, "default_policy": {"total_loss": 0.1545218212030283, "policy_loss": -0.0044944781764614875, "vf_loss": 0.6365372909278404, "vf_loss_unclipped": 2.3230154034568042, "vf_explained_var": 0.8997244660447283, "entropy": 0.09219430623258032, "mean_kl_loss": 0.0010756234909652493, "gradients_default_optimizer_global_norm": 0.28691378090439773, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0012000781250000002, "curr_kl_coeff": 5.8207661780829145e-12}}, "num_env_steps_sampled": 87040, "num_env_steps_trained": 0, "num_agent_steps_sampled": 87039, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.759000000000002, "episode_reward_min": 10.306000000000001, "episode_reward_mean": 10.734280000000002, "episode_len_mean": 37.86, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.526000000000002, 10.628, 10.309000000000001, 10.73, 10.729000000000001, 10.622, 10.628, 10.73, 10.73, 10.729, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.919, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.73, 10.73, 10.306000000000001, 10.729, 10.73, 10.838000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.917, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 11.137, 10.73, 10.73, 11.759000000000002, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.920000000000002, 10.73, 10.919, 10.814, 10.73, 10.63, 10.844000000000001, 10.73, 10.73, 10.73, 10.63, 10.940999999999999, 10.921000000000001, 10.521, 10.919, 10.729, 10.63, 10.73, 10.73, 10.73, 10.628, 10.73, 10.386000000000001, 10.73, 10.73, 10.73, 10.628, 10.73, 10.73, 10.73, 10.919], "episode_lengths": [38, 38, 38, 38, 36, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 39, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 38, 41, 38, 38, 38, 38, 38, 38, 37, 38, 37, 36, 38, 38, 39, 38, 38, 38, 38, 39, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 34, 38, 38, 38, 38, 38, 38, 38, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5411320557668811, "mean_inference_ms": 1.4031563213252727, "mean_action_processing_ms": 0.08088831191305733, "mean_env_wait_ms": 4.9269918650035605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003507852554321289, "ViewRequirementAgentConnector_ms": 0.23268556594848633}}, "episode_reward_max": 11.759000000000002, "episode_reward_min": 10.306000000000001, "episode_reward_mean": 10.734280000000002, "episode_len_mean": 37.86, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.526000000000002, 10.628, 10.309000000000001, 10.73, 10.729000000000001, 10.622, 10.628, 10.73, 10.73, 10.729, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.919, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.73, 10.73, 10.306000000000001, 10.729, 10.73, 10.838000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.917, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 11.137, 10.73, 10.73, 11.759000000000002, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.920000000000002, 10.73, 10.919, 10.814, 10.73, 10.63, 10.844000000000001, 10.73, 10.73, 10.73, 10.63, 10.940999999999999, 10.921000000000001, 10.521, 10.919, 10.729, 10.63, 10.73, 10.73, 10.73, 10.628, 10.73, 10.386000000000001, 10.73, 10.73, 10.73, 10.628, 10.73, 10.73, 10.73, 10.919], "episode_lengths": [38, 38, 38, 38, 36, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 39, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 38, 41, 38, 38, 38, 38, 38, 38, 37, 38, 37, 36, 38, 38, 39, 38, 38, 38, 38, 39, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 34, 38, 38, 38, 38, 38, 38, 38, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5411320557668811, "mean_inference_ms": 1.4031563213252727, "mean_action_processing_ms": 0.08088831191305733, "mean_env_wait_ms": 4.9269918650035605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003507852554321289, "ViewRequirementAgentConnector_ms": 0.23268556594848633}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87039, "num_agent_steps_trained": 0, "num_env_steps_sampled": 87040, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 19.326016341339916, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 87040, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 87039, "timers": {"training_iteration_time_ms": 50857.793, "sample_time_ms": 7131.011, "synch_weights_time_ms": 76.392}, "counters": {"num_env_steps_sampled": 87040, "num_env_steps_trained": 0, "num_agent_steps_sampled": 87039, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1863, "training_iteration": 85, "trial_id": "default", "date": "2025-12-20_11-59-08", "timestamp": 1766203148, "time_this_iter_s": 52.99627137184143, "time_total_s": 4266.54936671257, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4266.54936671257, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 86.63684210526317, "ram_util_percent": 14.611842105263161}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1023.0, "total_loss": 0.12606994863599538}, "default_policy": {"total_loss": 0.12606994863599538, "policy_loss": -0.0030600097961723804, "vf_loss": 0.5170395594090224, "vf_loss_unclipped": 1.5602125890552998, "vf_explained_var": 0.9344871342182159, "entropy": 0.10826776139438152, "mean_kl_loss": 0.00023618620842214, "gradients_default_optimizer_global_norm": 0.15238393377512693, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00112015625, "curr_kl_coeff": 2.9103830890414573e-12}}, "num_env_steps_sampled": 88064, "num_env_steps_trained": 0, "num_agent_steps_sampled": 88062, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.759000000000002, "episode_reward_min": 10.306000000000001, "episode_reward_mean": 10.75109, "episode_len_mean": 37.81, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.306000000000001, 10.729, 10.73, 10.838000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.917, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 11.137, 10.73, 10.73, 11.759000000000002, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.920000000000002, 10.73, 10.919, 10.814, 10.73, 10.63, 10.844000000000001, 10.73, 10.73, 10.73, 10.63, 10.940999999999999, 10.921000000000001, 10.521, 10.919, 10.729, 10.63, 10.73, 10.73, 10.73, 10.628, 10.73, 10.386000000000001, 10.73, 10.73, 10.73, 10.628, 10.73, 10.73, 10.73, 10.919, 10.73, 10.728000000000002, 10.73, 10.73, 10.73, 10.919, 10.928, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.320000000000002, 10.73, 11.734000000000002, 10.73, 10.73, 10.814, 10.73, 10.522000000000002, 10.73, 10.623000000000001, 10.812000000000001, 10.73], "episode_lengths": [37, 38, 38, 39, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 38, 41, 38, 38, 38, 38, 38, 38, 37, 38, 37, 36, 38, 38, 39, 38, 38, 38, 38, 39, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 34, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 36, 38, 38, 38, 38, 36, 38, 37, 38, 37, 36, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5415460991298575, "mean_inference_ms": 1.4033246678000018, "mean_action_processing_ms": 0.08090271790030461, "mean_env_wait_ms": 4.927097928028978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035278797149658203, "ViewRequirementAgentConnector_ms": 0.2329096794128418}}, "episode_reward_max": 11.759000000000002, "episode_reward_min": 10.306000000000001, "episode_reward_mean": 10.75109, "episode_len_mean": 37.81, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.306000000000001, 10.729, 10.73, 10.838000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.917, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.523000000000001, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 11.137, 10.73, 10.73, 11.759000000000002, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.920000000000002, 10.73, 10.919, 10.814, 10.73, 10.63, 10.844000000000001, 10.73, 10.73, 10.73, 10.63, 10.940999999999999, 10.921000000000001, 10.521, 10.919, 10.729, 10.63, 10.73, 10.73, 10.73, 10.628, 10.73, 10.386000000000001, 10.73, 10.73, 10.73, 10.628, 10.73, 10.73, 10.73, 10.919, 10.73, 10.728000000000002, 10.73, 10.73, 10.73, 10.919, 10.928, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.320000000000002, 10.73, 11.734000000000002, 10.73, 10.73, 10.814, 10.73, 10.522000000000002, 10.73, 10.623000000000001, 10.812000000000001, 10.73], "episode_lengths": [37, 38, 38, 39, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 38, 41, 38, 38, 38, 38, 38, 38, 37, 38, 37, 36, 38, 38, 39, 38, 38, 38, 38, 39, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 34, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 36, 38, 38, 38, 38, 36, 38, 37, 38, 37, 36, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5415460991298575, "mean_inference_ms": 1.4033246678000018, "mean_action_processing_ms": 0.08090271790030461, "mean_env_wait_ms": 4.927097928028978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035278797149658203, "ViewRequirementAgentConnector_ms": 0.2329096794128418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88062, "num_agent_steps_trained": 0, "num_env_steps_sampled": 88064, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 18.755309969992584, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 88064, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 88062, "timers": {"training_iteration_time_ms": 51304.61, "sample_time_ms": 7133.448, "synch_weights_time_ms": 76.706}, "counters": {"num_env_steps_sampled": 88064, "num_env_steps_trained": 0, "num_agent_steps_sampled": 88062, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1890, "training_iteration": 86, "trial_id": "default", "date": "2025-12-20_12-00-03", "timestamp": 1766203203, "time_this_iter_s": 54.60152244567871, "time_total_s": 4321.150889158249, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4321.150889158249, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 86.70000000000002, "ram_util_percent": 15.76883116883117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.07657317612320184}, "default_policy": {"total_loss": 0.07657317612320184, "policy_loss": -0.002321701543405652, "vf_loss": 0.3159816265106201, "vf_loss_unclipped": 1.0043702132999897, "vf_explained_var": 0.9601131498813629, "entropy": 0.08974734637886286, "mean_kl_loss": 0.0005707283687556242, "gradients_default_optimizer_global_norm": 0.18516921261325478, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0010401562499999998, "curr_kl_coeff": 1.4551915445207286e-12}}, "num_env_steps_sampled": 89088, "num_env_steps_trained": 0, "num_agent_steps_sampled": 89086, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.759000000000002, "episode_reward_min": 10.204, "episode_reward_mean": 10.74998, "episode_len_mean": 37.78, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.63, 10.73, 10.73, 10.73, 11.137, 10.73, 10.73, 11.759000000000002, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.920000000000002, 10.73, 10.919, 10.814, 10.73, 10.63, 10.844000000000001, 10.73, 10.73, 10.73, 10.63, 10.940999999999999, 10.921000000000001, 10.521, 10.919, 10.729, 10.63, 10.73, 10.73, 10.73, 10.628, 10.73, 10.386000000000001, 10.73, 10.73, 10.73, 10.628, 10.73, 10.73, 10.73, 10.919, 10.73, 10.728000000000002, 10.73, 10.73, 10.73, 10.919, 10.928, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.320000000000002, 10.73, 11.734000000000002, 10.73, 10.73, 10.814, 10.73, 10.522000000000002, 10.73, 10.623000000000001, 10.812000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 11.137, 10.73, 10.921000000000001, 10.729, 10.61, 10.73, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.729, 10.204, 10.521, 10.73, 10.73], "episode_lengths": [38, 38, 38, 38, 38, 39, 38, 38, 41, 38, 38, 38, 38, 38, 38, 37, 38, 37, 36, 38, 38, 39, 38, 38, 38, 38, 39, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 34, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 36, 38, 38, 38, 38, 36, 38, 37, 38, 37, 36, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 36, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 36, 37, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5418716126723532, "mean_inference_ms": 1.4030591584537542, "mean_action_processing_ms": 0.08088971506977106, "mean_env_wait_ms": 4.926474215174053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003662109375, "ViewRequirementAgentConnector_ms": 0.23204731941223145}}, "episode_reward_max": 11.759000000000002, "episode_reward_min": 10.204, "episode_reward_mean": 10.74998, "episode_len_mean": 37.78, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.63, 10.73, 10.73, 10.73, 11.137, 10.73, 10.73, 11.759000000000002, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.920000000000002, 10.73, 10.919, 10.814, 10.73, 10.63, 10.844000000000001, 10.73, 10.73, 10.73, 10.63, 10.940999999999999, 10.921000000000001, 10.521, 10.919, 10.729, 10.63, 10.73, 10.73, 10.73, 10.628, 10.73, 10.386000000000001, 10.73, 10.73, 10.73, 10.628, 10.73, 10.73, 10.73, 10.919, 10.73, 10.728000000000002, 10.73, 10.73, 10.73, 10.919, 10.928, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.320000000000002, 10.73, 11.734000000000002, 10.73, 10.73, 10.814, 10.73, 10.522000000000002, 10.73, 10.623000000000001, 10.812000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 11.137, 10.73, 10.921000000000001, 10.729, 10.61, 10.73, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.729, 10.204, 10.521, 10.73, 10.73], "episode_lengths": [38, 38, 38, 38, 38, 39, 38, 38, 41, 38, 38, 38, 38, 38, 38, 37, 38, 37, 36, 38, 38, 39, 38, 38, 38, 38, 39, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 34, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 36, 38, 38, 38, 38, 36, 38, 37, 38, 37, 36, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 36, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 36, 37, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5418716126723532, "mean_inference_ms": 1.4030591584537542, "mean_action_processing_ms": 0.08088971506977106, "mean_env_wait_ms": 4.926474215174053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003662109375, "ViewRequirementAgentConnector_ms": 0.23204731941223145}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89086, "num_agent_steps_trained": 0, "num_env_steps_sampled": 89088, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 19.390626112599257, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 89088, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 89086, "timers": {"training_iteration_time_ms": 51598.152, "sample_time_ms": 7136.613, "synch_weights_time_ms": 77.738}, "counters": {"num_env_steps_sampled": 89088, "num_env_steps_trained": 0, "num_agent_steps_sampled": 89086, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1917, "training_iteration": 87, "trial_id": "default", "date": "2025-12-20_12-01-03", "timestamp": 1766203263, "time_this_iter_s": 52.81247854232788, "time_total_s": 4373.963367700577, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4373.963367700577, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 76.63139534883722, "ram_util_percent": 15.790697674418608}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.06296457573771477}, "default_policy": {"total_loss": 0.06296457573771477, "policy_loss": -0.0017068279208615421, "vf_loss": 0.259097845479846, "vf_loss_unclipped": 0.6617599658668041, "vf_explained_var": 0.9742971196770668, "entropy": 0.09907553847879172, "mean_kl_loss": 0.0005199144790193344, "gradients_default_optimizer_global_norm": 0.06060128281824291, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0009601562499999996, "curr_kl_coeff": 7.275957722603643e-13}}, "num_env_steps_sampled": 90112, "num_env_steps_trained": 0, "num_agent_steps_sampled": 90110, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.734000000000002, "episode_reward_min": 10.014, "episode_reward_mean": 10.726070000000002, "episode_len_mean": 37.7, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.921000000000001, 10.521, 10.919, 10.729, 10.63, 10.73, 10.73, 10.73, 10.628, 10.73, 10.386000000000001, 10.73, 10.73, 10.73, 10.628, 10.73, 10.73, 10.73, 10.919, 10.73, 10.728000000000002, 10.73, 10.73, 10.73, 10.919, 10.928, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.320000000000002, 10.73, 11.734000000000002, 10.73, 10.73, 10.814, 10.73, 10.522000000000002, 10.73, 10.623000000000001, 10.812000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 11.137, 10.73, 10.921000000000001, 10.729, 10.61, 10.73, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.729, 10.204, 10.521, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.014, 10.73, 10.814, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.628, 10.73, 10.73, 10.623000000000001, 10.73, 10.729, 10.729, 10.73, 10.729, 10.729, 10.73, 10.729, 10.73, 10.73, 10.917], "episode_lengths": [37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 34, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 36, 38, 38, 38, 38, 36, 38, 37, 38, 37, 36, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 36, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 36, 37, 38, 38, 38, 38, 38, 38, 37, 38, 36, 38, 38, 38, 38, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5422840268742439, "mean_inference_ms": 1.4031133244268466, "mean_action_processing_ms": 0.08090284610810392, "mean_env_wait_ms": 4.926429126566745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036683082580566406, "ViewRequirementAgentConnector_ms": 0.23206710815429688}}, "episode_reward_max": 11.734000000000002, "episode_reward_min": 10.014, "episode_reward_mean": 10.726070000000002, "episode_len_mean": 37.7, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.921000000000001, 10.521, 10.919, 10.729, 10.63, 10.73, 10.73, 10.73, 10.628, 10.73, 10.386000000000001, 10.73, 10.73, 10.73, 10.628, 10.73, 10.73, 10.73, 10.919, 10.73, 10.728000000000002, 10.73, 10.73, 10.73, 10.919, 10.928, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.320000000000002, 10.73, 11.734000000000002, 10.73, 10.73, 10.814, 10.73, 10.522000000000002, 10.73, 10.623000000000001, 10.812000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 11.137, 10.73, 10.921000000000001, 10.729, 10.61, 10.73, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.729, 10.204, 10.521, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.014, 10.73, 10.814, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.628, 10.73, 10.73, 10.623000000000001, 10.73, 10.729, 10.729, 10.73, 10.729, 10.729, 10.73, 10.729, 10.73, 10.73, 10.917], "episode_lengths": [37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 34, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 36, 38, 38, 38, 38, 36, 38, 37, 38, 37, 36, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 36, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 36, 37, 38, 38, 38, 38, 38, 38, 37, 38, 36, 38, 38, 38, 38, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5422840268742439, "mean_inference_ms": 1.4031133244268466, "mean_action_processing_ms": 0.08090284610810392, "mean_env_wait_ms": 4.926429126566745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036683082580566406, "ViewRequirementAgentConnector_ms": 0.23206710815429688}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90110, "num_agent_steps_trained": 0, "num_env_steps_sampled": 90112, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 19.37811739546915, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 90112, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 90110, "timers": {"training_iteration_time_ms": 51768.895, "sample_time_ms": 7138.067, "synch_weights_time_ms": 80.243}, "counters": {"num_env_steps_sampled": 90112, "num_env_steps_trained": 0, "num_agent_steps_sampled": 90110, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1944, "training_iteration": 88, "trial_id": "default", "date": "2025-12-20_12-01-56", "timestamp": 1766203316, "time_this_iter_s": 52.8460853099823, "time_total_s": 4426.809453010559, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4426.809453010559, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 86.43333333333334, "ram_util_percent": 16.028000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.07493154145777225}, "default_policy": {"total_loss": 0.07493154145777225, "policy_loss": -0.003740213462151587, "vf_loss": 0.3150542415678501, "vf_loss_unclipped": 1.3157250866293908, "vf_explained_var": 0.9477206110954285, "entropy": 0.0956203730776906, "mean_kl_loss": 0.001150281767937944, "gradients_default_optimizer_global_norm": 0.08318488798104226, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0008801562500000003, "curr_kl_coeff": 3.6379788613018216e-13}}, "num_env_steps_sampled": 91136, "num_env_steps_trained": 0, "num_agent_steps_sampled": 91134, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.734000000000002, "episode_reward_min": 10.014, "episode_reward_mean": 10.733179999999999, "episode_len_mean": 37.71, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.320000000000002, 10.73, 11.734000000000002, 10.73, 10.73, 10.814, 10.73, 10.522000000000002, 10.73, 10.623000000000001, 10.812000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 11.137, 10.73, 10.921000000000001, 10.729, 10.61, 10.73, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.729, 10.204, 10.521, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.014, 10.73, 10.814, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.628, 10.73, 10.73, 10.623000000000001, 10.73, 10.729, 10.729, 10.73, 10.729, 10.729, 10.73, 10.729, 10.73, 10.73, 10.917, 10.73, 10.73, 10.729, 10.921000000000001, 10.526000000000002, 10.917, 10.73, 10.919, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.831, 10.73, 10.919, 10.73, 10.73, 10.73, 10.73, 10.526000000000002, 10.73, 10.623000000000001, 10.73, 10.917, 10.729000000000001, 10.921000000000001], "episode_lengths": [38, 38, 38, 38, 38, 38, 38, 36, 38, 38, 38, 38, 36, 38, 37, 38, 37, 36, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 36, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 36, 37, 38, 38, 38, 38, 38, 38, 37, 38, 36, 38, 38, 38, 38, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5426302667387805, "mean_inference_ms": 1.4030307065296557, "mean_action_processing_ms": 0.08090513445061685, "mean_env_wait_ms": 4.92606257630989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036559104919433594, "ViewRequirementAgentConnector_ms": 0.23172497749328613}}, "episode_reward_max": 11.734000000000002, "episode_reward_min": 10.014, "episode_reward_mean": 10.733179999999999, "episode_len_mean": 37.71, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.320000000000002, 10.73, 11.734000000000002, 10.73, 10.73, 10.814, 10.73, 10.522000000000002, 10.73, 10.623000000000001, 10.812000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 11.137, 10.73, 10.921000000000001, 10.729, 10.61, 10.73, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.729, 10.204, 10.521, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.014, 10.73, 10.814, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.628, 10.73, 10.73, 10.623000000000001, 10.73, 10.729, 10.729, 10.73, 10.729, 10.729, 10.73, 10.729, 10.73, 10.73, 10.917, 10.73, 10.73, 10.729, 10.921000000000001, 10.526000000000002, 10.917, 10.73, 10.919, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.831, 10.73, 10.919, 10.73, 10.73, 10.73, 10.73, 10.526000000000002, 10.73, 10.623000000000001, 10.73, 10.917, 10.729000000000001, 10.921000000000001], "episode_lengths": [38, 38, 38, 38, 38, 38, 38, 36, 38, 38, 38, 38, 36, 38, 37, 38, 37, 36, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 36, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 36, 37, 38, 38, 38, 38, 38, 38, 37, 38, 36, 38, 38, 38, 38, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5426302667387805, "mean_inference_ms": 1.4030307065296557, "mean_action_processing_ms": 0.08090513445061685, "mean_env_wait_ms": 4.92606257630989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036559104919433594, "ViewRequirementAgentConnector_ms": 0.23172497749328613}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91134, "num_agent_steps_trained": 0, "num_env_steps_sampled": 91136, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 19.48586830516044, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 91136, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 91134, "timers": {"training_iteration_time_ms": 52020.047, "sample_time_ms": 7143.85, "synch_weights_time_ms": 79.394}, "counters": {"num_env_steps_sampled": 91136, "num_env_steps_trained": 0, "num_agent_steps_sampled": 91134, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1971, "training_iteration": 89, "trial_id": "default", "date": "2025-12-20_12-02-49", "timestamp": 1766203369, "time_this_iter_s": 52.55369544029236, "time_total_s": 4479.363148450851, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4479.363148450851, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 86.42000000000002, "ram_util_percent": 16.290666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.07924225209280848}, "default_policy": {"total_loss": 0.07924225209280848, "policy_loss": -0.0018004754208959639, "vf_loss": 0.3244749754667282, "vf_loss_unclipped": 1.2759876489639281, "vf_explained_var": 0.9497247546911239, "entropy": 0.08636789079755544, "mean_kl_loss": 0.00028180848998644593, "gradients_default_optimizer_global_norm": 0.0593783073592931, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0008001562500000001, "curr_kl_coeff": 1.8189894306509108e-13}}, "num_env_steps_sampled": 92160, "num_env_steps_trained": 0, "num_agent_steps_sampled": 92158, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 10.921000000000001, "episode_reward_min": 10.014, "episode_reward_mean": 10.724110000000001, "episode_len_mean": 37.75, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.921000000000001, 10.729, 10.61, 10.73, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.729, 10.204, 10.521, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.014, 10.73, 10.814, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.628, 10.73, 10.73, 10.623000000000001, 10.73, 10.729, 10.729, 10.73, 10.729, 10.729, 10.73, 10.729, 10.73, 10.73, 10.917, 10.73, 10.73, 10.729, 10.921000000000001, 10.526000000000002, 10.917, 10.73, 10.919, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.831, 10.73, 10.919, 10.73, 10.73, 10.73, 10.73, 10.526000000000002, 10.73, 10.623000000000001, 10.73, 10.917, 10.729000000000001, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.716000000000001, 10.628, 10.628, 10.809999999999999, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.532000000000002, 10.921000000000001, 10.628, 10.628, 10.73, 10.838000000000001, 10.917000000000002], "episode_lengths": [38, 37, 38, 36, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 36, 37, 38, 38, 38, 38, 38, 38, 37, 38, 36, 38, 38, 38, 38, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 39, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5429854039927295, "mean_inference_ms": 1.4030157937262888, "mean_action_processing_ms": 0.08090821283695247, "mean_env_wait_ms": 4.925740569780325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036745071411132812, "ViewRequirementAgentConnector_ms": 0.23251056671142578}}, "episode_reward_max": 10.921000000000001, "episode_reward_min": 10.014, "episode_reward_mean": 10.724110000000001, "episode_len_mean": 37.75, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.921000000000001, 10.729, 10.61, 10.73, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.729, 10.204, 10.521, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.014, 10.73, 10.814, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.628, 10.73, 10.73, 10.623000000000001, 10.73, 10.729, 10.729, 10.73, 10.729, 10.729, 10.73, 10.729, 10.73, 10.73, 10.917, 10.73, 10.73, 10.729, 10.921000000000001, 10.526000000000002, 10.917, 10.73, 10.919, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.831, 10.73, 10.919, 10.73, 10.73, 10.73, 10.73, 10.526000000000002, 10.73, 10.623000000000001, 10.73, 10.917, 10.729000000000001, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.716000000000001, 10.628, 10.628, 10.809999999999999, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.532000000000002, 10.921000000000001, 10.628, 10.628, 10.73, 10.838000000000001, 10.917000000000002], "episode_lengths": [38, 37, 38, 36, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 36, 37, 38, 38, 38, 38, 38, 38, 37, 38, 36, 38, 38, 38, 38, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 39, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5429854039927295, "mean_inference_ms": 1.4030157937262888, "mean_action_processing_ms": 0.08090821283695247, "mean_env_wait_ms": 4.925740569780325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036745071411132812, "ViewRequirementAgentConnector_ms": 0.23251056671142578}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92158, "num_agent_steps_trained": 0, "num_env_steps_sampled": 92160, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 19.264593919026094, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 92160, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 92158, "timers": {"training_iteration_time_ms": 52167.536, "sample_time_ms": 7151.603, "synch_weights_time_ms": 81.34}, "counters": {"num_env_steps_sampled": 92160, "num_env_steps_trained": 0, "num_agent_steps_sampled": 92158, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 1998, "training_iteration": 90, "trial_id": "default", "date": "2025-12-20_12-03-42", "timestamp": 1766203422, "time_this_iter_s": 53.15780735015869, "time_total_s": 4532.52095580101, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4532.52095580101, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 86.39333333333335, "ram_util_percent": 16.810666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.13137246519327164}, "default_policy": {"total_loss": 0.13137246519327164, "policy_loss": -0.0033613643492572008, "vf_loss": 0.5392294481396676, "vf_loss_unclipped": 1.700929831713438, "vf_explained_var": 0.9256466969847679, "entropy": 0.09189061466604471, "mean_kl_loss": 0.00017458623945050268, "gradients_default_optimizer_global_norm": 0.2091734239831567, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0007201562499999999, "curr_kl_coeff": 9.094947153254554e-14}}, "num_env_steps_sampled": 93184, "num_env_steps_trained": 0, "num_agent_steps_sampled": 93182, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.056000000000001, "episode_reward_min": 10.32, "episode_reward_mean": 10.745690000000002, "episode_len_mean": 37.81, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.73, 10.921000000000001, 10.628, 10.73, 10.73, 10.623000000000001, 10.73, 10.729, 10.729, 10.73, 10.729, 10.729, 10.73, 10.729, 10.73, 10.73, 10.917, 10.73, 10.73, 10.729, 10.921000000000001, 10.526000000000002, 10.917, 10.73, 10.919, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.831, 10.73, 10.919, 10.73, 10.73, 10.73, 10.73, 10.526000000000002, 10.73, 10.623000000000001, 10.73, 10.917, 10.729000000000001, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.716000000000001, 10.628, 10.628, 10.809999999999999, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.532000000000002, 10.921000000000001, 10.628, 10.628, 10.73, 10.838000000000001, 10.917000000000002, 10.73, 10.921000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.32, 10.73, 10.73, 10.921000000000001, 10.532000000000002, 10.73, 10.73, 10.921000000000001, 11.056000000000001, 10.729000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.621, 10.73, 10.82, 10.73, 10.73, 10.73], "episode_lengths": [38, 38, 38, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 39, 37, 38, 37, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 37, 41, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5433295992854766, "mean_inference_ms": 1.4030635664541962, "mean_action_processing_ms": 0.08091138380674259, "mean_env_wait_ms": 4.925503901726244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035119056701660156, "ViewRequirementAgentConnector_ms": 0.23328137397766113}}, "episode_reward_max": 11.056000000000001, "episode_reward_min": 10.32, "episode_reward_mean": 10.745690000000002, "episode_len_mean": 37.81, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.73, 10.921000000000001, 10.628, 10.73, 10.73, 10.623000000000001, 10.73, 10.729, 10.729, 10.73, 10.729, 10.729, 10.73, 10.729, 10.73, 10.73, 10.917, 10.73, 10.73, 10.729, 10.921000000000001, 10.526000000000002, 10.917, 10.73, 10.919, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.831, 10.73, 10.919, 10.73, 10.73, 10.73, 10.73, 10.526000000000002, 10.73, 10.623000000000001, 10.73, 10.917, 10.729000000000001, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.716000000000001, 10.628, 10.628, 10.809999999999999, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.532000000000002, 10.921000000000001, 10.628, 10.628, 10.73, 10.838000000000001, 10.917000000000002, 10.73, 10.921000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.32, 10.73, 10.73, 10.921000000000001, 10.532000000000002, 10.73, 10.73, 10.921000000000001, 11.056000000000001, 10.729000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.621, 10.73, 10.82, 10.73, 10.73, 10.73], "episode_lengths": [38, 38, 38, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 39, 37, 38, 37, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 37, 41, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5433295992854766, "mean_inference_ms": 1.4030635664541962, "mean_action_processing_ms": 0.08091138380674259, "mean_env_wait_ms": 4.925503901726244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035119056701660156, "ViewRequirementAgentConnector_ms": 0.23328137397766113}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93182, "num_agent_steps_trained": 0, "num_env_steps_sampled": 93184, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 19.078019740486052, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 93184, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 93182, "timers": {"training_iteration_time_ms": 52502.2, "sample_time_ms": 7156.443, "synch_weights_time_ms": 81.418}, "counters": {"num_env_steps_sampled": 93184, "num_env_steps_trained": 0, "num_agent_steps_sampled": 93182, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2025, "training_iteration": 91, "trial_id": "default", "date": "2025-12-20_12-04-35", "timestamp": 1766203475, "time_this_iter_s": 53.67787432670593, "time_total_s": 4586.198830127716, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4586.198830127716, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 86.66710526315788, "ram_util_percent": 16.36842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1025.0, "total_loss": 0.12911142763204692}, "default_policy": {"total_loss": 0.12911142763204692, "policy_loss": -0.001355329931645495, "vf_loss": 0.5221121561963383, "vf_loss_unclipped": 1.6236740590595617, "vf_explained_var": 0.9307653802197154, "entropy": 0.08508941967312883, "mean_kl_loss": 0.0004329137171311697, "gradients_default_optimizer_global_norm": 0.1648080610647434, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.000640078125, "curr_kl_coeff": 4.547473576627277e-14}}, "num_env_steps_sampled": 94208, "num_env_steps_trained": 0, "num_agent_steps_sampled": 94207, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.056000000000001, "episode_reward_min": 10.32, "episode_reward_mean": 10.747010000000003, "episode_len_mean": 37.83, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.921000000000001, 10.73, 10.831, 10.73, 10.919, 10.73, 10.73, 10.73, 10.73, 10.526000000000002, 10.73, 10.623000000000001, 10.73, 10.917, 10.729000000000001, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.716000000000001, 10.628, 10.628, 10.809999999999999, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.532000000000002, 10.921000000000001, 10.628, 10.628, 10.73, 10.838000000000001, 10.917000000000002, 10.73, 10.921000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.32, 10.73, 10.73, 10.921000000000001, 10.532000000000002, 10.73, 10.73, 10.921000000000001, 11.056000000000001, 10.729000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.621, 10.73, 10.82, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.729, 10.532000000000002, 10.526000000000002, 10.73, 10.729, 10.841000000000001, 10.628, 10.73, 10.73, 10.919, 10.73, 10.73, 10.73, 10.921000000000001, 10.921000000000001, 10.73, 10.921000000000001, 10.729, 10.73, 10.73, 10.73, 10.73, 10.920000000000002], "episode_lengths": [38, 38, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 39, 37, 38, 37, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 37, 41, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 38, 38, 37, 38, 38, 38, 37, 37, 38, 37, 38, 38, 38, 38, 38, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5436451703438181, "mean_inference_ms": 1.4028502423722917, "mean_action_processing_ms": 0.08089593466422933, "mean_env_wait_ms": 4.924889523086637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003503561019897461, "ViewRequirementAgentConnector_ms": 0.23211193084716797}}, "episode_reward_max": 11.056000000000001, "episode_reward_min": 10.32, "episode_reward_mean": 10.747010000000003, "episode_len_mean": 37.83, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.921000000000001, 10.73, 10.831, 10.73, 10.919, 10.73, 10.73, 10.73, 10.73, 10.526000000000002, 10.73, 10.623000000000001, 10.73, 10.917, 10.729000000000001, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.716000000000001, 10.628, 10.628, 10.809999999999999, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.532000000000002, 10.921000000000001, 10.628, 10.628, 10.73, 10.838000000000001, 10.917000000000002, 10.73, 10.921000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.32, 10.73, 10.73, 10.921000000000001, 10.532000000000002, 10.73, 10.73, 10.921000000000001, 11.056000000000001, 10.729000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.621, 10.73, 10.82, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.729, 10.532000000000002, 10.526000000000002, 10.73, 10.729, 10.841000000000001, 10.628, 10.73, 10.73, 10.919, 10.73, 10.73, 10.73, 10.921000000000001, 10.921000000000001, 10.73, 10.921000000000001, 10.729, 10.73, 10.73, 10.73, 10.73, 10.920000000000002], "episode_lengths": [38, 38, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 39, 37, 38, 37, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 37, 41, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 38, 38, 37, 38, 38, 38, 37, 37, 38, 37, 38, 38, 38, 38, 38, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5436451703438181, "mean_inference_ms": 1.4028502423722917, "mean_action_processing_ms": 0.08089593466422933, "mean_env_wait_ms": 4.924889523086637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003503561019897461, "ViewRequirementAgentConnector_ms": 0.23211193084716797}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94207, "num_agent_steps_trained": 0, "num_env_steps_sampled": 94208, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 18.480424791223825, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 94208, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 94207, "timers": {"training_iteration_time_ms": 52957.463, "sample_time_ms": 7153.675, "synch_weights_time_ms": 82.316}, "counters": {"num_env_steps_sampled": 94208, "num_env_steps_trained": 0, "num_agent_steps_sampled": 94207, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2053, "training_iteration": 92, "trial_id": "default", "date": "2025-12-20_12-05-38", "timestamp": 1766203538, "time_this_iter_s": 55.41278028488159, "time_total_s": 4641.611610412598, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4641.611610412598, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 77.79550561797753, "ram_util_percent": 16.89438202247191}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1023.0, "total_loss": 0.08041746176313609}, "default_policy": {"total_loss": 0.08041746176313609, "policy_loss": -0.001447207247838378, "vf_loss": 0.3276548020541668, "vf_loss_unclipped": 0.681036214530468, "vf_explained_var": 0.9731442838907242, "entropy": 0.07659965809434652, "mean_kl_loss": 0.0003076719076327117, "gradients_default_optimizer_global_norm": 0.13883319087326526, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0005601562499999999, "curr_kl_coeff": 2.2737367883136385e-14}}, "num_env_steps_sampled": 95232, "num_env_steps_trained": 0, "num_agent_steps_sampled": 95230, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.056000000000001, "episode_reward_min": 10.32, "episode_reward_mean": 10.747210000000003, "episode_len_mean": 37.86, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.716000000000001, 10.628, 10.628, 10.809999999999999, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.532000000000002, 10.921000000000001, 10.628, 10.628, 10.73, 10.838000000000001, 10.917000000000002, 10.73, 10.921000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.32, 10.73, 10.73, 10.921000000000001, 10.532000000000002, 10.73, 10.73, 10.921000000000001, 11.056000000000001, 10.729000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.621, 10.73, 10.82, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.729, 10.532000000000002, 10.526000000000002, 10.73, 10.729, 10.841000000000001, 10.628, 10.73, 10.73, 10.919, 10.73, 10.73, 10.73, 10.921000000000001, 10.921000000000001, 10.73, 10.921000000000001, 10.729, 10.73, 10.73, 10.73, 10.73, 10.920000000000002, 10.63, 10.921000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.729, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.917, 10.73, 10.73, 10.917, 10.728, 10.838000000000001, 10.73, 10.729, 10.73, 10.73, 10.73], "episode_lengths": [38, 38, 37, 38, 38, 36, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 39, 37, 38, 37, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 37, 41, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 38, 38, 37, 38, 38, 38, 37, 37, 38, 37, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 39, 38, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5440007972413509, "mean_inference_ms": 1.4036277534231258, "mean_action_processing_ms": 0.08090741912788768, "mean_env_wait_ms": 4.9250080977259625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035457611083984375, "ViewRequirementAgentConnector_ms": 0.2333838939666748}}, "episode_reward_max": 11.056000000000001, "episode_reward_min": 10.32, "episode_reward_mean": 10.747210000000003, "episode_len_mean": 37.86, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.716000000000001, 10.628, 10.628, 10.809999999999999, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.532000000000002, 10.921000000000001, 10.628, 10.628, 10.73, 10.838000000000001, 10.917000000000002, 10.73, 10.921000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.32, 10.73, 10.73, 10.921000000000001, 10.532000000000002, 10.73, 10.73, 10.921000000000001, 11.056000000000001, 10.729000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.621, 10.73, 10.82, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.729, 10.532000000000002, 10.526000000000002, 10.73, 10.729, 10.841000000000001, 10.628, 10.73, 10.73, 10.919, 10.73, 10.73, 10.73, 10.921000000000001, 10.921000000000001, 10.73, 10.921000000000001, 10.729, 10.73, 10.73, 10.73, 10.73, 10.920000000000002, 10.63, 10.921000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.729, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.917, 10.73, 10.73, 10.917, 10.728, 10.838000000000001, 10.73, 10.729, 10.73, 10.73, 10.73], "episode_lengths": [38, 38, 37, 38, 38, 36, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 39, 37, 38, 37, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 37, 41, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 38, 38, 37, 38, 38, 38, 37, 37, 38, 37, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 39, 38, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5440007972413509, "mean_inference_ms": 1.4036277534231258, "mean_action_processing_ms": 0.08090741912788768, "mean_env_wait_ms": 4.9250080977259625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035457611083984375, "ViewRequirementAgentConnector_ms": 0.2333838939666748}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95230, "num_agent_steps_trained": 0, "num_env_steps_sampled": 95232, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 18.841973063792768, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 95232, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 95230, "timers": {"training_iteration_time_ms": 53297.646, "sample_time_ms": 7170.731, "synch_weights_time_ms": 82.262}, "counters": {"num_env_steps_sampled": 95232, "num_env_steps_trained": 0, "num_agent_steps_sampled": 95230, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2079, "training_iteration": 93, "trial_id": "default", "date": "2025-12-20_12-06-33", "timestamp": 1766203593, "time_this_iter_s": 54.3496778011322, "time_total_s": 4695.96128821373, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4695.96128821373, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 86.45512820512822, "ram_util_percent": 17.194871794871794}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.06678588883951306}, "default_policy": {"total_loss": 0.06678588883951306, "policy_loss": 0.0001862195902504027, "vf_loss": 0.2666032426059246, "vf_loss_unclipped": 0.6690676793456077, "vf_explained_var": 0.9740615233778953, "entropy": 0.09128689635545015, "mean_kl_loss": 0.00032950021567330624, "gradients_default_optimizer_global_norm": 0.1708294866140932, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.0004801562499999997, "curr_kl_coeff": 1.1368683941568192e-14}}, "num_env_steps_sampled": 96256, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96254, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 11.056000000000001, "episode_reward_min": 10.316, "episode_reward_mean": 10.74142, "episode_len_mean": 37.86, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.921000000000001, 10.532000000000002, 10.73, 10.73, 10.921000000000001, 11.056000000000001, 10.729000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.621, 10.73, 10.82, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.729, 10.532000000000002, 10.526000000000002, 10.73, 10.729, 10.841000000000001, 10.628, 10.73, 10.73, 10.919, 10.73, 10.73, 10.73, 10.921000000000001, 10.921000000000001, 10.73, 10.921000000000001, 10.729, 10.73, 10.73, 10.73, 10.73, 10.920000000000002, 10.63, 10.921000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.729, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.917, 10.73, 10.73, 10.917, 10.728, 10.838000000000001, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.326, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.628, 10.73, 10.316, 10.623000000000001, 10.73, 10.73, 10.73, 10.921000000000001, 10.622, 10.73, 10.63, 10.73, 10.921000000000001, 10.73, 10.73], "episode_lengths": [38, 37, 38, 38, 38, 37, 41, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 38, 38, 37, 38, 38, 38, 37, 37, 38, 37, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 37, 38, 38, 38, 37, 37, 38, 38, 38, 37, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5443314237768863, "mean_inference_ms": 1.4040853608414516, "mean_action_processing_ms": 0.08089652965996093, "mean_env_wait_ms": 4.92447716899274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035936832427978516, "ViewRequirementAgentConnector_ms": 0.23497223854064941}}, "episode_reward_max": 11.056000000000001, "episode_reward_min": 10.316, "episode_reward_mean": 10.74142, "episode_len_mean": 37.86, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.921000000000001, 10.532000000000002, 10.73, 10.73, 10.921000000000001, 11.056000000000001, 10.729000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.621, 10.73, 10.82, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.729, 10.532000000000002, 10.526000000000002, 10.73, 10.729, 10.841000000000001, 10.628, 10.73, 10.73, 10.919, 10.73, 10.73, 10.73, 10.921000000000001, 10.921000000000001, 10.73, 10.921000000000001, 10.729, 10.73, 10.73, 10.73, 10.73, 10.920000000000002, 10.63, 10.921000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.729, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.917, 10.73, 10.73, 10.917, 10.728, 10.838000000000001, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.326, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.628, 10.73, 10.316, 10.623000000000001, 10.73, 10.73, 10.73, 10.921000000000001, 10.622, 10.73, 10.63, 10.73, 10.921000000000001, 10.73, 10.73], "episode_lengths": [38, 37, 38, 38, 38, 37, 41, 38, 38, 38, 37, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 39, 38, 38, 38, 37, 38, 38, 38, 37, 37, 38, 37, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 37, 38, 38, 38, 37, 37, 38, 38, 38, 37, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5443314237768863, "mean_inference_ms": 1.4040853608414516, "mean_action_processing_ms": 0.08089652965996093, "mean_env_wait_ms": 4.92447716899274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035936832427978516, "ViewRequirementAgentConnector_ms": 0.23497223854064941}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96254, "num_agent_steps_trained": 0, "num_env_steps_sampled": 96256, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 19.053981284952787, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 96256, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 96254, "timers": {"training_iteration_time_ms": 53611.362, "sample_time_ms": 7177.465, "synch_weights_time_ms": 83.347}, "counters": {"num_env_steps_sampled": 96256, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96254, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2107, "training_iteration": 94, "trial_id": "default", "date": "2025-12-20_12-07-27", "timestamp": 1766203647, "time_this_iter_s": 53.74581456184387, "time_total_s": 4749.707102775574, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4749.707102775574, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 86.54473684210527, "ram_util_percent": 17.403947368421047}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.06751872124150396}, "default_policy": {"total_loss": 0.06751872124150396, "policy_loss": -0.0011356476694345473, "vf_loss": 0.27477325648069384, "vf_loss_unclipped": 0.6815458372235298, "vf_explained_var": 0.9736326768994331, "entropy": 0.08110573794692755, "mean_kl_loss": 0.00022657872277880297, "gradients_default_optimizer_global_norm": 0.044555820897221564, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00040015625000000034, "curr_kl_coeff": 5.684341970784096e-15}}, "num_env_steps_sampled": 97280, "num_env_steps_trained": 0, "num_agent_steps_sampled": 97278, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 10.925, "episode_reward_min": 10.316, "episode_reward_mean": 10.743300000000001, "episode_len_mean": 37.84, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.729, 10.841000000000001, 10.628, 10.73, 10.73, 10.919, 10.73, 10.73, 10.73, 10.921000000000001, 10.921000000000001, 10.73, 10.921000000000001, 10.729, 10.73, 10.73, 10.73, 10.73, 10.920000000000002, 10.63, 10.921000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.729, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.917, 10.73, 10.73, 10.917, 10.728, 10.838000000000001, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.326, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.628, 10.73, 10.316, 10.623000000000001, 10.73, 10.73, 10.73, 10.921000000000001, 10.622, 10.73, 10.63, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.920000000000002, 10.73, 10.73, 10.73, 10.73, 10.728, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.925, 10.73, 10.921000000000001, 10.73, 10.73], "episode_lengths": [38, 38, 39, 38, 38, 38, 37, 38, 38, 38, 37, 37, 38, 37, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 37, 38, 38, 38, 37, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5446959371089726, "mean_inference_ms": 1.4049657190656135, "mean_action_processing_ms": 0.08091279749808486, "mean_env_wait_ms": 4.924730654358463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035905838012695312, "ViewRequirementAgentConnector_ms": 0.23473811149597168}}, "episode_reward_max": 10.925, "episode_reward_min": 10.316, "episode_reward_mean": 10.743300000000001, "episode_len_mean": 37.84, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.729, 10.841000000000001, 10.628, 10.73, 10.73, 10.919, 10.73, 10.73, 10.73, 10.921000000000001, 10.921000000000001, 10.73, 10.921000000000001, 10.729, 10.73, 10.73, 10.73, 10.73, 10.920000000000002, 10.63, 10.921000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.729, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.917, 10.73, 10.73, 10.917, 10.728, 10.838000000000001, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.326, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.628, 10.73, 10.316, 10.623000000000001, 10.73, 10.73, 10.73, 10.921000000000001, 10.622, 10.73, 10.63, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.920000000000002, 10.73, 10.73, 10.73, 10.73, 10.728, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.925, 10.73, 10.921000000000001, 10.73, 10.73], "episode_lengths": [38, 38, 39, 38, 38, 38, 37, 38, 38, 38, 37, 37, 38, 37, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 37, 38, 38, 38, 37, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5446959371089726, "mean_inference_ms": 1.4049657190656135, "mean_action_processing_ms": 0.08091279749808486, "mean_env_wait_ms": 4.924730654358463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035905838012695312, "ViewRequirementAgentConnector_ms": 0.23473811149597168}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97278, "num_agent_steps_trained": 0, "num_env_steps_sampled": 97280, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 19.163365598246838, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 97280, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 97278, "timers": {"training_iteration_time_ms": 53656.334, "sample_time_ms": 7184.544, "synch_weights_time_ms": 83.365}, "counters": {"num_env_steps_sampled": 97280, "num_env_steps_trained": 0, "num_agent_steps_sampled": 97278, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2133, "training_iteration": 95, "trial_id": "default", "date": "2025-12-20_12-08-20", "timestamp": 1766203700, "time_this_iter_s": 53.43828463554382, "time_total_s": 4803.145387411118, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4803.145387411118, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 86.67631578947369, "ram_util_percent": 17.723684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.12677802070975303}, "default_policy": {"total_loss": 0.12677802070975303, "policy_loss": -0.0033983819419518115, "vf_loss": 0.5208309590816498, "vf_loss_unclipped": 1.628961380571127, "vf_explained_var": 0.9293976679444313, "entropy": 0.07831615153700114, "mean_kl_loss": 0.0006575128884719561, "gradients_default_optimizer_global_norm": 0.1808737832121551, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00032015625000000013, "curr_kl_coeff": 2.842170985392048e-15}}, "num_env_steps_sampled": 98304, "num_env_steps_trained": 0, "num_agent_steps_sampled": 98302, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 10.925, "episode_reward_min": 10.316, "episode_reward_mean": 10.740500000000003, "episode_len_mean": 37.86, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.729, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.917, 10.73, 10.73, 10.917, 10.728, 10.838000000000001, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.326, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.628, 10.73, 10.316, 10.623000000000001, 10.73, 10.73, 10.73, 10.921000000000001, 10.622, 10.73, 10.63, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.920000000000002, 10.73, 10.73, 10.73, 10.73, 10.728, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.925, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.919, 10.835, 10.838000000000001, 10.73, 10.814, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.917000000000002, 10.737000000000002, 10.73, 10.73, 10.628, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73], "episode_lengths": [38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 37, 38, 38, 38, 37, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 37, 38, 39, 38, 36, 38, 38, 38, 38, 38, 38, 37, 39, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5450566266612814, "mean_inference_ms": 1.4053376730631053, "mean_action_processing_ms": 0.08091812809624135, "mean_env_wait_ms": 4.924709169195287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003583192825317383, "ViewRequirementAgentConnector_ms": 0.23580670356750488}}, "episode_reward_max": 10.925, "episode_reward_min": 10.316, "episode_reward_mean": 10.740500000000003, "episode_len_mean": 37.86, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.729, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.917, 10.73, 10.73, 10.917, 10.728, 10.838000000000001, 10.73, 10.729, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.326, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.628, 10.73, 10.316, 10.623000000000001, 10.73, 10.73, 10.73, 10.921000000000001, 10.622, 10.73, 10.63, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.920000000000002, 10.73, 10.73, 10.73, 10.73, 10.728, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.925, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.919, 10.835, 10.838000000000001, 10.73, 10.814, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.917000000000002, 10.737000000000002, 10.73, 10.73, 10.628, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73], "episode_lengths": [38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 39, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 37, 38, 38, 38, 37, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 37, 38, 39, 38, 36, 38, 38, 38, 38, 38, 38, 37, 39, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5450566266612814, "mean_inference_ms": 1.4053376730631053, "mean_action_processing_ms": 0.08091812809624135, "mean_env_wait_ms": 4.924709169195287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003583192825317383, "ViewRequirementAgentConnector_ms": 0.23580670356750488}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98302, "num_agent_steps_trained": 0, "num_env_steps_sampled": 98304, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 19.251586289001008, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 98304, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 98302, "timers": {"training_iteration_time_ms": 53515.594, "sample_time_ms": 7182.185, "synch_weights_time_ms": 82.888}, "counters": {"num_env_steps_sampled": 98304, "num_env_steps_trained": 0, "num_agent_steps_sampled": 98302, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2161, "training_iteration": 96, "trial_id": "default", "date": "2025-12-20_12-09-13", "timestamp": 1766203753, "time_this_iter_s": 53.1955041885376, "time_total_s": 4856.340891599655, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4856.340891599655, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 86.46578947368421, "ram_util_percent": 17.884210526315787}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1025.0, "total_loss": 0.06866447068750858}, "default_policy": {"total_loss": 0.06866447068750858, "policy_loss": -3.9343336006490195e-05, "vf_loss": 0.2749168509390296, "vf_loss_unclipped": 0.5918052603558797, "vf_explained_var": 0.9770560787945259, "entropy": 0.07930837226350133, "mean_kl_loss": 0.0002364729259511651, "gradients_default_optimizer_global_norm": 0.05115296310041009, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00024007812500000027, "curr_kl_coeff": 1.421085492696024e-15}}, "num_env_steps_sampled": 99328, "num_env_steps_trained": 0, "num_agent_steps_sampled": 99327, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 10.925, "episode_reward_min": 10.316, "episode_reward_mean": 10.743440000000003, "episode_len_mean": 37.84, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.73, 10.73, 10.628, 10.73, 10.316, 10.623000000000001, 10.73, 10.73, 10.73, 10.921000000000001, 10.622, 10.73, 10.63, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.920000000000002, 10.73, 10.73, 10.73, 10.73, 10.728, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.925, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.919, 10.835, 10.838000000000001, 10.73, 10.814, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.917000000000002, 10.737000000000002, 10.73, 10.73, 10.628, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.628, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.728, 10.921000000000001], "episode_lengths": [38, 38, 38, 38, 38, 38, 37, 37, 38, 38, 38, 37, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 37, 38, 39, 38, 36, 38, 38, 38, 38, 38, 38, 37, 39, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5453710767340517, "mean_inference_ms": 1.4053154944348736, "mean_action_processing_ms": 0.08091855941713463, "mean_env_wait_ms": 4.924591892149177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034780502319335938, "ViewRequirementAgentConnector_ms": 0.23258471488952637}}, "episode_reward_max": 10.925, "episode_reward_min": 10.316, "episode_reward_mean": 10.743440000000003, "episode_len_mean": 37.84, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.73, 10.73, 10.628, 10.73, 10.316, 10.623000000000001, 10.73, 10.73, 10.73, 10.921000000000001, 10.622, 10.73, 10.63, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.920000000000002, 10.73, 10.73, 10.73, 10.73, 10.728, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.925, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.919, 10.835, 10.838000000000001, 10.73, 10.814, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.917000000000002, 10.737000000000002, 10.73, 10.73, 10.628, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.628, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.728, 10.921000000000001], "episode_lengths": [38, 38, 38, 38, 38, 38, 37, 37, 38, 38, 38, 37, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 37, 38, 39, 38, 36, 38, 38, 38, 38, 38, 38, 37, 39, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5453710767340517, "mean_inference_ms": 1.4053154944348736, "mean_action_processing_ms": 0.08091855941713463, "mean_env_wait_ms": 4.924591892149177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0034780502319335938, "ViewRequirementAgentConnector_ms": 0.23258471488952637}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99327, "num_agent_steps_trained": 0, "num_env_steps_sampled": 99328, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 18.932659912667624, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 99328, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 99327, "timers": {"training_iteration_time_ms": 53643.336, "sample_time_ms": 7182.232, "synch_weights_time_ms": 81.497}, "counters": {"num_env_steps_sampled": 99328, "num_env_steps_trained": 0, "num_agent_steps_sampled": 99327, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2188, "training_iteration": 97, "trial_id": "default", "date": "2025-12-20_12-10-15", "timestamp": 1766203815, "time_this_iter_s": 54.089646339416504, "time_total_s": 4910.430537939072, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4910.430537939072, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 77.2919540229885, "ram_util_percent": 17.23448275862069}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1023.0, "total_loss": 0.0767717796145007}, "default_policy": {"total_loss": 0.0767717796145007, "policy_loss": -0.000533103384077549, "vf_loss": 0.30929172933101656, "vf_loss_unclipped": 0.685365155339241, "vf_explained_var": 0.9729186460375786, "entropy": 0.07516808342188597, "mean_kl_loss": 0.00024408008118737, "gradients_default_optimizer_global_norm": 0.16010715393349528, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 0.00016015625000000014, "curr_kl_coeff": 7.10542746348012e-16}}, "num_env_steps_sampled": 100352, "num_env_steps_trained": 0, "num_agent_steps_sampled": 100350, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 10.925, "episode_reward_min": 10.523000000000001, "episode_reward_mean": 10.746250000000002, "episode_len_mean": 37.81, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.920000000000002, 10.73, 10.73, 10.73, 10.73, 10.728, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.925, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.919, 10.835, 10.838000000000001, 10.73, 10.814, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.917000000000002, 10.737000000000002, 10.73, 10.73, 10.628, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.628, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.728, 10.921000000000001, 10.73, 10.73, 10.623000000000001, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.621, 10.921000000000001, 10.73, 10.73, 10.628, 10.73, 10.628, 10.73, 10.523000000000001, 10.73, 10.73, 10.616000000000001, 10.921000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.73], "episode_lengths": [37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 37, 38, 39, 38, 36, 38, 38, 38, 38, 38, 38, 37, 39, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 37, 38, 38, 37, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5456669122388068, "mean_inference_ms": 1.4052696635576183, "mean_action_processing_ms": 0.0809187589935672, "mean_env_wait_ms": 4.924440205328086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003476858139038086, "ViewRequirementAgentConnector_ms": 0.23210358619689941}}, "episode_reward_max": 10.925, "episode_reward_min": 10.523000000000001, "episode_reward_mean": 10.746250000000002, "episode_len_mean": 37.81, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.920000000000002, 10.73, 10.73, 10.73, 10.73, 10.728, 10.623000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.925, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.919, 10.835, 10.838000000000001, 10.73, 10.814, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.917000000000002, 10.737000000000002, 10.73, 10.73, 10.628, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.628, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.728, 10.921000000000001, 10.73, 10.73, 10.623000000000001, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.621, 10.921000000000001, 10.73, 10.73, 10.628, 10.73, 10.628, 10.73, 10.523000000000001, 10.73, 10.73, 10.616000000000001, 10.921000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.73], "episode_lengths": [37, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 37, 38, 38, 38, 38, 37, 38, 39, 38, 36, 38, 38, 38, 38, 38, 38, 37, 39, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 37, 38, 38, 37, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5456669122388068, "mean_inference_ms": 1.4052696635576183, "mean_action_processing_ms": 0.0809187589935672, "mean_env_wait_ms": 4.924440205328086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.003476858139038086, "ViewRequirementAgentConnector_ms": 0.23210358619689941}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100350, "num_agent_steps_trained": 0, "num_env_steps_sampled": 100352, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 19.21918749462966, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 100352, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 100350, "timers": {"training_iteration_time_ms": 53687.033, "sample_time_ms": 7187.337, "synch_weights_time_ms": 82.191}, "counters": {"num_env_steps_sampled": 100352, "num_env_steps_trained": 0, "num_agent_steps_sampled": 100350, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2215, "training_iteration": 98, "trial_id": "default", "date": "2025-12-20_12-11-08", "timestamp": 1766203868, "time_this_iter_s": 53.28345203399658, "time_total_s": 4963.713989973068, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4963.713989973068, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 86.7013157894737, "ram_util_percent": 16.919736842105262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.06599599849432707}, "default_policy": {"total_loss": 0.06599599849432707, "policy_loss": -0.0006687358254566789, "vf_loss": 0.26671712212264537, "vf_loss_unclipped": 0.587793942540884, "vf_explained_var": 0.977128590643406, "entropy": 0.0907953403890133, "mean_kl_loss": 0.0003907345457347944, "gradients_default_optimizer_global_norm": 0.0850260918494314, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 8.01562499999995e-05, "curr_kl_coeff": 3.55271373174006e-16}}, "num_env_steps_sampled": 101376, "num_env_steps_trained": 0, "num_agent_steps_sampled": 101374, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 10.921000000000001, "episode_reward_min": 10.523000000000001, "episode_reward_mean": 10.750470000000002, "episode_len_mean": 37.75, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.73, 10.73, 10.917000000000002, 10.737000000000002, 10.73, 10.73, 10.628, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.628, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.728, 10.921000000000001, 10.73, 10.73, 10.623000000000001, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.621, 10.921000000000001, 10.73, 10.73, 10.628, 10.73, 10.628, 10.73, 10.523000000000001, 10.73, 10.73, 10.616000000000001, 10.921000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.921000000000001, 10.919, 10.920000000000002, 10.918000000000001, 10.73, 10.602, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.921000000000001, 10.921000000000001, 10.73, 10.919, 10.73, 10.623000000000001], "episode_lengths": [38, 38, 38, 38, 37, 39, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 37, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 37, 37, 37, 37, 38, 36, 38, 38, 38, 37, 38, 37, 37, 38, 37, 38, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5460529647496146, "mean_inference_ms": 1.4054418098433745, "mean_action_processing_ms": 0.08093289220038775, "mean_env_wait_ms": 4.924710136592053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035779476165771484, "ViewRequirementAgentConnector_ms": 0.23522210121154785}}, "episode_reward_max": 10.921000000000001, "episode_reward_min": 10.523000000000001, "episode_reward_mean": 10.750470000000002, "episode_len_mean": 37.75, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.73, 10.73, 10.73, 10.73, 10.917000000000002, 10.737000000000002, 10.73, 10.73, 10.628, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.628, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.728, 10.921000000000001, 10.73, 10.73, 10.623000000000001, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.621, 10.921000000000001, 10.73, 10.73, 10.628, 10.73, 10.628, 10.73, 10.523000000000001, 10.73, 10.73, 10.616000000000001, 10.921000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.921000000000001, 10.919, 10.920000000000002, 10.918000000000001, 10.73, 10.602, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.921000000000001, 10.921000000000001, 10.73, 10.919, 10.73, 10.623000000000001], "episode_lengths": [38, 38, 38, 38, 37, 39, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 37, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 37, 37, 37, 37, 38, 36, 38, 38, 38, 37, 38, 37, 37, 38, 37, 38, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5460529647496146, "mean_inference_ms": 1.4054418098433745, "mean_action_processing_ms": 0.08093289220038775, "mean_env_wait_ms": 4.924710136592053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0035779476165771484, "ViewRequirementAgentConnector_ms": 0.23522210121154785}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101374, "num_agent_steps_trained": 0, "num_env_steps_sampled": 101376, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 19.235346199031046, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 101376, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 101374, "timers": {"training_iteration_time_ms": 53755.475, "sample_time_ms": 7217.965, "synch_weights_time_ms": 83.694}, "counters": {"num_env_steps_sampled": 101376, "num_env_steps_trained": 0, "num_agent_steps_sampled": 101374, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2242, "training_iteration": 99, "trial_id": "default", "date": "2025-12-20_12-12-01", "timestamp": 1766203921, "time_this_iter_s": 53.238492488861084, "time_total_s": 5016.952482461929, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5016.952482461929, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 85.936, "ram_util_percent": 17.280000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 256.0, "num_env_steps_trained": 1024.0, "total_loss": 0.1021809782832861}, "default_policy": {"total_loss": 0.1021809782832861, "policy_loss": -0.003507894231006503, "vf_loss": 0.42278464138507843, "vf_loss_unclipped": 1.3695935055613517, "vf_explained_var": 0.9452704355120659, "entropy": 0.09087384045124054, "mean_kl_loss": 0.0010766852350229783, "gradients_default_optimizer_global_norm": 0.18713640701025724, "default_optimizer_lr": 0.0003, "curr_lr": 0.0003, "curr_entropy_coeff": 1.5625000000015626e-07, "curr_kl_coeff": 1.77635686587003e-16}}, "num_env_steps_sampled": 102400, "num_env_steps_trained": 0, "num_agent_steps_sampled": 102398, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 12.040000000000003, "episode_reward_min": 10.144000000000002, "episode_reward_mean": 10.760360000000006, "episode_len_mean": 37.74, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.921000000000001, 10.628, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.728, 10.921000000000001, 10.73, 10.73, 10.623000000000001, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.621, 10.921000000000001, 10.73, 10.73, 10.628, 10.73, 10.628, 10.73, 10.523000000000001, 10.73, 10.73, 10.616000000000001, 10.921000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.921000000000001, 10.919, 10.920000000000002, 10.918000000000001, 10.73, 10.602, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.921000000000001, 10.921000000000001, 10.73, 10.919, 10.73, 10.623000000000001, 10.73, 10.921000000000001, 10.921000000000001, 10.144000000000002, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.426, 10.728, 10.73, 10.73, 10.921000000000001, 10.73, 10.921000000000001, 10.73, 12.040000000000003, 10.921000000000001, 10.729000000000001, 10.73, 10.73, 10.63, 10.73, 10.73], "episode_lengths": [37, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 37, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 37, 37, 37, 37, 38, 36, 38, 38, 38, 37, 38, 37, 37, 38, 37, 38, 37, 38, 37, 37, 41, 38, 38, 37, 38, 38, 38, 38, 37, 38, 38, 38, 37, 38, 37, 38, 39, 37, 38, 38, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5464631456314966, "mean_inference_ms": 1.4057849683553814, "mean_action_processing_ms": 0.08095482411682337, "mean_env_wait_ms": 4.925434745326955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036170482635498047, "ViewRequirementAgentConnector_ms": 0.2373809814453125}}, "episode_reward_max": 12.040000000000003, "episode_reward_min": 10.144000000000002, "episode_reward_mean": 10.760360000000006, "episode_len_mean": 37.74, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.921000000000001, 10.628, 10.628, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.73, 10.728, 10.921000000000001, 10.73, 10.73, 10.623000000000001, 10.73, 10.73, 10.729, 10.73, 10.73, 10.73, 10.621, 10.921000000000001, 10.73, 10.73, 10.628, 10.73, 10.628, 10.73, 10.523000000000001, 10.73, 10.73, 10.616000000000001, 10.921000000000001, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.729, 10.73, 10.73, 10.63, 10.73, 10.73, 10.73, 10.73, 10.921000000000001, 10.921000000000001, 10.919, 10.920000000000002, 10.918000000000001, 10.73, 10.602, 10.73, 10.73, 10.73, 10.921000000000001, 10.73, 10.921000000000001, 10.921000000000001, 10.73, 10.919, 10.73, 10.623000000000001, 10.73, 10.921000000000001, 10.921000000000001, 10.144000000000002, 10.73, 10.73, 10.921000000000001, 10.73, 10.73, 10.73, 10.73, 10.426, 10.728, 10.73, 10.73, 10.921000000000001, 10.73, 10.921000000000001, 10.73, 12.040000000000003, 10.921000000000001, 10.729000000000001, 10.73, 10.73, 10.63, 10.73, 10.73], "episode_lengths": [37, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 37, 38, 38, 38, 38, 38, 38, 37, 38, 38, 36, 37, 38, 38, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 37, 37, 37, 37, 38, 36, 38, 38, 38, 37, 38, 37, 37, 38, 37, 38, 37, 38, 37, 37, 41, 38, 38, 37, 38, 38, 38, 38, 37, 38, 38, 38, 37, 38, 37, 38, 39, 37, 38, 38, 38, 38, 38, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5464631456314966, "mean_inference_ms": 1.4057849683553814, "mean_action_processing_ms": 0.08095482411682337, "mean_env_wait_ms": 4.925434745326955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.0036170482635498047, "ViewRequirementAgentConnector_ms": 0.2373809814453125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102398, "num_agent_steps_trained": 0, "num_env_steps_sampled": 102400, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 19.292753689851462, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 102400, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 102398, "timers": {"training_iteration_time_ms": 53747.717, "sample_time_ms": 7241.331, "synch_weights_time_ms": 81.478}, "counters": {"num_env_steps_sampled": 102400, "num_env_steps_trained": 0, "num_agent_steps_sampled": 102398, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2269, "training_iteration": 100, "trial_id": "default", "date": "2025-12-20_12-12-55", "timestamp": 1766203975, "time_this_iter_s": 53.07993221282959, "time_total_s": 5070.032414674759, "pid": 1031031, "hostname": "platform10-server", "node_ip": "100.99.95.105", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "chinese_checker_v0", "env_config": {"triangle_size": 2, "action_space": "Discrete(973)", "max_iters": 100, "render_mode": null, "observation_space": "Box(0, 1, (324,), int8)"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0003, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1024, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x752ea201da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x752ea0bab910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ChineseChecker.models.action_masking_rlm.TorchActionMaskRLM'>, observation_space=None, action_space=None, model_config_dict={'fcnet_hiddens': [512, 256, 128]}, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0003], [51200, 0.00015], [102400, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": [[0, 0.01], [51200, 0.004], [102400, 0.0]], "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5070.032414674759, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 86.24868421052632, "ram_util_percent": 17.627631578947366}}
